<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE us-patent-grant SYSTEM "us-patent-grant-v42-2006-08-23.dtd" [ ]>
<my-root>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353040-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353040</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12031832</doc-number>
<date>20080215</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>IL</country>
<doc-number>181426</doc-number>
<date>20070219</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>1044</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>18</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>11</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 24</main-classification>
<further-classification>726 22</further-classification>
<further-classification>726 25</further-classification>
<further-classification>714 48</further-classification>
</classification-national>
<invention-title id="d2e71">Automatic extraction of signatures for malware</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5452442</doc-number>
<kind>A</kind>
<name>Kephart</name>
<date>19950900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6487666</doc-number>
<kind>B1</kind>
<name>Shanklin et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 23</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7234167</doc-number>
<kind>B2</kind>
<name>Teblyashkin et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7409717</doc-number>
<kind>B1</kind>
<name>Szor</name>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7574742</doc-number>
<kind>B2</kind>
<name>Yang et al.</name>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7634810</doc-number>
<kind>B2</kind>
<name>Goodman et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7639714</doc-number>
<kind>B2</kind>
<name>Stolfo et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370474</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>8201244</doc-number>
<kind>B2</kind>
<name>Sun et al.</name>
<date>20120600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2003/0023865</doc-number>
<kind>A1</kind>
<name>Cowie et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713200</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2004/0039921</doc-number>
<kind>A1</kind>
<name>Chuang</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713187</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2004/0133796</doc-number>
<kind>A1</kind>
<name>Cohen et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713200</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2005/0027686</doc-number>
<kind>A1</kind>
<name>Shipp</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  3</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2005/0071649</doc-number>
<kind>A1</kind>
<name>Shipp</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713188</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2005/0108562</doc-number>
<kind>A1</kind>
<name>Khazan et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713200</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2006/0015630</doc-number>
<kind>A1</kind>
<name>Stolfo et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709230</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2006/0212942</doc-number>
<kind>A1</kind>
<name>Barford et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2007/0083513</doc-number>
<kind>A1</kind>
<name>Cohen et al.</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  6</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2007/0180528</doc-number>
<kind>A1</kind>
<name>Kane</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2008/0127336</doc-number>
<kind>A1</kind>
<name>Sun et al.</name>
<date>20080500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>EP</country>
<doc-number>1494427</doc-number>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>EP</country>
<doc-number>1742151</doc-number>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>GB</country>
<doc-number>2391965</doc-number>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00023">
<othercit>Weber, M. et al: &#x201c;A toolkit for . . . software&#x201d; Computer Security Applications Conference, IEEE, Dec. 9-13, 2002; pp. 423-431, XP010627054.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00024">
<othercit>Lemos, R, Counting the Cost of Slammer, CNET news.com. http://news.com.com/2100-1001-982955.html, Jan. 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00025">
<othercit>Yong Tang, Shigang Chen, Defending Against Internet Worms: A Signature-Based Approach, in Proc. of IEEE INFOCOM'05, Miami, Florida, USA, May 2005.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00026">
<othercit>Ke Wang and Salvatore J. Stolfo, &#x201c;Anomalous payload-based network intrusion detection&#x201d;, in Recent Advance in Intrusion Detection (RAID), Sep. 2004.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00027">
<othercit>David Brumley, et al., &#x201c;Towards Automatic Generation of Vulnerability-Based Signatures&#x201d;, in the Proceedings of the 2006 IEEE Symposium on Security and Privacy.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00028">
<othercit>N. Provos, &#x201c;A virtual Honeypot Framework,&#x201d; Center for Info. Tech. Integration, Univ. of Michigan, Ann Arbor, Michigan, USA, Tech. Rep. CITI Tech. Rep. 03-1, Oct. 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00029">
<othercit>Kim, H.-A. et al., &#x201c;Autograph: Toward Automated, Distributed Worm Signature Detection&#x201d;, in Proc. of the 13th Usenix Security Symp. (Security 2004), San Diego, CA, Aug. 2004.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00030">
<othercit>Vinod Yegneswaran et al., &#x201c;An architecture for generating semantics-aware signatures in 14th USENIX Security Symposium&#x201d;, Baltimore, Maryland, Aug. 2005.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00031">
<othercit>Mihai Christodorescu, et al., &#x201c;Semantics-aware malware detection&#x201d; in IEEE Symposium on Security and Privacy, Oakland, California, May 2005.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00032">
<othercit>Statically linked libraries; http://en.wikipedia.org/wiki/Statically<sub>&#x2014;</sub>linked<sub>&#x2014;</sub>library, Jul. 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>13</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 22- 26</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>2</number-of-drawing-sheets>
<number-of-figures>2</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20080201779</doc-number>
<kind>A1</kind>
<date>20080821</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Tahan</last-name>
<first-name>Gil</first-name>
<address>
<city>Omer</city>
<country>IL</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>IL</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Shabtai</last-name>
<first-name>Asaf</first-name>
<address>
<city>Carne Yosef</city>
<country>IL</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>IL</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Elovici</last-name>
<first-name>Yuval</first-name>
<address>
<city>Arugot</city>
<country>IL</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>IL</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Roach Brown McCarthy &#x26; Gruber, P.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>McCarthy</last-name>
<first-name>Kevin D.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<examiners>
<primary-examiner>
<last-name>Edwards</last-name>
<first-name>Linglan</first-name>
<department>2491</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Method for the automatic generation of malware signatures from computer files. A common function library (CFL) created, wherein the CFL contains any functions identified as a part of the standard computer language used to write computer files which are known as not containing malware. The functions of a computer file which does contain a malware are extracted and the CFL is updated with any new common functions if necessary, such that the remaining functions are all considered as candidates for generating the malware signature. The remaining functions are divided into clusters according to their location in the file and the optimal cluster for generating the malware signature is determined. One or more of the functions in the optimal cluster is selected randomly, as the malware signature.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="89.75mm" wi="224.03mm" file="US08353040-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="228.09mm" wi="113.11mm" orientation="landscape" file="US08353040-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="216.83mm" wi="133.01mm" orientation="landscape" file="US08353040-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CLAIM OF PRIORITY</heading>
<p id="p-0002" num="0001">This application claims priority to Israeli patent application number 181426, filed on Feb. 19, 2007.</p>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to the field of network security. Specifically, this invention relates to automatic extraction of signatures for malware, which can be later used in order to identify files which are infected with malware.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">During recent years, the number of malware attacks on computer networks has increased dramatically, as has the dependence of companies and government agencies on their computer networks. Consequently, many efforts are made in order to provide computer and data protection in multi-connectivity data networks.</p>
<p id="p-0005" num="0004">A single malware (malicious software) in a computerized system, intruding the system from the computer network, can result in the loss and/or unauthorized utilization and/or modification of large amounts of data. As a case in point, the total cost of the Code Red worm epidemic, as measured in lost productivity owing to interruptions in computer and network services, is estimated at $2.6 billion (Lemos, R, Counting the Cost of Slammer, CNET news, January 2003).</p>
<p id="p-0006" num="0005">Many malware protection methods rely on malware signatures generated from malware-containing files. Generally, such signatures are compared to the code of any file traveling on the internet, and if similar segments of code are found in any file, that file is forbidden continued progress across the internet.</p>
<p id="p-0007" num="0006">Automated signature generation for new attacks of this type is extremely difficult due to several reasons (Yong Tang, Shigang Chen, Defending Against Internet Worms: A Signature-Based Approach, in Proc. of IEEE INFOCOM'05, Miami, Fla., USA, May 2005). First, in order to create an attack signature, the attack traffic must be isolated from the legitimate traffic, which is not an easy task in all situations. Second, the signature generation must be general enough to capture all attack traffic of certain type but still be specific enough to avoid overlapping with the contents of normal traffic. Nowadays, the above problems are handled in an ad-hoc manner, based on human judgment. As a case in point, current rule-based network Intrusion Detection Systems (IDS) can do little to stop zero-day worms (Ke Wang and Salvatore J. Stolfo, &#x201c;anomalous payload-based network intrusion detection&#x201d;, in Recent Advance in Intrusion Detection (RAID), September 2004). Such systems depend upon signatures only known after the worm has been launched successfully, essentially disclosing its contents and method of infection for later deployment.</p>
<p id="p-0008" num="0007">Various techniques have been proposed to derive malware signatures automatically, including among others: Vulnerability-based Signatures (David Brumley, et al., &#x201c;Towards Automatic Generation of Vulnerability-Based Signatures&#x201d;, in the Proceedings of the 2006 IEEE Symposium on Security and Privacy); Payload-based Signatures (Ke Wang and Salvatore J. Stolfo, &#x201c;anomalous payload-based network intrusion detection&#x201d;, in Recent Advance in Intrusion Detection (RAID), September 2004; Kim, H.-A. and Karp, B., &#x201c;Autograph: Toward Automated, Distributed Worm Signature Detection&#x201d;, in <i>Proceedings of the </i>13<i>th Usenix Security Symposium </i>(<i>Security </i>2004), San Diego, Calif., August, 2004); Semantic-Aware Signatures (Vinod Yegneswaran et al., &#x201c;An architecture for generating semantics-aware signatures In 14th USENIX Security Symposium&#x201d;, Baltimore, Md., August 2005); The Amd Algorithm (Mihai Christodorescu, et al., &#x201c;Semantics-aware malware detection&#x201d; in IEEE Symposium on Security and Privacy, Oakland, Calif., May 2005) and Honeypot-based Signatures (Yong Tang, Shigang Chen, Defending Against Internet Worms: A Signature-Based Approach, in Proc. of IEEE INFOCOM'05, Miami, Fla., USA, May 2005).</p>
<p id="p-0009" num="0008">One of the main drawbacks of the prior art techniques, including those listed above, is that they tend to overemphasize the protection against recent worm epidemics and do not provide a general-purpose technique which can handle other types of malware as well. Moreover, signatures generated by the prior art techniques examine suspicious code by modeling malicious patterns in communication packets, payloads, unsuccessful connections, sessions and code structure (templates). Such signatures were tested and reported to be effective for small-sized malware. Nevertheless, they ignore the fact that many types of malware appear as full-fledged executable and therefore contain a significant portion of common-code emanating from the development tools and software packages used by the malware authors. Such common code is fixed across malware instances due to the fact that hackers usually repeatedly exploit a &#x201c;toolbox&#x201d; including a set of functions which enable them to generate various malware instances. Since signature-based systems do not examine malware at the executable level and do not account for these common code segments, which can be quite large, the quality of the signature generation mechanisms is dubious. Such quality is measured using the following criteria: sensitivity (low false negative for malware) and specificity (low false positive for innocuous traffic).</p>
<p id="p-0010" num="0009">In the art there have been developed several methods aiming at expediting the process of signature generation for the effective containment of worms. &#x201c;Autograph&#x201d; (Kim, H.-A. and Karp, B., &#x201c;Autograph: Toward Automated, Distributed Worm Signature Detection&#x201d;, in <i>Proceedings of the </i>13<i>th Usenix Security Symposium </i>(<i>Security </i>2004), San Diego, Calif., August, 2004), for example, stores source and destination addresses of each inbound unsuccessful TCP connection it observes. Once an external host has made unsuccessful connection attempts to more than a predetermined number of internal IP addresses, the flow classifier considers it to be a scanner. All successful connections from an IP address flagged as scanners are classified as suspicious, and their inbound packets written to the suspicious flow pool. In the next stage &#x201c;Autograph&#x201d; selects the most frequently occurring byte sequences across the flows in the suspicious flow pool and stores them as signatures. At the beginning of a worm's propagation, the aggregate rate at which all infected hosts scan the IP address space is relatively low. However, since &#x201c;Autograph&#x201d; relies on &#x201c;overhearing&#x201d; unsuccessful scans to identify suspicious source IP addresses, early in an epidemic an &#x201c;Autograph&#x201d; monitor is slow to accumulate suspicious addresses, and in turn slow to accumulate worm payloads. To address this problem &#x201c;Autograph&#x201d; uses a tattler that, as its name suggests, shares suspicious source addresses among all monitors, toward the goal of accelerating the accumulation of worm payloads.</p>
<p id="p-0011" num="0010">Tang and Chen (Yong Tang, Shigang Chen, Defending Against Internet Worms: A Signature-Based Approach, in Proc. of IEEE INFOCOM'05, Miami, Fla., USA, May 2005) addressed the above problems by designing a double-honeypot system (N. Provos, &#x201c;A virtual Honeypot Framework,&#x201d; Center for Information Technology Integration, University of Michigan, Ann Arbor, Mich., USA, Tech. Rep. CITI Technical Report 03-1, October 2003). Their system is deployed in a local network for automatic detection of worm attacks from the Internet. It should be noted that this system is not suitable for a large ISP environment.</p>
<p id="p-0012" num="0011">Two further algorithms, based on Expectation-Maximization (C. E. Lawrence and A. A. Reilly, &#x201c;An Expectation Maximization (EM) Algorithm for the Identification and Characterization of Common Sites in Unaligned Biopolymer Sequences,&#x201d; <i>PROTEINS:Structure, Function and Genetics</i>, vol. 7, pp. 41-51, 1990) and Gibbs sampling (C. E. Lawrence, et al., &#x201c;Detecting Subtle Sequence Signals: A Gibbs Sampling Strategy for Multiple Alignment,&#x201d; Science, vol. 262,pp. 208-214, October 1993), were proposed for efficient computation of Position Aware Distribution Signature (PADS). Experiments based on variants of the MS-Blaster worm were performed. The results showed that the signature-based defense system can accurately separate new variants of the worm from the normal background traffic by using the PADS signature derived from the past samples.</p>
<p id="p-0013" num="0012">The main drawback common to all of the automatic signature generation techniques mentioned above is that they are appropriate for instances of short, stream-based, worms such as Nimda, Code Red/Code Red II, MS Blaster (1.8 KB long), Sober, Netsky and B[e]agle. Larger malware files carrying full-fledged applications usually contain many code segments used by the development platform which was implemented to generate the malware instance. Those segments are not unique to the malware. As a result, selecting a signature that will be both sensitive and specific is a very challenging task for the above-mentioned techniques, when the file comprising the malware is relatively large.</p>
<p id="p-0014" num="0013">It would therefore be highly desirable to develop an automatic signature extraction method that would account for the common code segments. Such a method would be able to detect malware appearing in small, as well as large, files. The types of malware which could be detected by such a method include Trojan horses, spyware, adware, viruses, and worms operating in a Windows environment.</p>
<p id="p-0015" num="0014">It is the object of the present invention to provide a method by which malware signatures are essentially automatically extracted.</p>
<p id="p-0016" num="0015">It is a further object of the present invention to provide a method which is suitable to extract signatures from large files.</p>
<p id="p-0017" num="0016">It is yet a further object of the present invention to provide a method with low false negative for malware, as well as low false positive for innocuous traffic.</p>
<p id="p-0018" num="0017">Further purposes and advantages of this invention will become apparent as the description proceeds.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0019" num="0018">The present invention is directed to a method for the automatic generation of malware signatures from computer files. A common function library (CFL) created, wherein the CFL contains any functions identified as a part of the standard computer language used to write computer files which are known as not containing malware. The functions of a computer file which does contain a malware are extracted and the CFL is updated with any new common functions if necessary, such that the remaining functions are all considered as candidates for generating the malware signature. The remaining functions are divided into clusters according to their location in the file and the optimal cluster for generating the malware signature is determined. One or more of the functions in the optimal cluster is selected, e.g., randomly, as the malware signature.</p>
<p id="p-0020" num="0019">The CFL may be created by importing a large number of files containing no malware code into a function extractor and processing each file in the function extractor so as to identify and extract as many functions as possible from each file's code. Then the functions extracted from the different files are compared, where the functions which appear in more than one file are considered to be common. The common functions are then transferred and stored in the CFL for later reference.</p>
<p id="p-0021" num="0020">The functions may be identified and extracted using an appropriate disassembly software application, such as IDA Pro and a dedicated plug-in that scans the output of the IDA Pro application, normalizes the functions, and stores them in a database.</p>
<p id="p-0022" num="0021">The normalization feature of IDA Pro is used for eliminating the references which may cause similar functions, found in different files, to seem different.</p>
<p id="p-0023" num="0022">In one aspect, the functions are identified and extracted implementing a state machine, by manually or automatically comparing the binary code of a large number of computer files to the corresponding assembly representation, thereby allowing the identification of repeating patterns which represent the beginning or end of functions; by applying the state machine, wherein the state machine is able to identify the repeating patterns in the binary code that represent the beginnings and ends of function, on any incoming file thereby identifying functions in the binary code of each the incoming file; and by comparing the identified functions using a similarity test that can employ a similarity threshold, thereby determining which of the identified functions are common functions.</p>
<p id="p-0024" num="0023">The functions of a computer file which does contain a malware may be extracted by using a disassembly software application or a state machine.</p>
<p id="p-0025" num="0024">The functions may be divided into clusters by considering all possible clusters of the functions. Preferably, the optimal cluster is the cluster with the highest cluster score according to:</p>
<p id="p-0026" num="0025">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>ClusterScore</mi>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mi>C</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>s</mi>
        </mrow>
        <mrow>
          <mi>F</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>s</mi>
        </mrow>
      </mfrac>
      <mo>+</mo>
      <mfrac>
        <mrow>
          <mi>F</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>c</mi>
        </mrow>
        <mi>T</mi>
      </mfrac>
      <mo>+</mo>
      <mfrac>
        <mrow>
          <mi>F</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>l</mi>
        </mrow>
        <mrow>
          <mi>C</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>s</mi>
        </mrow>
      </mfrac>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
wherein
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0026">where Cs denotes the cluster size in bytes;</li>
        <li id="ul0002-0002" num="0027">Fs denotes the entire file's size;</li>
        <li id="ul0002-0003" num="0028">Fc denotes the number of functions in the cluster;</li>
        <li id="ul0002-0004" num="0029">T denotes the total number of functions in the file; and</li>
        <li id="ul0002-0005" num="0030">Fl denotes the sum of the functions length in the cluster.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0027" num="0031">An offset may be added to one of the functions selected as the malware signature. The selection of the malware signature from the best cluster may performed according to the entropy of the selected segment, wherein the segment selected has the maximal entropy.</p>
<p id="p-0028" num="0032">All the above and other characteristics and advantages of the invention will be further understood through the following illustrative and non-limitative description of preferred embodiments thereof.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading>
<p id="p-0029" num="0033"><figref idref="DRAWINGS">FIG. 1</figref> shows an outline of the CFL creation; and</p>
<p id="p-0030" num="0034"><figref idref="DRAWINGS">FIG. 2</figref> illustrates the clusters formed in a file's code.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF PREFERRED EMBODIMENTS</heading>
<p id="p-0031" num="0035">In order to address the disadvantages of the prior art methods related to hereinabove, the present invention proposes a novel method for signature generation which can be used for tagging malware.</p>
<p id="p-0032" num="0036">The method of the present invention employs an executable-analysis technique which sanitizes instances of malicious executables from any segment of common code. The malicious executables are stripped of any such segments and a unique signature, which can be later used for detection of suspicious traffic, is generated.</p>
<p id="p-0033" num="0037">In order to create and employ signatures for effective and efficient detection of malware in executables, the method of the present invention requires that the generated signature comply with the following requirements: (1) the signature generated by the present invention is sufficiently long to be unique among billions of benign executables, therefore providing the signature with high specificity; (2) the signature generated according to the present invention is sufficiently short to decrease the problems of Internet packet splits and detection hardware storage limitations; (3) the signature generated according to the method of the present invention is simple in order to be detected in real-time from the Internet data stream; (4) the signature is well defined to enable totally automatic generation thereof.</p>
<p id="p-0034" num="0038">When generating a malware signature it is necessary to locate a segment, or segments, of the data which is unique to the malware only. Since many malwares are developed using higher level languages (such as: C++, C, visual basic, Delphi, etc.) a large part of the malware containing files is not unique. As mentioned above, one of the drawbacks of the methods of the prior art is that they do not relate to these non-unique segments, and are thus able to create malware signatures only from relatively small files.</p>
<p id="p-0035" num="0039">In contrast, the method of the present invention initially strips the unique malware segments from the non-unique segments, related to the computer language used to write the file. The non-unique segments are referred to herein as &#x201c;common functions&#x201d;, and the first step of the method of the present invention is to create a Common Function Library (CFL). According to the present invention the CFL is dynamic, and whenever new common functions are identified they are added to the CFL. Taking the common functions found in the CFL into account reduces the risk of selecting non-unique segments of code as part of the malware signature, thereby enhancing the abilities of the malware signature in detecting incoming malware files of the same type.</p>
<p id="p-0036" num="0040">According to the present invention the CFL is constructed as shown in <figref idref="DRAWINGS">FIG. 1</figref>. In order to initiate the creation of the CFL, as large number of legitimate files (<b>1</b>), i.e., files clean of malware code, are imported into a function extractor (<b>3</b>). The function extractor processes each file, and as many as possible of the functions comprised therein are identified and extracted from the code. The extracted functions then proceed to the function matching stage (<b>5</b>), in which functions that appear in more than a single file are considered to be common. The common functions are transferred to the CFL database (<b>7</b>), and stored there for later reference.</p>
<p id="p-0037" num="0041">According to the present invention two approaches can be used in order to identify and extract functions from the file code. The first is disassembly using an appropriate software application, preferably IDA Pro and extracting functions, and the second is extracting functions using state machine.</p>
<p id="p-0038" num="0042">When identifying functions using IDA Pro (or any other appropriate application), each incoming file is first disassembled by the IDA Pro program and then functions from statically linked libraries are identified. The dedicated plug-in of the present invention scans the output of the IDA Pro application (i.e. all detected functions), normalizes the functions, and stores them in a database.</p>
<p id="p-0039" num="0043">The common functions, i.e., the functions that appear in several files, are then transferred to the CFL database. However, a function in different executable files may have a different binary representation, thus it is necessary to determine when functions are considered to be the same. A call for a function is usually represented by a command that contains a reference. Due to linking issues the reference, and thus the binary representation of the same function in different executables is usually different. Therefore, the normalization feature of IDA Pro is used, thereby eliminating the references, thus identical functions are identified as such.</p>
<p id="p-0040" num="0044">As mentioned hereinabove, the CFL is a dynamic database. Accordingly, if at any later stage a common function, that does not already exist in the CFL, is identified, that function is added to the CFL database.</p>
<p id="p-0041" num="0045">The second approach to identifying and extracting functions according to the present invention is by implementing a state machine. The state machine used according to the present invention is able to identify most of the functions that reside in an executable file without disassembling it.</p>
<p id="p-0042" num="0046">According to the present invention the binary code of a large number of programs is compared, either manually or automatically, with the corresponding assembly representation. For example, the sequence of instructions on the right hand side below is a common beginning of a function in assembly language. The corresponding binary code is found on the left hand side.</p>
<p id="p-0043" num="0047"><chemistry id="CHEM-US-00001" num="00001">
<img id="EMI-C00001" he="6.10mm" wi="56.05mm" file="US08353040-20130108-C00001.TIF" alt="embedded image" img-content="chem" img-format="tif"/>
</chemistry>
</p>
<p id="p-0044" num="0048">Such a comparison allows the identification of repeating patterns that represent the beginning/end of functions. These patterns can be represented as a state-machine which can then be applied on any incoming file, and is able to identify functions in the binary code of that file. Regarding the example above, the state machine identifies that the binary sequence &#x201c;55 8B EC&#x201d; represents the beginning of a function. Furthermore, the state machine according to the present invention is able to identify such a sequence in the binary code of any arbitrary file.</p>
<p id="p-0045" num="0049">By using the state-machine approach described above the beginning and the end of a function can be identified, but the reference attached to that function, which may be different in different executables, cannot be identified. Thus, when identifying functions using a state machine, in order to determine whether two given functions are close enough to be assumed as same function, regardless of the references changes and its offset in a file, a similarity test is used.</p>
<p id="p-0046" num="0050">The most simple similarity test that can be used in the present invention employs a similarity threshold. If the number of different bytes exceeds the threshold then the two functions are considered different. For example, if the threshold is 3, the two functions below are considered to be different functions, but if the threshold is greater that 4, they are considered to be the same. According to the present invention, the threshold is determined by trial and error.</p>
<p id="p-0047" num="0051">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>Function X in File1:</entry>
</row>
<row>
<entry/>
<entry>8B D8 8B D6 8B C3 E8 F5 CD FF FF 89 73 1C 5E 5B</entry>
</row>
<row>
<entry/>
<entry>Function X in File2:</entry>
</row>
<row>
<entry/>
<entry>8B D8 8B D6 8B C3 E8 DD E5 FF FF 89 43 38 5E 5B</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0048" num="0052">Once the CFL is constructed as described hereinabove using only &#x201c;clean&#x201d; files, i.e., files containing no malware, a malware signature must be generated from a file which contains a malware, hidden among &#x201c;clean&#x201d; sections of code.</p>
<p id="p-0049" num="0053">In the signature generation stage of the method of the present invention, the functions in an incoming file, which contains a malware, are extracted using one of the methods described hereinabove. Each of the functions is compared to the functions of the CFL, identifying a portion of the functions as common functions. The common functions are then filtered out of the system, and the CFL is updated if necessary. The remaining functions become candidates for generating the malware signature.</p>
<p id="p-0050" num="0054">As known to those familiar with the art, a malware signature must be unique. In order to increase the uniqueness of the generated malware signature the following constraints are used when choosing the segment/segments of the remaining functions which are defined as the signature:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0055">1) the segment is unique to the malware;</li>
    <li id="ul0003-0002" num="0056">2) the segment has high entropy, i.e., the bytes of the segment are not repetitive; and</li>
    <li id="ul0003-0003" num="0057">3) the segment is not a text.</li>
</ul>
</p>
<p id="p-0051" num="0058">The above constraints are essential especially since even after identifying all of the common functions in an incoming file, there may still be large segments of code that are not accounted for. These constraints assist in choosing the optimal segment/segments for the malware signature.</p>
<p id="p-0052" num="0059">In another embodiment of the present invention, in order to increase the uniqueness of the signature, an offset is added to all of the candidate functions.</p>
<p id="p-0053" num="0060">The final step of the method of the present invention relates to the selection of the function from which the signature is to be generated, while taking the above constraints into account, and optionally adding an offset.</p>
<p id="p-0054" num="0061">As mentioned above, the function from which the signature is created is selected from the functions remaining after the common functions have been filtered out. It is assumed that common linkers create a tightly grouped function cluster from the programmer's unique code. This unique code cluster is most likely to represent the unique description of the malware. Therefore, according to the present invention the remaining functions are processed and identified according to the clusters in which they physically lay in the executable file. In one embodiment of the present invention, all possible clusters of the remaining functions are considered. The best cluster for generating the malware signature is then chosen. An example of clusters created in a file's code, once it has been separated into common functions, non-common functions, and unlabeled data, can be seen in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0055" num="0062">In one embodiment of the present invention the clusters are graded based on the following function:</p>
<p id="p-0056" num="0063">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mi>ClusterScore</mi>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mi>C</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>s</mi>
      </mrow>
      <mrow>
        <mi>F</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>s</mi>
      </mrow>
    </mfrac>
    <mo>+</mo>
    <mfrac>
      <mrow>
        <mi>F</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>c</mi>
      </mrow>
      <mi>T</mi>
    </mfrac>
    <mo>+</mo>
    <mfrac>
      <mrow>
        <mi>F</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>l</mi>
      </mrow>
      <mrow>
        <mi>C</mi>
        <mo>&#x2062;</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>&#x2062;</mo>
        <mi>s</mi>
      </mrow>
    </mfrac>
  </mrow>
</mrow>
</math>
</maths>
<br/>
wherein,
<ul id="ul0004" list-style="none">
    <li id="ul0004-0001" num="0000">
    <ul id="ul0005" list-style="none">
        <li id="ul0005-0001" num="0064">Cs denotes the Cluster size in bytes</li>
        <li id="ul0005-0002" num="0065">Fs denotes the entire File's Size</li>
        <li id="ul0005-0003" num="0066">Fc denotes the number of functions in cluster</li>
        <li id="ul0005-0004" num="0067">T denotes the total number of function in file</li>
        <li id="ul0005-0005" num="0068">Fl denotes the sum of the function's length in cluster</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0057" num="0069">The cluster with the highest cluster score is then chosen as the one from which the signature is to be generated.</p>
<p id="p-0058" num="0070">Once the best cluster has been selected, the signature generator of the present invention selects one of the functions of that cluster, optionally adding an offset to the selected function.</p>
<p id="p-0059" num="0071">According to one embodiment of the present invention the function selected from the best cluster as the signature is selected randomly. According to a preferred embodiment of the present invention the function with the highest entropy is selected. Choosing a function with high entropy lowers the probability of selecting a data section as the signature.</p>
<p id="p-0060" num="0072">The selected function, possibly with its offset, is the malware signature. As would be understood by those familiar with the art, the offset of a function may contain segments of uncommon functions, unidentified code, as well as common functions. By using the clustering score mentioned above, the chances that the offset comprises part of a common function are reduced to a minimum. This increases the uniqueness of the selected malware signature.</p>
<p id="p-0061" num="0073">In another embodiment of the present invention more than one function can be selected for generating the signature, so that the signature consists of two or more byte strings.</p>
<p id="p-0062" num="0074">The present invention relates also to a method for identifying whether arbitrary files are, or contain, malware codes. Once such files are identified, a malware signature is generated therefrom.</p>
<p id="p-0063" num="0075">Another aspect of the present invention relates to a method for generating generic malware signatures, so that each signature is able to identify as many malware codes as possible. According to this method a &#x201c;malware common function library&#x201d; is constructed, and later implemented, in order to store various malware codes, and to generate generic signatures based upon them. As known to those familiar with the art, different malware codes that were generated by the same malware generator/malware toolbox are very likely to comprise common functions. Therefore, the method of the present invention is extremely useful for generating generic signatures for such malware codes. However, as would be understood by those familiar with the art, the method of the present invention is able to derive generic signatures for any malware codes, developed on any platforms, wherein the different malware codes comprise common functions.</p>
<p id="p-0064" num="0076">Although embodiments of the invention have been described by way of illustration, it will be understood that the invention may be carried out with many variations, modifications, and adaptations, without departing from its spirit or exceeding the scope of the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-chemistry idref="CHEM-US-00001" cdx-file="US08353040-20130108-C00001.CDX" mol-file="US08353040-20130108-C00001.MOL"/>
<us-math idrefs="MATH-US-00001" nb-file="US08353040-20130108-M00001.NB">
<img id="EMI-M00001" he="6.01mm" wi="76.20mm" file="US08353040-20130108-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08353040-20130108-M00002.NB">
<img id="EMI-M00002" he="6.01mm" wi="76.20mm" file="US08353040-20130108-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08353040-20130108-M00003.NB">
<img id="EMI-M00003" he="6.01mm" wi="76.20mm" file="US08353040-20130108-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for the automatic generation of malware signatures from computer files, said method comprising:
<claim-text>a) creating a common function library (CFL), wherein said CFL contains any functions of a computer file, which functions are identified as being part of a standard computer language used to write computer files which are known as not containing malware;</claim-text>
<claim-text>b) extracting the functions of a computer file which does contain a malware;</claim-text>
<claim-text>c) identifying common functions from the extracted functions, the common functions are known as not being part of a malware;</claim-text>
<claim-text>d) filtering out the common functions from the extracted functions, the remaining functions are all considered as candidates for generating the malware signature;</claim-text>
<claim-text>e) dividing said remaining functions into a multitude of clusters according to their location in said file;</claim-text>
<claim-text>f) determining an optimal cluster from the multitude of clusters for generating the malware signature, the optimal cluster is the cluster with the highest cluster score according to:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>ClusterScore</mi>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mi>C</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>s</mi>
        </mrow>
        <mrow>
          <mi>F</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>s</mi>
        </mrow>
      </mfrac>
      <mo>+</mo>
      <mfrac>
        <mrow>
          <mi>F</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>c</mi>
        </mrow>
        <mi>T</mi>
      </mfrac>
      <mo>+</mo>
      <mfrac>
        <mrow>
          <mi>F</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>l</mi>
        </mrow>
        <mrow>
          <mi>C</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mi>s</mi>
        </mrow>
      </mfrac>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>&#x2003;wherein</claim-text>
<claim-text>Cs denotes the cluster size in bytes;</claim-text>
<claim-text>Fs denotes the entire file's size;</claim-text>
<claim-text>Fc denotes the number of functions in said cluster;</claim-text>
<claim-text>T denotes the total number of functions in said file; and</claim-text>
<claim-text>Fl denotes the sum of the functions length in said cluster; and</claim-text>
<claim-text>g) selecting at least one of the functions in said optimal cluster as the malware signature;</claim-text>
<claim-text>the CFL is created by:
<claim-text>i) importing a number of files containing no malware code into a function extractor;</claim-text>
<claim-text>ii) processing each file in said function extractor so as to identify and extract as many functions as possible from each file's code;</claim-text>
<claim-text>iii) comparing the functions extracted from the different files, wherein the functions which appear in more than one file are considered to be common; and</claim-text>
<claim-text>iv) transferring and storing said common functions into the CFL for later reference.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the functions are identified and extracted using a disassembly software application and a dedicated plug-in.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the disassembly software application is IDA Pro.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the dedicated plug-in scans the output of the disassembly software application, normalizes said functions, and stores them in a database.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the normalization feature of IDA Pro is used for eliminating the references which may cause similar functions, found in different files, to seem different.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the functions are identified and extracted implementing a state machine, by the following steps:
<claim-text>a) comparing the binary code of a number of computer files to the corresponding assembly representation, thereby allowing the identification of repeating patterns which represent the beginning or end of functions;</claim-text>
<claim-text>b) applying said state machine, wherein said state machine is able to identify the repeating patterns in the binary code that represent the beginnings and ends of function, on any incoming file thereby identifying functions in the binary code of each said incoming file; and</claim-text>
<claim-text>c) comparing said identified functions using a similarity test, thereby determining which of said identified functions are common functions.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein step (a) is performed manually.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein step (a) is performed automatically.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein the similarity test employs a similarity threshold.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein step (b) is conducted implementing:
<claim-text>a) a disassembly software application, and a dedicated plug-in which scans the output of the disassembly software application, normalizes said functions, and stores them in a database, wherein the normalization feature of the disassembly software application is used for eliminating the references which may cause similar functions, found in different files, to seem different; or</claim-text>
<claim-text>b) using a state machine for:
<claim-text>i) comparing the binary code of a computer file to the corresponding assembly representation, thereby allowing the identification of repeating patterns which represent the beginning or end of functions;</claim-text>
<claim-text>ii) applying said state machine to identify the repeating patterns in the binary code that represent the beginnings and ends of function on the computer file, thereby identifying functions in the binary code of the computer file.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein an offset is added to at least one of the functions selected as the malware signature.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the selection of the malware signature from the cluster is performed randomly.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the selection of the malware signature from the optimal cluster is performed according to the entropy of the selected segment, wherein the segment selected has the maximal entropy. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353041-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353041</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12122575</doc-number>
<date>20080516</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>914</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 24</main-classification>
<further-classification>726 22</further-classification>
<further-classification>726 23</further-classification>
<further-classification>713153</further-classification>
<further-classification>713156</further-classification>
<further-classification>713188</further-classification>
<further-classification>709224</further-classification>
</classification-national>
<invention-title id="d2e53">Secure application streaming</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5832208</doc-number>
<kind>A</kind>
<name>Chen et al.</name>
<date>19981100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5892904</doc-number>
<kind>A</kind>
<name>Atkinson et al.</name>
<date>19990400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6088803</doc-number>
<kind>A</kind>
<name>Tso et al.</name>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6611925</doc-number>
<kind>B1</kind>
<name>Spear</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714 3814</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7107618</doc-number>
<kind>B1</kind>
<name>Gordon et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7363498</doc-number>
<kind>B2</kind>
<name>Hennessey et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713176</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7483993</doc-number>
<kind>B2</kind>
<name>Nachenberg et al.</name>
<date>20090100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0016925</doc-number>
<kind>A1</kind>
<name>Pennec et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0016959</doc-number>
<kind>A1</kind>
<name>Barton et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717178</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2002/0138766</doc-number>
<kind>A1</kind>
<name>Franczek et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2003/0126303</doc-number>
<kind>A1</kind>
<name>Kadakia et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709313</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2006/0101282</doc-number>
<kind>A1</kind>
<name>Costea et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713188</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2006/0123244</doc-number>
<kind>A1</kind>
<name>Gheorghescu et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713188</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2006/0259968</doc-number>
<kind>A1</kind>
<name>Nakakoji et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2007/0083930</doc-number>
<kind>A1</kind>
<name>Dumont et al.</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2007/0240220</doc-number>
<kind>A1</kind>
<name>Tuvell et al.</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00017">
<othercit>Paul Royal, Mitch Halpin, David Dagon, Robert Edmonds, Wenke Lee, &#x201c;PolyUnpack: Automating the Hidden-Code Extraction of Unpack-Executing Malware&#x201d;,Georgia Institute of Technology, USA, 2006.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>Hitchen, D., &#x201c;Softgrid FAQ, SoftGrid Applications: Can a SoftGrid Application be Infected by a Virus or Malware?&#x201d; Technet Blogs, Sep. 2007, 8 pages, [Online] [Retrieved on Sep. 1, 2009] Retrieved from the Internet&#x3c;URL:http://blogs.technet.com/dhitchen/default.aspx.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>PCT International Search Report and Written Opinion, PCT Application No. PCT/US2009/044017, Sep. 14, 2009, 11 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>&#x201c;Softricity Softgrid v4: Under the Covers Exploring the Softgrid Platform,&#x201d; Softricity Publications, Oct. 2006, 31 pages, [Online] [Retrieved on Sep. 1, 2009] Retrieved from the Internet&#x3c;URL:http://www.citrixtraininguk.co.uk/Documenets/Softgrid<sub>&#x2014;</sub>under<sub>&#x2014;</sub>the<sub>&#x2014;</sub>covers.pdf&#x3e;.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>18</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 22- 24</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713153</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713156</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713188</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090288166</doc-number>
<kind>A1</kind>
<date>20091119</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Brown</last-name>
<first-name>Timothy</first-name>
<address>
<city>Cupertino</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Clyde</last-name>
<first-name>Robert</first-name>
<address>
<city>Cupertino</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Fenwick &#x26; West LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Symantec Corporation</orgname>
<role>02</role>
<address>
<city>Cupertino</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Arani</last-name>
<first-name>Taghi</first-name>
<department>2496</department>
</primary-examiner>
<assistant-examiner>
<last-name>Mehrmanesh</last-name>
<first-name>Amir</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A server includes a scanning module for determining whether an application is free of malware, a module for packaging the application into blocks for delivery via application streaming, a module for providing the blocks to a client on request, and a module for adding to each block an indication of whether the associated application has already been determined to be free of malware. A client includes a module for requesting blocks of a streamed application from the server. When the client receives a block, it employs a module for verifying that the associated applications have been determined to be free of malware by examining the indication provided by the server. If verification is successful, then the block's code is executed without first receiving and scanning any additional blocks from the server.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="190.67mm" wi="127.93mm" file="US08353041-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="204.39mm" wi="127.34mm" file="US08353041-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="209.30mm" wi="172.30mm" orientation="landscape" file="US08353041-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="164.08mm" wi="153.16mm" file="US08353041-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="160.44mm" wi="152.48mm" file="US08353041-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="172.64mm" wi="66.12mm" file="US08353041-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="190.84mm" wi="148.17mm" file="US08353041-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">This invention pertains in general to computer security and in particular to efficiently implementing security checks of streamed applications.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">Application streaming is emerging as a useful way to execute applications and has benefits not provided by traditional application execution approaches. Specifically, application streaming permits execution of an application that has not been installed or stored locally on the client system on which it executes, providing application code and data to the client as needed, one block at a time. This provides a number of benefits, such as saving disk space that would otherwise be required on the client machine for storing the entire application, allowing centralized licensing control and simplified ability to patch and update applications, and allowing execution of the application to begin without requiring all the code to be first downloaded.</p>
<p id="p-0006" num="0005">However, application streaming currently does not always integrate smoothly with existing systems. In particular, the use of security systems such as malware scanning software currently can negate the benefits of application streaming. Specifically, conventional malware scanning technology sometimes cannot detect the presence of malware based on a single block of the application, taken separately from the rest of the application. Thus, conventional malware scanning software halts the execution of the streamed application until the entire application has been downloaded, scans the application as a whole, and only then permits the application to execute. This eliminates the beneficial ability of application streaming to execute an application of which only a portion is actually present on the client machine.</p>
<heading id="h-0002" level="1">BRIEF SUMMARY</heading>
<p id="p-0007" num="0006">The difficulties described above are addressed by a method, computer, and computer program product that incorporate a trust-based mechanism to ensure that all portions of a streamed application are free of malware while still preserving the beneficial performance properties of application streaming.</p>
<p id="p-0008" num="0007">One embodiment of the method receives a streamed block of an application, the block comprising code for a unit of an application. The method determines whether the block contains an indication that the application has been found to be free of malware, and responsive at least in part to the block containing an indication that the application has been found to be free of malware, execution of the code is permitted.</p>
<p id="p-0009" num="0008">A computer adapted to incorporate malware scanning within an application streaming system, comprises a computer-readable storage medium storing executable computer program modules. The computer program modules comprise a block server module for receiving, from a client, a request for a block, the block comprising code for a unit of an application. The modules further comprise a scan assurance module for determining whether the application has been found to be free of malware. The block server module obtains the requested block; the scan assurance module inserts into the obtained block an indication that the application has been scanned, responsive to determining that the application has been found to be free of malware; and the block server module provides the block, including the inserted indication, to the client.</p>
<p id="p-0010" num="0009">Embodiments of the computer program product have a computer-readable storage medium storing executable computer program modules for incorporating malware scanning within an application streaming system, the modules comprising a client application streaming module for receiving a streamed block of an application from a server, the block comprising code for a unit of the application. The modules further comprise client scan verification module for determining whether the block contains an indication that the application has been found to be free of malware, and for permitting execution of the code responsive at least in part to the block containing an indication that the application has been found to be free of malware.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 1</figref> is a high-level block diagram of a computing environment according to one embodiment.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 2</figref> is a high-level block diagram illustrating a typical computer for use as a client or server according to one embodiment.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 3</figref> is a high-level block diagram illustrating a detailed view of modules within the server, according to one embodiment.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 4</figref> is a high-level block diagram illustrating a detailed view of modules within the client, according to one embodiment.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart illustrating steps performed by a server application streaming module in cooperation with a server security module, according to one embodiment.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart illustrating steps performed by a client application streaming module in cooperation with a client security module, according to one embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0017" num="0016">The figures depict an embodiment of the present invention for purposes of illustration only. One skilled in the art will readily recognize from the following description that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles of the invention described herein.</p>
<heading id="h-0004" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 1</figref> is a high-level block diagram of a computing environment <b>100</b> according to one embodiment. <figref idref="DRAWINGS">FIG. 1</figref> illustrates a server <b>110</b> and a client <b>120</b> connected by a network <b>130</b>. Only one client <b>120</b> and one server <b>110</b> are shown in <figref idref="DRAWINGS">FIG. 1</figref> in order to simplify and clarify the description. Embodiments of the computing environment <b>100</b> can have thousands or millions of clients <b>120</b> and servers <b>110</b> connected to the network <b>130</b>.</p>
<p id="p-0019" num="0018">The client <b>120</b> can execute a variety of software applications, either according to the traditional paradigm in which the applications are installed locally prior to being executed, or using an application streaming system, in which an application is stored remotely on the server <b>110</b> and downloaded in separate pieces (&#x201c;blocks&#x201d;) and executed locally on the client <b>120</b>.</p>
<p id="p-0020" num="0019">In order to support application streaming, the server <b>110</b> stores the application code and data (collectively termed &#x201c;the application&#x201d; hereinafter) and makes them available for access. The server <b>110</b> comprises a server application streaming module <b>111</b> for providing a streamed application to requesting clients, and a server security module <b>112</b> for incorporating security into the application streaming provided by the server application streaming module <b>111</b>. The client <b>120</b> in turn comprises a client application streaming module <b>121</b> for requesting blocks of a desired application via application streaming, receiving the blocks, and executing code from the blocks in order to run the application. The client <b>120</b> additionally comprises a client security module <b>122</b> that incorporates security features into the application streaming provided by the client application streaming module <b>121</b>. These client and server application streaming modules <b>111</b> and <b>121</b>, together referred to as the &#x201c;application streaming system,&#x201d; communicate with each other to provide the client <b>120</b> with the application blocks needed to carry out the currently-required application functionality. Further, the client and server security modules <b>112</b> and <b>122</b> interact with their respective application streaming modules <b>111</b> and <b>121</b> in order to provide security for application streaming without requiring the entire application to be downloaded prior to its execution, thereby providing application execution with minimal delay.</p>
<p id="p-0021" num="0020">The server <b>110</b> communicates with the client <b>120</b> via the network <b>130</b>. In one embodiment, the network <b>130</b> is the Internet. The network <b>130</b> can also utilize dedicated or private communications links that are not necessarily part of the Internet. In one embodiment, the network <b>130</b> uses standard communications technologies and/or protocols such as Ethernet, 802.11, etc. Similarly, the networking protocols used on the network <b>130</b> can include the transmission control protocol/Internet protocol (TCP/IP), the hypertext transport protocol (HTTP), the file transfer protocol (FTP), etc. The data exchanged over the network <b>130</b> can be represented using technologies and/or formats including the hypertext markup language (HTML), the extensible markup language (XML), etc., as well as custom data streaming formats designed specifically for the transfer of application blocks. In addition, all or some of links can be encrypted using conventional encryption technologies such as the secure sockets layer (SSL), Secure HTTP and/or virtual private networks (VPNs). In another embodiment, the entities can use custom and/or dedicated data communications technologies instead of, or in addition to, the ones described above.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 2</figref> is a high-level block diagram illustrating a typical computer <b>200</b> for use as a client <b>120</b> or server <b>110</b> according to one embodiment. Illustrated are a processor <b>202</b> coupled to a bus <b>204</b>. Also coupled to the bus <b>204</b> are a memory <b>206</b>, a storage device <b>208</b>, a keyboard <b>210</b>, a graphics adapter <b>212</b>, a pointing device <b>214</b>, and a network adapter <b>216</b>. A display <b>218</b> is coupled to the graphics adapter <b>212</b>.</p>
<p id="p-0023" num="0022">The processor <b>202</b> may be any general-purpose processor such as an INTEL x86 compatible-CPU. The memory <b>206</b> may be, for example, firmware, read-only memory (ROM), non-volatile random access memory (NVRAM), and/or RAM, and holds instructions and data used by the processor <b>202</b>. The pointing device <b>214</b> may be a mouse, track ball, or other type of pointing device, and is used in combination with the keyboard <b>210</b> to input data into the computer <b>200</b>. The graphics adapter <b>212</b> displays images and other information on the display <b>218</b>. The network adapter <b>216</b> couples the computer <b>200</b> to the network <b>130</b>. The storage device <b>208</b> is, in one embodiment, a hard disk drive but can also be any other device capable of storing data, such as a writeable compact disk (CD) or DVD, a solid-state memory device, or other form of computer-readable storage medium. The storage device <b>208</b> stores the files for the operating system, applications, etc.</p>
<p id="p-0024" num="0023">The types of computers <b>200</b> utilized by the entities of <figref idref="DRAWINGS">FIG. 1</figref> can vary depending upon the embodiment and the processing power utilized by the entity. For example, a client <b>120</b> that is a personal digital assistant (PDA) typically has limited processing power, a small display <b>218</b>, and might lack a pointing device <b>214</b>. The server <b>110</b>, in contrast, may comprise multiple blade servers working together.</p>
<p id="p-0025" num="0024">As is known in the art, the computer <b>200</b> is adapted to execute computer program modules. As used herein, the term &#x201c;module&#x201d; refers to computer program logic and/or data for providing the specified functionality. A module can be implemented in hardware, firmware, and/or software. In one embodiment, the modules are stored on the storage device <b>208</b>, loaded into the memory <b>206</b>, and executed by the processor <b>202</b>.</p>
<p id="p-0026" num="0025">In addition, this description uses the term &#x201c;application&#x201d; to refer to a program executed by the computer <b>200</b>, including both the code and the data that the program comprises. The application is formed of one or more files that typically reside on the storage device <b>208</b> and are loaded into memory <b>206</b> when executed. At least one of the files loaded into memory <b>206</b> is referred to as the &#x201c;executable image&#x201d; and is executed as a process when executed in a traditional manner. When executed via application streaming, however, the application is segmented and executed in a different manner, as described more fully below.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 3</figref> is a high-level block diagram illustrating a detailed view of modules within the server <b>110</b> according to one embodiment, including the server application streaming module <b>111</b> and the server security module <b>112</b>. The sub-modules of the server application streaming module <b>111</b> of together provide the ability to stream an application to a client <b>120</b>, and include an application repository <b>301</b>, an application packaging module <b>302</b>, and a block server module <b>303</b>.</p>
<p id="p-0028" num="0027">The application packaging module <b>302</b> divides an application into a set of segments, termed &#x201c;blocks.&#x201d; In one embodiment, each block represents a particular logical unit of the application. A block may contain, in addition to a portion of the program itself, any metadata about the block useful to the application streaming system, such as its block number, its size in bytes, the byte range of the application that the block represents, etc. The application packaging module <b>302</b> additionally creates any organizational information required by the application streaming system to allow the client <b>120</b> to obtain the needed blocks. For example, in one embodiment the application packaging module <b>302</b> creates a data structure, e.g. a list, that correlates block numbers with the application byte ranges that they represent. This enables a client to determine which block number it requires in order to execute an instruction stored at a given memory address. The division into blocks may be logical or physical&#x2014;that is, the application may be physically divided into discrete blocks that are stored separately, or the blocks may be stored together and logically separated by means of the aforementioned data structure that correlates an address with a block number.</p>
<p id="p-0029" num="0028">The application repository <b>301</b> stores the segmented applications and any corresponding organizational information, as created by the application packaging module <b>302</b>. The application repository <b>301</b> may be implemented in different manners in different embodiments. For example, in one embodiment the application repository <b>301</b> is a set of tables in a relational database management system.</p>
<p id="p-0030" num="0029">The block server module <b>303</b> provides the appropriate blocks to the client <b>120</b> in response to a request for a streamed application or particular blocks thereof. The particular manner in which it does so depends upon the way in which the application packaging module <b>302</b> packaged the application. For example, in an embodiment in which the application packaging module <b>302</b> does not physically segment the application, the block server module <b>303</b> provides a requested block by sending the particular byte range of the file corresponding to the requested block number, dynamically inserting any required metadata, such as the block number. Alternatively, in an embodiment in which the blocks are stored separately along with their corresponding metadata, the block server module merely sends a copy of that discrete block of data.</p>
<p id="p-0031" num="0030">It is appreciated that the server application streaming module <b>111</b> and the modules thereof may be implemented in a variety of different manners, and is not limited to the particular implementation described above. Rather, many alternate implementations would be known to one of ordinary skill in the art, such as implementations having different numbers of modules or relationships therebetween, different data formats for packaging an application for application streaming, and the like.</p>
<p id="p-0032" num="0031">The sub-modules of the server security module <b>112</b> include an application scanning module <b>310</b> and a scan assurance module <b>311</b>, which cooperate with the modules of the server application streaming module <b>111</b> to provide assurance to the client <b>120</b> that the streamed application does not contain malware. In one embodiment, the server security module <b>112</b> additionally includes a server authentication module <b>312</b> used as part of authentication of the server <b>110</b> to the client <b>120</b>. The application scanning module <b>310</b> scans an application to ensure that it is free of malware. In one embodiment, prior to being scanned by the application scanning module <b>310</b>, the applications are installed and stored in a conventional manner within the file system of the server <b>110</b>. In other embodiments, the applications can be stored within a portion of the application repository <b>301</b> that is separate from the packaged form of the applications. In one embodiment, the scan is performed on an application before it is packaged for delivery as a streamed application. The application scanning module <b>310</b> can be implemented using conventional malware-detection software such as NORTON ANTIVIRUS, available from Symantec Corporation.</p>
<p id="p-0033" num="0032">The scan assurance module <b>311</b> interacts with the block server module <b>303</b> to indicate that the blocks provided to the client have been scanned. Specifically, the scan assurance module <b>311</b> adds, to each block sent to the client <b>120</b>, an indication of whether a malware scan has been performed on the application to which the block corresponds. In one embodiment, only applications that have previously been scanned are packaged for delivery as streamed applications, and thus in such an embodiment the indication added by the scan assurance module <b>311</b> is always positive, indicating that the block has been scanned. In another embodiment in which applications may be packaged and made available for streaming without having been scanned, the scan assurance module <b>311</b> has access to a data structure that correlates applications with whether they have been scanned and determined to be free of malware. Such a data structure could be maintained by the application scanning module <b>310</b>, for example.</p>
<p id="p-0034" num="0033">The server authentication module <b>312</b> applies cryptographic techniques to assure a client <b>120</b> that the indication in a block provided by the scan assurance module <b>311</b> is trustworthy. For example, in one embodiment the server authentication module <b>312</b> encrypts a communications channel between the server <b>110</b> and the client <b>120</b> to ensure that the indication is not altered during transmission by a malicious intermediary; thus, the server <b>110</b> encrypts the block before transmitting it to the client, and the client <b>120</b> decrypts the block before examining it. In another embodiment, the server authentication module <b>312</b> digitally signs the block to allow the client <b>120</b> to verify that the block has not been altered.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 4</figref> is a high-level block diagram illustrating a detailed view of modules within the client <b>120</b> according to one embodiment. The client application streaming module <b>121</b> is the client-side component of the application streaming system and communicates with the server application streaming module <b>111</b>. The client application streaming module <b>121</b> includes an application execution module <b>401</b> and a block requesting module <b>402</b>. The application execution module <b>401</b> receives and executes blocks from the server <b>110</b>. In one embodiment, the application execution module <b>401</b> stores the received blocks locally within a temporary storage area, such as a memory buffer, that will be available to the application execution module <b>401</b> when executing instructions. Application streaming can be initiated, for example, by providing the client application streaming module <b>121</b> with the identifier of a streamed application the execution of which is desired. For example, a user might double-click on a desktop icon illustrating the streamed application. Such an icon would specify execution of a process implementing the client application streaming module <b>121</b>, with the identifier of the streamed application passed to the process as an argument.</p>
<p id="p-0036" num="0035">The block requesting module <b>402</b> sends requests to the server <b>110</b> for blocks necessary for executing the streamed application. In one embodiment, the block requesting module <b>402</b> has access to a data structure, such as that created in one embodiment by application packaging module <b>302</b>, that correlates instruction addresses with blocks. Thus, when an instruction to be executed corresponds to a block not already downloaded by the client application streaming module <b>121</b>, the block requesting module sends a request for that block to the server <b>110</b>; when the instruction to be executed corresponds to a block that has been downloaded, no such request is necessary, since the instruction is already available locally on the client <b>120</b>, such as within a memory buffer of the application execution module <b>401</b>.</p>
<p id="p-0037" num="0036">The client security module <b>122</b> determines whether the streamed application is free of malicious code. The client scanning module <b>403</b> scans the client system for the presence of malware. In one embodiment, the client scanning module <b>403</b> is implemented by existing anti-malware software, such as NORTON ANTIVIRUS, and has automatic protection features that automatically detect and scan incoming data.</p>
<p id="p-0038" num="0037">The client scan verification module <b>404</b> interfaces with the client scanning module <b>403</b> to examine a block of a streaming application received at the client <b>120</b> to determine whether the streamed application has already been scanned and found to be free of malware. The client scan verification module <b>404</b> looks for the indication at a location in the block where the scan assurance module <b>311</b> is designed to place it. For example, the indication could be placed in the first byte of a block, with a non-zero value indicating that the relevant application has previously been scanned, and a zero value indicating that it has not. If such an indication is found, the client scan verification module <b>404</b> need not pass a block to the client scanning module <b>403</b>, but rather can immediately pass the block to the application execution module <b>401</b> for storage and execution; if it is not found, however, then the client scan verification module <b>404</b> will pass the block to the client scanning module <b>403</b>, which will then halt execution of the streamed application until all the application's blocks have been downloaded and the entire application file has been scanned.</p>
<p id="p-0039" num="0038">A client authentication module <b>405</b> ensures that the server <b>110</b> providing the streamed application is indeed a reliable, trusted source. If the client authentication module <b>405</b> does not determine that the server <b>110</b> is a trusted source, then an indication that the block has been found to be free of malware is ignored, the block instead being considered not to contain such an indication. Thus, in one embodiment, the block will be passed to the client scanning module <b>403</b>, with the result that all application blocks will be downloaded and the application scanned as a whole before it can be executed.</p>
<p id="p-0040" num="0039">In one embodiment, the client authentication module <b>405</b> maintains a whitelist of servers specifically authorized to perform application streaming, considering a server on the whitelist to be sufficiently authenticated. More specifically, the whitelist includes a list of unique server identifiers, such as internet protocol (IP) addresses. This list may be entered by the user, or by the author of the software embodying the client authentication module <b>405</b>, or be a combination thereof. Then, when a particular server <b>110</b> is streaming applications to the client <b>120</b>, the client authentication module <b>405</b> determines whether the IP address of the server <b>110</b> is within its whitelist, authenticating the server if so, and not authenticating it otherwise. Such a whitelist-based method of authentication is merely one example, and other methods of authentication would be equally possible to one of ordinary skill in the art.</p>
<p id="p-0041" num="0040">Additionally, the client authentication module <b>405</b> ensures that malware is not inserted into a block at some point between the sending by the server <b>110</b> and the receipt by the client <b>120</b>. This may be accomplished by the client authentication module <b>405</b> of the client <b>120</b> using conventional cryptographic techniques in cooperation with the server authentication module <b>312</b> on the server <b>110</b>, as discussed above with respect to the server authentication module <b>312</b>.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart illustrating steps performed by the server application streaming module <b>111</b> in cooperation with the server security module <b>112</b>, according to one embodiment. In one embodiment, the application scanning module <b>310</b> first scans <b>510</b> an application to ensure that it does not contain malware. Subsequently, the application packaging module <b>302</b> packages <b>520</b> the application, segmenting it into blocks and creating any other necessary associated information, as described above. The packaged application is stored within the application repository <b>301</b>, where it becomes available for streaming to clients. Next, the block server module <b>303</b> receives <b>530</b> a request for a block from the client <b>120</b>. The block server module <b>303</b> then provides the requested block to the scan assurance module <b>311</b>, which augments the block by adding, at a given location of the block, an indication of whether the application to which the block corresponds has been scanned for malware and found to be malware-free. Finally, the scan assurance module provides <b>540</b> the augmented block to the client <b>120</b>.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart illustrating steps performed by the client application streaming module <b>121</b> in cooperation with the client security module <b>122</b>, according to one embodiment. First, the block requesting module <b>402</b> of the client <b>120</b> requests <b>610</b> a block. The block request may be for a single block, or for multiple blocks, depending on the situation. For example, when the application to be streamed is first executed, the block requesting module <b>402</b> may request multiple blocks in order to obtain, in one transaction, all the code needed for the initial or core functionality of the application. Later, individual blocks may be requested by block requesting module <b>402</b> when accessing code for which a block has not already been obtained. Subsequently, the client <b>120</b> receives the requested block or blocks from the server <b>110</b>. The client scan verification module <b>404</b> examines the block to determine whether there is an indication <b>630</b> that that application has previously been scanned for malware.</p>
<p id="p-0044" num="0043">If the block does contain such an indication, then the client scan verification module <b>404</b> prevents the client scanning module <b>403</b> from operating on the block, instead allowing the application execution module <b>401</b> to immediately execute <b>640</b> the relevant code within the block. If the block does not contain the indication, however, then the client scan verification module <b>404</b> passes the block to the client scanning module <b>403</b>. As a result, the client scanning module <b>403</b> causes the block requesting module <b>402</b> to request <b>650</b> all the remaining blocks in the application. Then, when all the blocks have been received, the client scanning module <b>403</b> can assemble the blocks into a single unit and thereby scan <b>660</b> the entire application as a whole. In one embodiment, the client scan verification module <b>404</b> also passes the block to the client scanning module <b>403</b> even if the block does contain an indication that it was scanned, in response to the client authentication module <b>405</b> failing to determine that the server <b>110</b> providing the indication is trusted. In another embodiment, if the block does not contain the indication, or if the client authentication module <b>405</b> fails to determine that the server <b>110</b> is trusted, the client security module <b>122</b> issues an alert noting that the associated application has not been verified to be free of malware and prompting a user for input regarding whether to execute the application without performing a scan, taking the action specified by the user input, such as performing a scan, or executing the code without a scan. In another embodiment, the action to take in such cases is specified by a policy, such as a preference setting in security software embodying the client security module <b>122</b>.</p>
<p id="p-0045" num="0044">It is appreciated that the steps of <figref idref="DRAWINGS">FIGS. 5 and 6</figref> are for purposes of example. In other embodiments, the steps could be performed in a different order, or a number of times rather than exactly once, or there could be additional, fewer, or alternate steps.</p>
<p id="p-0046" num="0045">Thus, the above-described invention allows the integration of security into an application streaming system while simultaneously preserving the beneficial performance characteristics of application streaming.</p>
<p id="p-0047" num="0046">The above description is included to illustrate the operation of certain embodiments and is not meant to limit the scope of the invention. The scope of the invention is to be limited only by the following claims. From the above discussion, many variations will be apparent to one skilled in the relevant art that would yet be encompassed by the spirit and scope of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer-implemented method of incorporating malware scanning within an application streaming system, comprising:
<claim-text>receiving a user selection of an application via a graphical user interface;</claim-text>
<claim-text>identifying accesses to code of the application responsive to the user selection of the application;</claim-text>
<claim-text>identifying blocks of code of the application corresponding to the code accesses, each block comprising code for a unit of the application;</claim-text>
<claim-text>responsive to not having received the identified blocks of code, requesting, from a remote application streaming server, the identified blocks of code;</claim-text>
<claim-text>receiving a set of streamed blocks of the application from the remote application streaming server, each block comprising code for a unit of the application and having metadata comprising an indication of a portion of the application that the block represents, and each of a plurality of the streamed blocks containing an indication of whether the application has been found to be free of malware, the indication of whether the application has been found to be free of malware requiring at most one byte placed at a known location in the block and including either a first code indicating that the application has been found to be free of malware or a second code indicating that the application has not been found to be free of malware;</claim-text>
<claim-text>for each streamed block of the plurality of the streamed blocks:
<claim-text>determining whether the indication contained in the streamed block indicates that the application has been found to be free of malware; and</claim-text>
<claim-text>permitting execution of the code comprised by the streamed block, responsive at least in part to the streamed block containing an indication that the application has been found to be free of malware.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>responsive at least in part to the indication of at least one of the plurality of blocks indicating that the application has not been found to be free of malware:
<claim-text>halting execution of the code comprised by the received blocks;</claim-text>
<claim-text>scanning the code to determine whether it contains malware; and</claim-text>
<claim-text>permitting execution of the code, responsive to the scanning determining that the code does not contain malware.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising receiving all blocks of the application, wherein scanning the code does not take place until all blocks of the application have been received.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>responsive to the indication of at least one of the plurality of blocks indicating that the application has not been found to be free of malware:
<claim-text>displaying an alert to a user that the application has not been verified to be free of malware;</claim-text>
<claim-text>receiving user input specifying whether to execute the code without performing a scan of the block for malware; and</claim-text>
<claim-text>responsive at least in part to the user input, executing the code without performing a scan of the block for malware.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>authenticating the remote application streaming server by determining whether the server is on a security whitelist; and</claim-text>
<claim-text>permitting execution of the code responsive at least in part to the determination.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein at least one of the received blocks is digitally signed with a signature by the remote application streaming server, and receiving the block from the remote application streaming server further comprises verifying the signature.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein at least one of the received blocks is encrypted by the remote application streaming server, and receiving the block from the server remote application streaming further comprises decrypting the block.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the indication of a portion of the application that the block represents comprises a block number.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the indication of a portion of the application that the block represents an indication of a byte range of the application that the block represents.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A computer program product having a non-transitory computer-readable storage medium storing computer program modules executable by a computer processor and for incorporating malware scanning within an application streaming system, the modules comprising:
<claim-text>a module that when executed by the processor receives a user selection of an application via a graphical user interface;</claim-text>
<claim-text>a block requesting module that when executed by the processor performs actions comprising:
<claim-text>identifying accesses to code of the application responsive to the user selection of the application;</claim-text>
<claim-text>identifying blocks of code of the application corresponding to the code accesses, each block comprising code for a unit of the application;</claim-text>
<claim-text>responsive to not having received the identified blocks of code, requesting the identified blocks of code from a remote application streaming server;</claim-text>
</claim-text>
<claim-text>a client application streaming module that when executed by the processor receives a set of streamed blocks of the application from the remote application streaming server, each streamed block comprising code for a unit of the application and having metadata comprising an indication of a portion of the application that the block represents, and each of a plurality of the streamed blocks containing an indication of whether the application has been found to be free of malware, the indication of whether the application has been found to be free of malware requiring at most one byte placed at a known location in the block and including either a first code indicating that the application has been found to be free of malware or a second code indicating that the application has not been found to be free of malware; and</claim-text>
<claim-text>a client scan verification module that when executed by the processor:
<claim-text>for each streamed block of the plurality of the streamed blocks:
<claim-text>determines whether the indication contained in the streamed block indicates that the application has been found to be free of malware, and</claim-text>
<claim-text>permits execution of the code comprised by the streamed block, responsive at least in part to the streamed block containing an indication that the application has been found to be free of malware.</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, further comprising:
<claim-text>a client scanning module that when executed by the processor performs actions comprising the following, responsive at least in part to the indication of at least one of the plurality of blocks indicating that the application has not been found to be free of malware:
<claim-text>halting execution of the code comprised by the received blocks;</claim-text>
<claim-text>scanning the code to determine whether it contains malware; and</claim-text>
<claim-text>permitting execution of the code, responsive to the scanning determining that the code does not contain malware.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, further comprising:
<claim-text>a client scanning module that when executed by the processor performs actions comprising the following, responsive at least in part to the indication of at least one of the plurality of blocks indicating that the application has not been found to be free of malware:
<claim-text>displaying an alert to a user that the application has not been verified to be free of malware;</claim-text>
<claim-text>receiving user input specifying whether to execute the code without performing a scan of the block for malware; and</claim-text>
<claim-text>responsive at least in part to the user input, executing the code without performing a scan of the block for malware.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A computer adapted to incorporate malware scanning within an application streaming system, comprising:
<claim-text>a non-transitory computer-readable storage medium storing computer program modules executable by a computer processor, the modules comprising:
<claim-text>an application packaging module that when executed by the processor segments a pre-existing application into a set of blocks and stores the set of blocks separately within an application repository;</claim-text>
<claim-text>a block server module that when executed by the processor receives, from a remote client, requests for a plurality of blocks segmented from the application by the application packaging module, each block comprising code for a unit of the application; and</claim-text>
</claim-text>
<claim-text>a scan assurance module that when executed by the processor determines whether the application has been found to be free of malware;</claim-text>
<claim-text>wherein:
<claim-text>the block server module when executed by the processor identifies the requested blocks within the application repository;</claim-text>
<claim-text>the scan assurance module when executed by the processor inserts, as metadata into each of the identified blocks, an indication of a portion of the application that the block represents;</claim-text>
<claim-text>the scan assurance module when executed by the processor inserts, as metadata into each of a plurality of the identified blocks, an indication of whether the scan assurance module has determined the application to be free of malware, the indication of whether the application has been found to be free of malware requiring at most one byte placed at a known location in the block and including either a first code indicating that the application has been found to be free of malware or a second code indicating that the application has not been found to be free of malware, and</claim-text>
<claim-text>the block server module when executed by the processor provides the blocks, including the inserted indications, to the remote client.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer of <claim-ref idref="CLM-00013">claim 13</claim-ref>, the modules further comprising an application scanning module when executed by the processor determines whether applications are free of malware.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The computer of <claim-ref idref="CLM-00013">claim 13</claim-ref>, the modules further comprising a server authentication module that when executed by the processor encrypts at least one of the blocks provided by the block server to the client.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The computer of <claim-ref idref="CLM-00013">claim 13</claim-ref>, the modules further comprising a server authentication module that when executed by the processor digitally signs, with a digital signature, at least one of the blocks provided by the block server to the client.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The computer of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein:
<claim-text>the application packaging module when executed by the processor segments the application into a set of blocks and stores them in an application repository storing a plurality of applications;</claim-text>
<claim-text>the block server when executed by the processor obtains the blocks of the application from the application repository, each application packaged in the application repository as a set of blocks for delivery via application streaming.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The computer of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein each application stored in the application repository was determined to be free of malware prior to being stored in the application repository. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353042-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353042</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12202427</doc-number>
<date>20080901</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>437</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>12</main-group>
<subgroup>14</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 24</main-classification>
<further-classification>726 12</further-classification>
</classification-national>
<invention-title id="d2e53">Content filtering of remote file-system access protocols</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6453354</doc-number>
<kind>B1</kind>
<name>Jiang et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6957219</doc-number>
<kind>B1</kind>
<name>Lin et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>  1  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2002/0178381</doc-number>
<kind>A1</kind>
<name>Lee et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0110391</doc-number>
<kind>A1</kind>
<name>Wolff et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713200</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2003/0145228</doc-number>
<kind>A1</kind>
<name>Suuronen et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2004/0268017</doc-number>
<kind>A1</kind>
<name>Uzrad-Nali et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2008/0282337</doc-number>
<kind>A1</kind>
<name>Crawford et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00008">
<othercit>Firewall-1. The Industry's Most Proven Perimeter Security. Check Point Software Technologies Ltd. 4 pgs.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>Non-Final Office Action for U.S. Appl. No. 11/746,046 mailed Sep. 30, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Non-Final Rejection for U.S. Appl. No. 11/746,046 mailed Jul. 6, 2012.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Final Rejection for U.S. Appl. No. 11/746,046 mailed Feb. 2, 2012.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Non-Final Rejection for U.S. Appl. No. 11/746,046 mailed Jun. 23, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Final Rejection for U.S. Appl. No. 11/746,046 mailed Mar. 22, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>59</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 12</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 24</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707 10</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>11746046</doc-number>
<date>20070508</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>12202427</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090006423</doc-number>
<kind>A1</kind>
<date>20090101</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Crawford</last-name>
<first-name>William Jeffrey</first-name>
<address>
<city>Coquitlam</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Hamilton, DeSanctis &#x26; Cha LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Fortinet, Inc.</orgname>
<role>02</role>
<address>
<city>Sunnyvale</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Hoffman</last-name>
<first-name>Brandon</first-name>
<department>2433</department>
</primary-examiner>
<assistant-examiner>
<last-name>Ambaye</last-name>
<first-name>Samuel</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Methods and systems for content filtering of remote file-system access protocols are provided. According to one embodiment, holding buffers in which data collected from a remote file-system access protocol is stored, a holding buffer context table, a file map table and a usage table corresponding to each holding buffer are created within one or more computer-readable media. References to each of the holding buffers are tracked within the holding buffer context table. References to a common file are mapped to a common holding buffer of the holding buffers with the file map table. Modified and unmodified portions of the holding buffers are tracked using the usage table corresponding to each holding buffer. Responsive to a predetermined event in relation to a holding buffer or the holding buffers, the existence of malicious, dangerous or unauthorized content contained within the holding buffer is determined by performing content filtering on the holding buffer.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="143.34mm" wi="193.12mm" file="US08353042-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="203.71mm" wi="158.58mm" orientation="landscape" file="US08353042-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="212.68mm" wi="138.77mm" orientation="landscape" file="US08353042-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="200.74mm" wi="150.03mm" orientation="landscape" file="US08353042-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="206.33mm" wi="161.97mm" file="US08353042-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="205.40mm" wi="167.13mm" file="US08353042-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="204.98mm" wi="165.52mm" file="US08353042-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="206.16mm" wi="159.94mm" orientation="landscape" file="US08353042-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="201.42mm" wi="149.61mm" orientation="landscape" file="US08353042-20130108-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation of U.S. application Ser. No. 11/746,046 filed on May 8, 2007, which is hereby incorporated by reference for all purposes.</p>
<p id="p-0003" num="0002">This application may also relate to subject matter disclosed in U.S. application Ser. No. 11/283,891 filed on Nov. 22, 2005 and U.S. application Ser. No. 11/331,030 filed Jan. 13, 2006, both of which are hereby incorporated by reference in their entirety for all purposes.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">COPYRIGHT NOTICE</heading>
<p id="p-0004" num="0003">Contained herein is material that is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction of the patent disclosure by any person as it appears in the Patent and Trademark Office patent files or records, but otherwise reserves all rights to the copyright whatsoever. Copyright&#xa9; 2006-2007, Fortinet, Inc.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0005" num="0004">1. Field</p>
<p id="p-0006" num="0005">Embodiments of the present invention generally relate to computer security and computer network security. In particular, embodiments of the present invention relate to content filtering of remote file-system access protocol streams.</p>
<p id="p-0007" num="0006">2. Description of the Related Art</p>
<p id="p-0008" num="0007">Various remote file-system access protocols provide client applications with the ability to read and write to files on and to request services from server programs in a computer network. For example, the Server Message Block (SMB) protocol can be used over the Internet on top of the TCP/IP protocol or on top of other network protocols, such as Internetwork Packet Exchange (IPX) and NetBEUI, to access files at a remote server as well as other resources, including printers, mailslots, and named pipes. Thus, a client application can read, create, and update files on the remote server. It can also communicate with any server program that is set up to receive an SMB client request.</p>
<p id="p-0009" num="0008">Common Internet File System (CIFS) defines a standard remote file-system access protocol for use over the Internet, enabling groups of users to work together and share documents across the Internet or within corporate intranets. CIFS is an open, cross-platform technology based on the native file-sharing protocols built into Microsoft&#xae; Windows&#xae; and other popular Personal Computer (PC) operating systems, and supported on dozens of other platforms.</p>
<p id="p-0010" num="0009">Unfortunately, the use of such remote file-system access protocols introduces insecurities as (i) the complexities of these protocols have made it difficult to perform content filtering, such as malware scanning, on the files when transferred through a network gateway; (ii) most network equipment vendors have chosen to simply provide access control functionality to their gateways to control read and write access to files and/or specific shared resources while leaving any complex filtering to be performed on the server; and (iii) users sharing folders or other resources from their personal desktop machines may not have appropriate filtering applications (e.g., antivirus software) installed, and therefore malicious programs can potential spread to or from such shared folders or resources.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0011" num="0010">Methods and systems are described for content filtering of remote file-system access protocols. According to one embodiment, a proxy associated with a network device, logically interposed between a client and a server, intercepts a Server Message Block/Common Internet File System (SMB/CIFS) protocol request from the client. The proxy then issues the remote file-system access protocol request to the server on behalf of the client. Data being read from or written to a file associated with a share of the server is buffered by the proxy into a file buffer associated with the network device. Responsive to a predetermined event in relation to the SMB/CIFS protocol or the file buffer, the proxy determines the existence or non-existence of malicious, dangerous or unauthorized content contained within the file buffer by performing content filtering on the file buffer.</p>
<p id="p-0012" num="0011">In the aforementioned embodiment, the network device may be a gateway</p>
<p id="p-0013" num="0012">In various instances of the aforementioned embodiments, the proxy may be a transparent proxy that implements handlers for only a subset of commands of the SMB/CIFS protocol.</p>
<p id="p-0014" num="0013">In the context of various of the aforementioned embodiments, the file buffer may include multiple holding buffers for each open file in the share.</p>
<p id="p-0015" num="0014">In various instances of the aforementioned embodiments, the file buffer may include a single holding buffer for each open file in the share.</p>
<p id="p-0016" num="0015">In the context of various of the aforementioned embodiments, the file buffer may be stored in non-persistent storage of the network device.</p>
<p id="p-0017" num="0016">In the context of various of the aforementioned embodiments, the single holding buffer may be stored in a shared memory of the network device that is accessible by a plurality of processes running within the network device.</p>
<p id="p-0018" num="0017">In the context of various of the aforementioned embodiments, the method may further include the proxy tracking references to the single holding buffer by maintaining a reference table containing file identifiers.</p>
<p id="p-0019" num="0018">In the context of various of the aforementioned embodiments, the method may further include the proxy tracking usage and modification of the single holding buffer with a usage table.</p>
<p id="p-0020" num="0019">In the context of various of the aforementioned embodiments, the usage table may contain information indicative of free and filled sections of the single holding buffer.</p>
<p id="p-0021" num="0020">In the context of various of the aforementioned embodiments, the predetermined event may be a determination that the single holding buffer is full.</p>
<p id="p-0022" num="0021">In the context of various of the aforementioned embodiments, the predetermined event may be an observation regarding one or more behaviors commonly exhibited by file-infecting viruses.</p>
<p id="p-0023" num="0022">In the context of various of the aforementioned embodiments, the one or more behaviors may include an attempt to append data to the file.</p>
<p id="p-0024" num="0023">Other embodiments of the present invention relate to a network device, which includes a content processor, a remote file-system access protocol proxy coupled to the content processor and a memory. The content processor implements one or more filters configured to detect the presence of malicious code in data being scanned. The remote file-system access protocol proxy is configured to be logically interposed between a client and a server and to cause content filtering to be performed by the content processor on data transferred between the client and server via a remote file-system access protocol responsive to a predetermined event. The memory contains multiple file buffer data structures, which are configured to buffer data being read from or written to files associated with a share of the server and to map multiple references to individual files during a remote file-system access protocol session to a single holding buffer corresponding to each of the individual files.</p>
<p id="p-0025" num="0024">In the aforementioned embodiment, the remote file-system access protocol may be Server Message Block/Common Internet File System (SMB/CIFS) protocol.</p>
<p id="p-0026" num="0025">In various instances of the aforementioned embodiments, the network device may be a network gateway.</p>
<p id="p-0027" num="0026">In the context of various of the aforementioned embodiments, the remote file-system access protocol proxy may be a transparent proxy.</p>
<p id="p-0028" num="0027">In the context of various of the aforementioned embodiments, the memory may be a shared memory that is accessible by a plurality of processes running within the network device.</p>
<p id="p-0029" num="0028">In the context of various of the aforementioned embodiments, the file buffer data structures may include a usage table corresponding to each single holding buffer to facilitate tracking of usage and modification of each single holding buffer.</p>
<p id="p-0030" num="0029">In the aforementioned embodiment, each usage table may include entries indicative of free and filled sections of each corresponding single holding buffer.</p>
<p id="p-0031" num="0030">In the context of various of the aforementioned embodiments, the predetermined event may involve determining one or more of the single holding buffers is full.</p>
<p id="p-0032" num="0031">In the context of various of the aforementioned embodiments, the predetermined event may involve the remote file-system access protocol proxy observing one or more behaviors commonly exhibited by file-infecting viruses.</p>
<p id="p-0033" num="0032">In the aforementioned embodiment, the one or more behaviors may include an attempt to append data to a file of the plurality of files.</p>
<p id="p-0034" num="0033">Other embodiments of the present invention relate to a method of content filtering data observed during a remote file-system access protocol session. A request is received to establish a network session at a network device. The request includes a source network address, a destination network address and a remote file-system access protocol. Data associated with the network session is collected by intercepting at a proxy associated with the network device and logically interposed between a client and server, a remote file-system access protocol request from the client, or a remote file-system access protocol response from the server. The proxy issues the remote file-system access protocol request to the server on behalf of the client, or forwards the remote file-system access protocol response to the client on behalf of the server. Content filtering is performed on the collected data.</p>
<p id="p-0035" num="0034">In the aforementioned embodiment, the network device may be a gateway.</p>
<p id="p-0036" num="0035">In various instances of the aforementioned embodiments, the remote file-system access protocol may be Server Message Block (SMB)/Common Internet File System (CIFS).</p>
<p id="p-0037" num="0036">In the context of various of the aforementioned embodiments, the proxy may implement handlers for all or a subset of commands of the remote file-system access protocol.</p>
<p id="p-0038" num="0037">In the context of various of the aforementioned embodiments, a holding buffer may be used to store the collected data.</p>
<p id="p-0039" num="0038">Other features of embodiments of the present invention will be apparent from the accompanying drawings and from the detailed description that follows.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0040" num="0039">Embodiments of the present invention are illustrated by way of example, and not by way of limitation, in the figures of the accompanying drawings and in which like reference numerals refer to similar elements and in which:</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram conceptually illustrating a simplified network architecture in which embodiments of the present invention may be employed.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram conceptually illustrating interaction among various functional units of a network gateway with a client and server in accordance with one embodiment of the present invention.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 3</figref> is an example of a computer system with which embodiments of the present invention may be utilized.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram conceptually illustrating various data structures employed by a file buffer in accordance with an embodiment of the present invention.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 5</figref> is a high-level, simplified flow diagram illustrating conventional remote file-system access protocol session processing.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 6</figref> is a simplified flow diagram illustrating a remote file-system access protocol scanning process that may be implemented by a Server Message Block (SMB)/Common Internet File System (CIFS) proxy logically interposed between a client and a server in accordance with an embodiment of the present invention.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIGS. 7A-D</figref> are block diagrams conceptually illustrating various states of a holding buffer and a corresponding free pointer and usage table that may be used to efficiently determine whether the holding buffer is full in accordance with an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0048" num="0047">Methods and systems are described for content filtering of remote file-system access protocols. According to one embodiment, remote file-system access protocol streams, such as Server Message Block (SMB)/Common Internet File System (CIFS) streams, are monitored between the client and server by a network gateway. Files being read and written are buffered into a shared area and at some point examined by one or more filtering mechanisms for malicious, dangerous and/or unauthorized content. For example, a network gateway logically interposed between a client and server may perform content filtering on files and/or other data transferred through the network gateway via the SMB/CIFS protocol. The filtering mechanisms may include, but are not limited to, filters, such as malware scanning, filename pattern blocking, confidential information control, etc. Advantageously, by performing content filtering at the gateway automated malware is unable to spread to unprotected systems and more security is gained over the types of data transferred by remote file-system access protocols.</p>
<p id="p-0049" num="0048">Embodiments of the present invention provide a file buffer management architecture that maps different file IDs (FIDs), created during a remote file-system access protocol session and referring to the same file, to the same holding buffer to facilitate filling of the holding buffer and to trigger desired content filtering of the holding buffer.</p>
<p id="p-0050" num="0049">According to one embodiment, a novel method of managing and scanning buffered data is provided to deal with the complexities of remote file-system access protocols that allow multiple client processes and even multiple threads within such processes to perform actions (reads/writes) on any portion of a shared file at any time. An efficient method for management of the buffered data is encompassed in this invention.</p>
<p id="p-0051" num="0050">In one embodiment, an efficient method is provided for quickly determining when a holding buffer is full without requiring tracking or searching for unmodified portions of the holding buffer.</p>
<p id="p-0052" num="0051">Importantly, although various embodiments of the content filtering system and methodologies are discussed in the context of a network gateway, they are equally applicable to other virtual or physical network devices or appliances that may be logically interposed between clients and servers, such as firewalls, network security appliances, virtual private network (VPN) gateways, switches, bridges, routers and the like.</p>
<p id="p-0053" num="0052">In the following description, numerous specific details are set forth in order to provide a thorough understanding of embodiments of the present invention. It will be apparent, however, to one skilled in the art that embodiments of the present invention may be practiced without some of these specific details. In other instances, well-known structures and devices are shown in block diagram form.</p>
<p id="p-0054" num="0053">Embodiments of the present invention include various steps, which will be described below. The steps may be performed by hardware components or may be embodied in machine-executable instructions, which may be used to cause a general-purpose or special-purpose processor programmed with the instructions to perform the steps. Alternatively, the steps may be performed by a combination of hardware, software, firmware and/or by human operators.</p>
<p id="p-0055" num="0054">Embodiments of the present invention may be provided as a computer program product, which may include a machine-readable medium having stored thereon instructions, which may be used to program a computer (or other electronic devices) to perform a process. The machine-readable medium may include, but is not limited to, floppy diskettes, optical disks, compact disc read-only memories (CD-ROMs), and magneto-optical disks, ROMs, random access memories (RAMs), erasable programmable read-only memories (EPROMs), electrically erasable programmable read-only memories (EEPROMs), magnetic or optical cards, flash memory, or other type of media/machine-readable medium suitable for storing electronic instructions. Moreover, embodiments of the present invention may also be downloaded as a computer program product, wherein the program may be transferred from a remote computer to a requesting computer by way of data signals embodied in a carrier wave or other propagation medium via a communication link (e.g., a modem or network connection).</p>
<p id="p-0056" num="0055">While for sake of illustration embodiments of the present invention are described with respect to Server Message Block (SMB)/Common Internet File System (CIFS), the methods and systems described herein are equally applicable to other remote file-system access protocols, such as Samba, Network File System (NFS) Not Quite NFS (NQNFS), Optimized Remote File-system Access (ORFA), Apple Filing Protocol (AFP), NetWare Core Protocol (NCP), Kerberos, Remote File System (RFS), OS/400 File Server file system (QFileSvr.400).</p>
<p id="h-0007" num="0000">Terminology</p>
<p id="p-0057" num="0056">Brief definitions of terms used throughout this application are given below.</p>
<p id="p-0058" num="0057">The terms &#x201c;connected&#x201d; or &#x201c;coupled&#x201d; and related terms are used in an operational sense and are not necessarily limited to a direct connection or coupling.</p>
<p id="p-0059" num="0058">The term &#x201c;client&#x201d; generally refers to an application, program, process or device in a client/server relationship that requests information or services from another program, process or device (a server) on a network. Importantly, the terms &#x201c;client&#x201d; and &#x201c;server&#x201d; are relative since an application may be a client to one application but a server to another. The term &#x201c;client&#x201d; also encompasses software that makes the connection between a requesting application, program, process or device to a server possible, such as an FTP client.</p>
<p id="p-0060" num="0059">The phrase &#x201c;content filtering&#x201d; generally refers to performing monitoring or scanning of files and/or other data transfer between a client and a server, such as malware scanning, filename pattern blocking, confidential information control and the like.</p>
<p id="p-0061" num="0060">The phrases &#x201c;in one embodiment,&#x201d; &#x201c;according to one embodiment,&#x201d; and the like generally mean the particular feature, structure, or characteristic following the phrase is included in at least one embodiment of the present invention, and may be included in more than one embodiment of the present invention. Importantly, such phases do not necessarily refer to the same embodiment.</p>
<p id="p-0062" num="0061">The phrase &#x201c;network gateway&#x201d; generally refers to an internetworking system, a system that joins two networks together. A &#x201c;network gateway&#x201d; can be implemented completely in software, completely in hardware, or as a combination of the two. Depending on the particular implementation, network gateways can operate at any level of the OSI model from application protocols to low-level signaling.</p>
<p id="p-0063" num="0062">If the specification states a component or feature &#x201c;may&#x201d;, &#x201c;can&#x201d;, &#x201c;could&#x201d;, or &#x201c;might&#x201d; be included or have a characteristic, that particular component or feature is not required to be included or have the characteristic.</p>
<p id="p-0064" num="0063">The term &#x201c;proxy&#x201d; generally refers to an intermediary device, program or agent, which acts as both a server and a client for the purpose of making or forwarding requests on behalf of other clients.</p>
<p id="p-0065" num="0064">The phrase &#x201c;remote file-system access protocol&#x201d; generally refers to a protocol that enables network file sharing. For example, remote file-system access protocols may allow client processes to access remote files located across the Internet or within a corporate intranet on a server in either a sequential or non-sequential manner. Examples of remote file-system access protocols include, but are not limited to Server Message Block (SMB)/Common Internet File System (CIFS), Samba, Network File System (NFS), Not Quite NFS (NQNFS), Optimized Remote File-system Access (ORFA), Apple Filing Protocol (AFP), NetWare Core Protocol (NCP), Kerberos, Remote File System (RFS) and OS/400 File Server file system (QFileSvr.400).</p>
<p id="p-0066" num="0065">The term &#x201c;request,&#x201d; unless negated by the context of its usage, generally refers to a remote file-system access protocol request or command issued by a client to a server. According to one embodiment in which SMB is the remote file-system access protocol, some commands can be chained together within the same request. For example, opening a file and reading the file. These types of commands are referred to as ANDX commands.</p>
<p id="p-0067" num="0066">The term &#x201c;response,&#x201d; unless negated by the context of its usage, generally refers to a remote file-system access protocol response issued by a server to a client. A response is typically, but need not be responsive to a request by the client.</p>
<p id="p-0068" num="0067">The term &#x201c;responsive&#x201d; includes completely or partially responsive.</p>
<p id="p-0069" num="0068">The term &#x201c;server&#x201d; generally refers to an application, program, process or device in a client/server relationship that responds to requests for information or services by another program, process or device (a server) on a network. The term &#x201c;server&#x201d; also encompasses software that makes the act of serving information or providing services possible.</p>
<p id="p-0070" num="0069">The term &#x201c;share&#x201d; when used as a noun herein generally refers to a resource, such as a file-system directory, that is being shared via a remote file-system access protocol. A share is typically referred to by a directory path or a &#x201c;share name.&#x201d; The share name doesn't need to be the same as the actual name of the object being shared as it exists on the server. For example, the directory path &#x201c;/My_Documents/Clients/Client<sub>&#x2014;</sub>#1/&#x201d; could be provided with a shorter and more descriptive name &#x201c;Client<sub>&#x2014;</sub>#1_Files.&#x201d; The share name may then take the place of the actual directory name when the share is accessed via a remote file-system access protocol. For example, if the server is named &#x201c;server,&#x201d; then the path to the share could be specified to the remote file-system access protocol as &#x201c;\\server\Client<sub>&#x2014;</sub>#1_Files.&#x201d; In one embodiment, when a remote file-system access protocol session is initiated, the server assigns a special identifier called a Tree ID (TID) to identify the share for the duration of the session.</p>
<p id="p-0071" num="0070">The phrase &#x201c;transparent proxy&#x201d; generally refers to a specialized form of proxy that only implements a subset of a given protocol and allows unknown or uninteresting protocol commands to pass unaltered. Advantageously, as compared to a full proxy in which use by a client typically requires editing of the client's configuration file(s) to point to the proxy, it is not necessary to perform such extra configuration in order to use a transparent proxy.</p>
<p id="h-0008" num="0000">Overview</p>
<p id="p-0072" num="0071">One or more embodiments of the present invention may include combinations of various of the following features:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0072">1. A proxy running within a network gateway intercepting remote file-system access protocol requests/responses exchanged between a client and a server and responsive thereto performing content processing on data exchanged between the client and server.</li>
        <li id="ul0002-0002" num="0073">2. Implementation of a single shared holding buffer per file per session that is associated with the proxy and that is accessible to multiple processes and/or threads to hold data being read and/or written between the client and server via a remote file-system access protocol.</li>
        <li id="ul0002-0003" num="0074">3. Mechanisms for quickly and efficiently determining whether a holding buffer, which may be modified and accessed in a non-sequential manner, is full.</li>
        <li id="ul0002-0004" num="0075">4. Mechanisms for mapping multiple file IDs (FIDs) referring to the same file to one holding buffer and tracking additional references to the holding buffer.</li>
        <li id="ul0002-0005" num="0076">5. Mechanisms for blocking access to files discovered to be infected or detected by other filters.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0073" num="0077">According to one embodiment of the present invention, a new proxy intercepts incoming SMB/CIFS requests and responses and scans files that are passed back and forth between a client and a server.</p>
<p id="p-0074" num="0078">According to one embodiment, a buffering mechanism is employed to allow content filtering of data exchanged between the client and server by preserving a copy of the data on the network gateway. Multiple client processes and/or threads of a single client process can access the same server file at the same time and potentially in different areas of the file. As a result, the allocation of a buffer for each thread and/or process may cause the network gateway to run out of memory. Further, the use of a buffer for each thread and/or process may result in only partial filling of a buffer during a particular session, thereby delaying or precluding content processing of the buffered data. Consequently, according to one embodiment, a single shared holding buffer is implemented. In this manner, each process and/or thread refers to the same buffer and fills in portions of the buffer as it is accessed. Advantageously, the shared holding buffer mechanism of various embodiments of the present invention saves memory and allows the buffer to be filled more quickly thereby increasing the likelihood of triggering content processing of the buffer.</p>
<p id="p-0075" num="0079">In one embodiment, content processing of the holding buffer is triggered responsive to the holding buffer becoming full (or completely modified). According to one embodiment, a usage table and free pointer methodology are employed to track how full the holding buffer is and allow efficient determination of the free buffer space.</p>
<p id="p-0076" num="0080">In accordance with the SMB/CIFS protocol, a filename can be uniquely identified by a combination of the filename path and a tree identifier (TID). According to one embodiment, this information is used in a special table to identify a file that has been opened and associated it with a file identifier (FID). Note, several processes may open the same file and obtain different FIDs. Consequently, according to one embodiment, a mechanism is provided to map multiple FIDS referring to the same file to one holding buffer by way of a file map table and a holding buffer context table.</p>
<p id="p-0077" num="0081">In one embodiment, mechanisms are provided for blocking access to files discovered to be infected. Assuming a remote file-system access protocol that allows partial (e.g., random or sequential) file access, once a file is discovered by the network gateway to be infected, part of the file will already have been read by or written to the client or the server, respectively. As a result, the server or client may contain a partial file with a corrupted version of a virus. According to one embodiment, once a file is discovered by the network gateway to be infected, appropriate error codes can be returned to the client in remote file-system access protocol responses to deny access to the client and/or to trigger appropriate action by the client.</p>
<p id="p-0078" num="0082"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram conceptually illustrating a simplified network architecture in which embodiments of the present invention may be employed. In this simple example, one or more remote clients <b>115</b> are coupled in communication with a local area network (LAN) <b>110</b> via the public Internet <b>100</b> and a network gateway <b>105</b>, which incorporates various novel content filtering methodologies in relation to remote file-system access protocol streams that are described further below. In the present example, the network gateway <b>105</b> is also coupled to an email server <b>150</b>, a web server <b>160</b> and a domain name server (DNS) <b>170</b>.</p>
<p id="p-0079" num="0083">In the exemplary network architecture of <figref idref="DRAWINGS">FIG. 1</figref>, LAN <b>110</b> includes one or more printers <b>140</b>, one or more servers <b>130</b> and one or more local clients <b>120</b>. According to one embodiment, remote clients <b>115</b>, local clients <b>120</b> and servers <b>130</b> employ a remote file-system access protocol to share resources, such as a directory tree, with each other. In one embodiment, the network gateway <b>105</b> includes a transparent remote file-system access protocol proxy that intercepts client remote file-system access protocol requests and server remote file-system access protocol responses. Since the proxy is transparent, handlers need not be implemented for each request and each response. In fact, according to one embodiment, only a few requests and responses actually trigger any substantive content filtering processing activity on the part of the transparent proxy. For example, handlers may only be implemented for requests/responses relating to initiating a session, opening a file, reading a file, writing a file and closing a file. All other requests/responses not used by the proxy may be passed through to the server/client untouched.</p>
<p id="p-0080" num="0084">Importantly, in the context of the present example, remote clients <b>115</b> and local clients <b>120</b> may take on the role of a server when sharing local files stored thereon, for example.</p>
<p id="p-0081" num="0085"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram conceptually illustrating interaction among various functional units of a network gateway <b>200</b> with a client <b>210</b> and a server <b>220</b> in accordance with one embodiment of the present invention. While in this simplified example, only a single client, i.e., client <b>210</b>, and a single server, i.e., server <b>220</b>, are shown interacting with the network gateway <b>200</b>, it should be understood that many local and/or remote clients and servers may interact with the network gateway <b>200</b> and directly with each other.</p>
<p id="p-0082" num="0086">According to the present example, the network gateway <b>200</b>, which may be a virtual or physical device, includes three interacting functional units, a SMB/CIFS proxy <b>230</b>, a file buffer <b>240</b> and a content processor <b>250</b>. In one embodiment, the SMB/CIFS proxy <b>230</b> is a transparent proxy that implements handlers for SMB/CIFS requests/responses relevant to the performance of content filtering activities and passes through those not relevant to the performance of content filtering activities.</p>
<p id="p-0083" num="0087">As described in detail below, the file buffer <b>240</b> maintains a copy of file data read or written by the client <b>210</b> from/to a share <b>221</b> associated with the server <b>220</b> to facilitate content filtering.</p>
<p id="p-0084" num="0088">According to one embodiment, the content processor <b>250</b> performs content filtering on data stored within the file buffer <b>240</b>. The content processor <b>250</b> may proactively monitor the file buffer <b>240</b> to determine when content filtering should be performed, may periodically initiate content filtering or may perform content filtering responsive to external events (e.g., a request by the file buffer and/or by the SMB/CIFS proxy <b>230</b>). In the current example, content processor <b>250</b> includes an antivirus (AV) filter <b>251</b> and one or more other filters <b>252</b>. The AV filter <b>251</b> may apply current or future virus detection methodologies, such as scanning, integrity checking, interception, and heuristic detection and the like, to determine the presence of malicious code in the data being scanned. The one or more other filters <b>252</b> may perform filename pattern blocking, confidential information control and the like. In one embodiment, the content processor <b>250</b> is an integrated FortiASIC&#x2122; Content Processor chip developed by Fortinet, Inc. of Sunnyvale, Calif. In alternative embodiments, the content processor <b>250</b> may be a dedicated coprocessor or software to help offload content filtering tasks from a host processor.</p>
<p id="p-0085" num="0089">While in the present example, the SMB/CIFS proxy <b>230</b>, the file buffer <b>240</b> and the content processor <b>250</b> are all shown as residing within or as part of the same network device, in alternative embodiments one or more of the SMB/CIFS proxy <b>230</b>, the file buffer <b>240</b> and the content processor <b>250</b> may be located remotely from the other functional units. According to one embodiment, the hardware components and/or software modules that implement the SMB/CIFS proxy <b>230</b>, the file buffer <b>240</b> and the content processor <b>250</b> are generally provided on or distributed among one or more Internet and/or LAN accessible networked devices, such as one or more network gateways, firewalls, network security appliances, switches, bridges, routers, data storage devices, computer systems and the like. In one embodiment, the functionality of the separate functional units may be merged in various combinations. For example, the file buffer <b>240</b> may be incorporated with the SMB/CIFS proxy <b>230</b> or the SMB/CIFS proxy <b>230</b> may be incorporated within the content processor.</p>
<p id="p-0086" num="0090">As indicated above, for sake of illustration, various embodiments of the present invention are described in the context of the SMB/CIFS protocol suite; however, such examples are not intended to limit the scope of the present invention. Rather, the methodologies described herein have applicability to remote file-system access protocols generally.</p>
<p id="p-0087" num="0091"><figref idref="DRAWINGS">FIG. 3</figref> is an example of a computer system with which embodiments of the present invention may be utilized. The computer system <b>300</b> may represent or form a part of a network gateway, firewall, network security appliance, switch, bridge, router, data storage devices, server and/or other network device implementing one or more of the SMB/CIFS proxy <b>230</b>, the file buffer <b>240</b> and the content processor <b>250</b>. According to <figref idref="DRAWINGS">FIG. 3</figref>, the computer system <b>300</b> includes one or more processors <b>305</b>, one or more communication ports <b>310</b>, main memory <b>315</b>, read only memory <b>320</b>, mass storage <b>325</b>, a bus <b>330</b>, and removable storage media <b>340</b>.</p>
<p id="p-0088" num="0092">The processor(s) <b>305</b> may be Intel&#xae; Itanium&#xae; or Itanium 2&#xae; processor(s), AMD&#xae; Opteron&#xae; or Athlon MP&#xae; processor(s) or other processors known in the art.</p>
<p id="p-0089" num="0093">Communication port(s) <b>310</b> represent physical and/or logical ports. For example communication port(s) may be any of an RS-232 port for use with a modem based dialup connection, a 10/100 Ethernet port, or a Gigabit port using copper or fiber. Communication port(s) <b>310</b> may be chosen depending on a network such a Local Area Network (LAN), Wide Area Network (WAN), or any network to which the computer system <b>300</b> connects.</p>
<p id="p-0090" num="0094">Communication port(s) <b>310</b> may also be the name of the end of a logical connection (e.g., a Transmission Control Protocol (TCP) port or a Universal Datagram Protocol (UDP) port). For example communication ports may be one of the Well Know Ports, such as UDP ports <b>137</b> or <b>138</b>, TCP port <b>139</b> (used for NETBIOS Session Service&#x2014;NetBT (NetBIOS over TCP/IP)), TCP port <b>445</b> (SMB over TCP/IP) and TCP port <b>80</b> (used for HTTP service), assigned by the Internet Assigned Numbers Authority (IANA) for specific uses.</p>
<p id="p-0091" num="0095">Main memory <b>315</b> may be Random Access Memory (RAM), or any other dynamic storage device(s) commonly known in the art.</p>
<p id="p-0092" num="0096">Read only memory <b>320</b> may be any static storage device(s) such as Programmable Read Only Memory (PROM) chips for storing static information such as instructions for processors <b>305</b>.</p>
<p id="p-0093" num="0097">Mass storage <b>325</b> may be used to store information and instructions. For example, hard disks such as the Adaptec&#xae; family of SCSI drives, an optical disc, an array of disks such as RAID, such as the Adaptec family of RAID drives, or any other mass storage devices may be used.</p>
<p id="p-0094" num="0098">Bus <b>330</b> communicatively couples processor(s) <b>305</b> with the other memory, storage and communication blocks. Bus <b>330</b> may be a PCI/PCI-X or SCSI based system bus depending on the storage devices used.</p>
<p id="p-0095" num="0099">Optional removable storage media <b>340</b> may be any kind of external hard-drives, floppy drives, IOMEGA&#xae; Zip Drives, Compact Disc-Read Only Memory (CD-ROM), Compact Disc-Re-Writable (CD-RW), Digital Video Disk (DVD)-Read Only Memory (DVD-ROM), Re-Writable DVD and the like.</p>
<p id="p-0096" num="0100"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram conceptually illustrating various data structures employed by a file buffer in accordance with an embodiment of the present invention. According to the present example, the file buffer, such as file buffer <b>240</b>, includes a file map table <b>410</b>, a holding buffer context table <b>420</b> and one or more holding buffers <b>430</b>, <b>440</b> and <b>450</b>. Each of these data structures may be stored in non-persistent storage, persistent storage (e.g., a hard drive or memory card), shared memory, allocated memory, static memory.</p>
<p id="p-0097" num="0101">On a server, each file belongs to a particular tree commonly known as a share. When a remote file-system access protocol session is initiated, the user has chosen a particular file from a share. According to the SMB/CIFS protocol suite, the server assigns a special identifier called the tree ID (TID) to identify this share for the duration of the session. Note, the TID may be different for separate sessions even though it is the same share being accessed.</p>
<p id="p-0098" num="0102">According to one embodiment, the file map table <b>410</b> maps references to the same file of a share to a holding buffer or holding buffers (e.g., holding buffers <b>430</b>, <b>440</b> and/or <b>450</b>) corresponding to that file via the holding buffer context table <b>420</b>. In the current example, the file map table <b>410</b> includes a file map table entry <b>413</b> for each FID returned by the server during a remote file-system access protocol session. The file map table entry <b>413</b> also includes a corresponding pointer to a holding buffer context table entry <b>423</b> in the holding buffer context table <b>420</b>, which maintains a reference count <b>421</b> and a holding buffer pointer <b>422</b> to the holding buffer corresponding to the open file. While in the present example, each holding buffer context table entry <b>423</b> refers to only a single holding buffer, in alternative embodiments holding buffer context table entries <b>423</b> may refer to multiple holding buffers.</p>
<p id="p-0099" num="0103">Depending upon the remote file-system access protocol, during a single session, multiple programs and/or multiple threads within the same program may make requests for the same or different files using the same session connection. In the context of the SMB/CIFS protocol suite, a filename can be uniquely identified by a combination of the filename path and the TID. This information may be maintained in a special table, such as the file map table <b>410</b>, to identify a file that has been opened and to store the corresponding FID. Once the file is open, multiple threads of a single process may operate on the file using the same FID. However, each time a file is opened, a new FID may be returned. Depending upon the particular implementation, the FID may consist of a number, a character string, a string of binary digits or other data type.</p>
<p id="p-0100" num="0104">In the SMB/CIFS protocol suite, each program is identified by a Process ID (PID) in the SMB header (not shown). A particular thread of a program is identified using the Multiplex ID (MID) (not shown). Thus, it would be quite challenging to manage the many files that may be accessed and the states of multiple threads that are accessing the files. Additionally, multiple processes and/or threads of a single process can access the same file at the same time and potentially in different areas of the file. If a buffer was allocated for each thread and process the network gateway <b>200</b> would quickly run out of memory and each of the buffers may only be partially filled for the duration of the session and therefore may never be scanned (assuming scanning is trigged as a result of a buffer being filled). As a result, in accordance with one embodiment of the present invention, a single holding buffer concept is implemented that maps all references to the same file during a session to the same holding buffer. Advantageously, by using a single holding buffer per open file per session, each process and/or thread will refer to the same buffer and fill in portions of the buffer as it is accessed. This not only saves much memory but allows the buffer to be filled quickly and then scanned. In alternative embodiments, references to the same file across sessions may also be mapped to a common holding buffer or multiple holding buffers may be employed for an open file within or across sessions.</p>
<p id="p-0101" num="0105">In the present example, portions of the holding buffers <b>430</b>, <b>440</b> and <b>450</b> that have been modified are shaded and unmodified portions are unshaded. In one embodiment, the holding buffer corresponds to the size of the open file and corresponding portions of the holding buffer are modified as the client reads data from or writes data to the file on the server.</p>
<p id="p-0102" num="0106"><figref idref="DRAWINGS">FIG. 5</figref> is a high-level, simplified flow diagram illustrating conventional remote file-system access protocol session processing. At block <b>505</b>, the client program initiates a connection to the server and issues a negotiate request command. Typically, the negotiate request client command is used to determine the capabilities of the server and decide on various settings such as error code format, filename path format (unicode, long filename support, etc.) and various other options. In accordance with the SMB/CIFS protocol suite, before two machines can start communicating with SMB, they negotiate the dialect of CIFS to use. The SMB_COM_NEGOTIATE client command is the first message sent by client to the server. This client command includes a list of SMB dialects supported by the client. Responsive to the negotiate request command, at block <b>510</b>, the server returns information regarding, among other things, its capabilities, error code format and filename path format. When the connection request is accepted, the server response indicates which SMB dialect should be used by the client.</p>
<p id="p-0103" num="0107">At block <b>515</b>, the client program issues a tree connect command, which in the context of SMB/CIFS includes the name of the share the client wants to access. At block <b>520</b>, the server opens the share and if successful provides the client with a TID in the SMB header for the client to use in connection with subsequent requests relating to this shared resource.</p>
<p id="p-0104" num="0108">At block <b>525</b>, the client program issues an open command (e.g., an SMB_COM_OPEN client command with the name of the file, relative to the TID, that the client wants to open). At block <b>530</b>, the server attempts to open the requested file and upon successfully opening the file returns to the client a FID the client should supply for subsequent operations on this file and the size of the file.</p>
<p id="p-0105" num="0109">At block <b>535</b>, the client program issues read and/or write commands. In accordance with the SMB/CIFS protocol, a SMB_COM_READ client command includes the TID, FID, file offset and number of bytes to read. Similarly, a SMB_COM_WRITE client command includes the TID, FID, file offset, size of data block (in some cases) and the data to be written. At block <b>540</b>, the server returns/writes the data from/to the specified offset within the identified file.</p>
<p id="p-0106" num="0110">At block <b>545</b>, the client program issues a close command to close the file represented by TID and FID. At block <b>550</b>, the server closes the file and responds with a success or error code. Finally, to end the session, the client disconnects (not shown) from the resource represented by the TID. For example, in the context of the SMB/CIFS protocol, the client issues a SMB_COM_TREE_DISCONNECT command.</p>
<p id="p-0107" num="0111"><figref idref="DRAWINGS">FIG. 6</figref> is a simplified flow diagram illustrating a remote file-system access protocol scanning process that may be implemented by a Server Message Block (SMB)/Common Internet File System (CIFS) proxy logically interposed between a client and a server in accordance with an embodiment of the present invention. Conceptually, the transparent SMB/CIFS proxy may be thought of as residing on the vertical dashed line shown in <figref idref="DRAWINGS">FIG. 5</figref>. As such, the SMB/CIFS proxy acts as a server with respect to the client <b>501</b> and as a client with respect to the server <b>502</b>.</p>
<p id="p-0108" num="0112">According to one embodiment, the remote file-system access protocol proxy is associated with a network gateway and intercepts client remote file-system access protocol requests and server remote file-system access protocol responses. In one embodiment, handlers are only implemented for a subset of the requests and responses and therefore the remote file-system access protocol proxy may be a transparent proxy as only some of the requests and responses are relevant to the task of content filtering. For example, in the context of the SMB/CIFS protocol suite, handlers may only be implemented for requests/responses relating to initiating a session (e.g., SMB_COM_NEGOTIATE and/or SMB_COM_SESSION_SETUP_ANDX), opening a file (e.g., SMB_COM_OPEN), reading a file (e.g., SMB_COM_READ), writing a file (e.g., SMB_COM_WRITE) and closing a file (e.g., SMB_COM_CLOSE). All other requests/responses not used by the proxy may be passed through to the server/client untouched.</p>
<p id="p-0109" num="0113">After a remote file-system access protocol request/response is intercepted, at decision block <b>605</b>, a determination is made by the remote file-system access protocol scanning process regarding the type of remote file-system access protocol command or response that has been received. If the remote file-system access protocol request/response is a negotiate response from the server, then processing continues with block <b>610</b>. If the request/response is an open response from the client, then processing branches to block <b>615</b>. If the request/response is a read response from the server or a write request from the client, then processing continues with block <b>640</b>. In one embodiment, all other requests/responses are passed through unchanged to the server/client by proceeding to block <b>630</b>.</p>
<p id="p-0110" num="0114">At block <b>610</b>, a determination has been made that the intercepted remote file-system access protocol request/response is a negotiate response issued by the server to the client. According to one embodiment, the error code format negotiated and returned in this response is of interest and is stored for later use in connection with modifying responses. After block <b>610</b>, processing continues with block <b>630</b>.</p>
<p id="p-0111" num="0115">At block <b>615</b>, a determination had been made that the intercepted remote file-system access protocol request/response is an open response issued by the server to the client. If the previously issued open request to which this open response corresponds was successful on the server side, a FID is returned to the client as well as the size of the opened file. According to the present example, upon receiving the open response, a new file map table entry <b>413</b> is inserted into the file map table <b>410</b> and the FID <b>411</b> and the context table pointer <b>412</b> are initialized appropriately. According to the present example, a special mapping is created for the FID to a particular holding buffer. Note, several processes may open the same file and obtain different FIDS, but in accordance with various embodiments of the present invention they will all be mapped to the same holding buffer.</p>
<p id="p-0112" num="0116">At decision block <b>620</b>, it is determined whether a holding buffer already exists for the file that has just been opened. If not, then processing continues with block <b>625</b>. Otherwise, if a holding buffer already exists that corresponds to the current file, then processing branches to block <b>635</b>.</p>
<p id="p-0113" num="0117">At block <b>625</b>, a holding buffer is created and corresponding holding buffer context table entry <b>423</b> is initialized. According to one embodiment, in which each holding buffer context table entry <b>423</b> includes a reference count <b>421</b> and a holding buffer pointer <b>422</b>, the reference count <b>421</b> is initialized to one and the holding buffer pointer <b>422</b> is initialized to the address of the beginning of the holding buffer. After block <b>625</b>, processing continues with block <b>630</b>.</p>
<p id="p-0114" num="0118">At block <b>630</b>, the request/response is passed through to the server/client. Processing then resumes with block <b>605</b>.</p>
<p id="p-0115" num="0119">At block <b>635</b>, a holding buffer has previously been created for this file. Consequently, in an embodiment in which only a single holding buffer is employed for each file opened during a session, the reference count <b>421</b> of the holding buffer context table entry <b>423</b> corresponding to the holding buffer is incremented to reflect the existence of another reference to the file.</p>
<p id="p-0116" num="0120">At block <b>640</b>, a determination has been made that the intercepted remote file-system access protocol request/response is a read response issued by the server to the client or a write request made by the client to the server. According to the present example, the intercepted data (i.e., the data returned by the server responsive to the client's read request or the data provided by the client to be written to the specified file on the server) is written into the corresponding holding buffer (e.g., holding buffer <b>430</b>, <b>440</b> or <b>450</b>) at the appropriate offset. According to the present example, a free pointer (e.g., free pointer <b>730</b>) and usage table (e.g., usage table <b>710</b>) are maintained for each holding buffer (e.g., holding buffers <b>430</b>, <b>440</b> and/or <b>450</b>) to allow an efficient determination regarding the fullness of the holding buffer. Responsive to writing data into the holding buffer the free pointer and usage table are updated appropriately as described further below.</p>
<p id="p-0117" num="0121">At decision block <b>645</b>, it is determined whether one or more criteria for initiating scanning of the holding buffer (e.g., holding buffer <b>430</b>, <b>440</b> or <b>450</b>) have been satisfied. In one embodiment, the criteria include the holding buffer having been completely filled by the read and write requests of the various client processes accessing the file. In one embodiment, the holding buffer may be examined for unmodified portions to determine whether it has been completely filled. Alternatively, an efficient fullness test can be performed as described with reference to <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0118" num="0122">According to one embodiment, an additional triggering condition for content scanning includes a write request representing data being appended to the end of the file. Empirical evidence indicates appending data to the end of a file is a common behavior of file-infecting viruses. Experimentation with various forms of live file-infecting viruses revealed that when a file-infecting virus attempted to spread throughout the share it would, in most cases, read the header of the file first, make some modifications, and then begin appending itself to the end of the file. Since such viruses first obtain and change the headers, the header information as well as the data attempting to be appended are available in the holding buffer for content filtering. The rest of the buffer is irrelevant for purposes of detecting such viruses. Consequently, content filtering can be successfully performed upon observing such behavior with the only downside being redundant scanning for each appending write that is issued by the client.</p>
<p id="p-0119" num="0123">Various other triggering conditions may be used to initiate content filtering, such as the observation of other behaviors commonly exhibited by file-infecting viruses. In some embodiments, the holding buffers may periodically be scanned without regard for their state of fullness. At any rate, if one or more of the scanning criteria are satisfied, then processing continues with block <b>650</b>; otherwise, processing resumes with block <b>630</b>.</p>
<p id="p-0120" num="0124">At block <b>650</b>, the holding buffer is scanned. As indicated earlier, the content scanning or content filtering may include the examination of the holding buffer by one or more filtering mechanisms for malicious, dangerous and/or unauthorized content. The content filtering mechanisms may include, but are not limited to malware scanning, filename pattern blocking, confidential information control, etc.</p>
<p id="p-0121" num="0125">At decision block <b>655</b>, the existence of dangerous or unauthorized content is determined. If such content is found during the scanning, then processing branches to block <b>660</b>. Otherwise, if no dangerous or unauthorized content is discovered during the scanning, then processing continues with block <b>630</b></p>
<p id="p-0122" num="0126">At block <b>660</b>, dangerous or unauthorized content has been read from or written to the file. Consequently, further access to the file in question may be blocked by returning an appropriate error code to the client by modifying the server response. Processing then resumes with block <b>605</b>.</p>
<p id="p-0123" num="0127">Once it has been discovered that a file is infected, part of the file will have either been read or written to the client or server respectively. According to one embodiment, a second holding buffer, such as a shadow buffer (not shown) that only records data read from the server may be used to address this potential file corruption. The shadow buffers may have their own usage tables and be logically linked to the main holding buffers. If a virus, for instance, reads the header of a file, the initial read will be stored in both the holding buffer and the shadow buffer, then at the point at which the virus attempts to modify the header and write it back to the server only the holding buffer will contain the change and the shadow buffer will maintain the original header. When, the virus begins to append and is eventually detected, again the appended data will only have been added to the holding buffer and not to the shadow buffer. Consequently, in some embodiments, the shadow buffer may be used to restore the original file on the server from the clean copy maintained in the shadow buffer. Assuming virus writers begin to implement countermeasures to the shadow buffer mechanism, e.g., if the virus reads and writes then reads the same block again, one solution may be to store only the first read from a given block of the file to the shadow buffer.</p>
<p id="p-0124" num="0128">In one embodiment, by using the information regarding the error code format obtained during the session negotiation a response can be created with an error code denying access to the file by the client. Alternatively or additionally, the error code returned may trigger some other action, such as closing of the file and/or a local content scanning process, in the client program. Meanwhile, the server may contain a partial file with a corrupted version of the virus that will unlikely be able to be opened or executed. This partial file may however be detected by other host based antivirus software installed on the server. After receiving an error code responsive to a read or write request, the client will likely close the file. Notably, care in implementation is again required in connection with SMB ANDX chained commands since one or more early commands of the chain may have succeeded but subsequent ones fail. The structure of the chain should nevertheless be retained in the response to the client in order to prevent compatibility problems.</p>
<p id="p-0125" num="0129">At block <b>665</b>, a determination had been made that the intercepted remote file-system access protocol request/response is a close request issued by the client to the server. According to the present example, this will cause one of the file map table entries <b>413</b> to be removed from the file map table <b>410</b>.</p>
<p id="p-0126" num="0130">At block <b>670</b>, the reference count <b>421</b> in the corresponding holding buffer context table entry <b>423</b> is decremented to reflect that fact that one fewer process is referencing the file.</p>
<p id="p-0127" num="0131">At decision block <b>675</b>, it is determined if no references are currently being made to the file. If the number of references to the holding buffer is zero, then processing continues with block <b>680</b>; otherwise, if references remain to the holding buffer, then processing continues with block <b>630</b>.</p>
<p id="p-0128" num="0132">If the number of references to the holding buffer is zero, then it can be destroyed. However, in the present example, at block <b>680</b>, the holding buffer is simply marked for destruction. An asynchronous cleanup routine may destroy it at a later point thereby giving the holding buffer a chance to be resurrected again if it is accessed again shortly after the last close. For example, empirical evidence suggests when a user edits a file over a share, often the whole file is read over to the client computer and then closed and reopened for writing immediately afterwards.</p>
<p id="p-0129" num="0133">Note that for purposes of clarity and in order to simplify the present example a special characteristic of SMB, command chaining, has been ignored above. In the context of SMB, some commands can be chained together within the same request. For example opening a file and reading the file. These types of commands are called ANDX commands. While difficult to illustrate in a flow diagram, in order to function correctly, the proxy of the present example would be implemented to follow these command chains and act upon any data or information required from the commands.</p>
<p id="p-0130" num="0134"><figref idref="DRAWINGS">FIGS. 7A-D</figref> are block diagrams conceptually illustrating various states of a holding buffer and a corresponding free pointer and usage table that may be used to efficiently determine whether the holding buffer is full in accordance with an embodiment of the present invention.</p>
<p id="p-0131" num="0135">Some difficulties arise as a result of the way various remote file-system access protocols, such as SMB, are designed. For example, since the SMB protocol allows a file to be read and/or written at any offset, there can be no guarantee at any particular time that the whole file will be available in the holding buffer in order to facilitate successful content processing. Consequently, in accordance with various embodiments of the present invention, a tracking mechanism is employed to quickly and efficiently indicate whether the holding buffer is full.</p>
<p id="p-0132" num="0136">In one embodiment, the fullness tracking mechanism includes the use of a special usage table <b>710</b> and a pointer <b>730</b> called the free pointer. The usage table <b>710</b> may be a smaller buffer, a fraction, such as &#x215b;<sup>th</sup>, the size of the actual holding buffer <b>720</b>, where each bit <b>711</b> in the usage table <b>710</b> represents a number of bits, such as a byte <b>721</b> in the real holding buffer <b>720</b>. As a particular byte is modified in the real holding buffer <b>720</b>, the corresponding bit or bits are set in the usage table <b>710</b>.</p>
<p id="p-0133" num="0137">In one embodiment, the usage table is initialized in some predictable way (e.g., all nulls) to allow a determination to be made regarding the corresponding blocks of data in the holding buffer that have actually been read/written from/to the server versus blocks that are still in the initialized state. The holding buffer may also be initialized at creation, for example, by filling it with nulls, a single repeated character or random characters. According to the present example, corresponding blocks of data, e.g., bytes, that have been modified in the holding buffer will appear in the usage table as a block of bits that have been set, whereas areas that have not yet been touched will be unset in the usage table. It is possible that data read into the holding buffer is identical to its initialized state e.g., a block of nulls may be read into a holding buffer that was initialized to nulls; however, the block of nulls read will still be represented in the usage table as set bits. It is also possible for the same block or portion of a block to be read or written again, but does not affect the state of the usage table since that area has already been modified once before.</p>
<p id="p-0134" num="0138">In <figref idref="DRAWINGS">FIGS. 7A-D</figref>, bits <b>711</b> of the usage table <b>710</b> set to zero indicate the corresponding byte <b>721</b> of the holding buffer <b>720</b> are unmodified (i.e., that byte of the file has not yet been read by the client or written to by the client). Unmodified bytes <b>721</b> of the holding buffer <b>720</b> are unshaded and modified bytes <b>721</b> of the holding buffer <b>720</b> are shaded.</p>
<p id="p-0135" num="0139"><figref idref="DRAWINGS">FIG. 7A</figref> illustrates the usage table <b>710</b>, free pointer <b>730</b> and holding buffer <b>720</b> in an initial state before any data has been read from or written to the associated file. As illustrated in the simplified example of <figref idref="DRAWINGS">FIG. 7A</figref>, the free pointer <b>730</b> initially points at the beginning of the usage table <b>710</b>.</p>
<p id="p-0136" num="0140">As illustrated in the simplified example of <figref idref="DRAWINGS">FIG. 7B</figref>, at which point the first 64 bytes of the holding buffer <b>720</b> have been modified, as each full byte (8 bits of the usage table <b>710</b> representing 8 bytes in the real holding buffer <b>720</b>) is filled, the free pointer <b>730</b> is incremented to the next byte. When the holding buffer <b>720</b> is not full (as is the case in <figref idref="DRAWINGS">FIGS. 7A-C</figref>), the free pointer <b>730</b> will always point to the first non-full byte in the usage table <b>710</b>.</p>
<p id="p-0137" num="0141">Notably, as illustrated with reference to <figref idref="DRAWINGS">FIG. 7C</figref>, the holding buffer <b>720</b> can still be filled at offsets further into the file than the free pointer <b>730</b>, but the free pointer <b>730</b> will not move until the current location has been filled. As a note, in the current example, as long as the holding buffer <b>720</b> is not full, the free pointer <b>730</b> always points to the earliest unmodified block in the usage table <b>710</b>.</p>
<p id="p-0138" num="0142">As illustrated by <figref idref="DRAWINGS">FIG. 7D</figref>, if the free pointer <b>730</b> is incremented beyond the end of the usage table <b>710</b> (e.g., set to NULL), then the whole holding buffer <b>720</b> has been filled at that point and it is safe to process its content. As should be appreciated, this fullness tracking mechanism saves development effort and increases run-time efficiency since there is no need to track (and/or search for) each free chunk in the file.</p>
<p id="p-0139" num="0143">In alternative embodiments, the free pointer <b>730</b> need not be used and instead the usage table bits <b>711</b> may be logically ANDed to determine the existence of any unmodified portions of the holding buffer. In some embodiments, multiple pointers may be used to track free or filled sections of a particular holding buffer.</p>
<p id="p-0140" num="0144">While in the simplified example illustrated by <figref idref="DRAWINGS">FIGS. 7A-D</figref>, the usage table elements consist of a single bit corresponding to a single byte of the holding buffer, it is contemplated that the usage table elements could comprise one or more bits, one or more bytes, one or more numbers or one or more strings. Further, each usage table element may correspond to one or more bits of the holding buffer or one or more bytes of the holding buffer. In general, one bit of the usage table corresponds to n bytes of the holding buffer. For example, one bit in the usage table may represent a four byte unsigned long value (32 bits) or a long value (64 bits) or more. The more data from the holding buffer that is represented by each bit of the usage table, the smaller the usage table will be; however, to optimize for speed, implementations will likely wish to align the data on block boundaries to facilitate application of bit masks. Optimal speed is presently thought to be achieved at a ratio of approximately one usage table bit to less than or equal to four bytes of holding buffer for a 32-bit processor or approximately one usage table bit to less than or equal to eight bytes for a 64-bit processor.</p>
<p id="p-0141" num="0145">While embodiments of the invention have been illustrated and described, it will be clear that the invention is not limited to these embodiments only. Numerous modifications, changes, variations, substitutions, and equivalents will be apparent to those skilled in the art, without departing from the spirit and scope of the invention, as described in the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method comprising:
<claim-text>intercepting by a proxy associated with a network device, logically interposed between a client and a server, a Server Message Block/Common Internet File System (SMB/CIFS) protocol request from the client, the SMB/CIFS protocol request representing a request to make a partial file access to a file associated with a share of the server;</claim-text>
<claim-text>the proxy issuing the SMB/CIFS protocol request to the server on behalf of the client;</claim-text>
<claim-text>the proxy implementing a single shared holding buffer for the file during a particular SMB/CIFS protocol session, wherein the single shared holding buffer is used for both read and write accesses to the file and is used for accesses to the file by a plurality of processes running on the client by mapping different file IDs referring to the file to the single shared holding buffer;</claim-text>
<claim-text>the proxy buffering into the single shared holding buffer data being read from or written to the file as a result of the SMB/CIFS protocol request; and</claim-text>
<claim-text>responsive to a predetermined event in relation to the SMB/CIFS protocol or the single shared holding buffer, the proxy determining the existence or non-existence of malicious, dangerous or unauthorized content contained within the single shared holding buffer by performing content filtering on the single shared holding buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the network device comprises a gateway.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the proxy comprises a transparent proxy that implements handlers for only a subset of commands of the SMB/CIFS protocol.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the single shared holding buffer is stored in non-persistent storage of the network device.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the single shared holding buffer is stored in a shared memory of the network device that is accessible by a plurality of processes running within the network device.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising the proxy tracking references to the single shared holding buffer by maintaining a reference table containing file identifiers.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising the proxy tracking usage and modification of the single shared holding buffer with a usage table.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the usage table contains information indicative of free and filled sections of the single shared holding buffer.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the predetermined event comprises determining the single shared holding buffer is full.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the predetermined event comprises observing one or more behaviors commonly exhibited by file-infecting viruses.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the one or more behaviors include an attempt to append data to the file.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A network device comprising:
<claim-text>a content processor implementing one or more filters configured to detect the presence of malicious code in data being scanned;</claim-text>
<claim-text>a remote file-system access protocol proxy, coupled to the content processor, configured to be logically interposed between a client and a server and to cause content filtering to be performed by the content processor on data transferred between the client and server via a remote file-system access protocol responsive to a predetermined event, wherein the remote file-system access protocol proxy is further configured to handle remote file-system access protocol requests each representing a request to make a partial file access to one of a plurality of files associated with a share of the server; and</claim-text>
<claim-text>a memory containing therein a plurality of file buffer data structures, the file buffer data structures configured to buffer data being read from or written to the plurality of files as a result of the remote file-system access protocol requests and map multiple references, by a plurality of processes running on the client, to individual files of the plurality of files during a remote file-system access protocol session to a single holding buffer corresponding to each of the individual files by mapping different file IDs referring to each of the individual files to the single shared holding buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The network device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the remote file-system access protocol comprises Server Message Block/Common Internet File System (SMB/CIFS) protocol.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The network device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the network device comprises a network gateway.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The network device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the remote file-system access protocol proxy comprises a transparent proxy.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The network device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the memory is a shared memory that is accessible by a plurality of processes running within the network device.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The network device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the file buffer data structures include a usage table corresponding to each single holding buffer to facilitate tracking of usage and modification of each single holding buffer.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The network device of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein each usage table includes entries indicative of free and filled sections of each corresponding single holding buffer.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The network device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the predetermined event comprises determining one or more of the single holding buffers is full.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The network device of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the predetermined event comprises the remote file-system access protocol proxy observing one or more behaviors commonly exhibited by file-infecting viruses.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The network device of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein the one or more behaviors include an attempt to append data to a file of the plurality of files.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A method comprising:
<claim-text>receiving a request to establish a network session at a network device, the request being characterized by a source network address, a destination network address and a remote file-system access protocol;</claim-text>
<claim-text>collecting data associated with the network session by intercepting at a proxy associated with the network device, logically interposed between a client and server, a remote file-system access protocol request from the client, and a remote file-system access protocol response from the server, wherein the remote file-system access protocol request represents a request to make a partial file access to a file associated with a share of the server;</claim-text>
<claim-text>the proxy issuing the remote file-system access protocol request to the server on behalf of the client, and forwarding the remote file-system access protocol response to the client on behalf of the server;</claim-text>
<claim-text>the proxy implementing a single shared holding buffer for the file during a particular SMB/CIFS protocol session, wherein the single shared holding buffer is used for both read and write accesses to the file and is used for accesses to the file by a plurality of processes running on the client by mapping different file IDs referring to the file to the single shared holding buffer;</claim-text>
<claim-text>the proxy buffering the collected data into the single shared holding buffer data; and</claim-text>
<claim-text>responsive to a predetermined event in relation to the remote file-system access protocol or the single shared holding buffer, performing content filtering on the collected data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the network device comprises a gateway.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the remote file-system access protocol comprises Server Message Block (SMB)/Common Internet File System (CIFS).</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the proxy implements handlers for all or a subset of commands of the remote file-system access protocol.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. A method comprising:
<claim-text>intercepting by a proxy associated with a network device, logically interposed between a client and a server, a Server Message Block/Common Internet File System (SMB/CIFS) protocol request from the client, the SMB/CIFS protocol request representing a random or sequential access to a portion of data of a file associated with a share of the server;</claim-text>
<claim-text>the proxy issuing the SMB/CIFS protocol request to the server on behalf of the client;</claim-text>
<claim-text>the proxy implementing a single shared holding buffer for the file during a particular SMB/CIFS protocol session, wherein the single shared holding buffer is used for both read and write accesses to the file and is used for accesses to the file by a plurality of processes running on the client by mapping different file IDs referring to the file to the single shared holding buffer;</claim-text>
<claim-text>the proxy buffering into the single shared holding buffer data being read from or written to the file as a result of the SMB/CIFS protocol request; and</claim-text>
<claim-text>responsive to a predetermined event in relation to the SMB/CIFS protocol or the single shared holding buffer, the proxy determining the existence or non-existence of malicious, dangerous or unauthorized content contained within the file buffer by performing content filtering on the single shared holding buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the network device comprises a gateway.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the proxy comprises a transparent proxy that implements handlers for only a subset of commands of the SMB/CIFS protocol.</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the single shared holding buffer is stored in non-persistent storage of the network device.</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the single shared holding buffer is stored in a shared memory of the network device that is accessible by a plurality of processes running within the network device.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, further comprising the proxy tracking references to the single shared holding buffer by maintaining a reference table containing file identifiers.</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. The method of <claim-ref idref="CLM-00031">claim 31</claim-ref>, further comprising the proxy tracking usage and modification of the single shared holding buffer with a usage table.</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. The method of <claim-ref idref="CLM-00032">claim 32</claim-ref>, wherein the usage table contains information indicative of free and filled sections of the single shared holding buffer.</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the predetermined event comprises determining the single shared holding buffer is full.</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. The method of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the predetermined event comprises observing one or more behaviors commonly exhibited by file-infecting viruses.</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. The method of <claim-ref idref="CLM-00035">claim 35</claim-ref>, wherein the one or more behaviors include an attempt to append data to the file.</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. A non-transitory computer-readable storage medium embodying a set of instructions, which when executed by one or more processors of a network device logically interposed between a client and a server, cause the one or more processors to perform a method of proxying comprising:
<claim-text>intercepting a Server Message Block/Common Internet File System (SMB/CIFS) protocol request from the client, the SMB/CIFS protocol request representing a request to make a partial file access to a file associated with a share of the server;</claim-text>
<claim-text>issuing the SMB/CIFS protocol request to the server on behalf of the client;</claim-text>
<claim-text>implementing a single shared holding buffer for the file during a particular SMB/CIFS protocol session, wherein the single shared holding buffer is used for both read and write accesses to the file and is used for accesses to the file by a plurality of processes running on the client by mapping different file IDs referring to the file to the single shared holding buffer;</claim-text>
<claim-text>buffering into the single shared holding buffer data being read from or written to the file as a result of the SMB/CIFS protocol request; and</claim-text>
<claim-text>responsive to a predetermined event in relation to the SMB/CIFS protocol or the single shared holding buffer, determining the existence or non-existence of malicious, dangerous or unauthorized content contained within the single shared holding buffer by performing content filtering on the single shared holding buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The computer-readable storage medium of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the network device comprises a gateway.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. The computer-readable storage medium of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the single shared holding buffer is stored in non-persistent storage of the network device.</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. The computer-readable storage medium of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the single shared holding buffer is stored in a shared memory of the network device that is accessible by a plurality of processes running within the network device.</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. The computer-readable storage medium of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the method further comprises tracking references to the single shared holding buffer by maintaining a reference table containing file identifiers.</claim-text>
</claim>
<claim id="CLM-00042" num="00042">
<claim-text>42. The computer-readable storage medium of <claim-ref idref="CLM-00041">claim 41</claim-ref>, wherein the method further comprises tracking usage and modification of the single shared holding buffer with a usage table.</claim-text>
</claim>
<claim id="CLM-00043" num="00043">
<claim-text>43. The computer-readable storage medium of <claim-ref idref="CLM-00042">claim 42</claim-ref>, wherein the usage table contains information indicative of free and filled sections of the single shared holding buffer.</claim-text>
</claim>
<claim id="CLM-00044" num="00044">
<claim-text>44. The computer-readable storage medium of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the predetermined event comprises determining the single shared holding buffer is full.</claim-text>
</claim>
<claim id="CLM-00045" num="00045">
<claim-text>45. The computer-readable storage medium of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the predetermined event comprises observing one or more behaviors commonly exhibited by file-infecting viruses.</claim-text>
</claim>
<claim id="CLM-00046" num="00046">
<claim-text>46. The computer-readable storage medium of <claim-ref idref="CLM-00045">claim 45</claim-ref>, wherein the one or more behaviors include an attempt to append data to the file.</claim-text>
</claim>
<claim id="CLM-00047" num="00047">
<claim-text>47. A non-transitory computer-readable storage medium embodying a set of instructions, which when executed by one or more processors of a network device logically interposed between a client and a server, cause the one or more processors to perform a method of proxying comprising:
<claim-text>receiving a request to establish a network session, the request being characterized by a source network address, a destination network address and a remote file-system access protocol;</claim-text>
<claim-text>collecting data associated with the network session by intercepting a remote file-system access protocol request from the client, and a remote file-system access protocol response from the server, wherein the remote file-system access protocol request represents a request to make a partial file access to a file associated with a share of the server;</claim-text>
<claim-text>issuing the remote file-system access protocol request to the server on behalf of the client and forwarding the remote file-system access protocol response to the client on behalf of the server;</claim-text>
<claim-text>implementing a single shared holding buffer for the file during a particular SMB/CIFS protocol session, wherein the single shared holding buffer is used for both read and write accesses to the file and is used for accesses to the file by a plurality of processes running on the client by mapping different file IDs referring to the file to the single shared holding buffer;</claim-text>
<claim-text>buffering the collected data into the single shared holding buffer data; and</claim-text>
<claim-text>responsive to a predetermined event in relation to the remote file-system access protocol or the single shared holding buffer, performing content filtering on the collected data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00048" num="00048">
<claim-text>48. The computer-readable storage medium of <claim-ref idref="CLM-00047">claim 47</claim-ref>, wherein the network device comprises a gateway.</claim-text>
</claim>
<claim id="CLM-00049" num="00049">
<claim-text>49. The computer-readable storage medium of <claim-ref idref="CLM-00047">claim 47</claim-ref>, wherein the remote file-system access protocol comprises Server Message Block (SMB)/Common Internet File System (CIFS).</claim-text>
</claim>
<claim id="CLM-00050" num="00050">
<claim-text>50. A non-transitory computer-readable storage medium embodying a set of instructions, which when executed by one or more processors of a network device logically interposed between a client and a server, cause the one or more processors to perform a method of proxying comprising:
<claim-text>intercepting a Server Message Block/Common Internet File System (SMB/CIFS) protocol request from the client, the SMB/CIFS protocol request representing a random or sequential access to a portion of data of a file associated with a share of the server;</claim-text>
<claim-text>issuing the SMB/CIFS protocol request to the server on behalf of the client;</claim-text>
<claim-text>implementing a single shared holding buffer for the file during a particular SMB/CIFS protocol session, wherein the single shared holding buffer is used for both read and write accesses to the file and is used for accesses to the file by a plurality of processes running on the client by mapping different file IDs referring to the file to the single shared holding buffer;</claim-text>
<claim-text>buffering into the single shared holding buffer data being read from or written to the file as a result of the SMB/CIFS protocol request; and</claim-text>
<claim-text>responsive to a predetermined event in relation to the SMB/CIFS protocol or the single shared holding buffer, determining the existence or non-existence of malicious, dangerous or unauthorized content contained within the file buffer by performing content filtering on the single shared holding buffer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00051" num="00051">
<claim-text>51. The computer-readable storage medium of <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the network device comprises a gateway.</claim-text>
</claim>
<claim id="CLM-00052" num="00052">
<claim-text>52. The computer-readable storage medium of <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the single shared holding buffer is stored in non-persistent storage of the network device.</claim-text>
</claim>
<claim id="CLM-00053" num="00053">
<claim-text>53. The computer-readable storage medium of <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the single shared holding buffer is stored in a shared memory of the network device that is accessible by a plurality of processes running within the network device.</claim-text>
</claim>
<claim id="CLM-00054" num="00054">
<claim-text>54. The computer-readable storage medium of <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the method further comprises tracking references to the single shared holding buffer by maintaining a reference table containing file identifiers.</claim-text>
</claim>
<claim id="CLM-00055" num="00055">
<claim-text>55. The computer-readable storage medium of <claim-ref idref="CLM-00054">claim 54</claim-ref>, wherein the method further comprises tracking usage and modification of the single shared holding buffer with a usage table.</claim-text>
</claim>
<claim id="CLM-00056" num="00056">
<claim-text>56. The computer-readable storage medium of <claim-ref idref="CLM-00055">claim 55</claim-ref>, wherein the usage table contains information indicative of free and filled sections of the single shared holding buffer.</claim-text>
</claim>
<claim id="CLM-00057" num="00057">
<claim-text>57. The computer-readable storage medium of <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the predetermined event comprises determining the single shared holding buffer is full.</claim-text>
</claim>
<claim id="CLM-00058" num="00058">
<claim-text>58. The computer-readable storage medium of <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the predetermined event comprises observing one or more behaviors commonly exhibited by file-infecting viruses.</claim-text>
</claim>
<claim id="CLM-00059" num="00059">
<claim-text>59. The computer-readable storage medium of <claim-ref idref="CLM-00058">claim 58</claim-ref>, wherein the one or more behaviors include an attempt to append data to the file.</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353043-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353043</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12057457</doc-number>
<date>20080328</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>KR</country>
<doc-number>10-2007-0104113</doc-number>
<date>20071016</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>1293</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>11</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 25</main-classification>
<further-classification>726 22</further-classification>
<further-classification>726 23</further-classification>
<further-classification>726 24</further-classification>
</classification-national>
<invention-title id="d2e71">Web firewall and method for automatically checking web server for vulnerabilities</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6721721</doc-number>
<kind>B1</kind>
<name>Bates et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>  1  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7779469</doc-number>
<kind>B2</kind>
<name>Hopen et al.</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7926113</doc-number>
<kind>B1</kind>
<name>Gula et al.</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 25</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0056116</doc-number>
<kind>A1</kind>
<name>Bunker et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0193430</doc-number>
<kind>A1</kind>
<name>Cohen et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 25</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2006/0085852</doc-number>
<kind>A1</kind>
<name>Sima</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2007/0061877</doc-number>
<kind>A1</kind>
<name>Sima et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 12</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2007/0283441</doc-number>
<kind>A1</kind>
<name>Cole et al.</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 25</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2008/0092237</doc-number>
<kind>A1</kind>
<name>Yoon et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 25</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2009/0271863</doc-number>
<kind>A1</kind>
<name>Govindavajhala et al.</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 23</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>KR</country>
<doc-number>1020050075950</doc-number>
<kind>A</kind>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>KR</country>
<doc-number>100655492</doc-number>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Su Yong Kim, et al; &#x201c;Design of Vulnerability Scanner Using Email&#x201d;, WISC 2004, pp. 504-511 (2004).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>13</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 22- 25</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713189-194</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>3</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090100522</doc-number>
<kind>A1</kind>
<date>20090416</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Kim</last-name>
<first-name>Min Sik</first-name>
<address>
<city>Daejeon</city>
<country>KR</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>KR</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Park</last-name>
<first-name>Jung Gil</first-name>
<address>
<city>Daejeon</city>
<country>KR</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>KR</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Ladas &#x26; Parry LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Electronics and Telecommunications Research Institute</orgname>
<role>03</role>
<address>
<city>Daejeon</city>
<country>KR</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Zee</last-name>
<first-name>Edward</first-name>
<department>2495</department>
</primary-examiner>
<assistant-examiner>
<last-name>Debnath</last-name>
<first-name>Suman</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Provided is a web firewall for automatically checking for vulnerabilities, including: an administrating server scheduling part for ordering the examination of an administrating web server according to a predetermined examination schedule; a vulnerability search database calling part for calling a vulnerability search database previously stored according to the order of the administrating server scheduling part; a vulnerability searching part for searching for potential vulnerabilities of the administrating web server corresponding to data included in the called vulnerability search database; a vulnerability information deducing part for optimizing the results searched in the vulnerability searching part to deduce vulnerability information; a vulnerability checking part for checking the vulnerabilities of the administrating web server based on the results deduced from the vulnerability information deducing part; and a detailed vulnerability information reporting part for reporting detailed information on the checked vulnerabilities.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="100.67mm" wi="154.69mm" file="US08353043-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="172.04mm" wi="167.30mm" file="US08353043-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="219.03mm" wi="173.06mm" file="US08353043-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="204.64mm" wi="163.32mm" file="US08353043-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application claims priority to and the benefit of Korean Patent Application No. 2007-0104113, filed Oct. 16, 2007, the disclosure of which is incorporated herein by reference in its entirety.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">The present invention relates to a web firewall and method for automatically checking a web server for vulnerabilities, and more particularly, to a web firewall and method for automatically checking a web server for vulnerabilities according to a predetermined time schedule.</p>
<p id="p-0005" num="0004">2. Discussion of Related Art</p>
<p id="p-0006" num="0005">With the development of Internet technology, vulnerabilities of application programs have become a serious problem, and despite efforts made to prevent such vulnerabilities through inspection, violation of web servers is increasing.</p>
<p id="p-0007" num="0006">Particularly, since many web servers are still very vulnerable to violation due to inappropriate management, they have to be checked regularly and any weaknesses found must be eliminated to prevent future violation. However, web servers with large-scale domains or frequently changing web contents are very difficult to manage.</p>
<p id="p-0008" num="0007">Therefore, to solve these problems, a method of checking for vulnerabilities and providing the latest detailed information quickly and easily is required.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0009" num="0008">The present invention is directed to a web firewall and method for automatically checking a web server for vulnerabilities.</p>
<p id="p-0010" num="0009">The present invention is also directed to a web firewall and method for automatically checking a web server for vulnerabilities by setting an automatic schedule on a web firewall, automatically checking administrating web servers for vulnerabilities in consideration of their availability, and automatically reporting the results to an administrator.</p>
<p id="p-0011" num="0010">One aspect of the present invention provides a web firewall for automatically checking for vulnerabilities, including: an administrating server scheduling part for ordering the examination of an administrating web server according to a predetermined examination schedule; a vulnerability search database calling part for calling a vulnerability search database previously stored according to the order of the administrating server scheduling part; a vulnerability searching part for searching for potential vulnerabilities of the administrating web server corresponding to data included in the called vulnerability search database; a vulnerability information deducing part for optimizing the results searched in the vulnerability searching part to deduce vulnerability information; a vulnerability checking part for checking the vulnerabilities of the administrating web server based on the results deduced from the vulnerability information deducing part; and a detailed vulnerability information reporting part for reporting detailed information on the checked vulnerabilities.</p>
<p id="p-0012" num="0011">In an exemplary embodiment, the administrating server scheduling part may receive a vulnerability examination scheduling order from an external administrating server. A vulnerability search database may be further included to store vulnerability data of the administrating web server. The vulnerability search database may be regularly updated by an external administrator or via the Internet.</p>
<p id="p-0013" num="0012">Also, the vulnerability searching part may search for potential vulnerabilities of the administrating web server using at least one external search engine. The vulnerability information deducing part may collect information deduced from the at least one search engine and optimize the results. The detailed vulnerability information reporting part may be transmitted to an external administrating server.</p>
<p id="p-0014" num="0013">The vulnerability checking part may search for potential vulnerabilities which can allow abnormal access to the administrating web server, interrupt normal service of the administrating web server, or leak, modulate or delete data of the administrating web server. The data included in the vulnerability search database may include a list of vulnerabilities that can be searched by an external search engine.</p>
<p id="p-0015" num="0014">Another aspect of the present invention provides a method of automatically checking for vulnerabilities using a web firewall, including the steps of: setting a time schedule for checking administrating web server vulnerabilities corresponding to a predetermined examination schedule; confirming a time corresponding to the set schedule and measuring available system resources when the set time has arrived; calling a vulnerability search database when the system resources exceed a predetermined standard value; searching for potential vulnerabilities of the administrating web server corresponding to data extracted from the called vulnerability search database; optimizing the results of the potential vulnerability search; checking the vulnerabilities of the administrating web server corresponding to the optimized results; and making a detailed report on the results of the vulnerability check of the administrating web server.</p>
<p id="p-0016" num="0015">In an exemplary embodiment, the vulnerability examination schedule may be determined corresponding to a vulnerability examination schedule received from an external administrating server. The potential vulnerabilities of the administrating web server may be searched using at least one search engine.</p>
<p id="p-0017" num="0016">Further, the step of searching for potential vulnerabilities of the administrating web server may be performed by searching for potential vulnerabilities that can allow abnormal access to the administrating web server, interrupt normal service of the administrating web server, or leak, modulate or delete data of the administrating web server.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0018" num="0017">The above and other objects, features and advantages of the present invention will become more apparent to those of ordinary skill in the art by describing in detail exemplary embodiments thereof with reference to the attached drawings in which:</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 1</figref> is an overall diagram illustrating a configuration of a web firewall for automatically checking for vulnerabilities and an environment to which the firewall is applied according to an exemplary embodiment of the present invention;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram illustrating an operation method of a web firewall for automatically checking for vulnerabilities according to an exemplary embodiment of the present invention;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram illustrating a detailed configuration of a web firewall for automatically checking for vulnerabilities according to an exemplary embodiment of the present invention; and</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram illustrating a method of checking for vulnerabilities using a web firewall for automatically checking for vulnerabilities according to an exemplary embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF EXEMPLARY EMBODIMENTS</heading>
<p id="p-0023" num="0022">The foregoing and other objects, features and advantages of the invention will be apparent from the following more particular description of exemplary embodiments of the invention, as illustrated in the accompanying drawings.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 1</figref> is an overall diagram illustrating a configuration of a web firewall for automatically checking for vulnerabilities and an environment to which the firewall is applied.</p>
<p id="p-0025" num="0024">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, a web firewall <b>101</b> for automatically checking for vulnerabilities includes a firewall engine <b>111</b> and an automatic vulnerability searching part <b>113</b>. The web firewall <b>101</b> according to the present invention serves to prevent various kinds of violation on an administrating web server <b>105</b> by monitoring abnormal data, harmful codes and spy-ware included in Internet data <b>100</b> input from an external Internet environment when the Internet data is transmitted to the administrating web servers <b>105</b> that the web firewall manages.</p>
<p id="p-0026" num="0025">A conventional web firewall includes a web firewall engine to prevent violation on a web server, but security vulnerabilities of the web server have to be manually checked regularly through an administrator's computer.</p>
<p id="p-0027" num="0026">However, in the present invention, since the firewall <b>101</b> has the automatic vulnerability searching part <b>113</b>, the administrator does not need to regularly check for vulnerabilities of the web server <b>105</b> manually. When the administrator orders a vulnerability search schedule through the administrator's computer <b>107</b>, the automatic vulnerability searching part <b>113</b> automatically searches for vulnerabilities of the web server <b>105</b> regularly managed according to the vulnerability searching schedule, and reports the results. Particularly, the automatic vulnerability searching part <b>113</b> reduces resources used by the firewall and executes an exact search by using several external search engines <b>103</b> when searching for vulnerabilities.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram illustrating an operation method of a web firewall for automatically checking for vulnerabilities.</p>
<p id="p-0029" num="0028">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, in order to check for security vulnerabilities of a web server <b>205</b> managed by a web firewall <b>203</b> according to the present invention, which monitors data <b>201</b> transmitted to the web server <b>205</b> from the Internet, an administrating server <b>205</b> transmits a schedule <b>211</b> for checking for vulnerabilities of the web server <b>205</b> to the web firewall.</p>
<p id="p-0030" num="0029">Then, the web firewall <b>203</b> automatically checks for vulnerabilities using a vulnerability search database included in the web firewall <b>203</b> at predetermined times according to the schedule <b>211</b> transmitted to the administrating server (<b>213</b>).</p>
<p id="p-0031" num="0030">Subsequently, a detailed report on the results checked in the web firewall <b>203</b> is made and reported to the administrating server (<b>215</b>).</p>
<p id="p-0032" num="0031">In this case, the web firewall administrator can regularly check for vulnerabilities of the administrating web server without extra effort, thereby reducing effort and cost.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram illustrating a detailed configuration of a web firewall for automatically checking for vulnerabilities according to an exemplary embodiment of the present invention.</p>
<p id="p-0034" num="0033">Referring to <figref idref="DRAWINGS">FIG. 3</figref>, the web firewall for automatically checking for vulnerabilities according to the present invention includes a firewall engine <b>301</b>, an automatic vulnerability searching part <b>303</b> which may include an administrating server scheduling part <b>311</b>, a vulnerability information deducing part <b>313</b>, a vulnerability checking part <b>315</b>, a detailed vulnerability information reporting part <b>317</b>, a vulnerability search database calling part <b>319</b> and a vulnerability searching part <b>321</b>.</p>
<p id="p-0035" num="0034">The firewall engine <b>301</b> prevents various kinds of violation of a web server managed by the firewall by monitoring abnormal data, harmful codes and spy-ware included in the Internet data <b>100</b> when it is transmitted to several administrating web servers <b>105</b> that the web firewall manages. This is not different from a conventional firewall.</p>
<p id="p-0036" num="0035">The automatic vulnerability searching part <b>303</b> is the most critical part of the present invention. It searches for vulnerabilities of the web server automatically managed in response to a vulnerability search scheduling order transmitted from an external administrating server, and reports the search results.</p>
<p id="p-0037" num="0036">The administrating server scheduling part <b>311</b> in the automatic vulnerability searching part <b>303</b> receives and analyzes the vulnerability search scheduling order received from the external administrating server, thereby ordering the start of automatic checking for vulnerabilities of the web server regularly managed according to the scheduling order or in response to a scheduling order event.</p>
<p id="p-0038" num="0037">The vulnerability search database calling part <b>319</b> serves to call a database for searching vulnerabilities of the administrating server included in the firewall to examine the vulnerabilities by receiving the order from the administrating server scheduling part <b>311</b>. Here, data included in a vulnerability database is a list of vulnerabilities that can be searched by an external search engine among common web server vulnerabilities. The data may include vulnerability items included in web applications, administrator's input windows, administrator addresses and contents of the administrating web server, or a list of web pages which should not be open to the public.</p>
<p id="p-0039" num="0038">The vulnerability searching part <b>321</b> searches for potential vulnerabilities in the administrating web server based on information related to the vulnerabilities called by the vulnerability search database calling part <b>319</b>. It may search for potential vulnerabilities which can allow abnormal approach to the administrating web server, interrupt normal service of the administrating web server, or leak, modulate or delete data of the administrating web server. Such searches may be performed inside the web firewall of the present invention or using several external search servers. When using external search servers, the search can be performed without occupying excessive web server resources.</p>
<p id="p-0040" num="0039">The vulnerability information deducing part <b>313</b> collects information on potential vulnerabilities checked in the vulnerability searching part <b>321</b> and optimizes the information to yield the greatest vulnerabilities through logical operations. That is, based on the results deduced from several external search engines, actual vulnerabilities can be deduced.</p>
<p id="p-0041" num="0040">The vulnerability checking part <b>315</b> checks for vulnerabilities of the administrating web server based on the vulnerability information deduced from the vulnerability information deducing part <b>313</b>. From the administrating web server, these checks are performed by extracting serious vulnerabilities such as system, network and application security vulnerabilities.</p>
<p id="p-0042" num="0041">The detailed vulnerability information reporting part <b>317</b> serves to write detailed results on the items actually checked in the vulnerability checking part <b>315</b> and then transmit the detailed results to the administrating server.</p>
<p id="p-0043" num="0042">Such a module is applied to the web firewall in the exemplary embodiment, but can be added to a network device such as a router or gateway.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram illustrating a method of checking for vulnerabilities using a web firewall for automatically checking for vulnerabilities according to an exemplary embodiment of the present invention.</p>
<p id="p-0045" num="0044">Referring to <figref idref="DRAWINGS">FIG. 4</figref>, according to a time scheduling order predetermined by an external administrating server, a schedule is set in an administrating server scheduling part (S<b>401</b>). Then, the administrating server scheduling part verifies if a predetermined time corresponding to the predetermined time schedule has arrived (S<b>403</b>), and if the time has arrived, measures system resources (S<b>405</b>).</p>
<p id="p-0046" num="0045">This measurement of system resources is performed to enable examination of vulnerabilities when system resources of the web firewall are largely available, since the firewall of the present invention occupies system resources when examining web server vulnerabilities.</p>
<p id="p-0047" num="0046">When the measured system resources exceed a standard value (S<b>407</b>), a vulnerability search database is called to search for vulnerabilities (S<b>409</b>). The vulnerability search database is a database included in the firewall according to the present invention, and includes information for searching for vulnerabilities of the web server.</p>
<p id="p-0048" num="0047">When information is acquired from the vulnerability search database, potential vulnerabilities of the administrating web server are examined by the vulnerability searching part. In this embodiment, the potential vulnerabilities are examined using several external search engines (S<b>411</b>), but they can be examined using a different method.</p>
<p id="p-0049" num="0048">Further, vulnerabilities not easily detected by the external search engines may be searched for using a different method, for example, by using a conventional vulnerability searching program. Such a method involves searching for vulnerabilities not easily detected by the external search servers by examining whether or not a network port prohibited to the administrating web server is open (S<b>421</b>).</p>
<p id="p-0050" num="0049">After that, any vulnerabilities of the web server are collected and calculated to optimize the searched results (S<b>413</b>). In the results, the most potential vulnerabilities are determined, and the optimized vulnerabilities in the administrating web server are deduced.</p>
<p id="p-0051" num="0050">Then, the vulnerabilities of the administrating web server are actually checked (S<b>415</b>). If the vulnerabilities exist (S<b>417</b>), a detailed report on the vulnerabilities is written and transmitted to the administrating server (S<b>419</b>).</p>
<p id="p-0052" num="0051">As the vulnerabilities of the administrating web server in such a method are automatically checked according to the time schedule, a web firewall administrator may avoid the time, effort and cost of checking administrating web servers one by one according to updates on security vulnerability, which are complicated and varied.</p>
<p id="p-0053" num="0052">The present invention can provide a web firewall and method for automatically checking for vulnerabilities.</p>
<p id="p-0054" num="0053">The present invention can also provide a web firewall and method for automatically checking for vulnerabilities by setting an automatic schedule, automatically checking for vulnerabilities in administrating web servers in consideration of resource availability, and reporting the results to an administrator.</p>
<p id="p-0055" num="0054">While the invention has been shown and described with reference to certain exemplary embodiments thereof, it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the invention as defined by the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An administrating web server including a web firewall for automatically checking for vulnerabilities, comprising:
<claim-text>a processor;</claim-text>
<claim-text>an administrating server scheduling part for ordering the examination of the administrating web server according to a predetermined examination schedule;</claim-text>
<claim-text>a vulnerability search database calling part for calling a vulnerability search database previously stored according to the order of the administrating server scheduling part,</claim-text>
<claim-text>wherein the called vulnerability search database comprises a list of vulnerabilities included in the web firewall from internet data transmitted thought the web firewall to the web servers, and</claim-text>
<claim-text>wherein the list of vulnerabilities are generated prior to the ordered examination of the administrating web server according to the predetermined examination schedule;</claim-text>
<claim-text>a vulnerability searching part for searching for potential vulnerabilities of the administrating web server corresponding to data included in the called vulnerability search database, wherein the vulnerability searching part searches for potential vulnerabilities of the administrating web server using at least one external search engine, and</claim-text>
<claim-text>wherein the at least one external search engine searches for the potential vulnerabilities from the list of vulnerabilities included in the web firewall;</claim-text>
<claim-text>a vulnerability information deducing part for optimizing the results searched in the vulnerability searching part to deduce vulnerability information;</claim-text>
<claim-text>a vulnerability checking part for checking the vulnerabilities of the administrating web server based on the results deduced from the vulnerability information deducing part; and</claim-text>
<claim-text>a detailed vulnerability information reporting part for reporting detailed information on the checked vulnerabilities.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The administrating web server according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the administrating server scheduling part receives a vulnerability examination scheduling order from an external administrating server.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The administrating web server according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a vulnerability search database for storing data on vulnerabilities of the administrating web server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The administrating web server according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the vulnerability search database is regularly updated by an external administrator or via the Internet.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The administrating web server according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the vulnerability information deducing part collects information deduced from the at least one search engine and optimizes the results.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The administrating web server according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the detailed vulnerability information reporting part is transmitted to an external administrating server.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The administrating web server according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the vulnerability checking part searches for potential vulnerabilities which can allow abnormal access to the administrating web server, interrupt normal service of the administrating web server, or leak, modulate or delete data of the administrating web server.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The administrating web server according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the data included in the vulnerability search database comprises a list of vulnerabilities that can be searched by an external search engine.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A method of automatically checking for vulnerabilities using a web firewall for automatically checking for vulnerabilities, comprising the steps of:
<claim-text>setting a time schedule for checking administrating web server vulnerabilities corresponding to a predetermined examination schedule;</claim-text>
<claim-text>confirming a time corresponding to the set schedule and measuring available system resources when the set time has arrived;</claim-text>
<claim-text>calling a vulnerability search database when the system resources exceed a predetermined standard value, and</claim-text>
<claim-text>wherein the called vulnerability search database comprises a list of vulnerabilities include in the web firewall from internet data transmitted thought the web firewall;</claim-text>
<claim-text>searching for potential vulnerabilities of the administrating web server corresponding to data extracted from the called vulnerability search database, wherein the potential vulnerabilities of the administrating web server are searched using at least one external search engine, and</claim-text>
<claim-text>wherein the at least one external search engine searches for the potential vulnerabilities from the list of vulnerabilities included in the web firewall;</claim-text>
<claim-text>optimizing the results of the potential vulnerability search;</claim-text>
<claim-text>checking the vulnerabilities of the administrating web server corresponding to the optimized results; and</claim-text>
<claim-text>making a detailed report on the results of the vulnerability check of the administrating web server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the vulnerability examination schedule is determined corresponding to a vulnerability examination schedule received from an external administrating server.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the step of searching for potential vulnerabilities of the administrating web server is performed by searching for potential vulnerabilities that can allow abnormal access to the administrating web server, interrupt normal service of the administrating web server, or leak, modulate or delete data of the administrating web server.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the data included in the vulnerability search database comprises a list of vulnerabilities that can be searched by an external search engine.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. An administrating web server including a web firewall for automatically checking for vulnerabilities in a web server, comprising:
<claim-text>a processor;</claim-text>
<claim-text>an administrating server scheduling part for ordering the examination of the administrating web server according to a predetermined examination schedule;</claim-text>
<claim-text>a vulnerability search database calling part for calling a vulnerability search database previously stored according to the order of the administrating server scheduling part,</claim-text>
<claim-text>wherein the called vulnerability search database comprises a list of vulnerabilities included in a web firewall from internet data transmitted thought the web firewall to the web server, and</claim-text>
<claim-text>wherein the list of vulnerabilities are generated prior to using at least one external search engine to search for at least one or more of the vulnerabilities from the list of vulnerabilities;</claim-text>
<claim-text>a vulnerability searching part for searching for potential vulnerabilities of the administrating web server corresponding to data included in the called vulnerability search database, wherein the vulnerability searching part searches for potential vulnerabilities of the administrating web server using at least one external search engine, and the vulnerability searching part searches for potential vulnerabilities by examining whether a network port prohibited to the administrating web server is open;</claim-text>
<claim-text>a vulnerability information deducing part for optimizing the results searched in the vulnerability searching part to deduce vulnerability information;</claim-text>
<claim-text>a vulnerability checking part for checking the vulnerabilities of the administrating web server based on the results deduced from the vulnerability information deducing part; and</claim-text>
<claim-text>a detailed vulnerability information reporting part for reporting detailed information on the checked vulnerabilities. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353044-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353044</doc-number>
<kind>B1</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12147744</doc-number>
<date>20080627</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1092</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 25</main-classification>
<further-classification>726  1</further-classification>
<further-classification>718  1</further-classification>
</classification-national>
<invention-title id="d2e53">Methods and systems for computing device remediation</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7117495</doc-number>
<kind>B2</kind>
<name>Blaser et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7162724</doc-number>
<kind>B2</kind>
<name>Blaser et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7165260</doc-number>
<kind>B2</kind>
<name>Blaser et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7461086</doc-number>
<kind>B1</kind>
<name>Hurren et al.</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7461096</doc-number>
<kind>B1</kind>
<name>Hurren et al.</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7512977</doc-number>
<kind>B2</kind>
<name>Cook et al.</name>
<date>20090300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7519963</doc-number>
<kind>B1</kind>
<name>Blaser et al.</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7542988</doc-number>
<kind>B1</kind>
<name>Cook et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7549164</doc-number>
<kind>B2</kind>
<name>Cook et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7620956</doc-number>
<kind>B2</kind>
<name>Cook et al.</name>
<date>20091100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7877413</doc-number>
<kind>B1</kind>
<name>Cook et al.</name>
<date>20110100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>7886291</doc-number>
<kind>B1</kind>
<name>Jones et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7945897</doc-number>
<kind>B1</kind>
<name>Cook</name>
<date>20110500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>7970789</doc-number>
<kind>B1</kind>
<name>Blaser et al.</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>8010961</doc-number>
<kind>B1</kind>
<name>Cook et al.</name>
<date>20110800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>8112767</doc-number>
<kind>B1</kind>
<name>Cook</name>
<date>20120200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2003/0177389</doc-number>
<kind>A1</kind>
<name>Albert et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2006/0036570</doc-number>
<kind>A1</kind>
<name>Schaefer et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2006/0075140</doc-number>
<kind>A1</kind>
<name>Sobel et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709245</main-classification></classification-national>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2006/0179476</doc-number>
<kind>A1</kind>
<name>Challener et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  4</main-classification></classification-national>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2008/0281884</doc-number>
<kind>A1</kind>
<name>Subrahmanyam</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707205</main-classification></classification-national>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2009/0089815</doc-number>
<kind>A1</kind>
<name>Manczak et al.</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>719327</main-classification></classification-national>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2009/0094673</doc-number>
<kind>A1</kind>
<name>Seguin et al.</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  1</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00024">
<othercit>Jansen et. al. &#x201c;Policy Enforcement and Compliance Proofs for Xen Virtual Machines&#x201d; Mar. 7, 2008, VEE '08 Proceedings of the fourth ACM SIGPLAN/SIGOPS international conference on Virtual execution environments, pp. 101-110.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00025">
<othercit>Jared Blaser; Process Tracking Application Layered System; U.S. Appl. No. 11/324,571, filed Jan. 3, 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00026">
<othercit>Jeremy Hurren; Feature Based Software Virtualization; U.S. Appl. No. 11/960,706, filed Dec. 20, 2007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00027">
<othercit>Randall Cook; Automatic Virtualization Based on User-Defined Criteria; U.S. Appl. No. 12/024,079, filed Jan. 31, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726  1</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 25</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>718  1</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Jones</last-name>
<first-name>Howard</first-name>
<address>
<city>Provo</city>
<state>UT</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Unbedacht</last-name>
<first-name>Kevin</first-name>
<address>
<city>Orem</city>
<state>UT</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Cook</last-name>
<first-name>Randall R.</first-name>
<address>
<city>Springville</city>
<state>UT</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Advantedge Law Group</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Symantec Corporation</orgname>
<role>02</role>
<address>
<city>Mountain View</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Zand</last-name>
<first-name>Kambiz</first-name>
<department>2434</department>
</primary-examiner>
<assistant-examiner>
<last-name>Guirguis</last-name>
<first-name>Michael</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A computer-implemented method for remediation of a computing device attempting to access a network. The method may include detecting that the computing device is attempting to access the network. The method may also include determining that the computing device does not comply with a network-access-control policy of the network. The method may include using a virtualization layer to bring the computing device into compliance with the network-access-control policy. The method may include permitting the computing device to access the network after the computing device is brought into compliance with the network-access-control policy. Various other methods, systems, and computer-readable media are also disclosed.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="224.28mm" wi="173.48mm" file="US08353044-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="208.53mm" wi="169.67mm" orientation="landscape" file="US08353044-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="158.58mm" wi="159.60mm" file="US08353044-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="239.52mm" wi="162.98mm" file="US08353044-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="244.94mm" wi="172.38mm" file="US08353044-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="220.64mm" wi="190.58mm" file="US08353044-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="193.29mm" wi="187.20mm" file="US08353044-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="226.40mm" wi="189.23mm" file="US08353044-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="213.53mm" wi="189.57mm" file="US08353044-20130108-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="237.15mm" wi="183.90mm" orientation="landscape" file="US08353044-20130108-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="212.85mm" wi="195.66mm" orientation="landscape" file="US08353044-20130108-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCES TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is related to U.S. Pat. No. 7,162,724 filed 11 Jun. 2003 and titled &#x201c;Layered Computing Systems and Methods,&#x201d; U.S. Pat. No. 7,117,495 filed 11 Jun. 2003 and titled &#x201c;Systems and Methods for the Creation of Software Packages Using Layered Systems,&#x201d; U.S. Pat. No. 7,165,260 filed 11 Jun. 2003 and titled &#x201c;Layered Computing Systems and Methods for Insecure Environments,&#x201d; U.S. patent application Ser. No. 12/057,919 filed 28 Mar. 2008 and titled &#x201c;Methods and Systems for Inserting Software Applications into Images,&#x201d; and U.S. patent application Ser. No. 10/683,564 filed on 10 Oct. 2003 and titled &#x201c;Method and System for Scanning Network Devices,&#x201d; the disclosures of each of which are incorporated, in their entirety, by this reference.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">The managed state of an organization's individual endpoints may play a critical role in the overall security and availability of its IT infrastructure and related business operations. A new wave of sophisticated crimeware not only targets specific companies, but it also targets desktops and laptops as backdoor entryways into those enterprises' business operations and valuable resources. To safeguard themselves against these targeted threats, organizations may attempt to ensure that each endpoint continually complies with corporate security and configuration management policies. Failure to guarantee endpoint policy compliance may leave organizations vulnerable to a wide array of threats, including the proliferation of malicious code throughout the enterprise, disruption of business-critical servers, increased IT recovery and management costs, exposure of confidential information, damage to corporate brand, and regulatory fines due to non-compliance.</p>
<p id="p-0004" num="0003">Network access control may enable organizations to ensure the proper configuration and security state of user endpoints&#x2014;including those of onsite employees, remote employees, guests, contractors, and temporary workers&#x2014;before they are allowed to access resources on the corporate network. Some network access control solutions may discover and evaluate endpoint compliance status, provision the appropriate network access, and provide remediation capabilities to ensure that endpoint security policies and standards are met.</p>
<p id="p-0005" num="0004">Common remediation tasks may include installing security software, installing updates, and changing security settings on an endpoint computer. When the computer belongs to the organization that owns the data network, performing remediation on the computer typically does not give rise to ownership and/or legal issues. However, when the computer is the property of someone else (e.g., a business partner or customer), installing, updating, or modifying software may conflict with the foreign computer owner's own security policies and may expose the organization making the changes to legal liability. Thus, traditional remediation technologies may not be ideal for remediation of foreign devices (and other devices) attempting to connect to a network.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0006" num="0005">Embodiments of the instant disclosure may remediate computing devices attempting to access a network by using virtualization technology. Performing endpoint remediation in a virtualization layer may address one or more of the problems with traditional endpoint remediation technologies. In some embodiments, a security module on a network-access-control device may detect that a computing device is attempting to access a network. The security module may determine that the computing device does not comply with a network-access-control policy of the network. The security module may use a virtualization layer to bring the computing device into compliance with the network-access-control policy.</p>
<p id="p-0007" num="0006">For example, if the network-access-control policy requires a first security software program to be installed on the computing device, the security module may create a virtualization layer and install the security software on the virtualization layer. In some embodiments, the security module may use a virtualization layer to change a security setting of a security software program on the computing device. The security module may also use a virtualization layer to update a security software program on the computing device. Once the computing device is brought into compliance with endpoint security policies, the security module may permit the computing device to access the network.</p>
<p id="p-0008" num="0007">In various embodiments, the computing device may not support virtualization. In such embodiments, the security module may install virtualization software on the computing device in order to enable the use of a virtualization layer for remediation of the computing device. In other embodiments, the computing device may already support virtualization.</p>
<p id="p-0009" num="0008">According to certain embodiments, the security module may undo changes to the computing device when the computing device is no longer required to comply with the network-access-control policy (e.g., when the computing device disconnects from the network). For example, the security software may remove an update to a security software program, undo a change to the security setting, and/or remove security software from the computing device by disabling and/or removing the virtualization layer.</p>
<p id="p-0010" num="0009">The virtualization layer may be a software-virtualization-solution layer, such as a layer created by SYMANTEC's SOFTWARE VIRTUALIZATION SOLUTION (SVS). In some embodiments, the virtualization layer may be managed by a virtualization agent running on a virtualization-enabled microprocessor on the computing device. In other embodiments, the computing device may comprise a hard-drive cache (e.g., INTEL's TURBO MEMORY), and the virtualization layer may reside on the hard-drive cache.</p>
<p id="p-0011" num="0010">Features from any of the above-mentioned embodiments may be used in combination with one another in accordance with the general principles described herein. These and other embodiments, features, and advantages will be more fully understood upon reading the following detailed description in conjunction with the accompanying drawings and claims.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0012" num="0011">The accompanying drawings illustrate a number of exemplary embodiments and are a part of the specification. Together with the following description, these drawings demonstrate and explain various principles of the instant disclosure.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an exemplary network according to certain embodiments.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of an exemplary network-access-control device according to certain embodiments.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 3</figref> is a flow diagram of an exemplary method for remediating a computing device according to certain embodiments.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 4</figref> is a flow diagram of another exemplary method for remediating computing devices according to certain embodiments.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of exemplary components of a virtualization system on a computing device at a conceptual level according to certain embodiments.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram of an exemplary operation of a virtualization system according to certain embodiments.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of a computing system that supports virtualization according to certain embodiments.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram of the organization of an exemplary computing system with virtualization according to certain embodiments.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram of an exemplary computing system capable of implementing one or more of the embodiments described and/or illustrated herein.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram of an exemplary computing network capable of implementing one or more of the embodiments described and/or illustrated herein.</p>
<p id="p-0023" num="0022">Throughout the drawings, identical reference characters and descriptions indicate similar, but not necessarily identical, elements. While the exemplary embodiments described herein are susceptible to various modifications and alternative forms, specific embodiments have been shown by way of example in the drawings and will be described in detail herein. However, the exemplary embodiments described herein are not intended to be limited to the particular forms disclosed. Rather, the instant disclosure covers all modifications, equivalents, and alternatives falling within the scope of the appended claims.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0024" num="0023">The following is intended to provide a detailed description of various embodiments and should not be taken to be limiting in any way. Various exemplary methods and systems for remediation of a computing device are disclosed herein. In some embodiments, a security software module may use a virtualization layer to bring the computing device into compliance with a network-access-control policy. The security module may prevent the computing device from accessing the network until after the computing device is brought into compliance with the network-access-control policy. After the computing device is brought into compliance with the network-access-control policy, the security module may permit the computing device to access the network.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 1</figref> shows an exemplary network with a network-access-control device capable of implementing embodiments of the instant disclosure. <figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of the network-access-control device illustrated in <figref idref="DRAWINGS">FIG. 1</figref>. <figref idref="DRAWINGS">FIGS. 3 and 4</figref> are flow diagrams of exemplary methods for remediation of computing devices according to certain embodiments. <figref idref="DRAWINGS">FIGS. 5-8</figref> provide an overview of how various embodiments of virtualization technology may be implemented on a computing system. Finally, <figref idref="DRAWINGS">FIGS. 9 and 10</figref> show an exemplary computing system and network capable of implementing embodiments disclosed herein.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 1</figref> shows a network <b>5</b> with computing devices <b>12</b>, <b>14</b>, and <b>16</b>. Network <b>5</b> also includes a network-access-control device <b>20</b> and a server <b>18</b>. Computing device <b>16</b>, server <b>18</b>, computing device <b>14</b>, and network-access-control device <b>20</b> may communicate through network <b>10</b>. Network <b>10</b> may be the Internet, a wide area network, a local area network, a storage area network, or any other suitable network or network configuration. For example, network <b>10</b> may be a data network of an enterprise, and computing device <b>14</b>, computing device <b>16</b>, and server <b>18</b> may be enterprise resources that are permanently connected to network <b>10</b>.</p>
<p id="p-0027" num="0026">Computing device <b>12</b> may be a foreign computing device (e.g., a device that is not owned or controlled by the enterprise that controls network <b>10</b>). Computing device <b>12</b> may attempt to access network <b>10</b> through an access point, such as network-access-control device <b>20</b>. Computing device <b>12</b> may be a desktop computer, a laptop computer, a hand-held computer, or any other suitable computing device. Network-access-control device <b>20</b> may detect that computing device <b>12</b> is attempting to access network <b>10</b>. Network-access-control device <b>20</b> may scan computing device <b>12</b> to determine whether computing device <b>12</b> complies with network-access-control policies of network <b>10</b>.</p>
<p id="p-0028" num="0027">In some embodiments, network-access-control device <b>20</b> may scan computing device <b>12</b> by using a remote scanning technique, such as the one of the remote scanning techniques described in U.S. patent application Ser. No. 10/683,564. Network-access-control device <b>20</b> may also implement various other technologies to determine whether computing device <b>12</b> complies with network-access-control policies of network <b>10</b>. If computing device <b>12</b> complies with the network-access-control policies of network <b>10</b>, network-access-control device <b>20</b> may allow computing device <b>12</b> to access one or more resources on network <b>10</b>. However, if computing device <b>12</b> does not comply with the network-access-control policies of network <b>10</b>, network-access-control device <b>20</b> may prevent computing device <b>12</b> from accessing network <b>10</b> and may attempt to remediate computing device <b>12</b>.</p>
<p id="p-0029" num="0028">Network-access-control device <b>20</b> may use a virtualization layer to bring computing device <b>12</b> into compliance with the network-access-control policy. Software virtualization solutions may use software (e.g., file system filter drivers) to isolate applications, application data, and application settings within a segregated folder hierarchy referred to as a &#x201c;layer&#x201d; or a &#x201c;virtualization layer.&#x201d; One advantage of using virtualization for remediation is that the virtualization layer may be isolated, and when it is removed, it may leave behind no trace. Thus, remediation through virtualization may ensure that the computing device will be in a state identical to its state prior to the layer being delivered to the machine. Remediation through virtualization may be particularly useful for temporary remediation of foreign devices connecting to a network.</p>
<p id="p-0030" num="0029">To implement remediation through a virtualization layer, network-access-control device <b>20</b> may create or install a layer on computing device <b>12</b> on which the remediation may be performed. In some embodiments, network-access-control device <b>20</b> may direct virtualization software on computing device <b>12</b> to create a new virtualization layer for use in the remediation. Network-access-control device <b>20</b> may then install a security application on the layer. In other embodiments, network-access-control device <b>20</b> may create a setting on the layer that changes a setting of an application that is already on computing device <b>12</b>. In some embodiments, network-access-control device <b>20</b> may install an update for an application on the layer. Network-access-control device <b>20</b> may also perform any other suitable remediation function by using a virtualization layer.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 2</figref> shows a block diagram of network-access-control device <b>20</b>. Network-access-control device <b>20</b> may include a detection module <b>22</b>, a policy-enforcement module <b>24</b>, and a remediation interface <b>26</b>. Network-access-control device <b>20</b> may also comprise various other software and hardware components not shown in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0032" num="0031">Detection module <b>22</b> may be any module, application, or other computer-executable code capable of detecting that a computing device is attempting to access a network. Policy-enforcement module <b>24</b> may be any module, application, or other computer-executable code capable of determining that the computing device does not comply with a network-access-control policy of the network. Remediation interface <b>26</b> may be any module, application, or other computer-executable code capable of using a virtualization layer to bring the computing device into compliance with the network-access-control policy.</p>
<p id="p-0033" num="0032">Network-access-control device <b>20</b> may be a network-access-control enabled switch, a network-access-control enabled router, or any other security endpoint device of a network. Various other types of network devices may also provide all or a portion of the functionality of network-access-control device <b>20</b>. Detection module <b>22</b>, policy-enforcement module <b>24</b>, and/or remediation interface <b>26</b> may be native features of network-access-control device <b>20</b>. In other embodiments, detection module <b>22</b>, policy-enforcement module <b>24</b>, and/or interface <b>26</b> may be software solutions that can be installed on a network-access-control device or any other suitable computing device.</p>
<p id="p-0034" num="0033">In some embodiments, policy-enforcement module <b>24</b> may be programmed to prevent a computing device from accessing the network while the computing device is not in compliance with the network-access-control policy. Policy-enforcement module <b>24</b> may also be programmed to permit the computing device to access the network after the computing device is brought into compliance with the network-access-control policy.</p>
<p id="p-0035" num="0034">Remediation interface <b>26</b> may be programmed to determine whether a foreign computing device supports virtualization and may install virtualization software on the computing device if the computing device does not support virtualization. A device may support virtualization if the device has layering software and/or hardware that supports virtualization. For example, SYMANTEC's SVS software may be installed on the foreign device.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 3</figref> is a flow diagram of a method <b>30</b> for remediation of a computing device attempting to access a network. One or more of the steps in method <b>30</b> may be performed by a security software program. Such a security software program may provide the functionality of detection module <b>22</b>, policy-enforcement module <b>24</b>, and/or remediation interface <b>26</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0037" num="0036">The security software may detect that the computing device is attempting to access the network (step <b>32</b>). For example, the security software may detect that a computing device is attempting to access the network when the security software receives a request to access the network (or to access a network resource) from the computing device. The security software may determine that the computing device does not comply with a network-access-control policy of the network (step <b>34</b>). The security software may scan the computing device to determine whether the computing device complies with the network-access-control policy of the network. The security software may also query the computing device about whether the computing device complies with the network-access-control policies of the network.</p>
<p id="p-0038" num="0037">In some embodiments, the security software may determine whether the computing device complies with a single network-access-control policy of the network. In other embodiments, the security software may check whether the computing device complies with two or more network-access-control policies of the network. The security software may typically require the computing device to comply with every security policy of a network before allowing the computing device to access the network.</p>
<p id="p-0039" num="0038">Generally, a network-access-control policy may be a policy that defines the one or more requirements for accessing a network. For example, a network-access-control policy may require a particular antivirus software application (or a particular type of antivirus software application) to be installed on the computing device. The network-access-control policy may also be a policy that requires the computing device to include any other application, security patch, software plug-in, or other computer-executable code.</p>
<p id="p-0040" num="0039">In some embodiments, the network-access-control policy may be a policy that requires a security software program already on the computing device to have certain settings. For example, the network-access-control policy may require an antivirus program on the computing device to have auto-update enabled. The network-access-control policy may also require a firewall of the computing device to be set to its highest level of protection. The network-access-control policy may also require software installed on the computing device to have various other settings.</p>
<p id="p-0041" num="0040">In some embodiments, the network-access-control policy may be a policy that requires a particular update to be installed on the computing device. For example, the network-access-control policy may require that a service pack for an operating system be installed on the computing device before the computing device is allowed to access the network. The network-access-control policy may also require various other types of updates for various other software programs before allowing the computing device to access the network.</p>
<p id="p-0042" num="0041">The security software may use a virtualization layer to bring the computing device into compliance with the network-access-control policy (step <b>36</b>). For example, if the network-access-control policy requires an antivirus program to be installed on the computing device, the security module may install the anti-virus program on the virtualization layer. As part of installing the anti-virus program, the security module may also create or install the virtualization layer, or may direct the computing device to create the virtualization layer.</p>
<p id="p-0043" num="0042">When the computing device disconnects from the network, or when compliance with the network-access-control policy is no longer required for any other reason, the security module may remove the security software from the computing device. The security module may completely remove the security software from the computing device by deleting the layer created for the security software. In other embodiments, the security software may be effectively removed from the device (e.g., made inaccessible) by disabling the layer.</p>
<p id="p-0044" num="0043">In some embodiments, using the virtualization layer to bring the computing device into compliance with network policies may comprise using the virtualization layer to change a security setting of a security software program on the computing device. The security setting may be a registry setting, an option in the security software, or any other setting for the security software. The virtualization layer may provide settings for the security software that override the stored settings for the security software as long as the virtualization layer is enabled. In other words, the software application may use the settings on the virtualization layer, rather than the original underlying settings on the computing device, to govern the control of the security software. The security module may undo the change to the security setting when the computing device disconnects from the network or when the compliance with the network-access-control policy is no longer required for any other reason. In some embodiments, the compliance may be no longer be required when permanent changes, rather than virtual changes, are made to the device.</p>
<p id="p-0045" num="0044">After the computing device is brought into compliance with the network-access-control policy, the security module may permit the computing device to access the network (step <b>38</b>). The security module may allow the computing device access to the entire network, a portion of the network, a single device or resource on the network, or any other set or subset of network resources.</p>
<p id="p-0046" num="0045">In some embodiments, the virtualization layer may be managed by a virtualization agent running on a virtualization-enabled microprocessor on the computing device. The process may be executed locally by a known, secure management agent running on a virtualization-enabled chip, such as an INTEL VPRO chip. In such embodiments, the computing device may not need to have additional software installed to enable virtualization.</p>
<p id="p-0047" num="0046">In other embodiments, a computing device attempting to access a network device may have storage that may be used to contain layer data. For example, some computing devices may contain a hard drive cache, such as INTEL's TURBO MEMORY. In such embodiments, remediation data may be stored on the cache and layered over files and registry of the running operating system. Using a hard drive cache to store virtualization data may minimize the footprint of the remediation activity on the hard drive of the foreign device and may reduce the risk of unintentionally leaving behind permanent changes to the foreign device due to a failure of a remediation removal process. Using a hard drive cache to store virtualization data may also allow out-of-band distribution of virtual packages.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 4</figref> shows a computer-implemented method <b>40</b> for remediation of a computing device attempting to access a network. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, a security module may detect that the computing device is attempting to access the network (step <b>42</b>). The security module may determine that the computing device does not comply with the network-access-control policy of the network (step <b>44</b>).</p>
<p id="p-0049" num="0048">The security module may determine whether the computing device comprises virtualization technology. For example, the security module may look for a fslx.sys file system filter driver on the computing device. If the computing device is not already enabled with virtualization technology, the security module may install, or may direct the computing device to install, virtualization software on the computing device.</p>
<p id="p-0050" num="0049">The security module may create a virtualization layer on the computing device. The virtualization layer may be programmed to provide an interface between a security software application and an operating system running on the computing device. The security module may use the virtualization layer to bring the computing device into compliance with the network-access-control policy (step <b>48</b>). In some embodiments, a virtualization layer may be implemented by streaming remediation data to virtualization technology on the computing device. Such embodiments may help minimize the impact of remediation on the computing device.</p>
<p id="p-0051" num="0050">The security module may permit the computing device to access the network once the computing device is brought into compliance with the network-access-control policy (step <b>50</b>). Finally, the security module may remove the virtualization layer from the computing device when the computing device is no longer required to comply with the network policy (step <b>52</b>).</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 5</figref> shows a computing device with a virtualization layer at a conceptual level. A base operating system <b>110</b> may form a platform with which applications may be executed and from which files may be accessed in file systems. This operating system may include registry settings that may be globally available to applications for reading and writing. The computing device may include libraries <b>108</b> for executing functions of the operating system, including operating system files and registries, and other operating system functions. Layering system libraries and software <b>106</b> may be tied into libraries <b>108</b>. Layering system libraries and software <b>106</b> may interpret file system and registry accesses from applications <b>104</b>.</p>
<p id="p-0053" num="0052">Layering system software <b>106</b> may determine whether the access should be permitted to continue to the base operating system <b>110</b>, or should be redirected to layer information <b>112</b>. Layer information <b>112</b> may be the information relating to the contents of files and registry settings. Layer manager application <b>100</b> may control configuration of the layering system software <b>106</b> through a management application-programming interface (API <b>102</b>). A computing device enabled with layering technology may comprise layering a layer manager <b>100</b>, a management API <b>102</b>, and layering system libraries and software <b>106</b>. Applications <b>104</b> may be remediation software and/or settings for the computing device.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 6</figref> shows the operation of a computing system with a virtualization layer at a conceptual level. A computer system may include a base file system <b>206</b>, an application <b>200</b>, and a virtualization system comprising a layer B <b>202</b> and a layer A <b>204</b>. Layer B may have priority over layer A, which in turn may have priority over a base file system.</p>
<p id="p-0055" num="0054">In some embodiments, a computing device may already have a virtualization layer in place before network access remediation begins. For example, layer A may be a virtualization layer that stores settings for application <b>200</b>, which may be a security software program. In order to remediate the computing device, a remediation interface may change the settings on layer A. In other embodiments, an additional layer, layer B, may be created. In such embodiments, layer B may comprise the remediation data (e.g., software and settings).</p>
<p id="p-0056" num="0055">File access requests <b>208</b>, <b>210</b>, and <b>212</b> show how access to virtualization layers may be implemented. A first file access request <b>208</b> may be made by application <b>200</b>. The virtualization system may first search in layer B <b>202</b> for the requested file. Layer B <b>202</b> may include an entry for file access request <b>208</b>, and corresponding file in layer B <b>202</b> may be opened and returned to the application. Since layer B <b>202</b> has priority over layer A <b>204</b> and base file system <b>206</b>, even if layer A <b>204</b> and base file system <b>206</b> have entries that correspond to file access request <b>208</b>, the virtualization system may return the entry from layer B <b>202</b>.</p>
<p id="p-0057" num="0056">Application <b>200</b> may make another file access request <b>210</b>. The virtualization system may not find corresponding entry in layer B <b>202</b>, but may find an entry in layer A <b>204</b>. A third file access request <b>212</b> may not have a corresponding entry in layer B <b>202</b> or layer A <b>204</b>, and the virtualization system may therefore return an entry from base file system <b>206</b>.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 7</figref> shows an example of a computing device with a virtualization layer for remediation installed. The system may include an operating system <b>314</b>. Operating system <b>314</b> may comprise subsystems for handling a registry <b>316</b> and a file system subsystem <b>318</b>. The system driver <b>312</b> may be installed on operating system <b>314</b> and may have first processing priority for registry and file system accesses. A management application <b>300</b> may provide an administrator with an interface to interact with system driver <b>312</b> and make changes to layers. An API library <b>308</b> may provide a convenient interface for management application <b>300</b> to interface with system driver <b>312</b>.</p>
<p id="p-0059" num="0058">Management application <b>300</b> may provide notices to windows explorer <b>302</b> that the content of a mounted file system have been changed. Other applications <b>304</b> may interact with the system, performing read-and-write operations to the file system and registry through system driver <b>312</b>. The compression library <b>310</b> may be provided to compress layer information, especially for layer archives exported by the system.</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 8</figref> illustrates an example of virtualization layers installed on a computing device <b>402</b>. Computing device <b>402</b> may contain a number of layers <b>404</b><i>a</i>-<i>n</i>. Applications <b>406</b><i>a</i>-<i>n </i>may be installed on layers <b>404</b><i>a</i>-<i>n</i>, respectively. As referred to herein, a layer (or virtualization layer) may refer to a set of file systems and registry changes that may be managed by layering system software. In some embodiments, a layer may contain changes to one of the file systems but may not contain registry changes.</p>
<p id="p-0061" num="0060">A layer may isolate an application from a base file system and may include files in a directory structure of the applications installation. When the layer is inserted (or enabled) in an image, the application files and directories may be shadowed or overlaid on the regular operating file system. Shared libraries (such as DLLs), system accessible configurations (such as registry entries), and version control may be managed by a layering subsystem.</p>
<p id="p-0062" num="0061">Though each layer may be a separate and individual entity within an image, the application files, data, and system-accessible configuration may be presented as though they resided in their respective ordinary locations. Thus, an application stored in a layer may appear to the operating system of a deployed image as if it had been installed using traditional installation techniques.</p>
<p id="p-0063" num="0062">As previously noted, using virtualization layers for computing device remediation may have numerous advantages. For example, remediation applications inserted into a layer may be safely and completely uninstalled or removed from the image by removing the layer from the image. This provides an advantage of being able to completely remove the remediation after compliance with the network-access-control policy is no longer required.</p>
<p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram of an exemplary computing system <b>510</b> capable of implementing one or more of the embodiments described and/or illustrated herein. Computing system <b>510</b> broadly represents any single or multi-processor computing device or system capable of executing computer-readable instructions. Examples of computing system <b>510</b> include, without limitation, workstations, laptops, client-side terminals, servers, distributed computing systems, handheld devices, or any other computing system or device. In its most basic configuration, computing system <b>510</b> may comprise at least one processor <b>514</b> and system memory <b>516</b>.</p>
<p id="p-0065" num="0064">Processor <b>514</b> generally represents any type or form of processing unit capable of processing data or interpreting and executing instructions. In certain embodiments, processor <b>514</b> may receive instructions from a software application or module. These instructions may cause processor <b>514</b> to perform the functions of one or more of the exemplary embodiments described and/or illustrated herein. For example, processor <b>514</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the detecting, determining, using, permitting, installing, removing, undoing, updating, and/or creating steps described herein. Processor <b>514</b> may also perform and/or be a means for performing any other steps, methods, or processes described and/or illustrated herein.</p>
<p id="p-0066" num="0065">System memory <b>516</b> generally represents any type or form of volatile or non-volatile storage device or medium capable of storing data and/or other computer-readable instructions. Examples of system memory <b>516</b> include, without limitation, random access memory (RAM), read only memory (ROM), flash memory, or any other suitable memory device. Although not required, in certain embodiments computing system <b>510</b> may comprise both a volatile memory unit (e.g., system memory <b>516</b>) and a non-volatile storage device (e.g., primary storage device <b>532</b>, as described in detail below).</p>
<p id="p-0067" num="0066">In certain embodiments, exemplary computing system <b>510</b> may also comprise one or more components or elements in addition to processor <b>514</b> and system memory <b>516</b>. For example, as illustrated in <figref idref="DRAWINGS">FIG. 9</figref>, computing system <b>510</b> may comprise a memory controller <b>518</b>, an Input/Output (I/O) controller <b>520</b>, and a communication interface <b>522</b>, each of which may be interconnected via a communication infrastructure <b>512</b>. Communication infrastructure <b>512</b> generally represents any type or form of infrastructure capable of facilitating communication between one or more components of a computing device. Examples of communication infrastructure <b>512</b> include, without limitation, a communication bus (such as an ISA, PCI, PCIe, or similar bus) and a network.</p>
<p id="p-0068" num="0067">Memory controller <b>518</b> generally represents any type or form of device capable of handling memory or data or controlling communication between one or more components of computing system <b>510</b>. For example, in certain embodiments memory controller <b>518</b> may control communication between processor <b>514</b>, system memory <b>516</b>, and I/O controller <b>520</b> via communication infrastructure <b>512</b>. In certain embodiments, memory controller <b>518</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the steps or features described and/or illustrated herein, such as detecting, determining, using, permitting, installing, removing, undoing, updating, and/or creating.</p>
<p id="p-0069" num="0068">I/O controller <b>520</b> generally represents any type or form of module capable of coordinating and/or controlling the input and output functions of a computing device. For example, in certain embodiments I/O controller <b>520</b> may control or facilitate transfer of data between one or more elements of computing system <b>510</b>, such as processor <b>514</b>, system memory <b>516</b>, communication interface <b>522</b>, display adapter <b>526</b>, input interface <b>530</b>, and storage interface <b>534</b>. I/O controller <b>520</b> may be used, for example, to perform and/or be a means for detecting, determining, using, permitting, installing, removing, undoing, updating, and/or creating. I/O controller <b>520</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0070" num="0069">Communication interface <b>522</b> broadly represents any type or form of communication device or adapter capable of facilitating communication between exemplary computing system <b>510</b> and one or more additional devices. For example, in certain embodiments communication interface <b>522</b> may facilitate communication between computing system <b>510</b> and a private or public network comprising additional computing systems. Examples of communication interface <b>522</b> include, without limitation, a wired network interface (such as a network interface card), a wireless network interface (such as a wireless network interface card), a modem, and any other suitable interface. In at least one embodiment, communication interface <b>522</b> may provide a direct connection to a remote server via a direct link to a network, such as the Internet. Communication interface <b>522</b> may also indirectly provide such a connection through, for example, a local area network (such as an Ethernet network or a wireless IEEE 502.11 network), a personal area network (such as a BLUETOOTH or IEEE Standard 502.15.1-2002 network), a telephone or cable network, a cellular telephone connection, a satellite data connection, or any other suitable connection.</p>
<p id="p-0071" num="0070">In certain embodiments, communication interface <b>522</b> may also represent a host adapter configured to facilitate communication between computing system <b>510</b> and one or more additional network or storage devices via an external bus or communications channel. Examples of host adapters include, without limitation, SCSI host adapters, USB host adapters, IEEE 1394 host adapters, SATA and eSATA host adapters, ATA and PATA host adapters, Fibre Channel interface adapters, Ethernet adapters, or the like. Communication interface <b>522</b> may also allow computing system <b>510</b> to engage in distributed or remote computing. For example, communication interface <b>522</b> may receive instructions from a remote device or send instructions to a remote device for execution. In certain embodiments, communication interface <b>522</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the detecting, determining, using, permitting, installing, removing, undoing, updating, and/or creating steps disclosed herein. Communication interface <b>522</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0072" num="0071">As illustrated in <figref idref="DRAWINGS">FIG. 9</figref>, computing system <b>510</b> may also comprise at least one display device <b>524</b> coupled to communication infrastructure <b>512</b> via a display adapter <b>526</b>. Display device <b>524</b> generally represents any type or form of device capable of visually displaying information forwarded by display adapter <b>526</b>. Similarly, display adapter <b>526</b> generally represents any type or form of device configured to forward graphics, text, and other data from communication infrastructure <b>512</b> (or from a frame buffer, as known in the art) for display on display device <b>524</b>.</p>
<p id="p-0073" num="0072">As illustrated in <figref idref="DRAWINGS">FIG. 9</figref>, exemplary computing system <b>510</b> may also comprise at least one input device <b>528</b> coupled to communication infrastructure <b>512</b> via an input interface <b>530</b>. Input device <b>528</b> generally represents any type or form of input device capable of providing input, either computer or human generated, to exemplary computing system <b>510</b>. Examples of input device <b>528</b> include, without limitation, a keyboard, a pointing device, a speech recognition device, or any other input device. In at least one embodiment, input device <b>528</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the detecting, determining, using, permitting, installing, removing, undoing, updating, and/or creating steps disclosed herein. Input device <b>528</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0074" num="0073">As illustrated in <figref idref="DRAWINGS">FIG. 9</figref>, exemplary computing system <b>510</b> may also comprise a primary storage device <b>532</b> and a backup storage device <b>533</b> coupled to communication infrastructure <b>512</b> via a storage interface <b>534</b>. Storage devices <b>532</b> and <b>533</b> generally represent any type or form of storage device or medium capable of storing data and/or other computer-readable instructions. For example, storage devices <b>532</b> and <b>533</b> may be a magnetic disk drive (e.g., a so-called hard drive), a floppy disk drive, a magnetic tape drive, an optical disk drive, a flash drive, or the like. Storage interface <b>534</b> generally represents any type or form of interface or device for transferring data between storage devices <b>532</b> and <b>533</b> and other components of computing system <b>510</b>.</p>
<p id="p-0075" num="0074">In certain embodiments, storage devices <b>532</b> and <b>533</b> may be configured to read from and/or write to a removable storage unit configured to store computer software, data, or other computer-readable information. Examples of suitable removable storage units include, without limitation, a floppy disk, a magnetic tape, an optical disk, a flash memory device, or the like. Storage devices <b>532</b> and <b>533</b> may also comprise other similar structures or devices for allowing computer software, data, or other computer-readable instructions to be loaded into computing system <b>510</b>. For example, storage devices <b>532</b> and <b>533</b> may be configured to read and write software, data, or other computer-readable information. Storage devices <b>532</b> and <b>533</b> may also be a part of computing system <b>510</b> or may be a separate device accessed through other interface systems.</p>
<p id="p-0076" num="0075">Storage devices <b>532</b> and <b>533</b> may also be used, for example, to perform and/or be a means for performing, either alone or in combination with other elements, one or more of the detecting, determining, using, permitting, installing, removing, undoing, updating, and/or creating steps disclosed herein. Storage devices <b>532</b> and <b>533</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0077" num="0076">Many other devices or subsystems may be connected to computing system <b>510</b>. Conversely, all of the components and devices illustrated in <figref idref="DRAWINGS">FIG. 9</figref> need not be present to practice the embodiments described and/or illustrated herein. The devices and subsystems referenced above may also be interconnected in different ways from that shown in <figref idref="DRAWINGS">FIG. 9</figref>. Computing system <b>510</b> may also employ any number of software, firmware, and/or hardware configurations. For example, one or more of the exemplary embodiments disclosed herein may be encoded as a computer program (also referred to as computer software, software applications, computer-readable instructions, or computer control logic) on a computer-readable medium. The phrase &#x201c;computer-readable medium&#x201d; generally refers to any form of device, carrier, or medium capable of storing or carrying computer-readable instructions. Examples of computer-readable media include, without limitation, transmission-type media, such as carrier waves, and physical media, such as magnetic-storage media (e.g., hard disk drives and floppy disks), optical-storage media (e.g., CD- or DVD-ROMs), electronic-storage media (e.g., solid-state drives and flash media), and other distribution systems.</p>
<p id="p-0078" num="0077">The computer-readable medium containing the computer program may be loaded into computing system <b>510</b>. All or a portion of the computer program stored on the computer-readable medium may then be stored in system memory <b>516</b> and/or various portions of storage devices <b>532</b> and <b>533</b>. When executed by processor <b>514</b>, a computer program loaded into computing system <b>510</b> may cause processor <b>514</b> to perform and/or be a means for performing the functions of one or more of the exemplary embodiments described and/or illustrated herein. Additionally or alternatively, one or more of the exemplary embodiments described and/or illustrated herein may be implemented in firmware and/or hardware. For example, computing system <b>510</b> may be configured as an application specific integrated circuit (ASIC) adapted to implement one or more of the exemplary embodiments disclosed herein.</p>
<p id="p-0079" num="0078"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram of an exemplary network architecture <b>600</b> in which client systems <b>610</b>, <b>620</b>, and <b>630</b> and servers <b>640</b> and <b>645</b> may be coupled to a network <b>650</b>. Client systems <b>610</b>, <b>620</b>, and <b>630</b> generally represent any type or form of computing device or system, such as exemplary computing system <b>510</b> in <figref idref="DRAWINGS">FIG. 9</figref>. Similarly, servers <b>640</b> and <b>645</b> generally represent computing devices or systems, such as application servers or database servers, configured to provide various database services and/or to run certain software applications. Network <b>650</b> generally represents any telecommunication or computer network; including, for example, an intranet, a wide area network (WAN), a local area network (LAN), a personal area network (PAN), or the Internet.</p>
<p id="p-0080" num="0079">As illustrated in <figref idref="DRAWINGS">FIG. 10</figref>, one or more storage devices <b>660</b>(<b>1</b>)-(N) may be directly attached to server <b>640</b>. Similarly, one or more storage devices <b>670</b>(<b>1</b>)-(N) may be directly attached to server <b>645</b>. Storage devices <b>660</b>(<b>1</b>)-(N) and storage devices <b>670</b>(<b>1</b>)-(N) generally represent any type or form of storage device or medium capable of storing data and/or other computer-readable instructions. In certain embodiments, storage devices <b>660</b>(<b>1</b>)-(N) and storage devices <b>670</b>(<b>1</b>)-(N) may represent network-attached storage (NAS) devices configured to communicate with servers <b>640</b> and <b>645</b> using various protocols, such as NFS, SMB, or CIFS.</p>
<p id="p-0081" num="0080">Servers <b>640</b> and <b>645</b> may also be connected to a storage area network (SAN) fabric <b>680</b>. SAN fabric <b>680</b> generally represents any type or form of computer network or architecture capable of facilitating communication between a plurality of storage devices. SAN fabric <b>680</b> may facilitate communication between servers <b>640</b> and <b>645</b> and a plurality of storage devices <b>690</b>(<b>1</b>)-(N) and/or an intelligent storage array <b>695</b>. SAN fabric <b>680</b> may also facilitate, via network <b>650</b> and servers <b>640</b> and <b>645</b>, communication between client systems <b>610</b>, <b>620</b>, and <b>630</b> and storage devices <b>690</b>(<b>1</b>)-(N) and/or intelligent storage array <b>695</b> in such a manner that devices <b>690</b>(<b>1</b>)-(N) and array <b>695</b> appear as locally attached devices to client systems <b>610</b>, <b>620</b>, and <b>630</b>. As with storage devices <b>660</b>(<b>1</b>)-(N) and storage devices <b>670</b>(<b>1</b>)-(N), storage devices <b>690</b>(<b>1</b>)-(N) and intelligent storage array <b>695</b> generally represent any type or form of storage device or medium capable of storing data and/or other computer-readable instructions.</p>
<p id="p-0082" num="0081">In certain embodiments, and with reference to exemplary computing system <b>510</b> of <figref idref="DRAWINGS">FIG. 9</figref>, a communication interface, such as communication interface <b>522</b> in <figref idref="DRAWINGS">FIG. 9</figref>, may be used to provide connectivity between each client system <b>610</b>, <b>620</b>, and <b>630</b> and network <b>650</b>. Client systems <b>610</b>, <b>620</b>, and <b>630</b> may be able to access information on server <b>640</b> or <b>645</b> by using, for example, a web browser or other client software. Such software may allow client systems <b>610</b>, <b>620</b>, and <b>630</b> to access data hosted by server <b>640</b>, server <b>645</b>, storage devices <b>660</b>(<b>1</b>)-(N), storage devices <b>670</b>(<b>1</b>)-(N), storage devices <b>690</b>(<b>1</b>)-(N), or intelligent storage array <b>695</b>. Although <figref idref="DRAWINGS">FIG. 10</figref> depicts the use of a network (such as the Internet) for exchanging data, the embodiments described and/or illustrated herein are not limited to the Internet or any particular network-based environment.</p>
<p id="p-0083" num="0082">In at least one embodiment, all or a portion of one or more of the exemplary embodiments disclosed herein may be encoded as a computer program and loaded onto and executed by server <b>640</b>, server <b>645</b>, storage devices <b>660</b>(<b>1</b>)-(N), storage devices <b>670</b>(<b>1</b>)-(N), storage devices <b>690</b>(<b>1</b>)-(N), intelligent storage array <b>695</b>, or any combination thereof. All or a portion of one or more of the exemplary embodiments disclosed herein may also be encoded as a computer program, stored in server <b>640</b>, run by server <b>645</b>, and distributed to client systems <b>610</b>, <b>620</b>, and <b>630</b> over network <b>650</b>. Accordingly, network architecture <b>600</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the detecting, determining, using, permitting, installing, removing, undoing, updating, and/or creating steps disclosed herein. Network architecture <b>600</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0084" num="0083">As detailed above, client system <b>610</b> and/or one or more of the components of network architecture <b>600</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more steps of the exemplary methods described and/or illustrated herein. For example, client system <b>610</b> and/or one or more of the components of network architecture <b>600</b> may perform and/or be a means for performing a computer-implemented method for remediation of a computing device attempting to access a network. In some embodiments, the computer-implemented method may comprise detecting that the computing device is attempting to access the network and determining that the computing device does not comply with the network-access-control policy of the network. The method may further comprise using a virtualization layer to bring the computing device into compliance with the network-access-control policy and permitting the computing device to access the network after the computing device has been brought into compliance with the network-access-control policy.</p>
<p id="p-0085" num="0084">According to at least one embodiment, the method may further comprise determining whether the computing device supports virtualization and, if the computing device does not support virtualization, installing virtualization software on the computing device. In at least one embodiment, the virtualization layer may be a software-virtualization-solution layer, such as SYMANTEC's SYS technology. According to at least one embodiment, determining whether the computing device supports virtualization may comprise determining whether the computing system may comprise a driver that controls interactions between an operating system on a computing device and applications running on the virtualization layer.</p>
<p id="p-0086" num="0085">According to certain embodiments, the network-access-control policy may require a first security software program to be installed on the computing device. In some embodiments, using the virtualization layer to bring the computing device into compliance may comprise installing the security software on the virtualization layer. The method may also comprise removing the security software from the computing device when the computing device disconnects from the network.</p>
<p id="p-0087" num="0086">According to certain embodiments, the method may comprise using the virtualization layer to change a security setting of a security software program on the computing device. In some embodiments, when the computing device disconnects from the network or compliance is otherwise no longer required, the method may comprise undoing the change to the security setting.</p>
<p id="p-0088" num="0087">According to at least one embodiment, using the virtualization layer to bring the computing device into compliance may comprise updating a security software program on the computing device. When the computing device disconnects from the network, the security software program may be removed.</p>
<p id="p-0089" num="0088">In at least one embodiment, the virtualization layer may be managed by a virtualization agent running on a virtualization-enabled microprocessor on the computing device. In some embodiments, the computing device may comprise a hard-drive cache and the virtualization layer may reside on the hard-drive cache.</p>
<p id="p-0090" num="0089">In some embodiments, a virtualization layer may be programmed to provide an interface between a security software application and an operating system running on the computing device. According to at least one embodiment, the method may further comprise undoing changes to the computing device when the computing device is no longer required to comply with the network access policy.</p>
<p id="p-0091" num="0090">In certain embodiments, a system for controlling access to a network may comprise a detection module programmed to detect that a computing device is attempting to access the network. The system may also comprise a policy-enforcement module programmed to determine that the computing device does not comply with a network-access-control policy of the network. The system may further comprise a remediation interface programmed to use a virtualization layer to bring the computing device into compliance with the network-access-control policy.</p>
<p id="p-0092" num="0091">According to various embodiments, the system may comprise a network-access-control enabled switch. The network-access-control enabled switch may comprise the detection module, the policy enforcement module, and the remediation interface. According to other embodiments, the system may further comprise a network-access-control enabled router. The network-access-control enabled router may comprise the detection module, the policy enforcement module, and the remediation interface.</p>
<p id="p-0093" num="0092">In at least one embodiment, the policy enforcement module may be programmed to prevent the computing device from accessing the network while the computing device does not comply with the network-access-control policy. In some embodiments, the policy enforcement module may be programmed to permit the computing device to access the network after the computing device is brought into compliance with the network-access-control policy. According to various embodiments, the remediation interface may be programmed to determine whether the computing device supports virtualization. The remediation interface may also be programmed to install virtualization software on the computing device if the computing device does not support virtualization.</p>
<p id="p-0094" num="0093">According to certain embodiments, a computer-implemented method for remediation of a computing device attempting to access a network may comprise detecting that the computing device is attempting to access the network. The method may also comprise determining that the computing device does not comply with a network-access-control policy of the network. The method may further comprise creating a virtualization layer on the computing device. The virtualization layer may be programmed to provide an interface between security software application and an operating system running on the computing device. The method may further comprise using the virtualization layer to bring the computing device into compliance with the network-access-control policy. The method may further comprise permitting the computing device to access the network after the computing device is brought into compliance with the network-access-control policy. The method may further comprise removing the virtualization layer when the computing device is no longer required to comply with the network-access-control policy.</p>
<p id="p-0095" num="0094">While the foregoing disclosure sets forth various embodiments using specific block diagrams, flowcharts, and examples, each block diagram component, flowchart step, operation, and/or component described and/or illustrated herein may be implemented, individually and/or collectively, using a wide range of hardware, software, or firmware (or any combination thereof) configurations. In addition, any disclosure of components contained within other components should be considered exemplary in nature since many other architectures can be implemented to achieve the same functionality.</p>
<p id="p-0096" num="0095">The process parameters and sequence of steps described and/or illustrated herein are given by way of example only and can be varied as desired. For example, while the steps illustrated and/or described herein may be shown or discussed in a particular order, these steps do not necessarily need to be performed in the order illustrated or discussed. The various exemplary methods described and/or illustrated herein may also omit one or more of the steps described or illustrated herein or include additional steps in addition to those disclosed.</p>
<p id="p-0097" num="0096">Furthermore, while various embodiments have been described and/or illustrated herein in the context of fully functional computing systems, one or more of these exemplary embodiments may be distributed as a program product in a variety of forms, regardless of the particular type of computer-readable media used to actually carry out the distribution. The embodiments disclosed herein may also be implemented using software modules that perform certain tasks. These software modules may include script, batch, or other executable files that may be stored on a computer-readable storage medium or in a computing system. In some embodiments, these software modules may configure a computing system to perform one or more of the exemplary embodiments disclosed herein.</p>
<p id="p-0098" num="0097">The preceding description has been provided to enable others skilled in the art to best utilize various aspects of the exemplary embodiments disclosed herein. This exemplary description is not intended to be exhaustive or to be limited to any precise form disclosed. Many modifications and variations are possible without departing from the spirit and scope of the instant disclosure. The embodiments disclosed herein should be considered in all respects illustrative and not restrictive. Reference should be made to the appended claims and their equivalents in determining the scope of the instant disclosure.</p>
<p id="p-0099" num="0098">Unless otherwise noted, the terms &#x201c;a&#x201d; or &#x201c;an,&#x201d; as used in the specification and claims, are to be construed as meaning &#x201c;at least one of&#x201d; In addition, for ease of use, the words &#x201c;including&#x201d; and &#x201c;having,&#x201d; as used in the specification and claims, are interchangeable with and have the same meaning as the word &#x201c;comprising.&#x201d;</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer-implemented method for remediation of a computing device attempting to access a network, the computer-implemented method comprising:
<claim-text>detecting that the computing device is attempting to access the network, wherein the computing device comprises a base operating system that includes a base file system and registry;</claim-text>
<claim-text>determining that the computing device does not comply with a network-access-control policy of the network, wherein the computing device is a foreign device that is not controlled by an entity that controls the network;</claim-text>
<claim-text>determining that the computing device does not support virtualization because the computing device does not comprise virtualization layering software;</claim-text>
<claim-text>in response to determining that the computing device does not support virtualization:
<claim-text>installing virtualization layering software on the computing device, the virtualization laying software being programmed to determine whether access requests to the base operating system are permitted to continue to the base operating system or should be redirected to the virtualization layer;</claim-text>
<claim-text>installing the virtualization layer on the computing device;</claim-text>
</claim-text>
<claim-text>using the virtualization layer to bring the computing device into compliance with the network-access-control policy, wherein:
<claim-text>the virtualization layer comprises file system and/or registry changes that are isolated from the base file system and/or registry;</claim-text>
<claim-text>the file system and/or registry changes in the virtualization layer are isolated from the base file system and/or registry;</claim-text>
<claim-text>when the virtualization layer is enabled the file system and/or registry changes are overlaid over the base file system and/or registry such that the file system and/or registry changes appear to the base operating system as if they had been installed using traditional installation techniques;</claim-text>
<claim-text>the file system and/or registry changes are inaccessible when the virtualization layer is disabled;</claim-text>
</claim-text>
<claim-text>permitting the computing device to access the network after the computing device is brought into compliance with the network-access-control policy.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the virtualization layering software installs the virtualization layer on the computing device by creating the virtualization layer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the virtualization layer is a software-virtualization-solution layer;</claim-text>
<claim-text>determining that the computing device does not support virtualization comprises determining that the computing device does not comprise a driver that controls interactions between the base operating system on the computing device and the virtualization layer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the network-access-control policy requires a first security software program to be installed on the computing device;</claim-text>
<claim-text>using the virtualization layer to bring the computing device into compliance comprises installing the first security software program on the virtualization layer;</claim-text>
<claim-text>the file system and/or registry changes in the virtualization layer comprise the first security software program.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computer-implemented method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, further comprising:
<claim-text>determining that the computing device has disconnected from the network;</claim-text>
<claim-text>removing the first security software program from the computing device when the computing device disconnects from the network by disabling or deleting the virtualization layer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>using the virtualization layer to bring the computing device into compliance comprises using the virtualization layer to change a security setting of a security software program on the computing device;</claim-text>
<claim-text>the file system and/or registry changes in the virtualization layer comprise the security setting of the security software program.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The computer-implemented method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising:
<claim-text>undoing the change to the security setting when the computing device disconnects from the network by disabling the virtualization layer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>using the virtualization layer to bring the computing device into compliance comprises updating a security software program on the computing device by installing an update for the security software program to the virtualization layer;</claim-text>
<claim-text>the file system and/or registry changes in the virtualization layer comprise the update.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer-implemented method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising:
<claim-text>removing the update to the security software program when the computing device disconnects from the network by deleting the virtualization layer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>using the virtualization layer to bring the computing device into compliance with the network-access-control policy comprises streaming remediation data to the virtualization layer software on the computing device such that the impact of remediation on the computing device is minimized.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>determining that the file system and/or registry changes in the virtualization layer have been made permanently to the base file system and/or registry;</claim-text>
<claim-text>in response to determining that the file system and/or registry changes in the virtualization layer have been made permanently to the base file system and/or registry, deleting the virtualization layer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>determining that compliance with the network-access-control policy is no longer required;</claim-text>
<claim-text>in response to determining that compliance with the network-access-control policy is no longer required, undoing the file system and/or registry changes by removing and/or disabling the virtualization layer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising when the computing device no longer requires access to the network:
<claim-text>returning the computing device to a state that is identical to a state of the computing device prior to the virtualization layer being installed on the computing device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A computing system for controlling access to a network, the system comprising:
<claim-text>a base operating system;</claim-text>
<claim-text>a detection module programmed to detect that a computing device is attempting to access the network;</claim-text>
<claim-text>a policy-enforcement module programmed to determine that the computing device does not comply with a network-access-control policy of the network, wherein the computing device is a foreign device that is not controlled by an entity that controls the network;</claim-text>
<claim-text>a remediation interface programmed to:
<claim-text>determine that the computing device does not support virtualization because the computing device does not comprise virtualization layering software;</claim-text>
<claim-text>in response to determining that the computing device does not support virtualization:</claim-text>
<claim-text>install virtualization layering software on the computing device, the virtualization laying software being programmed to determine whether access requests to the base operating system are permitted to continue to the base operating system or should be redirected to a virtualization layer;</claim-text>
<claim-text>use the virtualization layering software to install the virtualization layer on the computing device;</claim-text>
<claim-text>use the virtualization layer to bring the computing device into compliance with the network-access-control policy;</claim-text>
</claim-text>
<claim-text>a file system filter driver that isolates the base operating system from remediation data in the virtualization layer;</claim-text>
<claim-text>at least one processor configured to execute the detection module and the policy-enforcement module.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising:
<claim-text>a network-access-control enabled switch, the network-access-control enabled switch comprising the detection module, the policy-enforcement module, and the remediation interface.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising:
<claim-text>a network-access-control enabled router, the network-access-control enabled router comprising the detection module, the policy-enforcement module, and the remediation interface.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein:
<claim-text>the policy-enforcement module is programmed to prevent the computing device from accessing the network while the computing device does not comply with the network-access-control policy;</claim-text>
<claim-text>the policy-enforcement module is programmed to permit the computing device to access the network after the computing device is brought into compliance with the network-access-control policy.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The system of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein:
<claim-text>the policy enforcement module is programmed to determine that compliance with the network-access-control policy is no longer required, and in response to determining that compliance with the network-access-control policy is no longer required, remove the virtualization layer such that the computing device is in a state identical to a state of the computing device prior to the virtualization layer being provided on the computing device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The system of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein:
<claim-text>the remediation interface is programmed to use the virtualization layer to bring the computing device into compliance by creating a setting on the virtualization layer that changes a setting of an application that is already installed on the computing device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. A computer-implemented method for remediation of a computing device attempting to access a network, the computer-implemented method comprising:
<claim-text>detecting that the computing device is attempting to access the network;</claim-text>
<claim-text>determining that the computing device does not comply with a network-access-control policy of the network, wherein the computing device is a foreign device that is not controlled by an entity that controls the network;</claim-text>
<claim-text>determining that the computing device does not support virtualization because the computing device does not comprise virtualization layering software;</claim-text>
<claim-text>in response to determining that the computing device does not support virtualization:
<claim-text>installing virtualization layering software on the computing device, the virtualization laying software being programmed to determine whether access requests to the base operating system are permitted to continue to the base operating system or should be redirected to a virtualization layer, and</claim-text>
<claim-text>using the virtualization layering software to install the virtualization layer on the computing device;</claim-text>
</claim-text>
<claim-text>using the virtualization layer to bring the computing device into compliance with the network-access-control policy;</claim-text>
<claim-text>permitting the computing device to access the network after the computing device is brought into compliance with the network-access-control policy;</claim-text>
<claim-text>removing the virtualization layer when the computing device is no longer required to comply with the network-access-control policy.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353045-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353045</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12493799</doc-number>
<date>20090629</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>613</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 25</main-classification>
<further-classification>726 22</further-classification>
</classification-national>
<invention-title id="d2e53">Method and tool for information security assessment that integrates enterprise objectives with vulnerabilities</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6249768</doc-number>
<kind>B1</kind>
<name>Tulskie et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705  736</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2005/0138413</doc-number>
<kind>A1</kind>
<name>Lippmann et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2005/0193430</doc-number>
<kind>A1</kind>
<name>Cohen et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 25</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2006/0200477</doc-number>
<kind>A1</kind>
<name>Barrenechea</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707100</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2010/0082513</doc-number>
<kind>A1</kind>
<name>Liu</name>
<date>20100400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>706 46</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00006">
<othercit>Barney et al., &#x201c;Strategic Management and Competitive Advantage&#x2014;Concepts and Cases&#x201d;, published by Prentice Hall, ISBN 0-13-154274-5, chapters 1-3, 2006.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00007">
<othercit>Clark et al., &#x201c;Security Risk Metrics: Fusing Enterprise Objectives and Vulnerabilities&#x201d;, Proceeding of the 2005 IEEE Workshop on Information Assurance and Security, pp. 388-393, 2005.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
</references-cited>
<number-of-claims>18</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 25</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 22</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>7</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100333002</doc-number>
<kind>A1</kind>
<date>20101230</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Karabey</last-name>
<first-name>Bugra</first-name>
<address>
<city>Ankara</city>
<country>TR</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>TR</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Baykal</last-name>
<first-name>Nazife</first-name>
<address>
<city>Ankara</city>
<country>TR</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>TR</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Collen IP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Ranft</last-name>
<first-name>Donald J.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<examiners>
<primary-examiner>
<last-name>Goodchild</last-name>
<first-name>William</first-name>
<department>2433</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">In one aspect, a method to assess information security vulnerability of an enterprise includes storing enterprise objectives in a computer system, storing enterprise resources determined using a value criterion, a rareness criterion, an inimitability criterion and a non-substitutability criterion in the computer system and storing enterprise information assets in the computer system. The method also includes mapping the enterprise objectives with the enterprise resources and mapping the enterprise information assets with the enterprise resources. The method further includes determining a threat analysis using an attack tree using the enterprise resources and the information assets and determining a risk value using the attack tree.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="144.53mm" wi="147.74mm" file="US08353045-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="139.36mm" wi="109.05mm" file="US08353045-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="211.84mm" wi="141.65mm" file="US08353045-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="215.48mm" wi="135.72mm" file="US08353045-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="158.50mm" wi="146.64mm" file="US08353045-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="132.76mm" wi="145.97mm" file="US08353045-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="141.05mm" wi="166.03mm" file="US08353045-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="211.50mm" wi="157.48mm" file="US08353045-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">As it is impossible to eliminate all the risks, organizations may hope that a perceived risk can be reduced if risk advice can be obtained through a risk assessment. Therefore, risk management plays a critical role in protecting an organization's information assets. Risk management is a process that covers both an assessment phase and a mitigation phase. In the assessment phase adequate methods and tools are required to determine quantitative results. In the traditional approaches the probability of occurrence of a risk is multiplied by its perceived impact to form a loss expectancy figure.</p>
<p id="p-0003" num="0002">In the domain of information systems and information security management the risk assessment phase is more complicated. As information security threats are constantly evolving, use of historical or statistical figures to estimate the probability of occurrence of a specific risk may present in faulty conclusions. Currently, data repositories like the National Vulnerability Database by National Institute of Standards and Technology (NIST) are used. In some examples, available automated tools are used to determine vulnerability assessments. Most of the time, these measures tend to be geared toward security professionals and usually are not suitable for managerial decision making, which are commonly driven by compliance requirements rather than the risk management thought processes. Suitable outcomes are expected from such tools and methods to help management make decisions, prioritize resources and develop mitigation strategies against the occurrence of such risks related with the information assets of a company, however most of the time that is not the case.</p>
<p id="p-0004" num="0003">U.S. National Security Agency (NSA)'s Mission Oriented Risk and Design Analysis (MORDA) provides a framework for analyzing complex information security risk postures. MORDA combines threat, attack and mission impact concepts to derive an unbiased risk metric, so the enterprise objectives in the form of missions are embedded within this framework. Identification of enterprise objectives has not been defined explicitly within MORDA.</p>
<p id="p-0005" num="0004">Another critical aspect of information security threats is their ever changing nature that evolves at a tremendous pace. In addition to that the interconnected nature of information assets presents an additional dimension of complexity in the form of a requirement for cascaded and parallel analysis of threats against the information assets.</p>
<p id="p-0006" num="0005">The attack tree approach is suitable to address such architectural complexities in a dynamic manner. Attacks are modeled through the use of a graphical, mathematical, decision tree structure called an attack tree. Similar studies exist that utilize attack graphs instead of attack trees. A known issue with attack trees (and graphs) is that for systems that include numerous information resource elements the task becomes cumbersome and the scalability of the approach becomes limited within large enterprises.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0007" num="0006">In one aspect, a method to assess information security vulnerability of an enterprise includes storing enterprise objectives in a computer system, storing enterprise resources determined using a value criterion, a rareness criterion, an inimitability criterion and a non-substitutability criterion in the computer system and storing enterprise information assets in the computer system. The method also includes mapping the enterprise objectives with the enterprise resources and mapping the enterprise information assets with the enterprise resources. The method further includes determining a threat analysis using an attack tree using the enterprise resources and the information assets and determining a risk value using the attack tree.</p>
<p id="p-0008" num="0007">In another aspect, an article includes a machine-readable storage medium that stores executable instructions to assess information security vulnerability of an enterprise. The instructions causes a machine to store enterprise objectives in a computer system, store enterprise resources determined using a value criterion, a rareness criterion, an inimitability criterion and a non-substitutability criterion in the computer system and store enterprise information assets in the computer system. The instructions also cause machine to map the enterprise objectives with the enterprise resources and map the enterprise information assets with the enterprise resources. The instructions further cause a machine to determine a threat analysis using an attack tree by using the enterprise resources and the information assets and determine a risk value using the attack tree.</p>
<p id="p-0009" num="0008">In a further aspect, an apparatus to assess information security vulnerability of an enterprise includes circuitry to store enterprise objectives in a computer system, store enterprise resources determined using a value criterion, a rareness criterion, an inimitability criterion and a non-substitutability criterion in the computer system, store enterprise information assets in the computer system, map the enterprise objectives with the enterprise resources, map the enterprise information assets with the enterprise resources, determine a threat analysis using an attack tree using the enterprise resources and the information assets and determine a risk value using the attack tree.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 1</figref> is a flowchart of an example of a process to assess information security vulnerability.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart of an example of a process to determine and map enterprise objectives, resources and information assets.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart of an example of a process to perform a value, rareness, inimitability and non-substitutability (VRIN) criteria filtering of the enterprise assets.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart of an example of a process to determine a risk value.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart of an example of process to form an attack tree.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart of an example of a process to form AND/OR nodes within the attack tree.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of an example of a computer on which one or more of the processes of <figref idref="DRAWINGS">FIGS. 2 to 6</figref> may be implemented.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0017" num="0016">Security is one of the key concerns in the domain of information technology (IT) systems. Maintaining the confidentiality, integrity and availability of IT systems, mandates a rigorous prior analysis of the security risks that confront the IT systems. In order to analyze, mitigate and recover from the security risks, a metrics-based approach is essential in prioritizing the response strategies to the security risks and is used for resource allocation schedules to mitigate the security risks. As will be described herein, enterprise objectives are focally integrated in the definition, impact calculation and prioritization phases of the analysis to determine metrics that are useful both for the technical and managerial communities within an enterprise. The inclusion of enterprise objectives in the identification of information assets acts as a preliminary filter to overcome the real-life scalability issues inherent with such threat modeling efforts. An attack-tree-based approach can be utilized to offer an information security tool and method that integrates the enterprise objectives with the information asset vulnerabilities within an enterprise.</p>
<p id="p-0018" num="0017">Existing tools and methods in the field of information security risk assessment suffer from certain issues. Due to the limited availability of statistics in the area of IT security, probabilistic calculations and methodologies that rely upon historical data may not be reliable. Also, due to the evolving nature of IT security threats and vulnerabilities, there may be asymmetric or non-linear leaps in the threat domain, compared to the traditional defense systems, so that the threats are dynamic in nature, which necessitates a dynamic modeling step within the methodology. In addition when the impact account is accounted for, it is evident that intangible components of the assets are at risk also. Thus, taking into account the technical level or pure monetary losses will not cover all situations. Therefore, business goals and priorities are accounted for as described herein leading to a solution having a scalability (and usability) within real life enterprise settings and scenarios.</p>
<p id="p-0019" num="0018">As described herein, a methodology, which utilizes Resource Based View (RBV) model of enterprises in the fundamental phases of the method, is used to identify the resources essential for an enterprise's success in line with objectives. The methodology further maps these resources and thus the enterprise objectives with the information assets domain. The resources and related assets are analyzed from the information security threats perspective. The resource-based view of an enterprise identifies enterprises as collections of tangible and intangible resources combined with capabilities to utilize these assets to finally develop competencies that result in competitive advantage. Until now it has not been used within the context of information security risk tools and methodologies.</p>
<p id="p-0020" num="0019">System security risks are of a complicated nature which can only be evaluated by considering a complex combination of possible consequences. Attack trees are well suited and frequently used for this pursuit, so that attack tree modeling are utilized in the information asset and threat modeling stage as described herein. A purpose of the attack tree is to define and analyze possible attacks on a system in a structured way that is modeled within a tree structure including a nodal hierarchy that allows the decomposition and analysis of an attack within a number of attack steps.</p>
<p id="p-0021" num="0020">Thus, the inclusion of the enterprise objectives enables results to be determined that will be inherently relevant to the decision making and execution steps of management. Identified resources through the resource based view constitute the root nodes of the attack tree and the related information assets and the steps of the threat scenario against these form the leaves of the attack tree. In addition, the techniques described herein will overcome the scalability issues with using the attack trees at the modeling and attack generation phases by prioritizing and focusing on the most critical information assets by the identification of these assets through a methodology that embeds and puts the enterprise objectives at the forefront of the system modeling and information asset definition phases.</p>
<p id="p-0022" num="0021">Therefore, the usage of the resource-based view enables integration of enterprise objectives with vulnerabilities presents useful results for the management and resolves the scalability issues inherent with the attack tree modeling of information security threats.</p>
<p id="p-0023" num="0022">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, a process <b>100</b> is an example of a process to assess information security vulnerability. As used herein an enterprise is any organization such as a business, a military unit, a club and so forth utilizing information assets (e.g., information technology (IT)). Enterprise objectives are either defined within mission statements and/or goals of an organization or can be compiled through discussions with the top level management of the company (<b>110</b>). Enterprise resources are identified, for example, through a rigorous resource-based modeling of the enterprise (<b>115</b>) (e.g., as described in <figref idref="DRAWINGS">FIGS. 2 to 4</figref>). Enterprise resources are based upon the relevant information assets that are identified (<b>120</b>) (e.g., as described in <figref idref="DRAWINGS">FIGS. 2 to 4</figref>). After the identification of the enterprise objectives, the enterprise resources, the information assets and a mapping of these elements to each other, a refined list and model is achieved that can be focused to determine information security (i.e., a threat analysis) (<b>125</b>). In one example, by using an attack tree methodology, a resultant quantitative risk figure (i.e., a resultant risk value) is determined (<b>130</b>).</p>
<p id="p-0024" num="0023">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, a process <b>200</b> is an example of a process to determine and map enterprise objectives, resources and information assets. Enterprise objectives such as missions and goals are compiled (<b>210</b>). A team, for example, that includes an enterprise's top management and functional managers (e.g., sales, marketing, finance, technical, logistics and so forth) determine a list of tangible and intangible enterprise resources, which are stored into a system (e.g., a computer <b>700</b> (<figref idref="DRAWINGS">FIG. 7</figref>)) (<b>215</b>) to determine risk.</p>
<p id="p-0025" num="0024">A list of enterprise information assets is defined by the information systems team in the enterprise and stored in the system (e.g., the computer <b>700</b> (<figref idref="DRAWINGS">FIG. 7</figref>)) (<b>220</b>). The identified resources are mapped with the identified objectives to form a limited list of resources that are mapped with the enterprise objectives (<b>225</b>). For example, the identified objectives are matched with the identified resources that are relevant for the successful achievement of the objectives. In one particular example, a list of resources that are deemed critical for the related objective is compiled for every objective.</p>
<p id="p-0026" num="0025">A value, rareness, inimitability, non-substitutability (VRIN) criteria test is used to refine and filter the enterprise resources to include enterprise resources that are relevant to the proper and successful functioning of the enterprise (<b>230</b>). The VRIN criteria are based upon the resource-based view of the enterprise and define differentiating, competitive and advantageous resources of the enterprise.</p>
<p id="p-0027" num="0026">The filtered list of enterprise resources are mapped with the relevant information assets from the identified list of assets defined in processing block <b>220</b> to form a mapped list of information assets with the critical resources (<b>235</b>). For example, the identified enterprise resources are matched with the identified assets that are relevant for the proper functioning of the resource. In one particular example, a list of assets that are deemed critical for the related enterprise resource is compiled for each resource.</p>
<p id="p-0028" num="0027">Referring to <figref idref="DRAWINGS">FIG. 3</figref>, an example of a process to filter a list of resources (processing block <b>230</b>) is a process <b>300</b>. The list of enterprise resources mapped to the enterprise objectives (see processing block <b>225</b>) are used (<b>310</b>).</p>
<p id="p-0029" num="0028">For each enterprise resource, the enterprise resource is evaluated against a value criterion (<b>310</b>). The value criterion defines that an enterprise's resources are valuable if they enable the enterprise to implement strategies that improve its efficiency and effectiveness. In one particular example, the value criterion is a Boolean and/or qualitative criterion that has a PASS/FAIL or COMPLIANT/NON-COMPLIANT value. Thus, the enterprise resources that fail the value criterion are discarded <b>340</b>.</p>
<p id="p-0030" num="0029">The enterprise resources that pass the value criterion are further evaluated against a rareness criterion (<b>320</b>). The rareness criterion from the resource-based view paradigm indicates that an enterprise has a competitive advantage if the same advantage is not shared by another enterprise. In one particular example, the rareness criterion is a Boolean and/or qualitative criterion that has a PASS/FAIL or COMPLIANT/NON-COMPLIANT value. Thus, the rarity of the enterprise resource is a decisive criterion for it to be accepted. Thus, the enterprise resources that fail the rareness criterion are discarded <b>340</b>.</p>
<p id="p-0031" num="0030">The enterprise resources that pass the rareness criterion are further evaluated against an inimitability criterion (<b>325</b>). The inimitability criterion indicates that in order to offer a sustainable advantage an enterprise resource is harder for a competing enterprise to imitate. In one particular example, the inimitability criterion is a Boolean and/or qualitative criterion that has a PASS/FAIL or COMPLIANT/NON-COMPLIANT value. For example, a low inimitability limit also lowers the mobility or increases the time for the enterprise resource to be copied. The enterprise resources that fail the inimitability criterion are discarded <b>340</b>.</p>
<p id="p-0032" num="0031">The enterprise resources that pass the inimitability criterion are further evaluated against a non-substitutability criterion (<b>330</b>). The non-substitutability criterion from the resource-based view thinking indicates that enterprise resources that are critical do not have equivalent enterprise resources (e.g., with a lower rareness criterion value or an inimitability criterion value) that can be substituted for them. For example, existence of such substitute enterprise resources voids the importance that the particular enterprise resource presents. The enterprise resources that fail the non-substitutability criterion are discarded <b>340</b> and the enterprise resources that pass the non-substitutability criterion form the filtered/refined list of enterprise resources.</p>
<p id="p-0033" num="0032">In processing block <b>235</b>, the enterprise resources that are refined and filtered in the VRIN analysis are mapped with the information assets defined in the processing block <b>220</b> to form a mapped list of information assets with the enterprise resources.</p>
<p id="p-0034" num="0033">Referring to <figref idref="DRAWINGS">FIG. 4</figref>, a process <b>400</b> is an example of a process to determine a risk value. In the threat modeling, the outcome of processing block <b>235</b> is used (<b>410</b>). The threats and threat scenarios that include a succession of serial and/or parallel steps of hostile moves that may jeopardize a specific enterprise resource are modeled using an attack tree (<b>415</b>).</p>
<p id="p-0035" num="0034">Referring to <figref idref="DRAWINGS">FIG. 5</figref>, a process <b>500</b> is an example of a process to form an attack tree. In forming the attack tree, the enterprise resources that successfully pass processing block <b>230</b> are used as the root nodes of the attack trees (<b>510</b>). The attack steps against the information assets that are relevant for this resource form the lower layers form the leaves of the tree (<b>515</b>). For the purpose of quantitative analysis numerical values are assigned to the leaf nodes such as, for example, a probability, a cost, and/or an impact of the related attack step (<b>520</b>).</p>
<p id="p-0036" num="0035">Referring back to <figref idref="DRAWINGS">FIG. 4</figref>, using the values from processing block <b>520</b> and the AND/OR logic outlined in the <figref idref="DRAWINGS">FIG. 6</figref>, the attack scenario steps values are determined (<b>420</b>). For the resultant impact, probability and risk level of an attack or series of attacks against the enterprise resources, a resultant risk value is determined (<b>425</b>).</p>
<p id="p-0037" num="0036">Referring to <figref idref="DRAWINGS">FIG. 6</figref>, a process <b>600</b> is an example of a process to form AND/OR nodes within an attack tree. For each layer in the attack tree (<b>610</b>), it is determined if more than one threat act is required (<b>615</b>) and it is determined if either of the threat acts suffice (<b>618</b>). A logical AND step is used if more than one attacker moves in parallel (<b>620</b>). A logical OR is utilized if the attacker can successfully pass a certain layer within the performance of either one of the attack steps (<b>623</b>).</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 7</figref> is an example of a computer <b>700</b>, which may be used to execute all or part of the processes <b>100</b>, <b>200</b>, <b>300</b>, <b>400</b>, <b>500</b> and <b>600</b>. Computer <b>700</b> includes a processor <b>722</b>, a volatile memory <b>724</b>, a non-volatile memory <b>726</b> (e.g., hard disk), for example, and a graphical user interface <b>728</b> (e.g., a screen, a mouse, a keyboard, a touch screen and so forth and any combination thereof). Non-volatile memory <b>726</b> includes an operating system <b>736</b>; data <b>738</b> (including enterprise objectives <b>750</b>, enterprise assets <b>760</b>, information assets <b>770</b>, a value criterion <b>782</b>, a rareness criterion <b>784</b>, a inimitability criterion <b>786</b> and non-substitutability criterion <b>788</b>); and computer instructions <b>734</b> which are executed out of volatile memory <b>724</b> to perform all or part of processes <b>100</b>, <b>200</b>, <b>300</b>, <b>400</b>, <b>500</b> and <b>600</b>. The data <b>738</b> may be added to the computer <b>700</b> using the GUI <b>728</b>. In one example, the identification of enterprise resources can be implemented using additional criteria added by a user using the GUI <b>782</b>.</p>
<p id="p-0039" num="0038">In one example, using the computer <b>700</b>, the enterprise objective definitions are defined by management and are inputted into the computer <b>700</b> using the GUI <b>728</b>. Usually such enterprise objectives take the form of mid- to long-term measurable goals that set the direction for the enterprise as a whole. Examples of such enterprise objectives can be, for example, achievement of X % revenue growth within the next two quarters, obtaining Y % market share within the end of year Z, cultivation of a learning organization culture, achieving six sigma quality level in three years, leading the innovative position within the industry in research and development.</p>
<p id="p-0040" num="0039">Afterwards, a team of top management and functional managers define the enterprise resources. Such resources may include all assets, capabilities, organizational processes, brands, information and knowledge base that the company owns, which, for example, may be in the form of tangible or intangible entities. Some examples for the resources may cover; brand names, in-house knowledge of technology, skilled human resources, patents, proprietary technologies, efficient procedures, specialized machinery. The resource categories are identified and stored in the computer <b>700</b>.</p>
<p id="p-0041" num="0040">The information system assets of the enterprise are defined by the information systems management team. Such resources may include but are not limited to; servers (database, Internet, e-business, mail, customer relationship management, enterprise resource planning etc), personal computers, thin clients, mobile computing platforms, network infrastructure (such as routers, switches, bridges, hubs), smartcard systems, RFID systems, point of sale systems, automated teller machines, information security appliances (firewalls, intrusion detection/prevention systems, antivirus tools etc.), private branch exchange telephony systems, closed circuit TV systems, data storage infrastructure, and so forth. Thus, the information systems level architecture of the enterprise is inputted to the computer <b>700</b> using, for example, the GUI <b>728</b> through a submission of a file in an appropriate format that covers this information architecture data.</p>
<p id="p-0042" num="0041">Afterwards the mapping is performed. Initially the enterprise objectives are mapped to the relevant enterprise resources. As an example if &#x201c;leading the innovative position within the industry in research and development&#x201d; was the enterprise objective at hand than the related enterprise resources to be mapped could be, for example, patents owned by the enterprise, proprietary technologies, skilled human resources, and specialized machinery (lab tools).</p>
<p id="p-0043" num="0042">The VRIN criteria are applied to filter/refine the mapped resources. Assuming, after taking into account the special circumstances of the enterprise, the enterprise resources that pass the VRIN criteria are the &#x201c;proprietary technologies and the specialized machinery&#x201d; and the information system assets previously defined are mapped to these filtered list of resources.</p>
<p id="p-0044" num="0043">In this example the information about the &#x201c;proprietary technologies&#x201d; reside within the knowledge database of the research and development (R&#x26;D) team or in the computers of the team members (e.g. in the form of software code). Also the &#x201c;specialized machinery&#x201d; resource can be a special lab tool used by the R&#x26;D team with connections to the R&#x26;D intranet. So the related information system assets will be all the computers, servers and network components within the R&#x26;D intranet and with direct connections to this intranet as the compromise (e.g., in the form of a security breach or an availability problem such as the downtime of the specialized lab tool) of these resources leads to the compromise of an enterprise resource (proprietary technology or specialized machinery) which directly affects an enterprise objective (leading the innovative position within the industry in research and development). In one example, these steps are repeated for every enterprise objective that has been defined.</p>
<p id="p-0045" num="0044">An attack tree is formed that takes the filtered enterprise resources as the root nodes and the attack scenario steps related with the relevant information assets as the leaves. Different attributes (like probability, cost, required time and so forth) can be assigned to these other nodes. Those of ordinary skill in the art can also use commercial off-the-shelf available attack tree formation programs. In one example, the formation of the attack tree can be performed with input from a data file that embeds an attack tree model. In another example, additional values and attributes can be defined and added by the user for the leaf node values of the attack tree. Analysis of the aforementioned attack tree is a straightforward implementation of the existing methods of attack tree analysis literature.</p>
<p id="p-0046" num="0045">By using the successive mapping steps and using the resource filtering of resource based view criteria, an essential list of resources and related information assets are identified. Thus, using this limited (but relevant) list of assets/resources to form the attack trees, the scalability issue of the attack tree analysis is overcome. Also the list of resources/assets pertain resources/assets that are relevant to the fulfillment of enterprise objectives and the results of the analysis is therefore beneficial not only in the technical domain but also for managerial decision making.</p>
<p id="p-0047" num="0046">The processes described herein (e.g., processes <b>100</b>, <b>200</b>, <b>300</b>, <b>400</b>, <b>500</b> and <b>600</b>) are not limited to use with the hardware and software of <figref idref="DRAWINGS">FIG. 7</figref>, they may find applicability in any computing or processing environment and with any type of machine or set of machines that is capable of running a computer program. The processes may be implemented in hardware, software, or a combination of the two. The processes may be implemented in computer programs executed on programmable computers/machines that each includes a processor, a storage medium or other article of manufacture that is readable by the processor (including volatile and non-volatile memory and/or storage elements), at least one input device, and one or more output devices. Program code may be applied to data entered using an input device to perform processes <b>100</b>, <b>200</b>, <b>300</b>, <b>400</b>, <b>500</b> and <b>600</b>, for example, and to generate output information.</p>
<p id="p-0048" num="0047">The processes described herein are not limited to the specific embodiments described herein. For example, the processes are not limited to the specific processing order of the process steps in <figref idref="DRAWINGS">FIGS. 1 to 6</figref>. Rather, any of the processing steps of <figref idref="DRAWINGS">FIGS. 1 to 6</figref> may be re-ordered, combined or removed, performed in parallel or in serial, as necessary, to achieve the results set forth above.</p>
<p id="p-0049" num="0048">Process steps in <figref idref="DRAWINGS">FIGS. 1 to 6</figref> associated with implementing the system may be performed by one or more programmable processors executing one or more computer programs to perform the functions of the system. All or part of the system may be implemented as, special purpose logic circuitry (e.g., an FPGA (field programmable gate array) and/or an ASIC (application-specific integrated circuit)).</p>
<p id="p-0050" num="0049">While the invention is shown and described in conjunction with a particular embodiment having an illustrative architecture having certain components in a given order, it is understood that other embodiments well within the scope of the invention are contemplated having more and fewer components, having different types of components, and being coupled in various arrangements. Such embodiments will be readily apparent to one of ordinary skill in the art. All documents cited herein are incorporated herein by reference. Other embodiments not specifically described herein are also within the scope of the following claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method comprising:
<claim-text>storing enterprise objectives in a computer system;</claim-text>
<claim-text>storing a list of enterprise resources in the computer system;</claim-text>
<claim-text>mapping the enterprise objectives with the enterprise resources;</claim-text>
<claim-text>removing enterprise resources from the list of enterprise resources that cannot be mapped to an enterprise objective to form a limited list of enterprise resources;</claim-text>
<claim-text>filtering the limited list of resources using a value criterion, a rareness criterion, an inimitability criterion and a non-substitutability criterion to form a filtered list of enterprise resources;</claim-text>
<claim-text>storing the filtered list of enterprise resources in the computer system;</claim-text>
<claim-text>storing enterprise information assets in the computer system;</claim-text>
<claim-text>mapping the enterprise information assets with enterprise resources from the filtered list;</claim-text>
<claim-text>determining a threat analysis using an attack tree using the enterprise resources from the filtered list and the information assets comprising forming the attack tree using a data file that embeds an attack tree model, the attack tree defining possible attacks on the computer system modeled within a tree structure comprising nodal hierarchy allowing the decomposition and analysis of an attack within a number of attack steps, the attack tree using the enterprise resources from the filtered list as root nodes in the attack tree; and</claim-text>
<claim-text>determining a risk value using the attack tree.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising identifying the enterprise objectives using mission statements.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising identifying the enterprise objectives using enterprise goals.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising storing enterprise resources determined using criteria added to the computer system by a user through a graphical user interface.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein storing enterprise resources comprises storing enterprise resources provided by a user through a graphical user interface.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein storing enterprise information assets in the computer system comprises storing a data file comprising the information assets.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein storing enterprise information assets in the computer system comprises storing enterprise information assets provided by a user through a graphical user interface.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the mapping of enterprise objectives with enterprise resources comprises mapping the enterprise objectives with enterprise resources provided by a user through a graphical user interface.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the mapping enterprise resources with enterprise information assets comprises mapping of enterprise resources with enterprise information assets provided by a user using a graphical user interface.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein determining a threat analysis using an attack tree comprises using additional values and attributes for leaf node values of the attack tree that are defined and added by a user through a graphical user interface.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. An article comprising:
<claim-text>a non-transitory machine-readable medium that stores executable instructions to assess information security vulnerability, the instructions causing a machine to:
<claim-text>store enterprise objectives in a computer system;</claim-text>
<claim-text>store a list of enterprise resources in the computer system;</claim-text>
<claim-text>map the enterprise objectives with the enterprise resources;</claim-text>
<claim-text>remove enterprise resources from the list of enterprise resources that cannot be mapped to an enterprise objective to form a limited list of enterprise resources;</claim-text>
<claim-text>filter the limited list of resources using a value criterion, a rareness criterion, an inimitability criterion and a non-substitutability criterion to form a filtered list of enterprise resources;</claim-text>
<claim-text>store the filtered list of enterprise resources in the computer system;</claim-text>
<claim-text>store enterprise information assets in the computer system;</claim-text>
<claim-text>map the enterprise information assets with enterprise resources from the filtered list;</claim-text>
<claim-text>determine a threat analysis using an attack tree using the enterprise resources from the filtered list and the information assets comprising forming the attack tree using a data file that embeds an attack tree model, the attack tree defining possible attacks on the computer system modeled within a tree structure comprising nodal hierarchy allowing the decomposition and analysis of an attack within a number of attack steps, the attack tree using the enterprise resources from the filtered list as root nodes in the attack tree; and</claim-text>
<claim-text>determine a risk value using the attack tree.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The article of <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising instructions causing a machine to identify the enterprise objectives using enterprise goals.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The article of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein the identification of enterprise resources can be implemented using additional criteria added to the computer system by a user.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The article of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein the identification of enterprise resources can be implemented using a graphical user interface.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The article of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein storing enterprise information assets in the computer system comprises storing a data file comprising the information assets.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. An apparatus, comprising:
<claim-text>circuitry to:
<claim-text>store enterprise objectives in a computer system;</claim-text>
<claim-text>store a list of enterprise resources in the computer system;</claim-text>
<claim-text>map the enterprise objectives with the enterprise resources;</claim-text>
<claim-text>remove enterprise resources from the list of enterprise resources that cannot be mapped to an enterprise objective to form a limited list of enterprise resources;</claim-text>
<claim-text>filter the limited list of resources using a value criterion, a rareness criterion, an inimitability criterion and a non-substitutability criterion to form a filtered list of enterprise resources;</claim-text>
<claim-text>store the filtered list of enterprise resources in the computer system;</claim-text>
<claim-text>store enterprise information assets in the computer system;</claim-text>
<claim-text>map the enterprise information assets with enterprise resources from the filtered list;</claim-text>
<claim-text>determine a threat analysis using an attack tree using the enterprise resources from the filtered list and the information assets comprising forming the attack tree using a data file that embeds an attack tree model, the attack tree defining possible attacks on the computer system modeled within a tree structure comprising nodal hierarchy allowing the decomposition and analysis of an attack within a number of attack steps, the attack tree using the enterprise resources from the filtered list as root nodes in the attack tree; and</claim-text>
<claim-text>determine a risk value using the attack tree.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the circuitry comprises at least one of a processor, a memory, programmable logic or logic gates.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the circuitry to map enterprise resources with enterprise information assets comprises circuitry to map enterprise resources with enterprise information assets provided by a user using a graphical user interface. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353046-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353046</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11147539</doc-number>
<date>20050608</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1108</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
<further-classification>726 16</further-classification>
<further-classification>380231</further-classification>
</classification-national>
<invention-title id="d2e53">System and method for delivery of a modular operating system</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4558176</doc-number>
<kind>A</kind>
<name>Arnold et al.</name>
<date>19851200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>4620150</doc-number>
<kind>A</kind>
<name>Germer et al.</name>
<date>19861000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>4750034</doc-number>
<kind>A</kind>
<name>Lem</name>
<date>19880600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>4817094</doc-number>
<kind>A</kind>
<name>Lebizay et al.</name>
<date>19890300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>4855730</doc-number>
<kind>A</kind>
<name>Venners et al.</name>
<date>19890800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>4855922</doc-number>
<kind>A</kind>
<name>Huddleston et al.</name>
<date>19890800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>4857999</doc-number>
<kind>A</kind>
<name>Welsh</name>
<date>19890800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>4910692</doc-number>
<kind>A</kind>
<name>Outram et al.</name>
<date>19900300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>4959774</doc-number>
<kind>A</kind>
<name>Davis</name>
<date>19900900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>4967273</doc-number>
<kind>A</kind>
<name>Greenberg</name>
<date>19901000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>5001752</doc-number>
<kind>A</kind>
<name>Fischer</name>
<date>19910300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>5012514</doc-number>
<kind>A</kind>
<name>Renton</name>
<date>19910400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>5249184</doc-number>
<kind>A</kind>
<name>Woest et al.</name>
<date>19930900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>5269019</doc-number>
<kind>A</kind>
<name>Peterson et al.</name>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>5274368</doc-number>
<kind>A</kind>
<name>Breeden et al.</name>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>5301268</doc-number>
<kind>A</kind>
<name>Takeda</name>
<date>19940400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>719329</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>5355161</doc-number>
<kind>A</kind>
<name>Bird et al.</name>
<date>19941000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>5369262</doc-number>
<kind>A</kind>
<name>Dvorkis et al.</name>
<date>19941100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>5406630</doc-number>
<kind>A</kind>
<name>Piosenka et al.</name>
<date>19950400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>5414861</doc-number>
<kind>A</kind>
<name>Horning</name>
<date>19950500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>5437040</doc-number>
<kind>A</kind>
<name>Campbell</name>
<date>19950700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>5442704</doc-number>
<kind>A</kind>
<name>Holtey</name>
<date>19950800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>5448045</doc-number>
<kind>A</kind>
<name>Clark</name>
<date>19950900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>5459867</doc-number>
<kind>A</kind>
<name>Adams et al.</name>
<date>19951000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>719321</main-classification></classification-national>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>5473692</doc-number>
<kind>A</kind>
<name>Davis</name>
<date>19951200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>5490216</doc-number>
<kind>A</kind>
<name>Richardson, III</name>
<date>19960200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>5500897</doc-number>
<kind>A</kind>
<name>Hartman, Jr.</name>
<date>19960300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>5513319</doc-number>
<kind>A</kind>
<name>Finch et al.</name>
<date>19960400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>5522040</doc-number>
<kind>A</kind>
<name>Hofsass et al.</name>
<date>19960500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>5530846</doc-number>
<kind>A</kind>
<name>Strong</name>
<date>19960600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>5552776</doc-number>
<kind>A</kind>
<name>Wade et al.</name>
<date>19960900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>5563799</doc-number>
<kind>A</kind>
<name>Brehmer et al.</name>
<date>19961000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>5568552</doc-number>
<kind>A</kind>
<name>Davis</name>
<date>19961000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>5586291</doc-number>
<kind>A</kind>
<name>Lasker et al.</name>
<date>19961200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>5671412</doc-number>
<kind>A</kind>
<name>Christiano</name>
<date>19970900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>5710706</doc-number>
<kind>A</kind>
<name>Markl et al.</name>
<date>19980100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00037">
<document-id>
<country>US</country>
<doc-number>5715403</doc-number>
<kind>A</kind>
<name>Stefik</name>
<date>19980200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 44</main-classification></classification-national>
</citation>
<citation>
<patcit num="00038">
<document-id>
<country>US</country>
<doc-number>5724425</doc-number>
<kind>A</kind>
<name>Chang et al.</name>
<date>19980300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00039">
<document-id>
<country>US</country>
<doc-number>5745879</doc-number>
<kind>A</kind>
<name>Wyman</name>
<date>19980400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00040">
<document-id>
<country>US</country>
<doc-number>5754763</doc-number>
<kind>A</kind>
<name>Bereiter</name>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00041">
<document-id>
<country>US</country>
<doc-number>5758068</doc-number>
<kind>A</kind>
<name>Brandt et al.</name>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00042">
<document-id>
<country>US</country>
<doc-number>5763832</doc-number>
<kind>A</kind>
<name>Anselm</name>
<date>19980600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00043">
<document-id>
<country>US</country>
<doc-number>5768382</doc-number>
<kind>A</kind>
<name>Schneier et al.</name>
<date>19980600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00044">
<document-id>
<country>US</country>
<doc-number>5771354</doc-number>
<kind>A</kind>
<name>Crawford</name>
<date>19980600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00045">
<document-id>
<country>US</country>
<doc-number>5774870</doc-number>
<kind>A</kind>
<name>Storey</name>
<date>19980600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00046">
<document-id>
<country>US</country>
<doc-number>5793839</doc-number>
<kind>A</kind>
<name>Farris et al.</name>
<date>19980800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00047">
<document-id>
<country>US</country>
<doc-number>5802592</doc-number>
<kind>A</kind>
<name>Chess et al.</name>
<date>19980900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00048">
<document-id>
<country>US</country>
<doc-number>5825883</doc-number>
<kind>A</kind>
<name>Archibald et al.</name>
<date>19981000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00049">
<document-id>
<country>US</country>
<doc-number>5841865</doc-number>
<kind>A</kind>
<name>Sudia</name>
<date>19981100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00050">
<document-id>
<country>US</country>
<doc-number>5844986</doc-number>
<kind>A</kind>
<name>Davis</name>
<date>19981200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00051">
<document-id>
<country>US</country>
<doc-number>5845065</doc-number>
<kind>A</kind>
<name>Conte et al.</name>
<date>19981200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00052">
<document-id>
<country>US</country>
<doc-number>5875236</doc-number>
<kind>A</kind>
<name>Jankowitz et al.</name>
<date>19990200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00053">
<document-id>
<country>US</country>
<doc-number>5883670</doc-number>
<kind>A</kind>
<name>Sporer et al.</name>
<date>19990300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00054">
<document-id>
<country>US</country>
<doc-number>5892906</doc-number>
<kind>A</kind>
<name>Chou et al.</name>
<date>19990400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00055">
<document-id>
<country>US</country>
<doc-number>5925127</doc-number>
<kind>A</kind>
<name>Ahmad</name>
<date>19990700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00056">
<document-id>
<country>US</country>
<doc-number>5948061</doc-number>
<kind>A</kind>
<name>Merriman</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00057">
<document-id>
<country>US</country>
<doc-number>5953502</doc-number>
<kind>A</kind>
<name>Helbig et al.</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00058">
<document-id>
<country>US</country>
<doc-number>5956408</doc-number>
<kind>A</kind>
<name>Arnold</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00059">
<document-id>
<country>US</country>
<doc-number>5983238</doc-number>
<kind>A</kind>
<name>Becker et al.</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00060">
<document-id>
<country>US</country>
<doc-number>5994710</doc-number>
<kind>A</kind>
<name>Knee et al.</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00061">
<document-id>
<country>US</country>
<doc-number>6021438</doc-number>
<kind>A</kind>
<name>Duvvoori</name>
<date>20000200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00062">
<document-id>
<country>US</country>
<doc-number>6026293</doc-number>
<kind>A</kind>
<name>Osborn</name>
<date>20000200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00063">
<document-id>
<country>US</country>
<doc-number>6049789</doc-number>
<kind>A</kind>
<name>Frison et al.</name>
<date>20000400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00064">
<document-id>
<country>US</country>
<doc-number>6061794</doc-number>
<kind>A</kind>
<name>Angelo et al.</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00065">
<document-id>
<country>US</country>
<doc-number>6078909</doc-number>
<kind>A</kind>
<name>Knutson</name>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00066">
<document-id>
<country>US</country>
<doc-number>6101606</doc-number>
<kind>A</kind>
<name>Diersch et al.</name>
<date>20000800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00067">
<document-id>
<country>US</country>
<doc-number>6119229</doc-number>
<kind>A</kind>
<name>Martinez et al.</name>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00068">
<document-id>
<country>US</country>
<doc-number>6147773</doc-number>
<kind>A</kind>
<name>Taylor</name>
<date>20001100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00069">
<document-id>
<country>US</country>
<doc-number>6148417</doc-number>
<kind>A</kind>
<name>Da Silva</name>
<date>20001100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00070">
<document-id>
<country>US</country>
<doc-number>6158657</doc-number>
<kind>A</kind>
<name>Hall, III et al.</name>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00071">
<document-id>
<country>US</country>
<doc-number>6185678</doc-number>
<kind>B1</kind>
<name>Arbaugh et al.</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00072">
<document-id>
<country>US</country>
<doc-number>6188995</doc-number>
<kind>B1</kind>
<name>Garst et al.</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 59</main-classification></classification-national>
</citation>
<citation>
<patcit num="00073">
<document-id>
<country>US</country>
<doc-number>6189146</doc-number>
<kind>B1</kind>
<name>Misra et al.</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00074">
<document-id>
<country>US</country>
<doc-number>6192392</doc-number>
<kind>B1</kind>
<name>Ginter</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709203</main-classification></classification-national>
</citation>
<citation>
<patcit num="00075">
<document-id>
<country>US</country>
<doc-number>6219652</doc-number>
<kind>B1</kind>
<name>Carter et al.</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00076">
<document-id>
<country>US</country>
<doc-number>6223291</doc-number>
<kind>B1</kind>
<name>Puhl</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00077">
<document-id>
<country>US</country>
<doc-number>6226747</doc-number>
<kind>B1</kind>
<name>Larsson et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00078">
<document-id>
<country>US</country>
<doc-number>6230185</doc-number>
<kind>B1</kind>
<name>Salas et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00079">
<document-id>
<country>US</country>
<doc-number>6233600</doc-number>
<kind>B1</kind>
<name>Salas et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00080">
<document-id>
<country>US</country>
<doc-number>6233685</doc-number>
<kind>B1</kind>
<name>Smith et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00081">
<document-id>
<country>US</country>
<doc-number>6243439</doc-number>
<kind>B1</kind>
<name>Arai et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00082">
<document-id>
<country>US</country>
<doc-number>6253224</doc-number>
<kind>B1</kind>
<name>Brice, Jr. et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00083">
<document-id>
<country>US</country>
<doc-number>6263431</doc-number>
<kind>B1</kind>
<name>Lovelace et al.</name>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00084">
<document-id>
<country>US</country>
<doc-number>6272469</doc-number>
<kind>B1</kind>
<name>Koritzinsky et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00085">
<document-id>
<country>US</country>
<doc-number>6279111</doc-number>
<kind>B1</kind>
<name>Jensenworth et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00086">
<document-id>
<country>US</country>
<doc-number>6279156</doc-number>
<kind>B1</kind>
<name>Amberg et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00087">
<document-id>
<country>US</country>
<doc-number>6286051</doc-number>
<kind>B1</kind>
<name>Becker et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00088">
<document-id>
<country>US</country>
<doc-number>6289319</doc-number>
<kind>B1</kind>
<name>Lockwood et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00089">
<document-id>
<country>US</country>
<doc-number>6295577</doc-number>
<kind>B1</kind>
<name>Anderson et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00090">
<document-id>
<country>US</country>
<doc-number>6303924</doc-number>
<kind>B1</kind>
<name>Adan et al.</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00091">
<document-id>
<country>US</country>
<doc-number>6314408</doc-number>
<kind>B1</kind>
<name>Salas et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00092">
<document-id>
<country>US</country>
<doc-number>6314409</doc-number>
<kind>B2</kind>
<name>Schneck et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00093">
<document-id>
<country>US</country>
<doc-number>6321335</doc-number>
<kind>B1</kind>
<name>Chu</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00094">
<document-id>
<country>US</country>
<doc-number>6327652</doc-number>
<kind>B1</kind>
<name>England et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713  2</main-classification></classification-national>
</citation>
<citation>
<patcit num="00095">
<document-id>
<country>US</country>
<doc-number>6330670</doc-number>
<kind>B1</kind>
<name>England et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713  2</main-classification></classification-national>
</citation>
<citation>
<patcit num="00096">
<document-id>
<country>US</country>
<doc-number>6334189</doc-number>
<kind>B1</kind>
<name>Granger et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00097">
<document-id>
<country>US</country>
<doc-number>6345294</doc-number>
<kind>B1</kind>
<name>O'Toole et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00098">
<document-id>
<country>US</country>
<doc-number>6363488</doc-number>
<kind>B1</kind>
<name>Ginter et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00099">
<document-id>
<country>US</country>
<doc-number>6367017</doc-number>
<kind>B1</kind>
<name>Gray</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00100">
<document-id>
<country>US</country>
<doc-number>6373047</doc-number>
<kind>B1</kind>
<name>Adan et al.</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00101">
<document-id>
<country>US</country>
<doc-number>6385727</doc-number>
<kind>B1</kind>
<name>Cassagnol et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00102">
<document-id>
<country>US</country>
<doc-number>6405923</doc-number>
<kind>B1</kind>
<name>Seysen</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00103">
<document-id>
<country>US</country>
<doc-number>6408170</doc-number>
<kind>B1</kind>
<name>Schmidt et al.</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00104">
<document-id>
<country>US</country>
<doc-number>6411941</doc-number>
<kind>B1</kind>
<name>Mullor et al.</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00105">
<document-id>
<country>US</country>
<doc-number>6424714</doc-number>
<kind>B1</kind>
<name>Wasilewski et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00106">
<document-id>
<country>US</country>
<doc-number>6441813</doc-number>
<kind>B1</kind>
<name>Ishibashi</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00107">
<document-id>
<country>US</country>
<doc-number>6442529</doc-number>
<kind>B1</kind>
<name>Krishan et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00108">
<document-id>
<country>US</country>
<doc-number>6442690</doc-number>
<kind>B1</kind>
<name>Howard, Jr. et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00109">
<document-id>
<country>US</country>
<doc-number>6460140</doc-number>
<kind>B1</kind>
<name>Schoch et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00110">
<document-id>
<country>US</country>
<doc-number>6463534</doc-number>
<kind>B1</kind>
<name>Geiger et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00111">
<document-id>
<country>US</country>
<doc-number>6496858</doc-number>
<kind>B1</kind>
<name>Frailong et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00112">
<document-id>
<country>US</country>
<doc-number>6567793</doc-number>
<kind>B1</kind>
<name>Hicks et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00113">
<document-id>
<country>US</country>
<doc-number>6571216</doc-number>
<kind>B1</kind>
<name>Garg et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00114">
<document-id>
<country>US</country>
<doc-number>6585158</doc-number>
<kind>B2</kind>
<name>Norskog</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00115">
<document-id>
<country>US</country>
<doc-number>6587684</doc-number>
<kind>B1</kind>
<name>Hsu et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00116">
<document-id>
<country>US</country>
<doc-number>6609201</doc-number>
<kind>B1</kind>
<name>Folmsbee</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00117">
<document-id>
<country>US</country>
<doc-number>6625729</doc-number>
<kind>B1</kind>
<name>Angelo</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00118">
<document-id>
<country>US</country>
<doc-number>6631478</doc-number>
<kind>B1</kind>
<name>Wang et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00119">
<document-id>
<country>US</country>
<doc-number>6646244</doc-number>
<kind>B2</kind>
<name>Aas et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00120">
<document-id>
<country>US</country>
<doc-number>6664948</doc-number>
<kind>B2</kind>
<name>Crane et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00121">
<document-id>
<country>US</country>
<doc-number>6671803</doc-number>
<kind>B1</kind>
<name>Pasieka</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00122">
<document-id>
<country>US</country>
<doc-number>6678828</doc-number>
<kind>B1</kind>
<name>Pham et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00123">
<document-id>
<country>US</country>
<doc-number>6690556</doc-number>
<kind>B2</kind>
<name>Smola et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00124">
<document-id>
<country>US</country>
<doc-number>6694000</doc-number>
<kind>B2</kind>
<name>Ung et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00125">
<document-id>
<country>US</country>
<doc-number>6704873</doc-number>
<kind>B1</kind>
<name>Underwood</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00126">
<document-id>
<country>US</country>
<doc-number>6708176</doc-number>
<kind>B2</kind>
<name>Strunk et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00127">
<document-id>
<country>US</country>
<doc-number>6716652</doc-number>
<kind>B1</kind>
<name>Ortlieb</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00128">
<document-id>
<country>US</country>
<doc-number>6738810</doc-number>
<kind>B1</kind>
<name>Kramer et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00129">
<document-id>
<country>US</country>
<doc-number>6763458</doc-number>
<kind>B1</kind>
<name>Watanabe</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00130">
<document-id>
<country>US</country>
<doc-number>6791157</doc-number>
<kind>B1</kind>
<name>Casto et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00131">
<document-id>
<country>US</country>
<doc-number>6816809</doc-number>
<kind>B2</kind>
<name>Circenis</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00132">
<document-id>
<country>US</country>
<doc-number>6816900</doc-number>
<kind>B1</kind>
<name>Vogel et al.</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00133">
<document-id>
<country>US</country>
<doc-number>6834352</doc-number>
<kind>B2</kind>
<name>Shin</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00134">
<document-id>
<country>US</country>
<doc-number>6839841</doc-number>
<kind>B1</kind>
<name>Medvinsky et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00135">
<document-id>
<country>US</country>
<doc-number>6844871</doc-number>
<kind>B1</kind>
<name>Hinckley et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00136">
<document-id>
<country>US</country>
<doc-number>6847942</doc-number>
<kind>B1</kind>
<name>Land et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00137">
<document-id>
<country>US</country>
<doc-number>6851051</doc-number>
<kind>B1</kind>
<name>Bolle et al.</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00138">
<document-id>
<country>US</country>
<doc-number>6868433</doc-number>
<kind>B1</kind>
<name>Philyaw</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00139">
<document-id>
<country>US</country>
<doc-number>6871283</doc-number>
<kind>B1</kind>
<name>Zurko et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00140">
<document-id>
<country>US</country>
<doc-number>6920567</doc-number>
<kind>B1</kind>
<name>Doherty et al.</name>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00141">
<document-id>
<country>US</country>
<doc-number>6934942</doc-number>
<kind>B1</kind>
<name>Chilimbi</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00142">
<document-id>
<country>US</country>
<doc-number>6954728</doc-number>
<kind>B1</kind>
<name>Kusumoto et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00143">
<document-id>
<country>US</country>
<doc-number>6957186</doc-number>
<kind>B1</kind>
<name>Guheen et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705323</main-classification></classification-national>
</citation>
<citation>
<patcit num="00144">
<document-id>
<country>US</country>
<doc-number>6976162</doc-number>
<kind>B1</kind>
<name>Ellison et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00145">
<document-id>
<country>US</country>
<doc-number>6983050</doc-number>
<kind>B1</kind>
<name>Yacobi et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00146">
<document-id>
<country>US</country>
<doc-number>6986042</doc-number>
<kind>B2</kind>
<name>Griffin</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00147">
<document-id>
<country>US</country>
<doc-number>6990174</doc-number>
<kind>B2</kind>
<name>Eskelinen</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00148">
<document-id>
<country>US</country>
<doc-number>6993648</doc-number>
<kind>B2</kind>
<name>Goodman et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00149">
<document-id>
<country>US</country>
<doc-number>7000100</doc-number>
<kind>B2</kind>
<name>Lacombe et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00150">
<document-id>
<country>US</country>
<doc-number>7000829</doc-number>
<kind>B1</kind>
<name>Harris et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00151">
<document-id>
<country>US</country>
<doc-number>7013384</doc-number>
<kind>B2</kind>
<name>Challener et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00152">
<document-id>
<country>US</country>
<doc-number>7028149</doc-number>
<kind>B2</kind>
<name>Grawrock et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00153">
<document-id>
<country>US</country>
<doc-number>7052530</doc-number>
<kind>B2</kind>
<name>Edlund et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00154">
<document-id>
<country>US</country>
<doc-number>7054468</doc-number>
<kind>B2</kind>
<name>Yang</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00155">
<document-id>
<country>US</country>
<doc-number>7069442</doc-number>
<kind>B2</kind>
<name>Sutton, II</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00156">
<document-id>
<country>US</country>
<doc-number>7069595</doc-number>
<kind>B2</kind>
<name>Cognigni et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00157">
<document-id>
<country>US</country>
<doc-number>7076652</doc-number>
<kind>B2</kind>
<name>Ginter et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00158">
<document-id>
<country>US</country>
<doc-number>7096469</doc-number>
<kind>B1</kind>
<name>Kubala et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00159">
<document-id>
<country>US</country>
<doc-number>7097357</doc-number>
<kind>B2</kind>
<name>Johnson et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00160">
<document-id>
<country>US</country>
<doc-number>7103574</doc-number>
<kind>B1</kind>
<name>Peinado et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00161">
<document-id>
<country>US</country>
<doc-number>7113912</doc-number>
<kind>B2</kind>
<name>Stefik</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00162">
<document-id>
<country>US</country>
<doc-number>7117183</doc-number>
<kind>B2</kind>
<name>Blair et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00163">
<document-id>
<country>US</country>
<doc-number>7121460</doc-number>
<kind>B1</kind>
<name>Parsons et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00164">
<document-id>
<country>US</country>
<doc-number>7127579</doc-number>
<kind>B2</kind>
<name>Zimmer et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00165">
<document-id>
<country>US</country>
<doc-number>7130951</doc-number>
<kind>B1</kind>
<name>Christie et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00166">
<document-id>
<country>US</country>
<doc-number>7143297</doc-number>
<kind>B2</kind>
<name>Buchheit et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00167">
<document-id>
<country>US</country>
<doc-number>7162645</doc-number>
<kind>B2</kind>
<name>Iguchi et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00168">
<document-id>
<country>US</country>
<doc-number>7171539</doc-number>
<kind>B2</kind>
<name>Mansell et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00169">
<document-id>
<country>US</country>
<doc-number>7174457</doc-number>
<kind>B1</kind>
<name>England et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00170">
<document-id>
<country>US</country>
<doc-number>7207039</doc-number>
<kind>B2</kind>
<name>Komarla et al.</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00171">
<document-id>
<country>US</country>
<doc-number>7234144</doc-number>
<kind>B2</kind>
<name>Wilt et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00172">
<document-id>
<country>US</country>
<doc-number>7236455</doc-number>
<kind>B1</kind>
<name>Proudler et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00173">
<document-id>
<country>US</country>
<doc-number>7669056</doc-number>
<kind>B2</kind>
<name>Frank</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00174">
<document-id>
<country>US</country>
<doc-number>7266569</doc-number>
<kind>B2</kind>
<name>Cutter et al.</name>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00175">
<document-id>
<country>US</country>
<doc-number>7299358</doc-number>
<kind>B2</kind>
<name>Chateau et al.</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00176">
<document-id>
<country>US</country>
<doc-number>7353402</doc-number>
<kind>B2</kind>
<name>Bourne et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00177">
<document-id>
<country>US</country>
<doc-number>7356709</doc-number>
<kind>B2</kind>
<name>Gunyakti et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00178">
<document-id>
<country>US</country>
<doc-number>7359807</doc-number>
<kind>B2</kind>
<name>Frank et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00179">
<document-id>
<country>US</country>
<doc-number>7360253</doc-number>
<kind>B2</kind>
<name>Frank et al.</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00180">
<document-id>
<country>US</country>
<doc-number>7392429</doc-number>
<kind>B2</kind>
<name>Westeronen et al.</name>
<date>20080600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00181">
<document-id>
<country>US</country>
<doc-number>7395245</doc-number>
<kind>B2</kind>
<name>Okamoto et al.</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00182">
<document-id>
<country>US</country>
<doc-number>7395452</doc-number>
<kind>B2</kind>
<name>Nicholson et al.</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00183">
<document-id>
<country>US</country>
<doc-number>7406446</doc-number>
<kind>B2</kind>
<name>Frank et al.</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00184">
<document-id>
<country>US</country>
<doc-number>7421413</doc-number>
<kind>B2</kind>
<name>Frank et al.</name>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00185">
<document-id>
<country>US</country>
<doc-number>7441121</doc-number>
<kind>B2</kind>
<name>Cutter, Jr. et al.</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00186">
<document-id>
<country>US</country>
<doc-number>7441246</doc-number>
<kind>B2</kind>
<name>Auerbach et al.</name>
<date>20081000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>719310</main-classification></classification-national>
</citation>
<citation>
<patcit num="00187">
<document-id>
<country>US</country>
<doc-number>7461249</doc-number>
<kind>B1</kind>
<name>Pearson et al.</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713156</main-classification></classification-national>
</citation>
<citation>
<patcit num="00188">
<document-id>
<country>US</country>
<doc-number>7464103</doc-number>
<kind>B2</kind>
<name>Siu</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00189">
<document-id>
<country>US</country>
<doc-number>7490356</doc-number>
<kind>B2</kind>
<name>Lieblich et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00190">
<document-id>
<country>US</country>
<doc-number>7493487</doc-number>
<kind>B2</kind>
<name>Phillips et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00191">
<document-id>
<country>US</country>
<doc-number>7494277</doc-number>
<kind>B2</kind>
<name>Setala</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00192">
<document-id>
<country>US</country>
<doc-number>7519816</doc-number>
<kind>B2</kind>
<name>Phillips et al.</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00193">
<document-id>
<country>US</country>
<doc-number>7539863</doc-number>
<kind>B2</kind>
<name>Phillips et al.</name>
<date>20090500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00194">
<document-id>
<country>US</country>
<doc-number>7549060</doc-number>
<kind>B2</kind>
<name>Bourne et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00195">
<document-id>
<country>US</country>
<doc-number>7562220</doc-number>
<kind>B2</kind>
<name>Frank et al.</name>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00196">
<document-id>
<country>US</country>
<doc-number>7565325</doc-number>
<kind>B2</kind>
<name>Lenard</name>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00197">
<document-id>
<country>US</country>
<doc-number>7568096</doc-number>
<kind>B2</kind>
<name>Evans</name>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00198">
<document-id>
<country>US</country>
<doc-number>7596784</doc-number>
<kind>B2</kind>
<name>Abrams</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00199">
<document-id>
<country>US</country>
<doc-number>7610631</doc-number>
<kind>B2</kind>
<name>Frank et al.</name>
<date>20091000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00200">
<document-id>
<country>US</country>
<doc-number>7644239</doc-number>
<kind>B2</kind>
<name>Westerinen et al.</name>
<date>20100100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00201">
<document-id>
<country>US</country>
<doc-number>7694153</doc-number>
<kind>B2</kind>
<name>Ahdout</name>
<date>20100400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00202">
<document-id>
<country>US</country>
<doc-number>7770205</doc-number>
<kind>B2</kind>
<name>Frank</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00203">
<document-id>
<country>US</country>
<doc-number>7814532</doc-number>
<kind>B2</kind>
<name>Cromer et al.</name>
<date>20101000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00204">
<document-id>
<country>US</country>
<doc-number>7877607</doc-number>
<kind>B2</kind>
<name>Circenis</name>
<date>20110100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00205">
<document-id>
<country>US</country>
<doc-number>7669056</doc-number>
<kind>C1</kind>
<name>Frank et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00206">
<document-id>
<country>US</country>
<doc-number>7891007</doc-number>
<kind>B2</kind>
<name>Waxman et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00207">
<document-id>
<country>US</country>
<doc-number>7958029</doc-number>
<kind>B1</kind>
<name>Bobich et al.</name>
<date>20110600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00208">
<document-id>
<country>US</country>
<doc-number>7979721</doc-number>
<kind>B2</kind>
<name>Westerinen et al.</name>
<date>20110700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00209">
<document-id>
<country>US</country>
<doc-number>2001/0034711</doc-number>
<kind>A1</kind>
<name>Tashenberg</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00210">
<document-id>
<country>US</country>
<doc-number>2001/0056413</doc-number>
<kind>A1</kind>
<name>Suzuki et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00211">
<document-id>
<country>US</country>
<doc-number>2001/0056539</doc-number>
<kind>A1</kind>
<name>Pavlin et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00212">
<document-id>
<country>US</country>
<doc-number>2002/0002597</doc-number>
<kind>A1</kind>
<name>Morrell, Jr.</name>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00213">
<document-id>
<country>US</country>
<doc-number>2002/0007310</doc-number>
<kind>A1</kind>
<name>Long</name>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00214">
<document-id>
<country>US</country>
<doc-number>2002/0023212</doc-number>
<kind>A1</kind>
<name>Proudler</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00215">
<document-id>
<country>US</country>
<doc-number>2002/0046098</doc-number>
<kind>A1</kind>
<name>Maggio</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00216">
<document-id>
<country>US</country>
<doc-number>2002/0055906</doc-number>
<kind>A1</kind>
<name>Katz et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00217">
<document-id>
<country>US</country>
<doc-number>2002/0091569</doc-number>
<kind>A1</kind>
<name>Kitaura et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00218">
<document-id>
<country>US</country>
<doc-number>2002/0107701</doc-number>
<kind>A1</kind>
<name>Batty et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00219">
<document-id>
<country>US</country>
<doc-number>2002/0111916</doc-number>
<kind>A1</kind>
<name>Coronna et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00220">
<document-id>
<country>US</country>
<doc-number>2002/0112171</doc-number>
<kind>A1</kind>
<name>Ginter et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00221">
<document-id>
<country>US</country>
<doc-number>2002/0123964</doc-number>
<kind>A1</kind>
<name>Kramer et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00222">
<document-id>
<country>US</country>
<doc-number>2002/0124212</doc-number>
<kind>A1</kind>
<name>Nitschke et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00223">
<document-id>
<country>US</country>
<doc-number>2002/0129359</doc-number>
<kind>A1</kind>
<name>Lichner</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00224">
<document-id>
<country>US</country>
<doc-number>2002/0138549</doc-number>
<kind>A1</kind>
<name>Urien</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00225">
<document-id>
<country>US</country>
<doc-number>2002/0141451</doc-number>
<kind>A1</kind>
<name>Gates et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00226">
<document-id>
<country>US</country>
<doc-number>2002/0144131</doc-number>
<kind>A1</kind>
<name>Spacey</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00227">
<document-id>
<country>US</country>
<doc-number>2002/0147601</doc-number>
<kind>A1</kind>
<name>Fagan</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00228">
<document-id>
<country>US</country>
<doc-number>2002/0147782</doc-number>
<kind>A1</kind>
<name>Dimitrova et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00229">
<document-id>
<country>US</country>
<doc-number>2002/0147912</doc-number>
<kind>A1</kind>
<name>Shmueli et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00230">
<document-id>
<country>US</country>
<doc-number>2002/0178071</doc-number>
<kind>A1</kind>
<name>Walker et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00231">
<document-id>
<country>US</country>
<doc-number>2002/0184482</doc-number>
<kind>A1</kind>
<name>Lacombe et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00232">
<document-id>
<country>US</country>
<doc-number>2002/0184508</doc-number>
<kind>A1</kind>
<name>Bialick et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00233">
<document-id>
<country>US</country>
<doc-number>2002/0193101</doc-number>
<kind>A1</kind>
<name>McAlinden</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00234">
<document-id>
<country>US</country>
<doc-number>2002/0194132</doc-number>
<kind>A1</kind>
<name>Pearson et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00235">
<document-id>
<country>US</country>
<doc-number>2003/0005135</doc-number>
<kind>A1</kind>
<name>Inoue et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00236">
<document-id>
<country>US</country>
<doc-number>2003/0014323</doc-number>
<kind>A1</kind>
<name>Scheer</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00237">
<document-id>
<country>US</country>
<doc-number>2003/0027549</doc-number>
<kind>A1</kind>
<name>Kiel et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00238">
<document-id>
<country>US</country>
<doc-number>2003/0028454</doc-number>
<kind>A1</kind>
<name>Ooho et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00239">
<document-id>
<country>US</country>
<doc-number>2003/0035409</doc-number>
<kind>A1</kind>
<name>Wang et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00240">
<document-id>
<country>US</country>
<doc-number>2003/0037246</doc-number>
<kind>A1</kind>
<name>Goodman et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00241">
<document-id>
<country>US</country>
<doc-number>2003/0040960</doc-number>
<kind>A1</kind>
<name>Eckmann</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00242">
<document-id>
<country>US</country>
<doc-number>2003/0046026</doc-number>
<kind>A1</kind>
<name>Levy et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00243">
<document-id>
<country>US</country>
<doc-number>2003/0048473</doc-number>
<kind>A1</kind>
<name>Rosen</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00244">
<document-id>
<country>US</country>
<doc-number>2003/0056107</doc-number>
<kind>A1</kind>
<name>Cammack et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00245">
<document-id>
<country>US</country>
<doc-number>2003/0084278</doc-number>
<kind>A1</kind>
<name>Cromer et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00246">
<document-id>
<country>US</country>
<doc-number>2003/0084285</doc-number>
<kind>A1</kind>
<name>Cromer et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00247">
<document-id>
<country>US</country>
<doc-number>2003/0084337</doc-number>
<kind>A1</kind>
<name>Simionescu et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00248">
<document-id>
<country>US</country>
<doc-number>2003/0084352</doc-number>
<kind>A1</kind>
<name>Schwartz et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00249">
<document-id>
<country>US</country>
<doc-number>2003/0088500</doc-number>
<kind>A1</kind>
<name>Shinohara et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00250">
<document-id>
<country>US</country>
<doc-number>2003/0093694</doc-number>
<kind>A1</kind>
<name>Medvinsky et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00251">
<document-id>
<country>US</country>
<doc-number>2003/0097596</doc-number>
<kind>A1</kind>
<name>Muratov et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00252">
<document-id>
<country>US</country>
<doc-number>2003/0110388</doc-number>
<kind>A1</kind>
<name>Pavlin et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00253">
<document-id>
<country>US</country>
<doc-number>2003/0115458</doc-number>
<kind>A1</kind>
<name>Song</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00254">
<document-id>
<country>US</country>
<doc-number>2003/0126519</doc-number>
<kind>A1</kind>
<name>Odorcic</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00255">
<document-id>
<country>US</country>
<doc-number>2003/0131252</doc-number>
<kind>A1</kind>
<name>Barton et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00256">
<document-id>
<country>US</country>
<doc-number>2003/0135380</doc-number>
<kind>A1</kind>
<name>Lehr et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00257">
<document-id>
<country>US</country>
<doc-number>2003/0149671</doc-number>
<kind>A1</kind>
<name>Yamamoto et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00258">
<document-id>
<country>US</country>
<doc-number>2003/0156572</doc-number>
<kind>A1</kind>
<name>Hui et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00259">
<document-id>
<country>US</country>
<doc-number>2003/0156719</doc-number>
<kind>A1</kind>
<name>Cronce</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00260">
<document-id>
<country>US</country>
<doc-number>2003/0163383</doc-number>
<kind>A1</kind>
<name>Engelhart</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00261">
<document-id>
<country>US</country>
<doc-number>2003/0163712</doc-number>
<kind>A1</kind>
<name>LaMothe et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00262">
<document-id>
<country>US</country>
<doc-number>2003/0172376</doc-number>
<kind>A1</kind>
<name>Coffin, III et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00263">
<document-id>
<country>US</country>
<doc-number>2003/0185395</doc-number>
<kind>A1</kind>
<name>Lee et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00264">
<document-id>
<country>US</country>
<doc-number>2003/0188165</doc-number>
<kind>A1</kind>
<name>Sutton et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00265">
<document-id>
<country>US</country>
<doc-number>2003/0196102</doc-number>
<kind>A1</kind>
<name>McCarroll</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00266">
<document-id>
<country>US</country>
<doc-number>2003/0196106</doc-number>
<kind>A1</kind>
<name>Erfani et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00267">
<document-id>
<country>US</country>
<doc-number>2003/0208338</doc-number>
<kind>A1</kind>
<name>Challener et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00268">
<document-id>
<country>US</country>
<doc-number>2003/0208573</doc-number>
<kind>A1</kind>
<name>Harrison et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00269">
<document-id>
<country>US</country>
<doc-number>2003/0229702</doc-number>
<kind>A1</kind>
<name>Hensbergen et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00270">
<document-id>
<country>US</country>
<doc-number>2004/0001088</doc-number>
<kind>A1</kind>
<name>Stancil et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00271">
<document-id>
<country>US</country>
<doc-number>2004/0003190</doc-number>
<kind>A1</kind>
<name>Childs et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00272">
<document-id>
<country>US</country>
<doc-number>2004/0003288</doc-number>
<kind>A1</kind>
<name>Wiseman et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00273">
<document-id>
<country>US</country>
<doc-number>2004/0010440</doc-number>
<kind>A1</kind>
<name>Lenard et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00274">
<document-id>
<country>US</country>
<doc-number>2004/0019456</doc-number>
<kind>A1</kind>
<name>Cirenis</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00275">
<document-id>
<country>US</country>
<doc-number>2004/0023636</doc-number>
<kind>A1</kind>
<name>Gurel et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00276">
<document-id>
<country>US</country>
<doc-number>2004/0030912</doc-number>
<kind>A1</kind>
<name>Merkle, Jr. et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00277">
<document-id>
<country>US</country>
<doc-number>2004/0034816</doc-number>
<kind>A1</kind>
<name>Richard</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00278">
<document-id>
<country>US</country>
<doc-number>2004/0039916</doc-number>
<kind>A1</kind>
<name>Aldis et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00279">
<document-id>
<country>US</country>
<doc-number>2004/0039924</doc-number>
<kind>A1</kind>
<name>Baldwin et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00280">
<document-id>
<country>US</country>
<doc-number>2004/0039960</doc-number>
<kind>A1</kind>
<name>Kassayan</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00281">
<document-id>
<country>US</country>
<doc-number>2004/0044629</doc-number>
<kind>A1</kind>
<name>Rhodes et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00282">
<document-id>
<country>US</country>
<doc-number>2004/0054907</doc-number>
<kind>A1</kind>
<name>Chateau et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00283">
<document-id>
<country>US</country>
<doc-number>2004/0054908</doc-number>
<kind>A1</kind>
<name>Circenis et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00284">
<document-id>
<country>US</country>
<doc-number>2004/0054909</doc-number>
<kind>A1</kind>
<name>Serkowski et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00285">
<document-id>
<country>US</country>
<doc-number>2004/0059937</doc-number>
<kind>A1</kind>
<name>Nakano</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00286">
<document-id>
<country>US</country>
<doc-number>2004/0064707</doc-number>
<kind>A1</kind>
<name>McCann et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00287">
<document-id>
<country>US</country>
<doc-number>2004/0067746</doc-number>
<kind>A1</kind>
<name>Johnson</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00288">
<document-id>
<country>US</country>
<doc-number>2004/0073670</doc-number>
<kind>A1</kind>
<name>Chack et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00289">
<document-id>
<country>US</country>
<doc-number>2004/0088548</doc-number>
<kind>A1</kind>
<name>Smetters et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00290">
<document-id>
<country>US</country>
<doc-number>2004/0093371</doc-number>
<kind>A1</kind>
<name>Burrows et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00291">
<document-id>
<country>US</country>
<doc-number>2004/0093508</doc-number>
<kind>A1</kind>
<name>Foerstner et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00292">
<document-id>
<country>US</country>
<doc-number>2004/0107359</doc-number>
<kind>A1</kind>
<name>Kawano et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00293">
<document-id>
<country>US</country>
<doc-number>2004/0107368</doc-number>
<kind>A1</kind>
<name>Colvin</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00294">
<document-id>
<country>US</country>
<doc-number>2004/0123127</doc-number>
<kind>A1</kind>
<name>Teicher et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00295">
<document-id>
<country>US</country>
<doc-number>2004/0125755</doc-number>
<kind>A1</kind>
<name>Roberts</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00296">
<document-id>
<country>US</country>
<doc-number>2004/0128251</doc-number>
<kind>A1</kind>
<name>Adam et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00297">
<document-id>
<country>US</country>
<doc-number>2004/0133794</doc-number>
<kind>A1</kind>
<name>Kocher et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713193</main-classification></classification-national>
</citation>
<citation>
<patcit num="00298">
<document-id>
<country>US</country>
<doc-number>2004/0139027</doc-number>
<kind>A1</kind>
<name>Molaro</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00299">
<document-id>
<country>US</country>
<doc-number>2004/0193919</doc-number>
<kind>A1</kind>
<name>Dabbish et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00300">
<document-id>
<country>US</country>
<doc-number>2004/0199769</doc-number>
<kind>A1</kind>
<name>Proudler</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00301">
<document-id>
<country>US</country>
<doc-number>2004/0220858</doc-number>
<kind>A1</kind>
<name>Maggio</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00302">
<document-id>
<country>US</country>
<doc-number>2004/0225894</doc-number>
<kind>A1</kind>
<name>Colvin</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00303">
<document-id>
<country>US</country>
<doc-number>2004/0255000</doc-number>
<kind>A1</kind>
<name>Simionescu et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00304">
<document-id>
<country>US</country>
<doc-number>2004/0268120</doc-number>
<kind>A1</kind>
<name>Mirtal et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00305">
<document-id>
<country>US</country>
<doc-number>2005/0015343</doc-number>
<kind>A1</kind>
<name>Nagai et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00306">
<document-id>
<country>US</country>
<doc-number>2005/0021944</doc-number>
<kind>A1</kind>
<name>Craft et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00307">
<document-id>
<country>US</country>
<doc-number>2005/0028000</doc-number>
<kind>A1</kind>
<name>Bulusu et al.</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00308">
<document-id>
<country>US</country>
<doc-number>2005/0033747</doc-number>
<kind>A1</kind>
<name>Wittkotter</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00309">
<document-id>
<country>US</country>
<doc-number>2005/0039013</doc-number>
<kind>A1</kind>
<name>Bajikar et al.</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00310">
<document-id>
<country>US</country>
<doc-number>2005/0044197</doc-number>
<kind>A1</kind>
<name>Lai</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00311">
<document-id>
<country>US</country>
<doc-number>2005/0050355</doc-number>
<kind>A1</kind>
<name>Graunke</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00312">
<document-id>
<country>US</country>
<doc-number>2005/0060388</doc-number>
<kind>A1</kind>
<name>Tatsumi et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00313">
<document-id>
<country>US</country>
<doc-number>2005/0065880</doc-number>
<kind>A1</kind>
<name>Amato et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00314">
<document-id>
<country>US</country>
<doc-number>2005/0080701</doc-number>
<kind>A1</kind>
<name>Tunney et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00315">
<document-id>
<country>US</country>
<doc-number>2005/0091104</doc-number>
<kind>A1</kind>
<name>Abraham</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00316">
<document-id>
<country>US</country>
<doc-number>2005/0097204</doc-number>
<kind>A1</kind>
<name>Horowitz et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00317">
<document-id>
<country>US</country>
<doc-number>2005/0102181</doc-number>
<kind>A1</kind>
<name>Scroggie et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00318">
<document-id>
<country>US</country>
<doc-number>2005/0108547</doc-number>
<kind>A1</kind>
<name>Sakai</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00319">
<document-id>
<country>US</country>
<doc-number>2005/0108564</doc-number>
<kind>A1</kind>
<name>Freeman et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00320">
<document-id>
<country>US</country>
<doc-number>2005/0120251</doc-number>
<kind>A1</kind>
<name>Fukumori</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00321">
<document-id>
<country>US</country>
<doc-number>2005/0125673</doc-number>
<kind>A1</kind>
<name>Cheng et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00322">
<document-id>
<country>US</country>
<doc-number>2005/0129296</doc-number>
<kind>A1</kind>
<name>Setala</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00323">
<document-id>
<country>US</country>
<doc-number>2005/0132150</doc-number>
<kind>A1</kind>
<name>Jewell et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00324">
<document-id>
<country>US</country>
<doc-number>2005/0138370</doc-number>
<kind>A1</kind>
<name>Goud et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00325">
<document-id>
<country>US</country>
<doc-number>2005/0138389</doc-number>
<kind>A1</kind>
<name>Catherman et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00326">
<document-id>
<country>US</country>
<doc-number>2005/0138423</doc-number>
<kind>A1</kind>
<name>Ranganathan</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00327">
<document-id>
<country>US</country>
<doc-number>2005/0141717</doc-number>
<kind>A1</kind>
<name>Cromer et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00328">
<document-id>
<country>US</country>
<doc-number>2005/0144099</doc-number>
<kind>A1</kind>
<name>Deb et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00329">
<document-id>
<country>US</country>
<doc-number>2005/0166051</doc-number>
<kind>A1</kind>
<name>Buer</name>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00330">
<document-id>
<country>US</country>
<doc-number>2005/0182921</doc-number>
<kind>A1</kind>
<name>Duncan</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00331">
<document-id>
<country>US</country>
<doc-number>2005/0182940</doc-number>
<kind>A1</kind>
<name>Sutton</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00332">
<document-id>
<country>US</country>
<doc-number>2005/0188843</doc-number>
<kind>A1</kind>
<name>Edlund et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00333">
<document-id>
<country>US</country>
<doc-number>2005/0203801</doc-number>
<kind>A1</kind>
<name>Morgenstern et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00334">
<document-id>
<country>US</country>
<doc-number>2005/0213761</doc-number>
<kind>A1</kind>
<name>Walmsley et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00335">
<document-id>
<country>US</country>
<doc-number>2005/0216577</doc-number>
<kind>A1</kind>
<name>Durham et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00336">
<document-id>
<country>US</country>
<doc-number>2005/0221766</doc-number>
<kind>A1</kind>
<name>Brizek et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00337">
<document-id>
<country>US</country>
<doc-number>2005/0235141</doc-number>
<kind>A1</kind>
<name>Ibrahim et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00338">
<document-id>
<country>US</country>
<doc-number>2005/0240533</doc-number>
<kind>A1</kind>
<name>Cutter et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00339">
<document-id>
<country>US</country>
<doc-number>2005/0246521</doc-number>
<kind>A1</kind>
<name>Bade et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00340">
<document-id>
<country>US</country>
<doc-number>2005/0246525</doc-number>
<kind>A1</kind>
<name>Bade et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00341">
<document-id>
<country>US</country>
<doc-number>2005/0246552</doc-number>
<kind>A1</kind>
<name>Bade et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00342">
<document-id>
<country>US</country>
<doc-number>2005/0257073</doc-number>
<kind>A1</kind>
<name>Bade et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00343">
<document-id>
<country>US</country>
<doc-number>2005/0275866</doc-number>
<kind>A1</kind>
<name>Corlett</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00344">
<document-id>
<country>US</country>
<doc-number>2005/0278519</doc-number>
<kind>A1</kind>
<name>Luebke et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00345">
<document-id>
<country>US</country>
<doc-number>2005/0279827</doc-number>
<kind>A1</kind>
<name>Mascavage et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00346">
<document-id>
<country>US</country>
<doc-number>2005/0286476</doc-number>
<kind>A1</kind>
<name>Crosswy et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00347">
<document-id>
<country>US</country>
<doc-number>2005/0289177</doc-number>
<kind>A1</kind>
<name>Hohmann et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707103 R</main-classification></classification-national>
</citation>
<citation>
<patcit num="00348">
<document-id>
<country>US</country>
<doc-number>2005/0289343</doc-number>
<kind>A1</kind>
<name>Tahan</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00349">
<document-id>
<country>US</country>
<doc-number>2006/0010326</doc-number>
<kind>A1</kind>
<name>Bade et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00350">
<document-id>
<country>US</country>
<doc-number>2006/0015717</doc-number>
<kind>A1</kind>
<name>Liu et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00351">
<document-id>
<country>US</country>
<doc-number>2006/0015718</doc-number>
<kind>A1</kind>
<name>Liu et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00352">
<document-id>
<country>US</country>
<doc-number>2006/0015732</doc-number>
<kind>A1</kind>
<name>Liu</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00353">
<document-id>
<country>US</country>
<doc-number>2006/0020784</doc-number>
<kind>A1</kind>
<name>Jonker et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00354">
<document-id>
<country>US</country>
<doc-number>2006/0026418</doc-number>
<kind>A1</kind>
<name>Bade</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00355">
<document-id>
<country>US</country>
<doc-number>2006/0026419</doc-number>
<kind>A1</kind>
<name>Arndt et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00356">
<document-id>
<country>US</country>
<doc-number>2006/0026422</doc-number>
<kind>A1</kind>
<name>Bade et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00357">
<document-id>
<country>US</country>
<doc-number>2006/0055506</doc-number>
<kind>A1</kind>
<name>Nicolas</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00358">
<document-id>
<country>US</country>
<doc-number>2006/0072748</doc-number>
<kind>A1</kind>
<name>Buer</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00359">
<document-id>
<country>US</country>
<doc-number>2006/0072762</doc-number>
<kind>A1</kind>
<name>Buer</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00360">
<document-id>
<country>US</country>
<doc-number>2006/0074600</doc-number>
<kind>A1</kind>
<name>Sastry et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00361">
<document-id>
<country>US</country>
<doc-number>2006/0075014</doc-number>
<kind>A1</kind>
<name>Tharappel et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00362">
<document-id>
<country>US</country>
<doc-number>2006/0075223</doc-number>
<kind>A1</kind>
<name>Bade et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00363">
<document-id>
<country>US</country>
<doc-number>2006/0085634</doc-number>
<kind>A1</kind>
<name>Jain</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00364">
<document-id>
<country>US</country>
<doc-number>2006/0085637</doc-number>
<kind>A1</kind>
<name>Pinkas</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00365">
<document-id>
<country>US</country>
<doc-number>2006/0085844</doc-number>
<kind>A1</kind>
<name>Buer et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00366">
<document-id>
<country>US</country>
<doc-number>2006/0089917</doc-number>
<kind>A1</kind>
<name>Strom et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00367">
<document-id>
<country>US</country>
<doc-number>2006/0090084</doc-number>
<kind>A1</kind>
<name>Buer</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00368">
<document-id>
<country>US</country>
<doc-number>2006/0100010</doc-number>
<kind>A1</kind>
<name>Gatto et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>463 29</main-classification></classification-national>
</citation>
<citation>
<patcit num="00369">
<document-id>
<country>US</country>
<doc-number>2006/0106845</doc-number>
<kind>A1</kind>
<name>Frank et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00370">
<document-id>
<country>US</country>
<doc-number>2006/0106920</doc-number>
<kind>A1</kind>
<name>Steeb et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00371">
<document-id>
<country>US</country>
<doc-number>2006/0107306</doc-number>
<kind>A1</kind>
<name>Thirumalai et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00372">
<document-id>
<country>US</country>
<doc-number>2006/0107328</doc-number>
<kind>A1</kind>
<name>Frank et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00373">
<document-id>
<country>US</country>
<doc-number>2006/0107335</doc-number>
<kind>A1</kind>
<name>Frank et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00374">
<document-id>
<country>US</country>
<doc-number>2006/0112267</doc-number>
<kind>A1</kind>
<name>Zimmer et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00375">
<document-id>
<country>US</country>
<doc-number>2006/0117177</doc-number>
<kind>A1</kind>
<name>Buer</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00376">
<document-id>
<country>US</country>
<doc-number>2006/0129824</doc-number>
<kind>A1</kind>
<name>Hoff et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00377">
<document-id>
<country>US</country>
<doc-number>2006/0130130</doc-number>
<kind>A1</kind>
<name>Kablotsky</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00378">
<document-id>
<country>US</country>
<doc-number>2006/0143431</doc-number>
<kind>A1</kind>
<name>Rothman</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00379">
<document-id>
<country>US</country>
<doc-number>2006/0165005</doc-number>
<kind>A1</kind>
<name>Frank et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00380">
<document-id>
<country>US</country>
<doc-number>2006/0168664</doc-number>
<kind>A1</kind>
<name>Frank et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00381">
<document-id>
<country>US</country>
<doc-number>2006/0206618</doc-number>
<kind>A1</kind>
<name>Zimmer et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00382">
<document-id>
<country>US</country>
<doc-number>2006/0213997</doc-number>
<kind>A1</kind>
<name>Frank et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00383">
<document-id>
<country>US</country>
<doc-number>2006/0282319</doc-number>
<kind>A1</kind>
<name>Maggio</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00384">
<document-id>
<country>US</country>
<doc-number>2006/0282899</doc-number>
<kind>A1</kind>
<name>Raciborski</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00385">
<document-id>
<country>US</country>
<doc-number>2007/0033102</doc-number>
<kind>A1</kind>
<name>Frank et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00386">
<document-id>
<country>US</country>
<doc-number>2007/0280422</doc-number>
<kind>A1</kind>
<name>Setala</name>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00387">
<document-id>
<country>US</country>
<doc-number>2009/0070454</doc-number>
<kind>A1</kind>
<name>McKinnon, III et al.</name>
<date>20090300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00388">
<document-id>
<country>US</country>
<doc-number>2012/0137127</doc-number>
<kind>A1</kind>
<name>Jain</name>
<date>20120500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00389">
<document-id>
<country>CN</country>
<doc-number>1531673</doc-number>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00390">
<document-id>
<country>EP</country>
<doc-number>0635790</doc-number>
<date>19950100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00391">
<document-id>
<country>EP</country>
<doc-number>0843449</doc-number>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00392">
<document-id>
<country>EP</country>
<doc-number>1061465</doc-number>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00393">
<document-id>
<country>EP</country>
<doc-number>1085396</doc-number>
<date>20010300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00394">
<document-id>
<country>EP</country>
<doc-number>1387237</doc-number>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00395">
<document-id>
<country>EP</country>
<doc-number>1429224</doc-number>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00396">
<document-id>
<country>EP</country>
<doc-number>1223722</doc-number>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00397">
<document-id>
<country>EP</country>
<doc-number>1460514</doc-number>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00398">
<document-id>
<country>EP</country>
<doc-number>1233337</doc-number>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00399">
<document-id>
<country>GB</country>
<doc-number>2359969</doc-number>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00400">
<document-id>
<country>GB</country>
<doc-number>2378780</doc-number>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00401">
<document-id>
<country>JP</country>
<doc-number>H0535461</doc-number>
<date>19930200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00402">
<document-id>
<country>JP</country>
<doc-number>H0635718</doc-number>
<date>19940200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00403">
<document-id>
<country>JP</country>
<doc-number>H07036559</doc-number>
<date>19950200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00404">
<document-id>
<country>JP</country>
<doc-number>H07141153</doc-number>
<date>19950600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00405">
<document-id>
<country>JP</country>
<doc-number>H086729</doc-number>
<date>19960100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00406">
<document-id>
<country>JP</country>
<doc-number>2001526550</doc-number>
<date>19970500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00407">
<document-id>
<country>JP</country>
<doc-number>H09185504</doc-number>
<date>19970700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00408">
<document-id>
<country>JP</country>
<doc-number>H9251494</doc-number>
<date>19970900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00409">
<document-id>
<country>JP</country>
<doc-number>2000293369</doc-number>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00410">
<document-id>
<country>JP</country>
<doc-number>2001051742</doc-number>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00411">
<document-id>
<country>JP</country>
<doc-number>2003510684</doc-number>
<date>20010300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00412">
<document-id>
<country>JP</country>
<doc-number>2001101033</doc-number>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00413">
<document-id>
<country>JP</country>
<doc-number>2003510713</doc-number>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00414">
<document-id>
<country>JP</country>
<doc-number>2001184472</doc-number>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00415">
<document-id>
<country>JP</country>
<doc-number>2001312325</doc-number>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00416">
<document-id>
<country>JP</country>
<doc-number>2001331229</doc-number>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00417">
<document-id>
<country>JP</country>
<doc-number>2001338233</doc-number>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00418">
<document-id>
<country>JP</country>
<doc-number>2002108478</doc-number>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00419">
<document-id>
<country>JP</country>
<doc-number>2002108870</doc-number>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00420">
<document-id>
<country>JP</country>
<doc-number>2002374327</doc-number>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00421">
<document-id>
<country>JP</country>
<doc-number>2003507785</doc-number>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00422">
<document-id>
<country>JP</country>
<doc-number>2003140761</doc-number>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00423">
<document-id>
<country>JP</country>
<doc-number>2003140762</doc-number>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00424">
<document-id>
<country>JP</country>
<doc-number>2003157335</doc-number>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00425">
<document-id>
<country>JP</country>
<doc-number>2003208314</doc-number>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00426">
<document-id>
<country>JP</country>
<doc-number>2003248522</doc-number>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00427">
<document-id>
<country>JP</country>
<doc-number>2003296487</doc-number>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00428">
<document-id>
<country>JP</country>
<doc-number>2002182562</doc-number>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00429">
<document-id>
<country>JP</country>
<doc-number>2004062561</doc-number>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00430">
<document-id>
<country>JP</country>
<doc-number>2004118327</doc-number>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00431">
<document-id>
<country>JP</country>
<doc-number>2004164491</doc-number>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00432">
<document-id>
<country>JP</country>
<doc-number>2004295846</doc-number>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00433">
<document-id>
<country>JP</country>
<doc-number>2004304755</doc-number>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00434">
<document-id>
<country>JP</country>
<doc-number>2007525774</doc-number>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00435">
<document-id>
<country>JP</country>
<doc-number>H08-054952</doc-number>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00436">
<document-id>
<country>KR</country>
<doc-number>20010000805</doc-number>
<date>20010100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00437">
<document-id>
<country>KR</country>
<doc-number>20020037453</doc-number>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00438">
<document-id>
<country>KR</country>
<doc-number>20050008439</doc-number>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00439">
<document-id>
<country>KR</country>
<doc-number>20050021782</doc-number>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00440">
<document-id>
<country>WO</country>
<doc-number>WO-9721162</doc-number>
<date>19970600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00441">
<document-id>
<country>WO</country>
<doc-number>WO-9811478</doc-number>
<date>19980300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00442">
<document-id>
<country>WO</country>
<doc-number>WO-0054126</doc-number>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00443">
<document-id>
<country>WO</country>
<doc-number>WO-0135293</doc-number>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00444">
<document-id>
<country>WO</country>
<doc-number>WO-0145012</doc-number>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00445">
<document-id>
<country>WO</country>
<doc-number>WO-0163512</doc-number>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00446">
<document-id>
<country>WO</country>
<doc-number>WO-0177795</doc-number>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00447">
<document-id>
<country>WO</country>
<doc-number>WO-0193461</doc-number>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00448">
<document-id>
<country>WO</country>
<doc-number>WO-0208969</doc-number>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00449">
<document-id>
<country>WO</country>
<doc-number>WO-02056155</doc-number>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00450">
<document-id>
<country>WO</country>
<doc-number>WO-02103495</doc-number>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00451">
<document-id>
<country>WO</country>
<doc-number>WO-03009115</doc-number>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00452">
<document-id>
<country>WO</country>
<doc-number>WO-03030434</doc-number>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00453">
<document-id>
<country>WO</country>
<doc-number>WO-03073688</doc-number>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00454">
<document-id>
<country>WO</country>
<doc-number>WO-03107585</doc-number>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00455">
<document-id>
<country>WO</country>
<doc-number>WO-03107588</doc-number>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00456">
<document-id>
<country>WO</country>
<doc-number>WO-2004092886</doc-number>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00457">
<document-id>
<country>WO</country>
<doc-number>WO-2007032974</doc-number>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00458">
<othercit>Specification of U.S. Appl. No. 10/989,907, filed Nov. 15, 2004.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00459">
<othercit>Specification of U.S. Appl. No. 11/006,837, filed Dec. 8, 2004.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00460">
<othercit>Gao, Jerry et al., &#x201c;Online Advertising&#x2014;Taxonomy and Engineering Perspectives&#x201d;, http://www.enqr.sjsu.edu/gaojerry/report/OnlineAdvertising%20.pdf, (2002),33 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00461">
<othercit>&#x201c;International Search Report and Written Opinion&#x201d;, Application No. PCT/US05/40940, 18 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00462">
<othercit>&#x201c;Decision to Refuse a European Application mailed Feb. 15, 2008&#x201d;, Application No. 05110697.9, 45 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00463">
<othercit>U.S. Appl. No. 11/018,095, Including O/As dated Aug. 19, 2009, Feb. 5, 2009, Oct. 21, 2009, and Mar. 25, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00464">
<othercit>U.S. Appl. No. 10/968,462, Including O/As dated Mar. 18, 2008, and Notice of Allowance dated Jul. 24, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00465">
<othercit>U.S. Appl. No. 11/022,493, Including O/A dated Aug. 10, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00466">
<othercit>U.S. Appl. No. 11/152,214, Including O/A dated Jun. 9, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00467">
<othercit>JP2007-552142, Including O/A dated Aug. 5, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00468">
<othercit>JP2007-541363, Including O/A dated Jul. 5, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00469">
<othercit>JP2007-54361, Including O/As dated Jun. 7, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00470">
<othercit>MX/a/2007/005657, Including O/As dated Jun. 29, 2009.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00471">
<othercit>EP05820090.8, Including O/As dated Jan. 11, 2008 and Mar. 5, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00472">
<othercit>CN20050038813.9, Including O/As dated Apr. 11, 2008 and May 22, 2009.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00473">
<othercit>MX/a2007/005656, Including O/As dated Jun. 29, 2009, Feb. 10, 2010 and Oct. 18, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00474">
<othercit>MX/a/2007/005659, Including O/As dated Nov. 30, 2009 and Jul. 2, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00475">
<othercit>EP05820177.3, Including Search dated Dec. 6, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00476">
<othercit>CN200580038812.4, Including O/As dated Dec. 18, 2009, Apr. 1, 2010 and Notice of Allowance dated May. 5, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00477">
<othercit>MX/a/2007/005660, Including O/As dated Jul. 7, 2009 and Notice of Allowance dated Feb. 18, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00478">
<othercit>EP05823253.9, Including Search dated Aug. 13, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00479">
<othercit>CN200580038745.6, Including O/As dated Sep. 27, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00480">
<othercit>MX/a/2007/005662, Including O/As dated Jul. 8, 2009 and Notice of Allowance dated Feb. 19, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00481">
<othercit>EP05821183.0, Including O/As Jan. 7, 2011 and Search dated Jul. 23, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00482">
<othercit>CN200580038773.8, Including Notice of Allowance dated Dec. 25, 2009.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00483">
<othercit>MX/a/2007/005655, Including O/As dated Jun. 26, 2009, Feb. 9, 2010, and Sep. 24, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00484">
<othercit>EP05819896.1, Including O/As dated Mar. 19, 2010 and Search dated Jan. 21, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00485">
<othercit>CN200680033207.2, Including O/As dated Jul. 30, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00486">
<othercit>U.S. Appl. No. 10/966,428, Including O/As dated Aug. 22, 2008,Mar. 10, 2008 and Notice of Allowance dated Nov. 6, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00487">
<othercit>EP05109616.2, Including Search dated Jan. 2, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00488">
<othercit>U.S. Appl. No. 10/982,962, Including O/As dated Oct. 7, 2008, May 13, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00489">
<othercit>&#x201c;International Search Report and Written Opinion mailed Jan. 16, 2006&#x201d;, Application No. PCT/US2006/034622, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00490">
<othercit>&#x201c;International Search Report and Written Opinion mailed Nov. 30, 2006&#x201d;, Application No. PCT/US05/40950, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00491">
<othercit>Qiao, Daji et al., &#x201c;MiSer: An Optimal Low-Energy Transmission Strategy for IEEE 802.11 a/h&#x201d;, <i>obtained from ACM</i>, (Sep. 2003),pp. 161-175.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00492">
<othercit>&#x201c;International Search Report and Written Opinion mailed Apr. 22, 2008&#x201d;, Application No. PCT/US2007/087960, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00493">
<othercit>Eren, H. et al., &#x201c;Fringe-Effect Capacitive Proximity Sensors for Tamper Proof Enclosures&#x201d;, <i>Proceedings of 2005 Sensors for Industry Conference</i>, (Feb. 2005),pp. 22-55.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00494">
<othercit>&#x201c;International Search Report and Written Opinion mailed Nov. 15, 2004&#x201d;, Application No. PCT/US05/40966, 9 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00495">
<othercit>Schneier, B. &#x201c;Applied Cryptography, Second Edition: Protocols, Algorithms, and Source Code in C (cloth)&#x201d;, (Jan. 1, 1996),13 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00496">
<othercit>Goering, Richard &#x201c;Web Venture Offers Metered Access to EDA Packages&#x2014;Startup Winds Clocks by the Hour Tools (E*CAD Will Launch Web Site That Provides Pay-Per-Use and Pay-Per-Hour Access to Range of Chip Design Software)&#x201d;, <i>Electronic Engineering Times</i>, (Nov. 6, 2000),3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00497">
<othercit>Zemao, Chen et al., &#x201c;A Malicious Code Immune Model Based on Program Encryption&#x201d;, <i>IEEE&#x2014;Wireless Communication, Networking and Mobile Computing</i>, WICOM '08, 4th International Conference on Oct. 12-14, 2008,5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00498">
<othercit>Mufti, Dr. Muid et al., &#x201c;Design and Implementation of a Secure Mobile IP Protocol&#x201d;, <i>Networking and Communication, INCC 204</i>, International Conference on Jun. 11-13, 2004,5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00499">
<othercit>Davida, George I., et al., &#x201c;UNIX Guardians: Active User Intervention in Data Protection&#x201d;, <i>Aerospace Computer Security Applications Conference</i>, Fourth Dec. 12-16, 1988,6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00500">
<othercit>Morales, Tatiana &#x201c;Understanding Your Credit Score&#x201d;, http://www.cbsnews.com/stories/2003/04/29/earlyshow/contributors/raymartin/main55152.shtml retrieved from the Intenet on Apr. 23, 2009, (Apr. 30, 2003),3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00501">
<othercit>&#x201c;Achieving Peak Performance: Insights from a Global Survey on Credit Risk and Collections Practices&#x201d;, <i>GCI Group Pamphlet</i>, (2002, 2004),12 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00502">
<othercit>&#x201c;Equifax Business Solutions&#x2014;Manage Your Customers&#x201d;, Retrieved from the Internet from http://www.equifax.com/sitePages/biz/smallBiz/?sitePage=manage Customers on Oct. 14, 2005, 3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00503">
<othercit>&#x201c;Prequalification Using Credit Reports&#x201d;, Retrieved from the Internet at http://www.credco.com/creditreports/prequalification.htm on Oct. 14, 2005, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00504">
<othercit>Gao, Jerry et al., &#x201c;Online Advertising&#x2014;Taxonomy and Engineering Perspectives&#x201d;, http://www.engr.sjsu.edu/gaojerry/report/OnlineAdvertising%20.pdf, (2002),33 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00505">
<othercit>Oshiba, Takashi et al., &#x201c;Personalized Advertisement-Duration Control for Streaming Delivery&#x201d;, <i>ACM Multimedia</i>, (2002),8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00506">
<othercit>Yue, Wei T., et al., &#x201c;The Reward Based Online Shopping Community&#x201d;, <i>Routledge</i>, vol. 10, No. 4, (Oct. 1, 2000),2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00507">
<othercit>&#x201c;International Search Report and Written Opinion mailed Nov. 8, 2007&#x201d;, Application No. PCT/US05/40967, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00508">
<othercit>&#x201c;International Search Report and Written Opinion&#x201d;. Application No. PCT/US05/40940, 18 pages, (Jun. 18, 2008).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00509">
<othercit>&#x201c;International Search Report and Written Opinion mailed Apr. 25, 2007&#x201d;, Application No. PCT/US05/040965, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00510">
<othercit>&#x201c;International Search Report and Written Opinion mailed Sep. 25, 2006&#x201d;, Application No. PCT/US05/40949, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00511">
<othercit>&#x201c;EP Office Action Mailed Nov. 17, 2006&#x201d;, Application No. 05110697.9, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00512">
<othercit>&#x201c;EP Office Action mailed Apr. 5, 2007&#x201d;, Application No. 05110697.9, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00513">
<othercit>&#x201c;EP Summons to Attend Oral Proceedings mailed Sep. 27, 2007&#x201d;, Application No. 05110697.9, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00514">
<othercit>&#x201c;Decision to Refuse a European Application mailed Feb. 15, 2008&#x201d;, Application No. 051106997.9, 45 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00515">
<othercit>&#x201c;International Search Report and Written Opinion mailed Sep. 8, 2006&#x201d;, Application No. PCT/US05/040942, 20 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00516">
<othercit>&#x201c;European Search Report mailed Dec. 6, 2010&#x201d;, Application No. EP/05820177, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00517">
<othercit>U.S Appl. No. 11/018,095, Including O/As dated Mar. 15, 2010; Jul. 8, 2010; Dec. 27, 2010; Jun. 9, 2011; and Sep. 27, 2011.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00518">
<othercit>&#x201c;Notice of Rejection mailed Sep. 9, 2011&#x201d;, JP Application No. 2007-548385, 9 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00519">
<othercit>U.S. Appl. No. 11/021,021, Including O/As dated Mar. 16, 2007 and Sep. 6, 2007 and Notice of Allowance dated Nov. 21, 2007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00520">
<othercit>U.S. Appl. No. 11/210,611, Including O/A dated Jun. 25, 2009 and Notice of Allowance dated Dec. 28, 2009.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00521">
<othercit>U.S. Appl. No. 11/007,089, Including O/As dated Mar. 6, 2007, Jun. 4, 2007, Aug. 17, 2007, Nov. 1, 2007, Jun. 30, 2007 and Sep. 23, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00522">
<othercit>U.S. Appl. No. 11/020,329, Including O/A dated Aug. 22, 2007 and Notice of Allowance dated Feb. 8, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00523">
<othercit>U.S. Appl. No. 11/034,377, Including O/As dated Feb. 2, 2007, Jul. 24, 2007, Mar. 28, 2008, Oct. 5, 2009.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00524">
<othercit>U.S. Appl. No. 11/039,165 Including O/As dated Apr. 23, 2008 and Nov. 19, 2008 and Notice of Allowance dated Apr. 30, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00525">
<othercit>U.S. Appl. No. 11/057,266, Including O/A dated Aug. 23, 2007 and Notice of Allowance dated Nov. 26, 2007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00526">
<othercit>U.S. Appl. No. 11/087,263, Including O/As dated Jun. 26, 2007, Nov. 14, 2007, Feb. 14, 2008, Oct. 29, 2008 and Mar. 23, 2005.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00527">
<othercit>U.S. Appl. No. 11/074,500, Including O/A dated Sep. 7, 2007 and Notice of Allowance dated Mar. 20, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00528">
<othercit>U.S. Appl. No. 11/224,635, Including O/A dated May 5, 2009, Jan. 12, 2010, Mar. 23, 2010 and Jul. 30, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00529">
<othercit>&#x201c;Extended European Search Report mailed Dec. 6, 2010&#x201d;, EP Application No. 05820177.3, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00530">
<othercit>&#x201c;Office Action mailed May 26, 2008&#x201d;, EP Application No. 05109616.2, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00531">
<othercit>&#x201c;Notice on Division of Application mailed Aug. 8, 2008&#x201d;, CN Application No. 200510113398.0,2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00532">
<othercit>&#x201c;Notice on First Office Action mailed Dec. 12, 2008&#x201d;, CN Application No. 200510113398.0.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00533">
<othercit>&#x201c;The Second Office Action mailed Jun. 3, 2009&#x201d;, CN Application No. 200510113398.0, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00534">
<othercit>&#x201c;Notice on Proceeding with the Registration Formalities mailed Oct. 23, 2009&#x201d;, CN Application No. 200510113398.0, 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00535">
<othercit>&#x201c;Examiner's First Report on Application mailed Jun. 4, 2010&#x201d;, AU Application No. 2005222507, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00536">
<othercit>&#x201c;Notice of Acceptance mailed Oct. 14, 2010&#x201d;, AU Application No. 2005222507, 3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00537">
<othercit>&#x201c;Decision on Grant of a Patent for Invention mailed Apr. 29, 2010&#x201d;, Russian Application No. 2005131911, 31 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00538">
<othercit>&#x201c;Office Action mailed Dec. 3, 2009&#x201d;, Russian Application No. 2005131911.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00539">
<othercit>&#x201c;Notice of Allowance mailed Nov. 13, 2009&#x201d;, MX Application No. PA/a/2005/011088, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00540">
<othercit>&#x201c;TCG Specification Architecture Overview&#x201d;, Revision 1.2, (Apr. 28, 2004),55 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00541">
<othercit>&#x201c;International Search Report and Written Opinion mailed Jun. 19, 2007&#x201d;, PCT Application No. PCT/US05/46091, 11 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00542">
<othercit>&#x201c;Notice on Grant of Patent Right for Invention mailed Jan. 29, 2010&#x201d;, CN Application No. 200580040764.2, 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00543">
<othercit>&#x201c;International Search Report mailed Jan. 5, 2007&#x201d;, Application No. PCT/US2006/032708, 3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00544">
<othercit>&#x201c;Cyotec&#x2014;CyoLicence&#x201d;, printed from www.cyotec.com/products/cyoicence on Sep. 7, 2005, (Copyright 2003-2005).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00545">
<othercit>&#x201c;Magic Desktop Automation Suite for the Small and Mid-Sized Buisness&#x201d;, printed from www.remedy.com/soultions/magic<sub>&#x2014;</sub>it<sub>&#x2014;</sub>suite.htm on Sep. 7, 2005, (Copyright 2005), 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00546">
<othercit>&#x201c;PACE Anti-Piracy Introduction&#x201d;, printed from www.paceap.com/psintro.html on Sep. 7, 2005, (Copyright 2002),4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00547">
<othercit>&#x201c;Office Action mailed Jul. 6, 2009&#x201d;, MX Application No. MX/a/2007/005661, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00548">
<othercit>&#x201c;Office Action mailed Oct. 1, 2010&#x201d;, MX Application No. MX/a/2007/005661, 3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00549">
<othercit>&#x201c;Office Action mailed Mar. 8, 2011&#x201d;, MX Application No. MX/a/2007/005661, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00550">
<othercit>&#x201c;Notice on Second Office Action mailed Jun. 7, 2010&#x201d;, CN Application No. 200680030846.3, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00551">
<othercit>&#x201c;Decision on Rejection mailed Sep. 13, 2010&#x201d;, CN Application No. 200680030846.3, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00552">
<othercit>Kwok, Sai H., &#x201c;Digital Rights Management for the Online Music Business&#x201d;, <i>ACM SIGecom Exhchanges</i>, vol. 3, No. 3, (Aug. 2002),pp. 17-24.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00553">
<othercit>&#x201c;International Search Report and Written Opinion mailed Mar. 21, 2007&#x201d;, Application No. PCT/US05/46223, 10 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00554">
<othercit>&#x201c;The First Office Action mailed Oct. 9, 2009&#x201d;, CN Application No. 200580043102.0, 20 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00555">
<othercit>&#x201c;Notice of Rejection mailed Jun. 13, 2011&#x201d;, JP Application No. 2007-551270, 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00556">
<othercit>&#x201c;International Search Report and Written Opinion mailed Jul. 9, 2008&#x201d;, Application No. PCT/US05/46539, 11 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00557">
<othercit>&#x201c;Notice of the First Office Action mailed Dec. 29, 2010&#x201d;, CN Application No. 200580044294.7, 9 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00558">
<othercit>&#x201c;Office Action mailed Jul. 1, 2009&#x201d;, MX Application No. 2007/a/2007/007441.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00559">
<othercit>&#x201c;European Search Report mailed Aug. 31, 2011&#x201d;, EP Application No. 05855148.2, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00560">
<othercit>&#x201c;International Search Report and Written Opinion mailed Sep. 25, 2007&#x201d;, Application No. PCT/US06/12811, 10 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00561">
<othercit>&#x201c;Examiner's First Report mailed Sep. 15, 2009&#x201d;, AU Application No. 2006220489, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00562">
<othercit>&#x201c;Notice of Acceptance mailed Jan. 25, 2010&#x201d;, AU Application No. 2006220489, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00563">
<othercit>&#x201c;The First Office Action mailed Aug. 22, 2008&#x201d;, CN Application No. 200680006199.2, 23 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00564">
<othercit>&#x201c;The Second Office Action mailed Feb. 20, 2009&#x201d;, CN Application No. 200680006199.2, 9 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00565">
<othercit>&#x201c;The Fourth Office Action mailed Jan. 8, 2010&#x201d;, CN Application No. 200680006199.2, 10 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00566">
<othercit>&#x201c;The Fifth Office Action mailed Jul. 14, 2010&#x201d;, CN Application No. 200680006199.2, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00567">
<othercit>&#x201c;Notice on Grant of Patent mailed Oct. 20, 2010&#x201d;, CN Application No. 10/20/10, 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00568">
<othercit>&#x201c;First Office Action mailed Aug. 21, 2009&#x201d;, CN Application No. 200680030846.3, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00569">
<othercit>&#x201c;Notice of Rejection mailed Jul. 12, 2011&#x201d;, JP Application No. 2007-541351, 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00570">
<othercit>&#x201c;Notice of Rejection mailed Jul. 22, 2011&#x201d;, JP Application No. 2007-541362.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00571">
<othercit>&#x201c;Notice of Rejection mailed Jul. 15, 2011&#x201d;, JP Application No. 2007-541356, 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00572">
<othercit>&#x201c;Notice of Rejection mailed Jul. 26, 2011&#x201d;, JP Application No. 2007-541352, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00573">
<othercit>&#x201c;Notice of Rejection mailed Jul. 22, 2011&#x201d;, JP Application No. 2007-541355 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00574">
<othercit>&#x201c;Notice of Allowance mailed Sep. 12, 2011&#x201d;, U.S. Appl. No. 11/224,635.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00575">
<othercit>&#x201c;Notice on the First Office Action mailed Dec. 11, 2009&#x201d;, CN Application No. 200510127170.7, 16 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00576">
<othercit>&#x201c;Notice of Rejection mailed Jun. 21, 2011&#x201d;, JP Application No. 2005-330496, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00577">
<othercit>Lampson, Butler et al., &#x201c;Authentication in Distributed Systems: Theory and Practice&#x201d;, <i>ACM Transactions on Computer Systems</i>, v10, 265,(1992),18 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00578">
<othercit>&#x201c;DMOD WorkSpace OEM Unique Features&#x201d;, www.dmod.com/oem<sub>&#x2014;</sub>features, Retrieved from the Internet on Jan. 12, 2005,3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00579">
<othercit>&#x201c;Notice of Rejection mailed Jun. 7, 2011&#x201d;, Japanese Application No. 2007-541361, 3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00580">
<othercit>&#x201c;Office Action mailed Jun. 29, 2009&#x201d;, Mexican Application No. MX/a/2007/005657, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00581">
<othercit>&#x201c;Search Report Dated Jan. 11, 2008&#x201d;, EP Application No. 05820090.8, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00582">
<othercit>&#x201c;Examination Report mailed Mar. 5, 2008&#x201d;, EP Application No. 05820090.8, 1 page.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00583">
<othercit>&#x201c;First Office Action mailed Apr. 11, 2008&#x201d;, Chinese Application No. 200580038813.9, 11 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00584">
<othercit>&#x201c;Office Action mailed Jun. 29, 2009&#x201d;, Mexican Application No. MX/a/2007/005656, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00585">
<othercit>&#x201c;Office Action mailed Nov. 30, 2009&#x201d;, Mexican Application No. MX/a/2007/005659, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00586">
<othercit>&#x201c;Notice of Allowance mailed Jul. 2, 2010&#x201d;, Mexican Application No. MX/a/2007/005659, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00587">
<othercit>&#x201c;Second Office Action mailed Dec. 18, 2009&#x201d;, Chinese Application No. 200580038812.4, 24 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00588">
<othercit>&#x201c;Third Office Action mailed Apr. 1, 2010&#x201d;, Chinese Application No. 200580038812.4, 9 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00589">
<othercit>&#x201c;Notice on Grant of Patent Right for Invention mailed May 5, 2011&#x201d;, Chinese Application No. 200580038812.4, 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00590">
<othercit>&#x201c;Office Action mailed Jul. 7, 2009&#x201d;, Mexican Application No. MX/a/2007/005660, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00591">
<othercit>&#x201c;Notice of Allowance mailed Feb. 18, 2010&#x201d;, Mexican Application No. MX/a/2007/005660, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00592">
<othercit>&#x201c;Extended European Search Report mailed Aug. 13, 2010&#x201d;, EP Application No. 05823253.9, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00593">
<othercit>&#x201c;Notice on the First Office Action mailed Sep. 27, 2010&#x201d;, Chinese Application No. 200580038745.6, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00594">
<othercit>&#x201c;Office Action mailed Jul. 8, 2009&#x201d;, Mexican Application No. MX/a/2007/005662, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00595">
<othercit>&#x201c;Notice of Allowance mailed Feb. 19, 2010&#x201d;, Mexican Application No. MX/a/2007/005662, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00596">
<othercit>&#x201c;Partial Search Report mailed Jul. 23, 2010&#x201d;, EP Application No. 05821183.0.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00597">
<othercit>&#x201c;Extended European Search Report mailed Jan. 7, 2011&#x201d;, EP Application No. 05821183.0, 9 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00598">
<othercit>&#x201c;Notice of Allowance mailed Dec. 25, 2009&#x201d;, Chinese Application No. 200580038773.8, 4 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00599">
<othercit>&#x201c;Office Action mailed Jun. 26, 2009&#x201d;, Mexican Application No. MX/a/2007/005655, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00600">
<othercit>&#x201c;Office Action mailed Feb. 9, 2010&#x201d;, Mexican Application No. MX/a/2007/005855, 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00601">
<othercit>&#x201c;Office Action mailed Sep. 24, 2010&#x201d;, Mexican Application No. MX/a/2007/005655, 3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00602">
<othercit>&#x201c;Extended European Search Report mailed Jan. 21, 2010&#x201d;, EP Application No. 05819896.1, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00603">
<othercit>&#x201c;Office Action mailed Mar. 19, 2010&#x201d;, EP Application No. 05819896.1, 1 page.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00604">
<othercit>&#x201c;Office Action mailed Feb. 10, 2010&#x201d;, Mexican Applicaiton No. MX/a/2007/005656, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00605">
<othercit>&#x201c;Office Action mailed Oct. 18, 2010&#x201d;, Mexican Application No. MX/a/2007/005656, 3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00606">
<othercit>&#x201c;Office Action mailed May 22, 2009&#x201d;, Chinese Application No. 200580038771.9, 5 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00607">
<othercit>&#x201c;Notice on the First Office Action mailed Jul. 30, 2010&#x201d;, Chinese Application No. 200680033207.2, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00608">
<othercit>&#x201c;EP Search Report mailed Jan. 2, 2008&#x201d;, EP Application No. 05109616.2, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00609">
<othercit>&#x201c;Flonix: USB Desktop OS Solutions Provider, http://www.flonix.com&#x201d;, <i>Retrieved from the Internet </i>Jun. 1, 2005, (Copyright 2004),2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00610">
<othercit>&#x201c;Migo by PowerHouse Technologies Group, http://www.4migo.com&#x201d;, <i>Retrieved from the Internet </i>Jun. 1, 2005, (Copyright 2003),3 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00611">
<othercit>&#x201c;WebServUSB, http://www.webservusb.com&#x201d;, <i>Retrieved from the Internet </i>Jun. 1, 2005, (Copyright 2004),16 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00612">
<othercit>&#x201c;Notice of Rejection mailed Jul. 5, 2011&#x201d;, Japanese Application No. 2007-541363, 10 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00613">
<othercit>&#x201c;Notice of Rejection mailed Aug. 5, 2011&#x201d;, Japanese Patent Application No. 2007-552142, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00614">
<othercit>&#x201c;Notice of Rejection mailed Nov. 11, 2011&#x201d;, Japanese Application No. 2005-301957, 21 pages. (MS#310416.06).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00615">
<othercit>Utagawa, Mari et al., &#x201c;Creation of Card Application by IC Card OS &#x2018;Multos&#x2019; Which Can Rewrite Application&#x201d;, Interface, vol. 29, No. 3, ISSN: 0387-9569, CQ Publishing Co. Ltd., (Mar. 1, 2003),pp. 46-55.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00616">
<othercit>&#x201c;Extended European Search Report mailed Dec. 21, 2011&#x201d;, EP Application No. 05854752.2, 7 pages. (MS#310476.10).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00617">
<othercit>&#x201c;Office Action mailed Dec. 7, 2011&#x201d;, JP Application No. 2008-528054, 7 pages. (MS#310477.31).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00618">
<othercit>&#x201c;Final Rejection mailed Jan. 17, 2012&#x201d;, Japan Application No. 2007-552142, 8 pages. (MS#310522.06).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00619">
<othercit>&#x201c;EP Office Action mailed Mar. 8, 2012&#x201d;, EP Application No. 05109616.2, 6 pages. (MS#310416.05).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00620">
<othercit>&#x201c;Office Action mailed Dec. 7, 2011&#x201d;, JP Application No. 2008-528054, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00621">
<othercit>&#x201c;Notice of Preliminary Rejection mailed May 30, 2012&#x201d;, Korean Patent Application No. 10-2007-7011069, 1 page.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00622">
<othercit>Mois, Dan et al., &#x201c;Reconfiguration Securityfor Hardware Agents in Testing&#x201d;, Automation Quality and Testing Robotics (AQTR), 2010 IEEE International Conference on vol. 2, (2010), pp. 1-5.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00623">
<othercit>Zhang, Kai et al., &#x201c;Reconfigurable Security Protection System Based on Net FPGA and Embedded Soft-Core Technology&#x201d;, Computer Design and Applications (ICCDA), 2010 International Conference on Volume, (2010),pp. V5-540-V5-544.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00624">
<othercit>Ooi, Joo G., et al., &#x201c;A Proof of Concept on Defending Cold Boot Attack&#x201d;, Quality Electronic Design, ASQED 2009, 1st Asia Symposium, (2009),pp. 330-335.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00625">
<othercit>&#x201c;Extended European Search Report mailed Jul. 5, 2012&#x201d;, EP Application No. 05851550.3 (MS#310477.26), 6 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00626">
<othercit>&#x201c;Preliminary Rejection mailed Jul. 4, 2012&#x201d;, Korean Application No. 10-2007- 7012294, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00627">
<othercit>&#x201c;Office Action mailed Jun. 8, 2012&#x201d;, JP Application No. 2005-301957, 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00628">
<othercit>Nakajima, S. &#x201c;Do You Really Know It? Basics of Windows2000/XP Network, 4th Installment, What is Logon Like?&#x201d;, Nikkei Business Publications, Inc., (Jan. 2004),pp. 116-121.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00629">
<othercit>&#x201c;First Special Feature, Security Oriented Web Application Development, Part 3, Method for Realizing Secure Session Management&#x201d;, N&#x2018;Network Guide (vol. 4,.U.S. Appl. No. 32) Softbank Publishing Inc., (Jan. 2004),pp. 47-59.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>705 59</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 64</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 67</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 52</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713464</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713173</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713176</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713180</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713178</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713167</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713193</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>719321</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>719329</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>717126</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>717168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715781</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726  1</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726  6</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 17</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380231-233</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>711  6</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20060282899</doc-number>
<kind>A1</kind>
<date>20061214</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Raciborski</last-name>
<first-name>Bohdan</first-name>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Microsoft Corporation</orgname>
<role>02</role>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Darrow</last-name>
<first-name>Justin T</first-name>
<department>2438</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An operating system and method for use include a core function module, or basic kernel, providing fundamental operating system support and one or more add-on modules that allow customization of the operating system as desired. Add-on modules may provide support or extended capability to the computer including hardware, applications, peripherals, and support. A digital signature may be used to confirm the integrity of an add-on module prior to installation. Certification may be verified to determine if installation of the add-on module is authorized. By withholding certification, a service provider may manage illegal or undesired modifications to a provided computer. Digital rights management may be used to enforce terms of use of the add-on module in keeping with licensing arrangements.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="232.49mm" wi="146.05mm" file="US08353046-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="244.77mm" wi="194.14mm" file="US08353046-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="230.12mm" wi="187.11mm" orientation="landscape" file="US08353046-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="171.62mm" wi="167.30mm" file="US08353046-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="193.80mm" wi="131.74mm" file="US08353046-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="251.80mm" wi="167.22mm" file="US08353046-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="174.24mm" wi="157.90mm" file="US08353046-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">This disclosure relates to operating systems and particularly relates to a system and method for delivery of a modular operating system.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Operating systems typically include functions such as hardware management memory management, disk file systems, a basic graphics engine, and application runtime support. Operating systems are available as monolithic blocks that incorporate all the above functions and often more. Purchasing these large operating systems can represent a significant portion of the cost of an overall computer system. After purchase, the user may find significant functionality available that is not required, or some functions that would be desirable that are not available.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0004" num="0003">According to one aspect of the disclosure an operating system is composed of a small basic kernel, often given away for free. The small basic kernel, may be used for simple operations and for basic application support. A user of the computer system may then have the opportunity to add specific modules supporting the functionality required for his or her particular interests. While some add-on modules may be free, others may be available for a fee or as part of a subscription.</p>
<p id="p-0005" num="0004">According to another aspect of the disclosure, multiple users may each build from the small basic kernel to personalize and customize the operating system for their individual needs on the same computer. For example, one user may purchase and install a suite support pack to improve the performance of utilities such as word processors. Another user may choose a game support pack that may include 3-D graphics acceleration, more memory, a game controller driver, and advanced sound support.</p>
<p id="p-0006" num="0005">According to another aspect of the disclosure, digital rights management may be used to manage add-on modules. As opposed to the prior art, where the operating system is available in perpetuity, add-on modules may be available for limited periods of time, based on the license terms. It may also be possible to allow only certified or authorized add-on modules to be installed, enabling digital rights management to allow selective purchase by users, fraud control for providers and also to restrict unauthorized operating system extensions from being installed that may support unauthorized hardware and/or software.</p>
<p id="p-0007" num="0006">According to yet another aspect of the disclosure, add-on modules may allow extensions to initial basic functions, such as, the number of windows allowed, the number of processors in use, the amount of memory available, and the number of concurrent applications running.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> is a simplified and representative block diagram of a computer network;</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 2</figref> is a simplified and representative block diagram of a computer;</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 3</figref> is a simplified and representative block diagram illustrating the functional relationship between operating system elements; and</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 4</figref> is a simplified and representative block diagram of an exemplary add-on module;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 5</figref> is a flow chart depicting a method for extending a basic operating system using add-on modules; and</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 6</figref> is a flow chart depicting a method booting a computer using add-on modules.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF VARIOUS EMBODIMENTS</heading>
<p id="p-0014" num="0013">Although the following text sets forth a detailed description of numerous different embodiments, it should be understood that the legal scope of the description is defined by the words of the claims set forth at the end of this disclosure. The detailed description is to be construed as exemplary only and does not describe every possible embodiment since describing every possible embodiment would be impractical, if not impossible. Numerous alternative embodiments could be implemented, using either current technology or technology developed after the filing date of this patent, which would still fall within the scope of the claims.</p>
<p id="p-0015" num="0014">It should also be understood that, unless a term is expressly defined in this patent using the sentence &#x201c;As used herein, the term &#x2018;<sub>&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;&#x2014;</sub>&#x2019; is hereby defined to mean . . . &#x201d; or a similar sentence, there is no intent to limit the meaning of that term, either expressly or by implication, beyond its plain or ordinary meaning, and such term should not be interpreted to be limited in scope based on any statement made in any section of this patent (other than the language of the claims). To the extent that any term recited in the claims at the end of this patent is referred to in this patent in a manner consistent with a single meaning, that is done for sake of clarity only so as to not confuse the reader, and it is not intended that such claim term by limited, by implication or otherwise, to that single meaning. Finally, unless a claim element is defined by reciting the word &#x201c;means&#x201d; and a function without the recital of any structure, it is not intended that the scope of any claim element be interpreted based on the application of 35 U.S.C. &#xa7;112, sixth paragraph.</p>
<p id="p-0016" num="0015">Much of the inventive functionality and many of the inventive principles are best implemented with or in software programs or instructions and integrated circuits (ICs) such as application specific ICs. It is expected that one of ordinary skill, notwithstanding possibly significant effort and many design choices motivated by, for example, available time, current technology, and economic considerations, when guided by the concepts and principles disclosed herein will be readily capable of generating such software instructions and programs and ICs with minimal experimentation. Therefore, in the interest of brevity and minimization of any risk of obscuring the principles and concepts in accordance to the present invention, further discussion of such software and ICs, if any, will be limited to the essentials with respect to the principles and concepts of the preferred embodiments.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a network <b>10</b> that may be used to implement a dynamic software provisioning system. The network <b>10</b> may be the Internet, a virtual private network (VPN), or any other network that allows one or more computers, communication devices, databases, etc., to be communicatively connected to each other. The network <b>10</b> may be connected to a computer <b>12</b>, such as a personal computer and a computer terminal <b>14</b> via an Ethernet <b>16</b> and a router <b>18</b>, and a landline <b>20</b>. On the other hand, the network <b>10</b> may be wirelessly connected to a laptop computer <b>22</b> and a personal data assistant <b>24</b> via a wireless communication station <b>26</b> and a wireless link <b>28</b>. Similarly, a server <b>30</b>, such as a proxy server or edge server may be connected to the network <b>10</b> using a communication link <b>32</b> and a web server <b>34</b> may be connected to the network <b>10</b> using another communication link <b>36</b>.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a computing device in the form of a computer <b>110</b>. Components of the computer <b>110</b> may include, but are not limited to a processing unit <b>120</b>, a system memory <b>130</b>, and a system bus <b>121</b> that couples various system components including the system memory to the processing unit <b>120</b>. The system bus <b>121</b> may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. By way of example, and not limitation, such architectures include Industry Standard Architecture (ISA) bus, Micro Channel Architecture (MCA) bus, Enhanced ISA (EISA) bus, Video Electronics Standards Association (VESA) local bus, and Peripheral Component Interconnect (PCI) bus also known as Mezzanine bus.</p>
<p id="p-0019" num="0018">The computer <b>110</b> may also include a cryptographic unit <b>125</b>. Briefly, the cryptographic unit <b>125</b> has a calculation function that may be used to verify digital signatures, calculate hashes, digitally sign hash values, and encrypt or decrypt data. The cryptographic unit <b>125</b> may also have a protected memory for storing keys and other secret data. Another function supported by the cryptographic unit <b>125</b> may be digital rights management, that in its simplest form is a variation of encryption. The cryptographic unit may also include a timer or clock (not depicted) to support expiration dates and some usage limits. In other embodiments, the functions of the cryptographic unit may be instantiated in software and run via the operating system.</p>
<p id="p-0020" num="0019">Computer <b>110</b> typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer <b>110</b> and includes both volatile and nonvolatile media, removable and non-removable media. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media includes, but is not limited to, RAM, ROM, EEPROM, FLASH memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical disk storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can accessed by computer <b>110</b>. Communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term &#x201c;modulated data signal&#x201d; means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, radio frequency, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.</p>
<p id="p-0021" num="0020">The system memory <b>130</b> includes computer storage media in the form of volatile and/or nonvolatile memory such as read only memory (ROM) <b>131</b> and random access memory (RAM) <b>132</b>. A basic input/output system <b>133</b> (BIOS), containing the basic routines that help to transfer information between elements within computer <b>110</b>, such as during start-up, is typically stored in ROM <b>131</b>. RAM <b>132</b> typically contains data and/or program modules that are immediately accessible to and/or presently being operated on by processing unit <b>120</b>. By way of example, and not limitation, <figref idref="DRAWINGS">FIG. 2</figref> illustrates operating system <b>134</b>, application programs <b>135</b>, other program modules <b>136</b>, and program data <b>137</b>.</p>
<p id="p-0022" num="0021">The computer <b>110</b> may also include other removable/non-removable, volatile/nonvolatile computer storage media. By way of example only, <figref idref="DRAWINGS">FIG. 2</figref> illustrates a hard disk drive <b>141</b> that reads from or writes to non-removable, nonvolatile magnetic media, a magnetic disk drive <b>151</b> that reads from or writes to a removable, nonvolatile magnetic disk <b>152</b>, and an optical disk drive <b>155</b> that reads from or writes to a removable, nonvolatile optical disk <b>156</b> such as a CD ROM or other optical media. Other removable/non-removable, volatile/nonvolatile computer storage media that can be used in the exemplary operating environment include, but are not limited to, magnetic tape cassettes, flash memory cards, digital versatile disks, digital video tape, solid state RAM, solid state ROM, and the like. The hard disk drive <b>141</b> is typically connected to the system bus <b>121</b> through a non-removable memory interface such as interface <b>140</b>, and magnetic disk drive <b>151</b> and optical disk drive <b>155</b> are typically connected to the system bus <b>121</b> by a removable memory interface, such as interface <b>150</b>.</p>
<p id="p-0023" num="0022">The drives and their associated computer storage media discussed above and illustrated in <figref idref="DRAWINGS">FIG. 2</figref>, provide storage of computer readable instructions, data structures, program modules and other data for the computer <b>110</b>. In <figref idref="DRAWINGS">FIG. 2</figref>, for example, hard disk drive <b>141</b> is illustrated as storing operating system <b>144</b>, application programs <b>145</b>, other program modules <b>146</b>, and program data <b>147</b>. Note that these components can either be the same as or different from operating system <b>134</b>, application programs <b>135</b>, other program modules <b>136</b>, and program data <b>137</b>. Operating system <b>144</b>, application programs <b>145</b>, other program modules <b>146</b>, and program data <b>147</b> are given different numbers here to illustrate that, at a minimum, they are different copies. A user may enter commands and information into the computer <b>20</b> through input devices such as a keyboard <b>162</b> and cursor control device <b>161</b>, commonly referred to as a mouse, trackball or touch pad. Other input devices (not shown) may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit <b>120</b> through a user input interface <b>160</b> that is coupled to the system bus, but may be connected by other interface and bus structures, such as a parallel port, game port or a universal serial bus (USB). A monitor <b>191</b> or other type of display device is also connected to the system bus <b>121</b> via an interface, such as a graphics controller <b>190</b>. In addition to the monitor, computers may also include other peripheral output devices such as speakers <b>197</b> and printer <b>196</b>, which may be connected through an output peripheral interface <b>195</b>.</p>
<p id="p-0024" num="0023">The computer <b>110</b> may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer <b>180</b>. The remote computer <b>180</b> may be a personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to the computer <b>110</b>, although only a memory storage device <b>181</b> has been illustrated in <figref idref="DRAWINGS">FIG. 2</figref>. The logical connections depicted in <figref idref="DRAWINGS">FIG. 2</figref> include a local area network (LAN) <b>171</b> and a wide area network (WAN) <b>173</b>, but may also include other networks. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets and the Internet.</p>
<p id="p-0025" num="0024">When used in a LAN networking environment, the computer <b>110</b> is connected to the LAN <b>171</b> through a network interface or adapter <b>170</b>. When used in a WAN networking environment, the computer <b>110</b> typically includes a modem <b>172</b> or other means for establishing communications over the WAN <b>173</b>, such as the Internet. The modem <b>172</b>, which may be internal or external, may be connected to the system bus <b>121</b> via the user input interface <b>160</b>, or other appropriate mechanism. In a networked environment, program modules depicted relative to the computer <b>110</b>, or portions thereof, may be stored in the remote memory storage device. By way of example, and not limitation, <figref idref="DRAWINGS">FIG. 2</figref> illustrates remote application programs <b>185</b> as residing on memory device <b>181</b>.</p>
<p id="p-0026" num="0025">The communications connections <b>170</b> <b>172</b> allow the device to communicate with other devices. The communications connections <b>170</b> <b>172</b> are an example of communication media. The communication media typically embodies computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. A &#x201c;modulated data signal&#x201d; may be a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media includes wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Computer readable media may include both storage media and communication media.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 3</figref> shows a simplified block diagram of the relationship between the basic kernel and add-on modules. The basic kernel <b>202</b> may supply functions such as basic memory management, system input/output, boot processes, file system support, and fundamental display capabilities. Add-on modules provide a mechanism to extend or increase the capabilities of the basic kernel <b>202</b>. As depicted in <figref idref="DRAWINGS">FIG. 3</figref>, add-on module <b>204</b> has been included into the basic kernel <b>202</b> system. A basic kernel add-on module <b>206</b> may provide support for additional memory or multiple processors, for example. Add-on module <b>208</b> may extend the functionality of kernel add-on module <b>206</b>. Add-on module <b>208</b> may similarly extend the basic kernel function, such as adding support for higher-speed operation of a multiple processor environment. Additional add-on modules <b>210</b> <b>212</b> <b>214</b> are depicted as not yet being installed. For the sake of illustration, it is shown that add-on module <b>210</b> is available for free, add-on module <b>212</b> has a one-time charge of $6, and add-on module <b>214</b> has an ongoing charge of $2 per month.</p>
<p id="p-0028" num="0027">By way of illustration, and not limitation, some of the functions associated with add-on modules are discussed in several broad categories: hardware, peripherals, communication and applications/bundles.</p>
<p id="p-0029" num="0028">The hardware category may include power management, removable memory support, metered disk drives, multiple processor support, increased screen resolution, increased screen color depth, 3D acceleration, and patches/bug fixes/service packs. Power management offers the user options for setting power consumption, particularly in a laptop, but also for desktop environments. Removable memory support may include capabilities for rotating media such as CD and DVD, as well as solid-state memory such as USB memory peripherals. A metered disk drive (not depicted) may provide a user with a base function for small capacity disk storage at a given speed. Advanced support for disk access may include high speed/high capacity drives as well as network drives. In a base configuration supported by the basic kernel <b>202</b>, the number of processors may be limited to one, or to a fixed performance level. An add-on module for processor support may allow variable performance levels up to the maximum capability of the processor or may include activation of additional processors both locally and on a network. The basic kernel <b>202</b> of the operating system may support limited screen resolutions and color depth, while an add-on module may expand those capabilities. 3-D acceleration is of interest to some users is discussed further below. In the area of operating system maintenance, service packs, bug fixes, and patches have been included in the original purchase price of an operating system for prior art systems. The use of an add-on module for support of bug fixes, service packs, and patches allows users to selectively pay for only the support that is of interest to them.</p>
<p id="p-0030" num="0029">The peripheral category may include installed printers, COM ports, USB ports, telephone service, and the number of peripherals allowed. A computer <b>110</b> functioning with the basic kernel operating system <b>202</b> may have limited peripheral support. Add-on modules may allow users to select the types, speed, and number of peripherals allowed and supported.</p>
<p id="p-0031" num="0030">The communication category may include network interfaces, such as dial up, TCP, and peer-to-peer networks, etc. A computer <b>110</b> supported by the basic kernel <b>202</b> may not include any network support for use in basic applications. For example, in areas where communication infrastructure is nonexistent or limited, a user may not wish to invest in high speed communication capability. Add-on modules for communication may be used to support low-speed access such as dial up, higher-speed access, for example, DSL speeds up 500 kilobits per second, or speeds up to the maximum supported by the available hardware. Communication may also be limited by type, such as support for Internet browsing separate from peer-to-peer networking.</p>
<p id="p-0032" num="0031">While most of the capabilities discussed in the following are also shown above, application specific packages or bundled add-on modules may be used to provide easy support for users having a specific interest. For example, a power user may want specific window and background themes with associated styles, a significant number of concurrent windows, and an unlimited number of concurrent applications, up to the capacity of the hardware. A game support pack including advanced sound support, game controller support, and increased video memory may be of interest to those users primarily interested in interactive games. Users of business support applications may benefit from a support pack including high speed disk access, network drive support, and network printing, for example.</p>
<p id="p-0033" num="0032">While not exhaustive, the above illustrate the nature and range of capabilities that may be supported by add-on modules and a basic kernel operating system.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a representative add-on module, such as the add-on modules discussed with respect to <figref idref="DRAWINGS">FIG. 3</figref>. The add-on module <b>300</b> may include functional code <b>302</b> and support data <b>304</b>. The functional code <b>302</b> may include software, algorithms, and utilities for supporting the specific function provided by the add-on module <b>300</b>. Data <b>304</b> may include both static and dynamic data, such as icons, environment data, settings, or user data. The add-on module <b>300</b> may further include a digital signature <b>306</b>. Digital signatures, such as digital signature <b>306</b> are well known in the industry but, in brief, may be used to verify the integrity of the add-on module <b>300</b> as received, as well as to confirm the identity of the source of the add-on module <b>300</b>. Digital signatures may be verified using the cryptographic unit <b>125</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0035" num="0034">A certification <b>308</b> may be used in addition to digital signature <b>306</b>. While the digital signature <b>306</b> may be used to verify, for example, authorship of the add-on module functional code <b>302</b>, the certification <b>308</b> may be used to verify authorization to install the add-on module <b>300</b> granted by a service provider or other interested party. For example, a service provider may, for business or support reasons, wish to restrict the use of certain add-on modules even though they are compatible with the basic kernel <b>202</b>.</p>
<p id="p-0036" num="0035">Digital rights indicia <b>310</b> may be used to impose limits on usage of the add-on module <b>300</b>. The digital rights indicia <b>310</b> may cover usage until an expiration date, a number of uses over a time period, a cumulative number of uses, or a via metadata processed, as some examples.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 5</figref> may illustrate a method of identifying and installing add-on modules. A computer, such as computer <b>110</b>, may start <b>402</b> basic kernel <b>202</b> of a core operating system when booted. A user may be presented at block <b>404</b> with a selection of add-on modules, such as add-on module <b>300</b>, for example, showing capability and cost, if any. The basic kernel <b>202</b> of the core operating system may then receive <b>406</b> a selection of add-on modules. The selection made at block <b>406</b> may include an explicit or implicit funding authorization. When funding is required, funds may be collected at block <b>408</b>. Funding may be accomplished by any of the known mechanisms, such as payment from a pre-paid account or by an on-line funds transfer. Once the funding operation completes successfully, the yes branch from block <b>408</b> may be followed.</p>
<p id="p-0038" num="0037">The selected add-on module <b>300</b> may be present, or may need to be downloaded (not depicted). A digital signature <b>306</b> may be confirmed at block <b>410</b> to ensure the add-on module <b>300</b> is intact and untampered as well as to verify the identity of the signer. When the digital signature is confirmed, execution may follow the yes branch from block <b>410</b> where a certification <b>308</b>, if present, is confirmed at block <b>412</b>. As discussed above, the certification <b>308</b> may be present in addition to a digital signature and may relate more to authorization for loading as opposed to checking integrity and source verification which may depend more on the digital signature. When the certification is confirmed at block <b>412</b>, the yes branch may be followed to block <b>414</b> where the add-on module <b>300</b> may be installed and normal operation using the newly installed add-on module may proceed. Additional add-on modules may be installed using a similar method until all desired add-on modules are operational.</p>
<p id="p-0039" num="0038">Should the funding process at block <b>408</b> fail, or the confirmation of the digital signature and certification at blocks <b>410</b> and <b>412</b> respectively, fail, execution may continue at block <b>416</b> where the user may be presented with an error message and choices for continuing. One choice may be to return to block <b>414</b> for reselection of an add-on module. Processing after presentation <b>416</b> of the error message may also continue by resuming operation (not depicted) using only the basic kernel <b>202</b> core operating system and any previously installed add-on modules.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 6</figref> depicts a method of booting a computer <b>110</b> where one or more add-on modules, such as add-on module <b>300</b>, are already present and when no additional selections are made. The basic kernel <b>202</b>, or core operating system, may be started <b>502</b>. Part of the boot process or initial operation of computer <b>110</b> may determine <b>504</b> whether add-on modules are installed or available to the basic kernel <b>202</b>. The add-on module <b>300</b> may be examined for digital rights indicia at block <b>506</b>. When digital rights indicia are present and the criteria required are satisfied, the yes branch from block <b>506</b> may be followed and the add-on module started at block <b>508</b>. Similarly, if no digital rights indicia are present, the add-on module may be started at block <b>508</b>. Should the digital rights criteria fail at block <b>506</b>, for example, if an expiration date has passed, the fail branch from block <b>506</b> may be followed to block <b>510</b> where a notification may be presented to the user indicating the add-on module was not started. The notification at block <b>510</b> may further include an opportunity to correct the failure, for example, by purchasing an additional usage allocation.</p>
<p id="p-0041" num="0040">By following a process such as that described above, users benefit from the flexibility to add only those capabilities to an operating system which are of value, and, in some cases, for a period of time as needed. Operating system vendors may also benefit by reduced piracy of full capacity operating systems in favor of widely available core operating systems that are easily upgradable in affordable increments. Lastly, service providers or system operators who may be providing computers on a pay-as-you-go or pay-per-use basis may be able to limit installation of potentially harmful applications or hardware peripherals by restricting the installation of required operating system add-on modules.</p>
<p id="p-0042" num="0041">Although the forgoing text sets forth a detailed description of numerous different embodiments of the invention, it should be understood that the scope of the invention is defined by the words of the claims set forth at the end of this patent. The detailed description is to be construed as exemplary only and does not describe every possibly embodiment of the invention because describing every possible embodiment would be impractical, if not impossible. Numerous alternative embodiments could be implemented, using either current technology or technology developed after the filing date of this patent, which would still fall within the scope of the claims defining the invention.</p>
<p id="p-0043" num="0042">Thus, many modifications and variations may be made in the techniques and structures described and illustrated herein without departing from the spirit and scope of the present invention. Accordingly, it should be understood that the methods and apparatus described herein are illustrative only and are not limiting upon the scope of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>I claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of delivering operating system functionality to a computer, the method comprising:
<claim-text>implementing a core operating system function on the computer, the core operating system function comprising memory management for the computer;</claim-text>
<claim-text>determining that a first add-on module for providing additional hardware functionality to the core operating system function is available, the first add-on module providing at least removable memory support for the computer;</claim-text>
<claim-text>determining whether digital rights criteria associated with the first add-on module are satisfied, the digital rights criteria corresponding to at least one of a number of uses of the first add-on module, an expiration date of the first add-on module, or a cumulative number of uses of the first add-on module, are satisfied; and</claim-text>
<claim-text>providing the computer with the removable memory support by executing the first add-on module on the computer, responsive to determining that the digital rights criteria have been satisfied.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>presenting a plurality of add-on modules;</claim-text>
<claim-text>receiving a selection of the first add-on module from the plurality of add-on modules;</claim-text>
<claim-text>confirming a digital signature corresponding to the first add-on module; and</claim-text>
<claim-text>installing the first add-on module on the computer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:
<claim-text>confirming a certification authorizing installation of the first add-on module.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, the removable memory support including capabilities for rotating media comprising CD media and DVD media.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, the removable memory support including capabilities for solid-state memory comprising USB memory peripherals.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, the first add-on module being selected from a plurality of add-on modules, the plurality of add-on modules providing capability for:
<claim-text>adding support for power management to the computer;</claim-text>
<claim-text>adding support for metered disk drives to the computer;</claim-text>
<claim-text>adding support for multiple processors to the computer;</claim-text>
<claim-text>adding support for multiple cores within a single processor to the computer;</claim-text>
<claim-text>adding support for increased screen resolution to the computer;</claim-text>
<claim-text>adding support for increased screen color depth to the computer; and</claim-text>
<claim-text>adding support for patches, bug fixes, and service packs to the computer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, the support for power management offering user options for setting power consumption by the computer.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, the support for the metered disk drives comprising advanced support for disk access including high speed drives, high capacity drives, and network drives.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the core operating system function supports only one processor and the support for multiple processors includes activation of additional processors.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>executing a second add-on module on the computer, the second add-on module allowing variable performance levels for a processor of the computer up to a maximum capability of the processor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the computer comprises a processor, the method further comprising:
<claim-text>executing a second add-on module on the computer, the second add-on module activating additional processors including an additional processor on the computer and an additional processor on a network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the core operating system function supports limited screen resolutions and color depth, the method further comprising:
<claim-text>executing a second add-on module on the computer, the second add-on module expanding the support for screen resolutions and color depth relative to the core operating system function.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein support for service packs, bug fixes, and patches is not included in an original purchase price of the core operating system function.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, further comprising allowing a user to selectively pay for support of bug fixes, service packs, and patches by installing a second add-on module on the computer.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising executing a second add-on module on the computer, the second add-on module providing the computer with support for Internet browsing.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising executing a second add-on module on the computer, the second add-on module providing the computer with support for peer-to-peer networking.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising executing a second add-on module on the computer, the second add-on module providing the computer with support for styles and user interface themes that allow a user to change an experience by personalizing an existing desktop environment on the computer via a new theme, the new theme being based on an existing theme and including:
<claim-text>custom colors,</claim-text>
<claim-text>screensavers,</claim-text>
<claim-text>wallpapers,</claim-text>
<claim-text>sounds,</claim-text>
<claim-text>screen rendering options, and</claim-text>
<claim-text>special effects.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising executing a bundle of add-on modules on the computer, the bundle of add-on modules providing the computer with support for:
<claim-text>advanced sound support, game controller support, and increased video memory.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, the core operating system function further comprising functions for:
<claim-text>system input/output,</claim-text>
<claim-text>boot processes,</claim-text>
<claim-text>file system support, and</claim-text>
<claim-text>fundamental display capabilities.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353047-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353047</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11608572</doc-number>
<date>20061208</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1460</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
<further-classification>726 29</further-classification>
<further-classification>705 65</further-classification>
<further-classification>358  115</further-classification>
</classification-national>
<invention-title id="d2e53">Methods and systems for digital image data tracking</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5671282</doc-number>
<kind>A</kind>
<name>Wolff et al.</name>
<date>19970900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5768483</doc-number>
<kind>A</kind>
<name>Maniwa et al.</name>
<date>19980600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6115739</doc-number>
<kind>A</kind>
<name>Ogawa et al.</name>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6223223</doc-number>
<kind>B1</kind>
<name>Kumpf et al.</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6437875</doc-number>
<kind>B1</kind>
<name>Unno</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6952281</doc-number>
<kind>B1</kind>
<name>Irons et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2002/0085244</doc-number>
<kind>A1</kind>
<name>Blasio et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2003/0046445</doc-number>
<kind>A1</kind>
<name>Witt et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2003/0117664</doc-number>
<kind>A1</kind>
<name>McCarthy</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2003/0217008</doc-number>
<kind>A1</kind>
<name>Habegger et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 51</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2004/0083260</doc-number>
<kind>A1</kind>
<name>Kobayashi et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2004/0114175</doc-number>
<kind>A1</kind>
<name>Cherry et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2004/0263898</doc-number>
<kind>A1</kind>
<name>Ferlitsch</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  115</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2005/0031162</doc-number>
<kind>A1</kind>
<name>Sagi et al.</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382101</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2005/0078336</doc-number>
<kind>A1</kind>
<name>Ferlitsch</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2005/0081137</doc-number>
<kind>A1</kind>
<name>Ferlitsch</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2005/0108280</doc-number>
<kind>A1</kind>
<name>Kagle et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707103 R</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2006/0218188</doc-number>
<kind>A1</kind>
<name>Duncan et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>7071041</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2007/0027818</doc-number>
<kind>A1</kind>
<name>Lofgren et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 65</main-classification></classification-national>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2007/0198632</doc-number>
<kind>A1</kind>
<name>Peart et al.</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709203</main-classification></classification-national>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>EP</country>
<doc-number>1096775</doc-number>
<kind>A2</kind>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>JP</country>
<doc-number>10289308</doc-number>
<date>19981000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>WO</country>
<doc-number>WO0195609</doc-number>
<kind>A1</kind>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00024">
<othercit>Chipless ID for Paper Documents; Daniel Lopresti and George Nagy;Department of Computer Science and Engineering; Lehigh University, Bethlehem, PA 18015 USA;2005, http://www.cse.lehigh.edu.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
</references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>358  115</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 50</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 51</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 65</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20080137129</doc-number>
<kind>A1</kind>
<date>20080612</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ferlitsch</last-name>
<first-name>Andrew Rodney</first-name>
<address>
<city>Camas</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Matthews</last-name>
<first-name>Kristine Elizabeth</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Ripma</last-name>
<first-name>David C.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Sharp Laboratories of America, Inc.</orgname>
<role>02</role>
<address>
<city>Camas</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Truong</last-name>
<first-name>Thanhnga B</first-name>
<department>2438</department>
</primary-examiner>
<assistant-examiner>
<last-name>Lee</last-name>
<first-name>Jason</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Embodiments of the present invention comprise systems and methods for notification handling in a processing server and an imaging device.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="127.76mm" wi="178.65mm" file="US08353047-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="129.71mm" wi="177.63mm" file="US08353047-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="199.14mm" wi="156.97mm" file="US08353047-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="237.83mm" wi="88.73mm" file="US08353047-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="226.48mm" wi="166.45mm" file="US08353047-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="235.63mm" wi="168.66mm" file="US08353047-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="234.61mm" wi="146.13mm" file="US08353047-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">Embodiments of the present invention comprise methods and systems for digital image data tracking.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">It is desirable to recognize the presence of digital image data on a processing server without a separate monitoring process. It is also desirable to track, over the entire lifecycle of a document comprising digital image data, the history of the document processing subsequent to the initial processing by the processing server.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0004" num="0003">Some embodiments of the present invention comprise methods and systems for digital image data tracking comprising associating a document tracking identifier with digital image data, wherein the document tracking identifier comprises the communication address of the imaging device that generated the digital image data and a globally unique identifier.</p>
<p id="p-0005" num="0004">The foregoing and other objectives, features, and advantages of the invention will be more readily understood upon consideration of the following detailed description of the invention taken in conjunction with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE SEVERAL DRAWINGS</heading>
<p id="p-0006" num="0005"><figref idref="DRAWINGS">FIG. 1</figref> is a drawing showing embodiments of the present invention comprising an imaging device, a remote computing device, and a scan server;</p>
<p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. 2</figref>. is a diagram showing embodiments of the present invention comprising a scan server that may register to receive event notifications and may monitor events;</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing embodiments of the present invention comprising an imaging device that may send and receive event notifications;</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing embodiments of the present invention comprising an imaging device that may receive post-processing event notifications and display update messages on a control panel display;</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram showing embodiments of the present invention comprising an imaging device that may receive final-delivery event notifications and display update messages on a control panel display;</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram showing embodiments of the present invention comprising embedding a document tracking identifier in scanned image data;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram showing embodiments of the present invention comprising document duplication notification;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram showing embodiments of the presenting invention comprising embedding a document tracking identifier in digital image data;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 9</figref> is a diagram showing embodiments of the present invention comprising receiving event notification at an imaging device and recording receipt of the event notification in a job record; and</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 10</figref> is a diagram showing embodiments of the present invention comprising document duplication notification.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF EXEMPLARY EMBODIMENTS</heading>
<p id="p-0016" num="0015">Embodiments of the present invention will be best understood by reference to the drawings, wherein like parts are designated by like numerals throughout. The figures listed above are expressly incorporated as part of this detailed description.</p>
<p id="p-0017" num="0016">It will be readily understood that the components of the present invention, as generally described and illustrated in the figures herein, could be arranged and designed in a wide variety of different configurations. Thus, the following more detailed description of the embodiments of the methods and systems of the present invention is not intended to limit the scope of the invention but it is merely representative of the presently preferred embodiments of the invention.</p>
<p id="p-0018" num="0017">Elements of embodiments of the present invention may be embodied in hardware, firmware and/or software. While exemplary embodiments revealed herein may only describe one of these forms, it is to be understood that one skilled in the art would be able to effectuate these elements in any of these forms while resting within the scope of the present invention.</p>
<p id="p-0019" num="0018">Embodiments of the present invention may comprise methods and systems for recognizing the presence of digital image data on a processing server without a separate monitoring process. Embodiments of the present invention may also comprise methods and systems to track, over the entire lifecycle of a document comprising digital image data, the history of the document processing subsequent to the initial processing by the processing server. Some embodiments of the present invention comprise methods and systems for digital image data tracking comprising associating a document tracking identifier with digital image data, wherein the document tracking identifier comprises the communication address of the imaging device that generated the digital image data and a globally unique identifier.</p>
<p id="p-0020" num="0019">Embodiments of the present invention are described herein using scanned image data as exemplary digital image data and a scan server as an exemplary processing server. These descriptions are by way of illustration and not limitation. Exemplary digital image data may include, in addition to scanned image data, fax data, digital camera image data, digital image data generated by a print driver, and any other digital image data. Exemplary processing servers may include any server providing a processing function on digital image data.</p>
<p id="p-0021" num="0020">Exemplary embodiments of the present invention may be described in relation to <figref idref="DRAWINGS">FIG. 1</figref>. These exemplary embodiments may comprise an imaging device <b>10</b> comprising a scanning device. In some embodiments, the imaging device <b>10</b> may take the form of a multi-function peripheral device (MFP) that combines the functions of two or more traditionally separated imaging devices. An MFP may combine any number of imaging devices, but typically comprises the functions of a printer, scanner, copier and fax machine. In alternate embodiments, the imaging device <b>10</b> may take the form of a separate scanner. The imaging device <b>10</b> may be connected to a remote computing device <b>12</b> and a scan server <b>14</b>. In some embodiments, the remote computing device <b>12</b> and the scan server <b>14</b> may be distinct. In alternate embodiments, the remote computing device <b>12</b> and the scan server <b>14</b> may be the same device.</p>
<p id="p-0022" num="0021">The connection <b>11</b> between the imaging device <b>10</b> and the remote computing device <b>12</b> and the connection <b>13</b> between the imaging device <b>10</b> and the scan server <b>14</b> may be any communications link, such as a network connection, a telephone line, a serial cable or some other wired or wireless communications link.</p>
<p id="p-0023" num="0022">The imaging device <b>10</b> may further comprise a user interface (UI) panel <b>16</b>, which may comprise input buttons <b>15</b> and a display device <b>17</b>. In some embodiments, the display device <b>17</b> may comprise a touch panel system with or without input buttons <b>15</b>. User input and display may also be performed through a separate UI device <b>18</b> that may be connected to the imaging device <b>10</b> by a communication link <b>19</b>, for example, a USB (Universal Serial Bus) connection, a network cable, a wireless connection or some other communications link. The UI device <b>18</b> may comprise an input device, such as a keyboard or buttons as well as a display device, which may also be a touch screen panel. The UI device <b>18</b> may also comprise an interface for transfer of instructions that are input to the device <b>18</b> from a remote input device. This form of UI device <b>18</b> may comprise memory sticks, USB memory cards and other storage devices that may be configured to store input for transfer to an imaging device. The display device <b>17</b> or UI device <b>18</b> may also be under the control of an external application, which may be hosted on the remote computing device <b>12</b>, the scan server <b>14</b>, or another computing host (not shown).</p>
<p id="p-0024" num="0023">The imaging device <b>10</b> may comprise scan-to-destination capabilities. Scan-to-destination operations may comprise those in which a final or intermediate outcome is the delivery of digital image data. Exemplary operations may include copy, fax in, fax out, print, file transfer, scan, OCR (Optical Character Recognition), Bates stamping, and file format conversion. Exemplary destinations may include a print engine, a network path, a local storage medium, a local port, for example, a USB port, an electronic-mail (email) address, an FTP (File Transfer Protocol) site, a PSTN (Public Switched Telephone Network) and a URL (Uniform Resource Locator). Scan-to-destination capabilities may comprise loading a scan-to-destination profile on the imaging device <b>10</b>, where the scan-to-destination profile effectuates the delivery of scanned image data to a specified folder on the scan server <b>14</b>. Exemplary scanned image data formats include TIFF (Tagged Image File Format), TIFF-FX (Tagged Image File Format-FaX), JPEG (Joint Photographic Experts Group), JPEG2000, PNG (Portable Network Graphics), BMP (BitMaP), GIF (Graphic Interchange Format), and PDF (Portable Document Format). The delivery of scanned image may be via any communications method, protocol or combination thereof, for example, SOAP/XML (Simple Object Access Protocol/eXtensible Markup Language), DIME (Direct Internet Message Encapsulation), FTP, NFS (Network File System), SMTP (Simple Mail Transfer Protocol), HTTP/HTML (Hyper Text Transfer Protocol/Hyper Text Markup Language), AppleTalk, and a proprietary protocol over TCP/IP (Transmission Control Protocol/Internet Protocol). The scan-to-destination profile may additionally contain metadata that may be transmitted with the scanned image data. The metadata may comprise indications of how the scanned image data may be post-processed. Exemplary post-processing operations may include delivery to a designated client and OCR operations. The data generated by OCR processing may be further processed, such as for natural language translation or content summarization. A user may initiate a scanning process by selecting a scan-to-destination profile and subsequently scanning one or more documents.</p>
<p id="p-0025" num="0024">The imaging device <b>10</b> functionality and user interface <b>16</b>, <b>18</b> may be controlled by an external application residing on the remote computing device <b>12</b>. One method for controlling an imaging device via an external application residing on a remote computing device is disclosed in U.S. patent application Ser. No. 10/962,248, entitled &#x201c;Methods and Systems for Imaging Device Remote Application Interaction,&#x201d; filed on Oct. 8, 2004 which is hereby incorporated herein by reference.</p>
<p id="p-0026" num="0025">In some exemplary embodiments, the imaging device <b>10</b> may register for and receive job completion notifications from the scan server <b>14</b>. In some embodiments of the present invention, the scan server <b>14</b> may receive scanned image data from the imaging device <b>10</b>, may post process the received scanned image data, may deliver the post-processed scanned image data to a final or intermediate destination, or may send notifications of the status of the post-processing.</p>
<p id="p-0027" num="0026">In some embodiments of the present invention, the imaging device <b>10</b> may send an event notification to a client, for example, the scan server <b>14</b>, when the imaging device <b>10</b> transfers a scanned image file. Exemplary operations in which a file transfer may occur include scan-to-destination, fax transmittal, offline storage transfer, and external translation operations. In some embodiments, the imaging device <b>10</b> may send an event notification when the file transfer is complete. In alternative embodiments, notification may be sent at the initiation of a file transfer. In still alternate embodiments, notification including progress updates may be sent periodically during file transfer. File transfer event notifications may be sent to multiple clients.</p>
<p id="p-0028" num="0027">In some embodiments, a client recipient may be predefined, for example by a system administrator. In alternative embodiments, a client device may register to receive file transfer notification. A client device may register with an imaging device to receive notification using a registration message. A registration request message may be sent by any of numerous protocols including, for example, SOAP/XML, HTTP/HTML, or a proprietary protocol over TCP/IP. An exemplary SOAP/XML registration message may be:</p>
<p id="p-0029" num="0028">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>&#x3c;action type=&#x201d;register&#x201d;&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;event type=&#x201d;file transfer&#x201d; action=&#x201d;notify&#x201d;&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;transfer-start&#x3e;no&#x3c;/transfer-start&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;transfer-progress&#x3e;no&#x3c;/transfer-progress&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;transfer-end&#x3e;yes&#x3c;/transfer-end&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;/event&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;destination&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;address type=&#x201d;ip&#x201d;&#x3e;ip_address&#x3c;/address&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;protocol&#x3e;SOAP&#x3c;/protocol&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;destination&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x3c;/action&#x3e;</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
where &#x3c;transfer-start&#x3e;no&#x3c;/transfer-start&#x3e; indicates that the client does not request notification at the start of the transfer, &#x3c;transfer-progress&#x3e;no&#x3c;/transfer-progress&#x3e; indicates that the client does not request notification of transfer progress, and &#x3c;transfer-end&#x3e;yes&#x3c;/transfer-end&#x3e; indicates that the client requests notification at the end of the file transfer. The notification is to be sent to the address indicated by ip_address using SOAP protocol.
</p>
<p id="p-0030" num="0029">In some embodiments, the client device may only register after authentication of the client to the imaging device <b>10</b>. In some embodiments, the imaging device <b>10</b> may impose restrictions on which events or operations a client may register for notification. In still alternate embodiments, a client device may receive notification of a file transfer based on data relating to the file-transfer operation. In some embodiments, the client device may only register after the imaging device <b>10</b> has announced (e.g., multicast, unicast, or broadcast) its presence or acceptance window for registration.</p>
<p id="p-0031" num="0030">In some embodiments of the present invention, the scan server <b>14</b> may register with the imaging device <b>10</b> to receive event notification for events associated with scan-to-destination operations. Exemplary notifications include notification of availability of a scanned image that may be processed by the scan server <b>14</b> and file transfers to destinations that are accessible to the scan server <b>14</b>. Exemplary methods of identifying scan-to-destination operations include identifying those operations associated with a particular group of scan-to-destination profiles and those operations associated with a particular remote application.</p>
<p id="p-0032" num="0031">In some embodiments, the imaging device <b>10</b> may be controlled by an application residing on the remote computing device <b>12</b>. Registered events may be associated with the application on the remote computing device <b>12</b>, and the imaging device <b>10</b> may send notification of file transfers only when the imaging device <b>10</b> is under the control of the application on the remote computing <b>12</b>.</p>
<p id="p-0033" num="0032">The scan server <b>14</b> may monitor continuously for event notification. In some embodiments, the monitoring process may be associated with a port, protocol, or URI (Uniform Resource Identifier). When the network interface of the scan server <b>14</b> receives a notification, it may initiate or otherwise alert the scan processing process. Upon receipt of a notification, the scan server <b>14</b> may examine the notification to determine information carried by the notification. Exemplary information may include the location of the transferred file, the location of metadata associated with the transferred file, the metadata associated with the transferred file, ownership information, a timestamp, the originating device. An exemplary XML notification may be of the form:</p>
<p id="p-0034" num="0033">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>&#x3c;action type=&#x201d;notify&#x201d;&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;event type=&#x201d;file transfer&#x201d;&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;transfer-end&#x3e;yes&#x3c;/transfer-end&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;/event&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;file&#x3e;file_path&#x3c;/file&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;source&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;address type=&#x201d;ip&#x201d;&#x3e;ip_address&#x3c;/address&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;remote-application&#x3e;application_name&#x3c;/remote-application&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;job id=&#x201d;...&#x201d;&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;/source&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;final-destination&#x3e;destination_info&#x3c;/final-destination&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;response&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;confirm-receipt&#x3e;yes&#x3c;/confirm-receipt&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;confirm-processing&#x3e;yes&#x3c;/confirm-processing&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;confirm-deliver&#x3e;yes&#x3c;/confirm-delivery&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;/response&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;actions&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;OCR&#x3e;yes&#x3c;/OCR&#x3e;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;&#x3c;/actions&#x3e;</entry>
</row>
<row>
<entry>&#x3c;/action&#x3e;</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
where the action associated with a delivery file is independent of the location to which the file is delivered. In some embodiments, a processing queue may be implemented at the scan server <b>14</b> based on the order in which the event notifications are received.
</p>
<p id="p-0035" num="0034">In some embodiments, after the scan processing process has received and examined the notification, the scan processing process may initiate the processing of the scanned image data. The processing may commence immediately in some embodiments, or in alternate embodiments, the processing may be deferred, for example, in queue-based processing. In some embodiments, validation actions may be performed after the scan server <b>14</b> receives the event notification. Exemplary validation actions include verifying the data in the event notification, verifying the data is present and complete at the specified location, verifying format and version support for the data, verifying that the specified requested action is supported, and authentication of the request. In some embodiments, the scan server <b>14</b> may acknowledge receipt of the scanned image data in a message to the imaging device <b>10</b>. An exemplary acknowledgement message in XML format may be:</p>
<p id="p-0036" num="0035">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>&#x3c;action type=&#x201d;notify&#x201d;&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;event type=&#x201d;file transfer&#x201d;&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;confirm-receipt&#x3e;yes&#x3c;/confirm-receipt&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;/event/</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;file&#x3e;file_path&#x3c;/file&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;destination&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;address type=&#x201d;ip&#x201d;&#x3e;ip_address&#x3c;/address&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x2003;&#x2003;&#x3c;job id=&#x201d;...&#x201d;&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x2003;&#x2003;&#x3c;/destination&#x3e;</entry>
</row>
<row>
<entry/>
<entry>&#x3c;/action&#x3e;</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
where ip_address is the address of the imaging device <b>10</b>.
</p>
<p id="p-0037" num="0036">In some embodiments, when the imaging device <b>10</b> receives confirmation from the scan server <b>14</b> that the scanned image data has been received, the imaging device <b>10</b> may display on the front panel display <b>17</b> a confirmation message that the scan server <b>14</b> has accepted the scanned image data for processing. In some embodiments, the front panel confirmation may be under the control of an application on the remote computing device <b>12</b> after the imaging device <b>10</b> has relayed the receipt confirmation message from the scan server <b>14</b> to the remote computing device <b>12</b>. The imaging device <b>10</b> may update a dynamic record for the scan job to indicate that it was accepted by the scan server <b>14</b> for processing. The imaging device <b>10</b> may be released to proceed to the next operation. Secondary notification may be sent by the imaging device <b>10</b> to another client upon receipt of confirmation of receipt of the scanned image data from the scan server <b>14</b>. Other clients may include, for example, a job accounting server and an auditing server. The dynamic record for the scan job may maintain a notification history or a notification state.</p>
<p id="p-0038" num="0037">The scan processing process may initiate post-processing actions associated with the scanned image data. Exemplary post-processing actions may include OCR, Bates stamping, indexing, content auditing, content filtering, image enhancement, compression, encryption, merging of multiple scanned images (also considered composition), format conversion, spelling/grammar correction, and natural language translation. Any combination or number of post-processing actions may be combined.</p>
<p id="p-0039" num="0038">In some embodiments of the present invention, the post-processing actions to be performed on scanned image data may be specified in the file-transfer event, may be specified in the metadata associated with the scanned image data, may be inferred from the delivery destination, may be inferred from a profile associated with the user who initiated the scan-to-destination operation, or may be derived dynamically from the contents of the scanned image data. In some embodiments of the present invention, the scan server <b>14</b> may send a notification to the imaging device <b>10</b> upon completion of a post-processing action. Notification may also be sent to any client device that has registered for notification of a particular post-processing action event.</p>
<p id="p-0040" num="0039">In some embodiments, the notification may be sent by an individual post-processing application. In alternative embodiments, the scan server directing the post-processing actions may send the notification. In alternate embodiments in which an external application is controlling the post-processing actions, the external application may send notifications.</p>
<p id="p-0041" num="0040">Upon receipt of a post-processing notification, the imaging device <b>10</b> may display on the front panel display <b>17</b> a confirmation message that the post-processing action has been completed. In some embodiments, the front panel confirmation may be under the control of an application on the remote computing device <b>12</b> after the imaging device <b>10</b> has relayed the post-processing notification message from the scan server <b>14</b> to the remote computing device <b>12</b>. The imaging device <b>10</b> may update a dynamic record for the scan job to indicate that the post-processing action has been completed The imaging device <b>10</b> may be released to proceed to the next operation. Secondary post-processing notification may be sent by the imaging device <b>10</b> to another client upon receipt of the post-processing notification. Other clients may include, for example, a job accounting server and an auditing server. In some embodiments, notifications associated with post-processing may include notification of when a post-processing action is scheduled, status notification on the progress of a post-processing step, and notification of requests for resources or configuration information.</p>
<p id="p-0042" num="0041">After completion of post processing, the scan server <b>14</b> may transmit the post-processed scanned image data to its final destination. Exemplary methods by which the post-processed scanned image data may be sent include according to a method specified in an event, by a method registered by a client, or by a method predefined at the scan server <b>14</b>. In some embodiments of the present invention, after the post-processed scanned image data is successfully transmitted to its final destination, the scan server <b>14</b> may send a confirmation message (final-delivery notification) to the imaging device <b>10</b> indicating the successful transfer of the data. Or upon failure, a message indicating the failure of data transfer.</p>
<p id="p-0043" num="0042">Upon receipt of a final-delivery notification, the imaging device <b>10</b> may display on the front panel display <b>17</b> a message reflecting the final-delivery status of the post-processed scanned image data. In some embodiments, the front panel confirmation may be under the control of an application on the remote computing device <b>12</b> after the imaging device <b>10</b> has relayed the final-delivery notification message from the scan server <b>14</b> to the remote computing device <b>12</b>. The imaging device <b>10</b> may update a dynamic record for the scan job to indicate the final-delivery status. The imaging device <b>10</b> may be released to proceed to the next operation. Secondary final-delivery notification may be sent by the imaging device <b>10</b> to another client upon receipt of the final-delivery notification. Other clients may include, for example, a job accounting server and an auditing server.</p>
<p id="p-0044" num="0043">Some embodiments of the present invention may be described in relation to <figref idref="DRAWINGS">FIG. 2</figref>. A client device, for example a scan server, may register <b>20</b> with an imaging device to receive notification of a file-transfer event. The scan server may then continuously monitor <b>22</b> events. Upon receipt of an event notification, the scan server may process <b>24</b> the event notification, and if the scanned image data has been successfully received at the scan server, the scan server may send <b>25</b> a receipt of confirmation to the imaging device. The scan server may also initiate post processing <b>26</b> of the scanned image data. Upon completion of each post-processing action, the scan server may send <b>27</b> notification confirming the completion of the post-processing action to the imaging device. After all post-processing actions have terminated, the scan server may transfer <b>28</b> the post-processed scanned image data to a final destination. Upon transfer of the post-processed image data to the final destination, the scan server may send <b>30</b> a final-destination transfer confirmation to the imaging device.</p>
<p id="p-0045" num="0044">Some embodiments of the present invention may be described in relation to <figref idref="DRAWINGS">FIG. 3</figref>. An imaging device may after transferring <b>32</b> a file containing scanned image data, send <b>33</b> file-transfer event notifications to client devices. Upon receiving <b>34</b> a receipt indicating reception of the scanned image data by a receiving device, the imaging device may record <b>35</b> in a job history that the scanned image data was received, as evidenced by the receipt. The imaging device may then display <b>36</b> a message to this effect on the display of either a local or external control panel.</p>
<p id="p-0046" num="0045">Some embodiments of the present invention may be described in relation to <figref idref="DRAWINGS">FIG. 4</figref>. After receiving <b>40</b> notification of a post-processing event from a scan server, an imaging device may record <b>42</b> in a job history that the post-processing event has occurred, as evidenced by receipt of the notification. The imaging device may then display <b>44</b> a message to this effect on the display of either a local or external control panel.</p>
<p id="p-0047" num="0046">Some embodiments of the present invention may be described in relation to <figref idref="DRAWINGS">FIG. 5</figref>. After receiving <b>50</b> notification from a scan server that post processed scanned image data has been delivered to its final destination, an imaging device may record <b>52</b> in a job history that the final delivery has occurred, as evidenced by receipt of the final-delivery notification. The imaging device may then display <b>54</b> a message to this effect on the display of either a local or external control panel.</p>
<p id="p-0048" num="0047">In some embodiments of the present invention, an imaging device may associate a job-tracking identifier with the scanned image data generated at the imaging device. In some embodiments, the job-tracking identifier may comprise a communication address of the originating source, for example, the communication address of the imaging device. In some embodiments, the job-tracking identifier may comprise a globally unique identifier (GUID), for example a GUID generated by the Microsoft GUID generator.</p>
<p id="p-0049" num="0048">In some embodiments of the present invention, the job-tracking identifier may be embedded in metadata associated with the scanned image. In alternative embodiments, the job-tracking identifier may be embedded in the scanned image data. In some embodiments, the job-tracking identifier may be encrypted. In alternate embodiments, the job-tracking identifier may be part of the encryption key for the image content embedded in the encrypted job identifier. For example, in some embodiments of the present invention, a first key may be used to decrypt an encryption header. The decrypted header may comprise a second key for decrypting the image content in addition to additional information, for example, the job identifier.</p>
<p id="p-0050" num="0049">Some embodiments of the present invention may described in relation to <figref idref="DRAWINGS">FIG. 6</figref>. An imaging device may generate <b>62</b> scanned image data <b>61</b> from an input document <b>60</b>. The imaging device may then embed <b>64</b> a document tracking identifier into the scanned image data <b>61</b>. The document tracking identifier may comprise the communication address of the imaging device. In alternative embodiments, the document tracking identifier may comprise additional information <b>63</b>, for example a globally unique identifier. After embedding <b>64</b> the document tracking identifier into the scanned image data, the imaging device may record <b>66</b> the document tracking identifier in a job history database maintained by the imaging device. In some embodiments, the job history database may reside on the imaging device. In alternative embodiments, the job history database may be external to the imaging device. The scanned image data embedded with the document tracking identifier <b>67</b> may be transferred <b>68</b> as in a scan-to-destination operation. In some embodiments, the document tracking identifier may be persistent over the lifecycle of the document.</p>
<p id="p-0051" num="0050">In some embodiments, the imaging device may receive notifications on subsequent use or processing downstream from the scan server and associated post-processing services, for example, when the scanned image data is viewed, when the scanned image data is altered or destroyed, and when the scanned image data is transferred. In some embodiments, the scanned image data and any documents derived from the scanned image data may be maintained within a system that is compatible with the event notification system to the imaging device. In these embodiments, processes to view, duplicate, modify, destroy, and otherwise access and process the scanned image data and documents derived from the scanned image data may only be performed by applications that support event notification according to the embodiments of the present invention.</p>
<p id="p-0052" num="0051">Some embodiments of the present invention comprise a secure operating environment. Alternative embodiments of the present invention, may enforce security by encrypting scanned image data and documents derived from the scanned image data using a symmetric or public key, or keys, associated with an application compatible with event notifications. In such embodiments, attempts to view or otherwise access the scanned image data and documents derived from the scanned image data using applications that do not support the event notifications may be unsuccessful since such applications may not have the matching symmetric or private key required to decrypt the data.</p>
<p id="p-0053" num="0052">In some embodiments of the present invention, when a derived document is subsequently processed after final delivery, the application performing the processing may extract from the document the document tracking identifier and may send a notification to the imaging device. The notification may comprise information regarding the processing action and the completion status. The imaging device may update the dynamic job record associated with the originally scanned image data. Exemplary subsequent processing operations may include viewing, printing, modifying content, exporting, copying, and destroying the document.</p>
<p id="p-0054" num="0053">Some embodiments of the present invention may be described relative to <figref idref="DRAWINGS">FIG. 7</figref>. If subsequent processing of a derived document <b>70</b> comprises electronic duplication <b>72</b>, the document tracking identifier associated with the originally scanned image data may be modified <b>74</b> and embedded <b>76</b> in the electrically duplicated document. In some embodiments, modification of the document tracking identifier may comprise adding an instance identifier to the document tracking identifier. The imaging device may be notified <b>78</b> of the document duplication. In some embodiments, notification may additionally contain the instance information. In these embodiments, the imaging device may create a branch in the job history log corresponding to the instance. Notification to the imaging device of processing actions on the duplicate document may be updated in the job history log at the corresponding branch by the imaging device.</p>
<p id="p-0055" num="0054">In some embodiments of the present invention, when a derived document is destroyed, a notification of the destruction of the derived document may be sent to the imaging device. Exemplary action which may be viewed as document destruction include deleting the document record from the file system, deleting the document content from the file system, and obscuring the deleted document contents from data recovery. The imaging device may then update the job history record to indicate the destruction of the document. In some embodiments, the imaging device may freeze the job history. Any subsequence notifications relating to the document may be flagged. In some embodiments, an alert to a system administrator may be generated by the imaging device.</p>
<p id="p-0056" num="0055">Some embodiments of the present invention may described in relation to <figref idref="DRAWINGS">FIG. 8</figref>. An imaging device may generate <b>82</b> digital image data. In alternative embodiments, the imaging device may receive the digital image data. The imaging device may then embed <b>84</b> a document tracking identifier into the digital image data. The document tracking identifier may comprise the communication address of the imaging device. In alternative embodiments, the document tracking identifier may comprise additional information <b>83</b>, for example a globally unique identifier. After embedding <b>84</b> the document tracking identifier into the digital image data, the imaging device may record <b>86</b> the document tracking identifier in a job history database maintained by the imaging device. In some embodiments, the job history database may reside on the imaging device. In alternative embodiments, the job history database may be external to the imaging device. The digital image data embedded with the document tracking identifier <b>87</b> may be transferred <b>88</b> to a processing server. In some embodiments, the document tracking identifier may be persistent over the lifecycle of the document.</p>
<p id="p-0057" num="0056">In some embodiments, the imaging device may receive notifications on subsequent use or processing downstream from the processing server, for example, when the digital image data is viewed, when the digital image data is altered or destroyed, and when the digital image data is transferred. In some embodiments, the digital image data and any documents derived from the digital image data may be maintained within a system that is compatible with the event notification system to the imaging device. In these embodiments, processes to view, duplicate, modify, destroy, and otherwise access and process the digital image data and documents derived from the digital image data may only be performed by applications that support event notification according to the embodiments of the present invention.</p>
<p id="p-0058" num="0057">Some embodiments of the present invention may be described in relation to <figref idref="DRAWINGS">FIG. 9</figref>. An imaging device may receive <b>92</b> event notification from a processing server. The imaging device may determine <b>94</b> the job tracking identifier from the event notification and record <b>96</b> receipt of the event notification in the job record associated with the job tracking identifier. In some embodiments, the job record may be part of a job history database that may be maintained by the imaging device. In some embodiments, the job record may reside on the imaging device. In alternate embodiments, the job record may reside on a storage medium that may be external to the imaging device. The imaging device may display <b>98</b>, on a control panel display associated with the imaging device, a message reflecting the receipt <b>92</b> of the event notification or a message related to the processing associated with the notification.</p>
<p id="p-0059" num="0058">Some embodiments of the present invention comprise a secure operating environment. Alternative embodiments of the present invention, may enforce security by encrypting digital image data and documents derived from the digital image data using a symmetric or public key, or keys, associated with an application compatible with event notifications. In such embodiments, attempts to view or otherwise access the digital image data and documents derived from the digital image data using applications that do not support the event notifications may be unsuccessful since such applications may not have the matching symmetric or private key required to decrypt the data.</p>
<p id="p-0060" num="0059">In some embodiments of the present invention, when a derived document is subsequently processed after final delivery, the application performing the processing may extract from the document the document tracking identifier and may send a notification to the imaging device. The notification may comprise information regarding the processing action and the completion status. The imaging device may update the dynamic job record associated with the original digital image data. Exemplary subsequent processing operations may include viewing, printing, modifying content, exporting, copying, and destroying the document.</p>
<p id="p-0061" num="0060">Some embodiments of the present invention may be described relative to <figref idref="DRAWINGS">FIG. 10</figref>. If subsequent processing of a derived document <b>100</b> comprises electronic duplication <b>102</b>, the document tracking identifier associated with the originally generated digital image data may be modified <b>104</b> and embedded <b>106</b> in the electrically duplicated document. In some embodiments, modification of the document tracking identifier may comprise adding an instance identifier to the document tracking identifier. The imaging device may be notified <b>108</b> of the document duplication. In some embodiments, notification may additionally contain the instance information. In these embodiments, the imaging device may create a branch in the job history log corresponding to the instance. Notification to the imaging device of processing actions on the duplicate document may be updated in the job history log at the corresponding branch by the imaging device.</p>
<p id="p-0062" num="0061">The terms and expressions which have been employed in the foregoing specification are used therein as terms of description and not of limitation, and there is no intention in the use of such terms and expressions of excluding equivalence of the features shown and described or portions thereof, it being recognized that the scope of the invention is defined and limited only by the claims which follow.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for tracking digital image data, said method comprising:
<claim-text>generating digital image data on an imaging device;</claim-text>
<claim-text>associating a document tracking identifier with said digital image data, wherein said document tracking identifier comprises the communication address of said imaging device and a globally unique identifier for said digital image data;</claim-text>
<claim-text>recording said document tracking identifier in a first job history record maintained by said imaging device, thereby associating said document tracking identifier with said first job history record;</claim-text>
<claim-text>notifying a processing server of the availability of said digital image data;</claim-text>
<claim-text>notifying said processing server of said document tracking identifier associated with said digital image data;</claim-text>
<claim-text>receiving a receipt notification for said digital image data from said processing server at said imaging device, whereby said receipt notification indicates the receipt of said digital image data at said processing server from said imaging device and comprises said document tracking identifier;</claim-text>
<claim-text>recording receipt of said receipt notification in said first job history record;</claim-text>
<claim-text>in response to said receiving, releasing said imaging device to proceed to a next operation; and</claim-text>
<claim-text>notifying a client of said receiving of said receipt notification for said digital image data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said imaging device is a multi-function peripheral device.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said document tracking identifier is embedded in said digital image data.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said document tracking identifier is embedded in metadata associated with said digital image data.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said document tracking identifier is encrypted.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>receiving a post-processing action notification associated with said digital image data from said processing server at said imaging device, whereby said post-processing action notification comprises said document tracking identifier; and</claim-text>
<claim-text>recording receipt of said post-processing action notification in said first job history record.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>receiving a final-delivery notification associated with said digital image data from said processing server at said imaging device, whereby said final-delivery notification comprises said document tracking identifier; and</claim-text>
<claim-text>recording receipt of said final-delivery notification in said first job history record.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>receiving a duplication notification associated with said digital image data from a remote computing device at said imaging device, whereby said duplication notification indicates duplication of said digital image data and comprises said document tracking identifier;</claim-text>
<claim-text>receiving a modified document tracking identifier from said remote computing device at said imaging device, whereby said modified document tracking identifier is associated with said duplication of said digital image data;</claim-text>
<claim-text>establishing a second job history record associated with said modified tracking identifier and said first job history record; and</claim-text>
<claim-text>recording said modified document tracking identifier in said second job history record.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>receiving a destruction notification associated with said digital image data from a first remote computing device at said imaging device, whereby said destruction notification indicates the destruction of said digital image data and comprises said document tracking identifier;</claim-text>
<claim-text>recording receipt of said destruction notification in said first job history record; and</claim-text>
<claim-text>receiving a subsequent notification associated with said digital image data from a second remote computing device at said imaging device, wherein said subsequent notification is received at said imaging device after said destruction notification;</claim-text>
<claim-text>generating an alert related to said subsequent notification at said imaging device; and</claim-text>
<claim-text>sending said alert to an administrative computing device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A method for tracking digital image data, said method comprising:
<claim-text>generating digital image data on an imaging device;</claim-text>
<claim-text>associating a document tracking identifier with said digital image data, wherein said document tracking identifier comprises the communication address of said imaging device and a globally unique identifier for said digital image data;</claim-text>
<claim-text>recording said document tracking identifier in a job history record maintained by said imaging device, thereby associating said document tracking identifier with said job history record;</claim-text>
<claim-text>notifying a processing server of the availability of said digital image data;</claim-text>
<claim-text>notifying said processing server of said document tracking identifier associated with said digital image data;</claim-text>
<claim-text>receiving a receipt notification for said digital image data from said processing server at said imaging device, whereby said receipt notification indicates the receipt of said digital image data at said processing server from said imaging device and comprises said document tracking identifier;</claim-text>
<claim-text>recording receipt of said receipt notification in said job history record;</claim-text>
<claim-text>in response to said receiving said receipt notification, releasing said imaging device to proceed to a next operation;</claim-text>
</claim-text>
<claim-text>receiving an event notification comprising said document tracking identifier;
<claim-text>recording receipt of said event in said job history record; and</claim-text>
<claim-text>notifying a client of said receiving of said receipt notification for said digital image data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein said document tracking identifier is embedded in said digital image data.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein said document tracking identifier is embedded in metadata associated with said digital image data.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein said document tracking identifier is encrypted.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein said event notification comprises notification of post processing of said digital image data.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein said event notification comprises:
<claim-text>notification of duplication associated with said digital image data; and</claim-text>
<claim-text>a modified document tracking identifier. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353048-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353048</doc-number>
<kind>B1</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11461247</doc-number>
<date>20060731</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1105</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 27</main-classification>
<further-classification>726 17</further-classification>
<further-classification>726 18</further-classification>
<further-classification>713193</further-classification>
<further-classification>709204</further-classification>
<further-classification>709238</further-classification>
<further-classification>380270</further-classification>
</classification-national>
<invention-title id="d2e53">Application digital rights management (DRM) and portability using a mobile device for authentication</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7027808</doc-number>
<kind>B2</kind>
<name>Wesby</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455419</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7162543</doc-number>
<kind>B2</kind>
<name>Fischer et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7362869</doc-number>
<kind>B2</kind>
<name>Landrock</name>
<date>20080400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380277</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7415721</doc-number>
<kind>B2</kind>
<name>Fransdonk</name>
<date>20080800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  4</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7447907</doc-number>
<kind>B2</kind>
<name>Hart et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713176</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7484103</doc-number>
<kind>B2</kind>
<name>Woo et al.</name>
<date>20090100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713189</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7512806</doc-number>
<kind>B2</kind>
<name>Lemke</name>
<date>20090300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713186</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7529929</doc-number>
<kind>B2</kind>
<name>Asokan et al.</name>
<date>20090500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713161</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7545941</doc-number>
<kind>B2</kind>
<name>Sovio et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380270</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7591017</doc-number>
<kind>B2</kind>
<name>Watkins et al.</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7734549</doc-number>
<kind>B2</kind>
<name>Dabbish et al.</name>
<date>20100600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 59</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>7783702</doc-number>
<kind>B2</kind>
<name>Liu et al.</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709204</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7788709</doc-number>
<kind>B1</kind>
<name>Henry et al.</name>
<date>20100800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  6</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>7809953</doc-number>
<kind>B2</kind>
<name>Little et al.</name>
<date>20101000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713184</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>8089520</doc-number>
<kind>B2</kind>
<name>Ko et al.</name>
<date>20120100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3482111</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2002/0059516</doc-number>
<kind>A1</kind>
<name>Turtiainen et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713153</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2002/0126652</doc-number>
<kind>A1</kind>
<name>Ha et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370352</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2002/0133722</doc-number>
<kind>A1</kind>
<name>Levanon et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2003/0037254</doc-number>
<kind>A1</kind>
<name>Fischer et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713200</main-classification></classification-national>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2003/0105812</doc-number>
<kind>A1</kind>
<name>Flowers et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709203</main-classification></classification-national>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2003/0182572</doc-number>
<kind>A1</kind>
<name>Cowan et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713200</main-classification></classification-national>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2003/0204472</doc-number>
<kind>A1</kind>
<name>Yamagishi</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 41</main-classification></classification-national>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2004/0002902</doc-number>
<kind>A1</kind>
<name>Muehlhaeuser</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2004/0117663</doc-number>
<kind>A1</kind>
<name>Colvin</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713202</main-classification></classification-national>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2004/0172535</doc-number>
<kind>A1</kind>
<name>Jakobsson et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2004/0255169</doc-number>
<kind>A1</kind>
<name>Little et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713202</main-classification></classification-national>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2005/0004875</doc-number>
<kind>A1</kind>
<name>Kontio et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 52</main-classification></classification-national>
</citation>
<citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2005/0015618</doc-number>
<kind>A1</kind>
<name>Schneider et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2005/0080815</doc-number>
<kind>A1</kind>
<name>Inoue et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707103 Y</main-classification></classification-national>
</citation>
<citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2005/0091539</doc-number>
<kind>A1</kind>
<name>Wang et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>2005/0154795</doc-number>
<kind>A1</kind>
<name>Kuz et al.</name>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709227</main-classification></classification-national>
</citation>
<citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>2005/0278787</doc-number>
<kind>A1</kind>
<name>Naslund et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>2006/0036555</doc-number>
<kind>A1</kind>
<name>Beck et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>2006/0074985</doc-number>
<kind>A1</kind>
<name>Wolfish et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>7071041</main-classification></classification-national>
</citation>
<citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>2006/0106726</doc-number>
<kind>A1</kind>
<name>Raley et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 59</main-classification></classification-national>
</citation>
<citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>2006/0123463</doc-number>
<kind>A1</kind>
<name>Yeap et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  2</main-classification></classification-national>
</citation>
<citation>
<patcit num="00037">
<document-id>
<country>US</country>
<doc-number>2006/0141962</doc-number>
<kind>A1</kind>
<name>Forbes et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4551861</main-classification></classification-national>
</citation>
<citation>
<patcit num="00038">
<document-id>
<country>US</country>
<doc-number>2006/0149846</doc-number>
<kind>A1</kind>
<name>Schuba</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00039">
<document-id>
<country>US</country>
<doc-number>2006/0206709</doc-number>
<kind>A1</kind>
<name>Labrou et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713167</main-classification></classification-national>
</citation>
<citation>
<patcit num="00040">
<document-id>
<country>US</country>
<doc-number>2006/0235796</doc-number>
<kind>A1</kind>
<name>Johnson et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 44</main-classification></classification-national>
</citation>
<citation>
<patcit num="00041">
<document-id>
<country>US</country>
<doc-number>2006/0242404</doc-number>
<kind>A1</kind>
<name>Su</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713150</main-classification></classification-national>
</citation>
<citation>
<patcit num="00042">
<document-id>
<country>US</country>
<doc-number>2006/0272032</doc-number>
<kind>A1</kind>
<name>Jogand-Coulomb et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 30</main-classification></classification-national>
</citation>
<citation>
<patcit num="00043">
<document-id>
<country>US</country>
<doc-number>2006/0282395</doc-number>
<kind>A1</kind>
<name>Leibowitz</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 67</main-classification></classification-national>
</citation>
<citation>
<patcit num="00044">
<document-id>
<country>US</country>
<doc-number>2007/0010236</doc-number>
<kind>A1</kind>
<name>Allen et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455418</main-classification></classification-national>
</citation>
<citation>
<patcit num="00045">
<document-id>
<country>US</country>
<doc-number>2007/0119953</doc-number>
<kind>A1</kind>
<name>Tsao</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00046">
<document-id>
<country>US</country>
<doc-number>2007/0124372</doc-number>
<kind>A1</kind>
<name>Liu et al.</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709204</main-classification></classification-national>
</citation>
<citation>
<patcit num="00047">
<document-id>
<country>US</country>
<doc-number>2007/0154014</doc-number>
<kind>A1</kind>
<name>Aissi et al.</name>
<date>20070700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380249</main-classification></classification-national>
</citation>
<citation>
<patcit num="00048">
<document-id>
<country>US</country>
<doc-number>2008/0005783</doc-number>
<kind>A1</kind>
<name>Polzin et al.</name>
<date>20080100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  3</main-classification></classification-national>
</citation>
<citation>
<patcit num="00049">
<document-id>
<country>US</country>
<doc-number>2008/0022387</doc-number>
<kind>A1</kind>
<name>Leung</name>
<date>20080100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 12</main-classification></classification-national>
</citation>
<citation>
<patcit num="00050">
<document-id>
<country>US</country>
<doc-number>2008/0040618</doc-number>
<kind>A1</kind>
<name>Andersson et al.</name>
<date>20080200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713193</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00051">
<othercit>Kwon II Lee, DRM Framework secure distribution of mobile contents, 2004, Lecture notes Computer Science, 3090/2004, pp. 4-7.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00052">
<othercit>Non-Final Office Action mailed Apr. 9, 2009 in U.S. Appl. No. 11/456,951.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00053">
<othercit>Final Office Action mailed Nov. 10, 2009 in U.S. Appl. No. 11/456,951.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00054">
<othercit>Notice of Allowance mailed Jan. 26, 2010 in U.S. Appl. No. 11/456,951.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>25</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726  4</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 26- 30</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713163-169</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713193</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709213</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>7</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Werner</last-name>
<first-name>Shane R.</first-name>
<address>
<city>Olathe</city>
<state>KS</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Cope</last-name>
<first-name>Warren B.</first-name>
<address>
<city>Olathe</city>
<state>KS</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>McConnell</last-name>
<first-name>Von</first-name>
<address>
<city>Leawood</city>
<state>KS</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Sprint Communications Company L.P.</orgname>
<role>02</role>
<address>
<city>Overland Park</city>
<state>KS</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Flynn</last-name>
<first-name>Nathan</first-name>
<department>2431</department>
</primary-examiner>
<assistant-examiner>
<last-name>Lakhia</last-name>
<first-name>Viral</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method, system, and medium are provided for operating a computing device and a mobile device to access computer software with a secure access and to access a packet network, and for operating a computer software on a mobile device with different computing devices. A mobile device is used to authenticate a user's access to computer software. The computer software may reside on the mobile device, the user's computing device, or another computing device. A unique identifier is stored in the mobile device associated with the computer software to enable the authentication.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="111.59mm" wi="185.93mm" file="US08353048-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="241.64mm" wi="191.60mm" file="US08353048-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="169.93mm" wi="143.51mm" orientation="landscape" file="US08353048-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="187.37mm" wi="133.60mm" file="US08353048-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="208.62mm" wi="173.23mm" file="US08353048-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="240.71mm" wi="184.57mm" file="US08353048-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="232.66mm" wi="165.18mm" file="US08353048-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="255.78mm" wi="195.83mm" file="US08353048-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">Not applicable.</p>
<heading id="h-0002" level="1">STATEMENT REGARDING FEDERALLY SPONSORED RESEARCH OR DEVELOPMENT</heading>
<p id="p-0003" num="0002">Not applicable.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">Although mobile devices have the ability to handle telephone calls, they are unique from telephones connected to wireline systems. Mobile devices contain unique identifiers which allow them to connect and be identified in wireless networks. Most telephones in a wireline system do not have these characteristics except for various voice over packet (VOP) telephones that use internet protocol (IP) addresses as unique identifiers. In the wireless environment, these unique identifiers provide service providers with a way to identify and control the mobile devices.</p>
<p id="p-0005" num="0004">The unique identifiers vary according to the type of wireless technology that may be used and the service provider. The unique identifiers are used to identify a user that may want access to a wireless network. The unique identifier identifies the mobile device to the service provider and wireless network. The service provider can use the unique identifiers in a mobile device to verify information about the user or the device such as the level of service that is to be provided, if the user is allowed to originate telephone calls, the location of the mobile device, etc. The unique identifiers may include such items as a username and password embedded in the mobile device, an IP address, an ESN, or an IMEI. These unique identifiers are the more common ones that are associated with mobile devices, but there are others that can be used. As wireless technologies evolve, the number of unique identifiers will increase and evolve as well.</p>
<p id="p-0006" num="0005">One of the challenges that users face today is having the ability to migrate information from one computing device to another computing device. Usually, a user has to install a computer software program onto a computing device in order to use the computing device. However, if the user is mobile and needs to use the computer software program on a second computing device, the user has to find a way to re-install the computer software program to operate at the second computing device since the computer software program is already stored on the first computing device.</p>
<p id="p-0007" num="0006">The first challenge is for the user to operate the computer software program on the second computing device when the computer software program is already stored on the first computing device. The user may have to re-install the computer software program on the second computing device and go through a re-authentication process with the second installation. If the user does not have the authentication information, the user will be prevented from accessing the computer software program although the computer software program may have been installed properly.</p>
<p id="p-0008" num="0007">Another challenge for the user, even after gaining access to the second computing device and having the computer software program installed, is to have access to the data files that were originally used and stored on the first computing device with the computer software program. One current solution for accessing such data files is to store the data files on a removable media device such as a floppy disk, a CD, a flash memory (such as a USB memory), or a removable disk drive. The user can store the data files on the removable media device and later use the removable media device with the computer software program (if the user has access). Unfortunately, the user has to maintain the most recent version of the data files either on the first computing device or on the removable media device. In addition, the user needs the authenticated version of the computer software program to access the data files. At some point, the first computing device and the removable media device may need to be synchronized to have the same data. Secondly, the user has to take care not to damage the removable media device. Thirdly, the removable media device has to be small enough to not distract the user when it is moved from place to place. If the removable media device is too bulky or cumbersome, the user may not find the removable media device practical and may lose interest in using such device. Fourthly, the user has to use an authenticated version of the computer software program with the data files.</p>
<p id="p-0009" num="0008">For the reasons discussed above, a solution is needed that allows a user to use an authenticated version of a computer software program even when the user is using different types of computing devices. The solution needs to allow the user to access the user's data files and the computer software program without the need for a removable media device and without the need for prompting for a key or re-authentication information. The solution also needs to allow the user to access the Internet from the different types of computing devices while using the computer software program and data files.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0010" num="0009">The present invention is defined by the claims below. Embodiments of the present invention solve at least the above problems by providing a system, method, and media for, among other things, operating a computing device and a mobile device to access computer software with a secure access and to access a packet network, and for operating a computer software on a mobile device with different computing devices.</p>
<p id="p-0011" num="0010">In a first aspect, a computer system having a processor and a memory for executing a method for operating a computing device and a mobile device to access computer software with a secure access is provided that includes communicating between the computing device and the mobile device over a connection. A set of information is accessed on the mobile device from the computing device for an authentication. A user is authenticated with the mobile device at the computing device to operate either or both a first computer software on the mobile device or a second computer software not on the mobile device. Either the first computer software or the second computer software is operated from the computing device.</p>
<p id="p-0012" num="0011">In another aspect, a computer system having a processor and a memory for executing a method for operating a computing device and a mobile device to access computer software with a secure access and to access a packet network is provided that includes communicating between the computing device and the mobile device over a connection. A set of information is accessed on the mobile device from the computing device for an authentication. A user is authenticated with the mobile device at the computing device to operate either or both a first computer software on the mobile device or a second computer software not on the mobile device. Either the first computer software and the second computer software is operated from the computing device. From the computing device, the packet network is accessed through the mobile device.</p>
<p id="p-0013" num="0012">In yet another aspect, computer-readable media containing thereon computer-readable code for causing a mobile device to perform a method for authenticating a user at a computing device is provided that includes receiving at the mobile device notifications that a user is attempting an access to a computer software. Data is received associated with the computer software. A determination of an authorization assigned to the user is facilitated to access the computer software from information stored on either the mobile device or another computing device. Other information is provided based on the authorization to the computing device to allow the access to the computer software.</p>
<p id="p-0014" num="0013">In yet another aspect, a computer system having a processor and a memory for executing a method for operating a first computer software on a mobile device with different computing devices is provided that includes loading the first computer software onto the mobile device. A unique identifier is provided to associate with the first computer software. The unique identifier is stored with the first computer software or stored in the mobile device. The first computer software is configured to execute from the mobile device with the unique identifier. The mobile device is connected to a first computing device. The first computing device operates the first computer software.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS</heading>
<p id="p-0015" num="0014">Illustrative embodiments of the present invention are described in detail below with reference to the attached drawing figures, which are incorporated by reference herein and wherein:</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an exemplary operating environment illustrating a computing device accessing authentication information and computer software installed on a mobile device;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of an exemplary operating environment illustrating a computing device accessing authentication information installed on a mobile device and accessing the Internet through the mobile device;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of an exemplary computer software installed on a mobile device when implementing an embodiment of the present invention;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart of an exemplary process for operating a computing device using authentication information and computer software installed on a mobile device;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart of an exemplary process for operating a computing device using authentication information and computer software installed on a mobile device and accessing the Internet through the mobile device;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart of an exemplary process for terminating an operation of a computing device with a mobile device and operating another computing device with the mobile device;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart of an exemplary process for operating exemplary computer software in a mobile device when implementing an embodiment of the present invention; and</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart of an exemplary process for using unique identifiers in a mobile device for authenticating a user at a computing device.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0024" num="0023">Embodiments of the present invention provide systems, methods, and media for operating a computing device with a mobile device wherein the mobile device stores authentication information.</p>
<p id="h-0007" num="0000">Acronyms and Shorthand Notations</p>
<p id="p-0025" num="0024">Throughout the description of the present invention, several acronyms and shorthand notations are used to aid the understanding of certain concepts pertaining to the associated system and services. These acronyms and shorthand notations are solely intended for the purpose of providing an easy methodology of communicating the ideas expressed herein and are in no way meant to limit the scope of the present invention. The following is a list of these acronyms:</p>
<p id="p-0026" num="0025">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="63pt" align="left"/>
<colspec colname="2" colwidth="154pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>AAA</entry>
<entry>Authentication, Authorization, and Accounting</entry>
</row>
<row>
<entry>BLUETOOTH</entry>
<entry>Technology for connecting devices using a short-</entry>
</row>
<row>
<entry/>
<entry>ranged wireless connection.</entry>
</row>
<row>
<entry>CD</entry>
<entry>Compact Disk</entry>
</row>
<row>
<entry>CDMA</entry>
<entry>Code Division Multiple Access</entry>
</row>
<row>
<entry>DRM</entry>
<entry>Digital Rights Management</entry>
</row>
<row>
<entry>EDGE</entry>
<entry>Enhance Data Rates for GSM (and TDMA)</entry>
</row>
<row>
<entry/>
<entry>Evolution</entry>
</row>
<row>
<entry>ESN</entry>
<entry>Electronic Serial Number</entry>
</row>
<row>
<entry>EV-DO</entry>
<entry>Evolution Data Only or Evolution Data Optimized</entry>
</row>
<row>
<entry>GPRS</entry>
<entry>General Packet Radio Services</entry>
</row>
<row>
<entry>GSM</entry>
<entry>Global System for Mobile Communications</entry>
</row>
<row>
<entry>IMEI</entry>
<entry>International Mobile Equipment Identity</entry>
</row>
<row>
<entry>IP</entry>
<entry>Internet Protocol</entry>
</row>
<row>
<entry>OS</entry>
<entry>Operating System</entry>
</row>
<row>
<entry>PDA</entry>
<entry>Personal Digital Assistant</entry>
</row>
<row>
<entry>UMTS</entry>
<entry>Universal Mobile Telephone System</entry>
</row>
<row>
<entry>USB</entry>
<entry>Universal Serial Bus</entry>
</row>
<row>
<entry>VOP</entry>
<entry>Voice Over Packet</entry>
</row>
<row>
<entry>W-CDMA</entry>
<entry>Wide Code Division Multiple Access</entry>
</row>
<row>
<entry>WiFi</entry>
<entry>Wireless Fidelity (802.11 network)</entry>
</row>
<row>
<entry>WiMAX</entry>
<entry>Worldwide Interoperability for Wireless Access</entry>
</row>
<row>
<entry/>
<entry>(802.16 network)</entry>
</row>
<row>
<entry>ZIGBEE</entry>
<entry>Technology for connecting devices using a short-</entry>
</row>
<row>
<entry/>
<entry>ranged wireless connection.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0027" num="0026">Further, various technical terms are used throughout this description. A definition of such terms can be found in <i>Newton's Telecom Dictionary </i>by H. Newton, 21<sup>st </sup>Edition (2005). These definitions are intended to provide a clearer understanding of the ideas disclosed herein but are not intended to limit the scope of the present invention. The definitions and terms should be interpreted broadly and liberally to the extent allowed the meaning of the words offered in the above-cited reference.</p>
<p id="p-0028" num="0027">As one skilled in the art will appreciate, embodiments of the present invention may be embodied as, among other things: a method, system, or computer-program product. Accordingly, the embodiments may take the form of a hardware embodiment, a software embodiment, or an embodiment combining software and hardware. In one embodiment, the present invention takes the form of a computer-program product that includes computer-useable instructions embodied on one or more computer-readable media.</p>
<p id="p-0029" num="0028">Computer-readable media include both volatile and nonvolatile media, removable and nonremovable media, and contemplates media readable by a database, a switch, and various other network devices. Network switches, routers, and related components are conventional in nature, as are means of communicating with the same. By way of example, and not limitation, computer-readable media comprise computer-storage media.</p>
<p id="p-0030" num="0029">Computer-storage media, or machine-readable media, include media implemented in any method or technology for storing information. Examples of stored information include computer-useable instructions, data structures, program modules, and other data representations. Computer-storage media include, but are not limited to RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile discs (DVD), magnetic cassettes, magnetic tape, magnetic disk storage, and other magnetic storage devices. These memory components can store data momentarily, temporarily, or permanently.</p>
<p id="h-0008" num="0000">Computing Software Access and Authentication with a Mobile Device</p>
<p id="p-0031" num="0030">Embodiments of the present invention may be implemented to allow a user to operate computer software using authentication information on a mobile device. The computers software may be stored on the mobile device or on a computing device. The authentication information is associated with the computer software.</p>
<p id="p-0032" num="0031">In <figref idref="DRAWINGS">FIG. 1</figref>, an exemplary operating environment <b>100</b> is shown with a computing device <b>110</b> connected to a mobile device <b>120</b> over a connection <b>115</b>. The computing device <b>110</b> may be a computer, a workstation, a server, or a PDA. The mobile device <b>120</b> may be a mobile phone, a handheld computer, or a PDA. The connection <b>115</b> may be a USB connection, an Ethernet connection, a serial port connection, a parallel port connection, or a wireless connection. The wireless connection may include BLUETOOTH, infrared, WiFi, and WiMax to name a few. The types of computing devices, mobile device, and connections listed above are not exhaustive and may include others not mentioned in this specification.</p>
<p id="p-0033" num="0032">Within mobile device <b>120</b>, an authentication <b>125</b> may be stored in the memory of mobile device <b>120</b>. Authentication <b>125</b> may be a set of unique identifiers associated with mobile device <b>120</b>. The set of unique identifiers may include a username, a telephone number, a password, an IP address, an ESN, and an IMEI. It is well known in the arts that mobile devices such as mobile telephones have unique identifiers to identify them in a wireless network.</p>
<p id="p-0034" num="0033">Mobile device <b>120</b> also includes a computer software <b>127</b> that may be pre-loaded. Computer software <b>127</b> may be an application or computer program that may be executed by a user. Mobile device <b>120</b> has a capacity in the gigabyte range to store various computer software. Computer software <b>127</b> may use authentication <b>125</b> to enable a user to access and execute computer software <b>127</b>. The use of authentication <b>125</b> may be performed in several exemplary ways. First, upon an installation of computer software <b>127</b>, the user may be required to provide authentication <b>125</b> which is stored in mobile device <b>120</b>. Secondly, a computer program may automatically associate authentication <b>125</b> with computer software <b>127</b> when computer software <b>127</b> is stored in mobile device <b>120</b>.</p>
<p id="p-0035" num="0034">Signal <b>130</b> illustrates the wireless capability of mobile device <b>120</b>. Although not shown here, mobile device <b>120</b> may communicate using a variety of wireless technologies including, but not limited to, CDMA, GPRS, GSM, EDGE, EV-DO, W-CDMA, UMTS, WiFi, and WiMax. The transmit and receive capabilities using these technologies will go through the exemplary signal <b>130</b>.</p>
<p id="p-0036" num="0035">Going back to computing device <b>110</b>, computing device <b>110</b> includes computer software <b>112</b>. Computer software <b>112</b> is similar to computer software <b>127</b>. However, if a user installs computer software <b>112</b> in computing device <b>110</b>, the user may be required to provide authentication information similar to providing a key when installing new computer software. As discussed above, the user may provide authentication information during the installation process at computing device <b>110</b> which matches authentication <b>125</b>. Or, a computer program may automatically associate authentication <b>125</b> with computer software <b>127</b> when a connection is made between computing device <b>110</b> and mobile device <b>120</b>.</p>
<p id="p-0037" num="0036">Turning now to <figref idref="DRAWINGS">FIG. 2</figref>, an exemplary operating environment <b>200</b> is shown similar to <figref idref="DRAWINGS">FIG. 1</figref>. A computing device <b>210</b> is connected to a mobile device <b>220</b> over a connection <b>215</b>. The computing device <b>210</b> represents the same computing device as computing device <b>110</b>. The computer software <b>212</b> represents the same computer software as computer software <b>112</b>. The connection <b>215</b> represents the same connection as connection <b>115</b>. The mobile device <b>220</b> represents and includes the same functionality as mobile device <b>120</b> with an addition. Mobile device <b>220</b> includes a data access <b>229</b>. Authentication <b>225</b> represents the same functions as authentication <b>125</b>. Computer software <b>227</b> represents the same functions as computer software <b>127</b>.</p>
<p id="p-0038" num="0037">Data access <b>229</b> allows mobile device <b>220</b> to access the Internet <b>240</b> over a connection <b>235</b>. Connection <b>235</b> represents the various devices and signals that are involved in order to allow mobile device <b>220</b> to connect to the Internet <b>240</b>. The discussion of how mobile device <b>220</b> connects to the Internet <b>240</b> is beyond the scope of this invention and shall not be discussed here. However, one of ordinary skill in the art understands that in today's technologies, home agents, foreign agents, and AAA servers may be involved as part of connection <b>235</b> to provide data access <b>229</b> to the Internet <b>240</b>.</p>
<p id="p-0039" num="0038">Within the Internet <b>240</b>, a server <b>245</b> may exist to communicate with mobile device <b>220</b> for authentication activities. Server <b>245</b> may be used for verification purposes when a user tries to access or operate a specific application or computer program. For example, when the user attempts to access an application or a computer program, identified as either computer software <b>212</b> or <b>227</b>, mobile device <b>220</b> may send authentication <b>225</b> or a subset thereof to server <b>245</b> to verify authorization information. Server <b>245</b> may return a reply to mobile device <b>220</b> which sends information to computing device <b>210</b> to allow authorized use to computer software <b>212</b> or <b>227</b>. This example can occur for subscription services allowing the user to use computer software, such as virus detection software, over a time period.</p>
<p id="p-0040" num="0039">In <figref idref="DRAWINGS">FIG. 3</figref>, an exemplary computer software <b>300</b> is shown with a mobile device <b>320</b>. Mobile device <b>320</b> includes an exemplary set of software identified by an operating component <b>330</b>, a receiving component <b>333</b>, a facilitating component <b>335</b>, an validating component <b>337</b>, an output component <b>339</b>, and a data access component <b>340</b>. Mobile device <b>320</b> is similar to mobile devices <b>120</b> and <b>220</b> discussed above.</p>
<p id="p-0041" num="0040">It has already been stated above that mobile device <b>320</b> is capable of holding a significant amount of information in its memory. Mobile devices can contain storage capacities in the gigabyte range allowing a variety of software information to be stored. In <figref idref="DRAWINGS">FIG. 3</figref>, operating component <b>330</b> represents the software that runs the mobile device. Operating component <b>330</b> may also include storing computer software such as computer software <b>127</b> and <b>227</b>. Receiving component <b>333</b> represents the software for collecting or monitoring for information that a user is attempting to access or operate computer software <b>112</b>, <b>127</b>, <b>212</b>, or <b>227</b>. Receiving component <b>333</b> also represents the software for receiving data about computer software <b>112</b>, <b>127</b>, <b>212</b>, or <b>227</b>. In order to know what authentication is required, receiving component <b>333</b> has to retrieve or receive information associated with the computer software.</p>
<p id="p-0042" num="0041">When mobile device <b>320</b> has authentication <b>125</b> or <b>225</b> as discussed above along with information gathered by receiving component <b>333</b>, facilitating component <b>335</b> operates to authorize a user to gain access to the computer software. Facilitating component <b>335</b> may attempt to respond to information received by other components when the user attempts to access computer software, or facilitating component <b>335</b> may interact with other computing devices such as server <b>245</b> to determine the authorization for the user.</p>
<p id="p-0043" num="0042">Validating component <b>337</b> represents software for authentication <b>125</b> or <b>225</b>. As discussed above, this information may include a set of unique identifiers associated with mobile device <b>320</b>. The set of unique identifiers may include a username, a telephone number, a password, an IP address, an ESN, and an IMEI. It may include other unique information not mentioned here. Although validating component <b>337</b> may vary according to the implementation, this software represents the specific information that identifies the mobile device or identifies unique characteristics required for authentication purposes. Other components in mobile device <b>320</b> may retrieve information in validating component <b>337</b> to accomplish the authentication or authorization process.</p>
<p id="p-0044" num="0043">Output component <b>339</b> represents the exemplary software to send information to computing devices authorizing or acknowledging an authorization for the user to use computer software <b>112</b>, <b>127</b>, <b>212</b>, or <b>227</b>. Output component <b>339</b> may include a key to be used by the computer software, a reply, or a subset of validating component <b>337</b>. Depending on the implementation of an embodiment, information will be sent from mobile device <b>320</b> to a computing device giving access to the user at the computing device. The way in which this information will be delivered as well as what information will be delivered may vary especially when the computer software is stored on the mobile device versus the computing device. For example, if the computer software is stored on the mobile device, there may be little information delivered to the computing device regarding authorization. The user may receive an acknowledgement to access the computer software on mobile device <b>320</b>. However, if the computer software is loaded in the computing device <b>110</b> or <b>210</b>, a much more involved authentication process may occur with a set of information being delivered to the computing device from output component <b>339</b>.</p>
<p id="p-0045" num="0044">Another software that may be found in mobile device <b>320</b> is data access component <b>340</b>. Data access component <b>340</b> represents the exemplary software to access the Internet <b>240</b>. Data access component <b>340</b> is associated with data access <b>229</b> discussed above.</p>
<p id="p-0046" num="0045">The various software components represent exemplary software that may be implemented in an embodiment of the present invention. In different embodiments, the software components may be represented differently. In some cases, various components may be combined. In other cases, some components may be removed. The idea here is to illustrate the possibilities in implementing various embodiments for the purposes of using mobile device <b>320</b> for authentication activities as well as for storing computer software to operate with a computing device.</p>
<p id="p-0047" num="0046">With <figref idref="DRAWINGS">FIGS. 1-3</figref>, embodiments of the present invention may be implemented using the processes discussed below in <figref idref="DRAWINGS">FIGS. 4-8</figref>.</p>
<p id="p-0048" num="0047">In <figref idref="DRAWINGS">FIG. 4</figref>, a process for operating a computing device using authentication information and computer software installed on a mobile device is provided in a method <b>400</b>. In a step <b>410</b>, computer software <b>127</b> is installed in mobile device <b>120</b>. Authentication information such as authentication <b>125</b> is established in mobile device <b>120</b>. Although not shown here, the installation of computer software <b>127</b> is similar to installing computer software on a computing device. Various techniques may be used to install computer software <b>127</b>. Some of which may include the receipt of computer software <b>127</b> over a wireless connection.</p>
<p id="p-0049" num="0048">In a step <b>420</b>, computing device <b>110</b> is connected to mobile device <b>120</b> using the various connections (connection <b>115</b>) discussed above in <figref idref="DRAWINGS">FIG. 1</figref>. This connection enables computing device <b>110</b> and mobile device <b>120</b> to communicate together.</p>
<p id="p-0050" num="0049">After computer software <b>127</b> is installed in mobile device <b>120</b> in step <b>410</b>, when a user attempts to access computer software <b>127</b> from computing device <b>110</b>, the user is authenticated with authentication information on mobile device <b>120</b> in a step <b>430</b>. In an embodiment of the present invention, mobile device <b>120</b> may appear as a letter drive when it is connected to computing device <b>110</b>.</p>
<p id="p-0051" num="0050">In a step <b>440</b>, a user operates computing device <b>110</b> executing computer software <b>127</b> from mobile device <b>120</b>. In this step, the user may run an application that has been stored on mobile device <b>440</b> after the authentication process completes. In other embodiments, an authentication process may not be required as the user may have pre-loaded authentication information with computer software <b>127</b> when it was initially installed.</p>
<p id="p-0052" num="0051">Turning now to <figref idref="DRAWINGS">FIG. 5</figref>, a process for operating a computing device using authentication information and computer software installed on a mobile device and accessing the Internet through the mobile device is shown in a method <b>500</b>. Method <b>500</b> is similar to method <b>400</b> with some additions. Method <b>500</b> includes an ability of mobile phone <b>120</b> to provide data access as shown in mobile phone <b>220</b>.</p>
<p id="p-0053" num="0052">In a step <b>550</b>, a user operates computing device <b>210</b> to access the Internet <b>240</b> through mobile device <b>220</b>. To facilitate this access, mobile phone <b>220</b> has data access <b>229</b> and connection <b>235</b> indicating the capability to access the Internet <b>240</b>. Step <b>550</b> illustrates that mobile device <b>220</b> may provide computer software <b>227</b> to computing device <b>210</b> while at the same time providing internet access. Steps <b>510</b>, <b>520</b>, <b>530</b>, and <b>540</b> are similar to steps <b>410</b>, <b>420</b>, <b>430</b>, and <b>440</b>, and are not discussed further.</p>
<p id="p-0054" num="0053">In <figref idref="DRAWINGS">FIG. 6</figref>, a process for terminating an operation of a computing device with a mobile device and operating another computing device with the mobile device is shown in a method <b>600</b>. Method <b>600</b> begins as a continuation of the steps in <figref idref="DRAWINGS">FIGS. 4 and 5</figref>.</p>
<p id="p-0055" num="0054">After the user completes operating at either computing device <b>110</b> or <b>210</b>, the user may disconnect the computing device from the mobile device in a step <b>610</b>. As discussed above, the computer software is stored on the mobile device and some or all of the data files may be stored on the mobile device. Later, the user desires to use another computing device and connects the mobile device to this new computing device as shown in a step <b>620</b>. The user operates the new computing device using the computer software on the mobile device in a step <b>640</b>. In a step <b>670</b>, the user accesses the Internet <b>240</b> while also operating computing device <b>110</b> or <b>210</b>.</p>
<p id="p-0056" num="0055">As shown in the steps <b>610</b>-<b>640</b>, the user has reconnected to the new computing device illustrating that the functionality that the user had in methods <b>400</b> and <b>500</b> surrounding authentication, in respective <figref idref="DRAWINGS">FIGS. 4 and 5</figref>, may be used again in method <b>600</b>. The mobile device acts as the storage device which may be connected to different computing devices. Method <b>600</b> illustrates that the user may use different computing devices but still have an ability use the same computer software and data files from the mobile device.</p>
<p id="p-0057" num="0056">In <figref idref="DRAWINGS">FIG. 7</figref>, a process for operating exemplary computer software in a mobile device when implementing an embodiment of the present invention is shown in a method <b>700</b>. Method <b>700</b> illustrates the actions of computer-readable media installed on a mobile device.</p>
<p id="p-0058" num="0057">In a step <b>710</b>, various computer software is loaded onto mobile device <b>120</b> or <b>220</b>. In a step <b>720</b>, mobile device <b>120</b> or <b>220</b> receive notifications that a user is attempting to access or operate computer software on mobile device <b>120</b> or <b>220</b>, computing device <b>110</b> or <b>210</b>, or over the Internet <b>240</b>. The computer software is represented by computer software <b>112</b>, <b>127</b>, <b>212</b>, or <b>227</b>. In a step <b>730</b>, data is received at mobile device <b>120</b> or <b>220</b> associated with the computer software. This data may be in the form of requests to determine the authorization or permitted access for the user. In a step <b>740</b>, mobile device <b>120</b> or <b>220</b> operate to aid in determining the authorization for the user to access computer software <b>112</b>, <b>127</b>, <b>212</b>, or <b>227</b>. Mobile device <b>120</b> or <b>220</b> uses authentication information stored in the mobile device or at a server or both to aid in the determination of the authorization. As discussed above, in one case, an acknowledgement is provided based on the unique identifier information stored in the mobile device. In another case, a unique identifier is provided as a key. In yet another case, a unique identifier is provided to a server for verification such as for a subscription. In a step <b>750</b>, information is provided from mobile device <b>120</b> or <b>220</b>, based on the authorization, to computing device <b>110</b> or <b>210</b> to allow access to computer software <b>112</b>, <b>127</b>, <b>212</b>, or <b>227</b>.</p>
<p id="p-0059" num="0058">Turning now to <figref idref="DRAWINGS">FIG. 8</figref>, a process for using unique identifiers in a mobile device for authenticating a user at a computing device is shown in a method <b>800</b>. In a step <b>810</b>, computer software is loaded onto either the mobile device or a first computing device. It was discussed above how the loading process could occur and shall not be discussed here. In a step <b>820</b>, a unique identifier is provided associated with the computer software. In a step <b>830</b>, the unique identifier is stored on the mobile device. In a step <b>840</b>, the computer software is configured or compiled to execute from the mobile device with the unique identifier. In a step <b>850</b>, the mobile device is connected to the first computing device. In a step <b>860</b>, a user operates the computer software at the first computing device.</p>
<p id="p-0060" num="0059">Steps <b>810</b>-<b>860</b> represent implementations of embodiments of the present invention whereby an authentication process occurs to allow access to computer software by the user. The remaining steps illustrate what happens when the mobile is disconnected from the first computing device.</p>
<p id="p-0061" num="0060">In a step <b>870</b>, the mobile device is disconnected from the first computing device and reconnected to a second computing device. Two situations may occur depending on whether the computer software is stored on the mobile device or stored on the first computing device. Where the computer software is stored on the mobile device, the user may operate the computer software from the second computing device. Authentication is probably not needed since the authentication information is provided during initial installation of the computer software on the mobile device where the authentication information resides. However, if the computer software is stored on the second computing device, an authentication process may occur when the mobile device is connected to the second computing device. The mobile device may connect to a server through the Internet to verify access at the second computing. The mobile device may directly provide authentication information to the second computing device to allow access by the user to the computer software stored on the second computing device.</p>
<p id="p-0062" num="0061">In a step <b>880</b>, because the first computing device was disconnected from the mobile device, the user can no longer execute the computer software at the first computing device even when the computer software is stored on the first computing device. The mobile device provides authentication information in the form of the unique identifiers which may be transmitted to the first computing device during the connection between the first computing device and the mobile device. However, if this connection is lost, the computer software at the first computing device cannot verify certain information in the mobile device to enable access. Therefore, access to the computer software is prohibited.</p>
<p id="p-0063" num="0062">In a scenario about the present invention, a user owns a mobile phone such as mobile device <b>120</b> with a large storage capacity in the gigabyte range. The user loads the computer software such as applications onto the mobile phone. The user also provides unique information that identifies the user with the loaded computer software. A few weeks later, while traveling away from home, the user desires to use a computer located in a hotel business center. The user connects the mobile phone to the hotel's computer using a USB cable. The user turns on the computer and gains access to the mobile phone. The user chooses to execute the computer software that is loaded on the phone. Other software in the mobile phone uses the unique information to allow the user to operate the computer software from the hotel's computer. In this scenario, the user may have pre-loaded authentication information with the computer software when it was initially installed on the mobile phone removing any additional need for re-authentication when the phone is connected to the computer and the computer software is accessed. The scenario enables the user to use the computer software on the mobile phone with different computers.</p>
<p id="p-0064" num="0063">Continuing with the scenario discussed above, while the user is operating the computer with computer software <b>227</b> in this case, the user may desire to access the Internet <b>240</b>. The user may initialize a web browser program that is either stored on the computer or stored on the mobile phone as part of computer software <b>227</b>. The mobile phone handles the connections to the Internet <b>240</b> and enables the web data to be transferred to the computer rather than on the display of the mobile phone. Therefore, the user may operate the computer while also accessing the Internet.</p>
<p id="p-0065" num="0064">In another scenario, a user purchases an application designed to run from a mobile device. The user provide a unique identifier such as a phone umber or ESN. The computer program is compiled to only run from the mobile device with the unique identifier. The user plugs the mobile device into the computing device at his or her home and the computer program may be executed at the computing device in the home. Later, the user unplugs the mobile device from the computing device in the home and plugs the mobile device into a computing device at his or her office. The computing device in the home can no longer access or execute the computer program while the computing device in the office can execute the computer program.</p>
<p id="p-0066" num="0065">In yet another scenario, a user purchases an application designed to run from a mobile device. The computer program uses the Internet to verify the user status for subscription by relaying unique identifiers such as the phone number or ESN. The user plugs the mobile device into the computing device at the user's home and the user may access and execute the application. As in the scenario above, the user unplugs the mobile device from the computing device in the home and plugs the mobile device into a computing device at his or her office. The computing device in the home can no longer access or execute the computer program while the computing device in the office can execute the computer program.</p>
<p id="p-0067" num="0066">Although not discussed above, the computer software or application could be a game, a soft phone, or an application such as the MS OFFICE from the Microsoft Corporation of Redmond, Wash. For example, a person may go to work and need the VISIO application developed by the Microsoft Corporation of Redmond, Wash. The application may be loaded in the mobile phone along with data files. The person may run the application from the phone when connected to a computer. When the person is done, the person can unplug the phone keeping the application and data files stored on the phone. Later, the person may plug the phone into another computer have the functionality again.</p>
<p id="p-0068" num="0067">The prior discussion is only for illustrative purposes to convey exemplary embodiments. The steps discussed in <figref idref="DRAWINGS">FIGS. 4-8</figref> may be executed without regards to order. Some steps may be omitted and some steps may be executed at a different time than shown. For example, step <b>550</b> may be executed before step <b>540</b>. Step <b>840</b> may be executed before step <b>830</b>. The point here is to convey that the figures are merely exemplary for the embodiments of the present invention and that other embodiments may be implemented for the present invention.</p>
<p id="p-0069" num="0068">Many different arrangements of the various components depicted, as well as components not shown, are possible without departing from the spirit and scope of the present invention. Embodiments of the present invention have been described with the intent to be illustrative rather than restrictive. Alternative embodiments will become apparent to those skilled in the art that do not depart from its scope. A skilled artisan may develop alternative means of implementing the aforementioned improvements without departing from the scope of the present invention.</p>
<p id="p-0070" num="0069">It will be understood that certain features and subcombinations are of utility and may be employed without reference to other features and subcombinations and are contemplated within the scope of the claims. Not all steps listed in the various figures need be carried out in the specific order described.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer system having a processor and a memory, the computer system operable to execute a method for operating a computing device and a mobile device to access one or more computer software with a secure access, comprising:
<claim-text>communicating between the computing device and the mobile device over a connection, wherein the connection is selected from a group including a USB connection, an Ethernet connection, a serial port connection, a parallel port connection, and a wireless connection, and wherein the wireless connection is selected from a group including Bluetooth, infrared, WiFi, and WiMax;</claim-text>
<claim-text>accessing for an authentication a set of information on the mobile device from the computing device;</claim-text>
<claim-text>authenticating, with authentication information on the mobile device, a user at the computing device by validating at least a digital rights management (DRM) access for the user to execute a computer software installed on the mobile device; and</claim-text>
<claim-text>operating from the computing device the computer software executed on the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein authenticating with the mobile device the user at the computing device comprises validating a digital rights management (DRM) access for the user.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein authenticating with the mobile device the user at the computing device comprises verifying a security access for the user to access the first computer software.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The system of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein verifying the security access comprises at least one of validating the set of information stored in the mobile device and providing the set of information stored in the mobile device to another computing device.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The system of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the set of information is selected from a group including a username, a telephone number, a password, an IP address, an ESN, and an IMEI.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The system of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the another computing device is a server.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising making a telephone call using at least one of the mobile device and a software program on the computing device.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>disconnecting the mobile device from the computing device;</claim-text>
<claim-text>reconnecting the mobile device to a new computing device;</claim-text>
<claim-text>accessing the set of information on the mobile device from the new computing device for the authentication;</claim-text>
<claim-text>authenticating with authentication information on the mobile device the user at the new computing device to operate the computer software on the mobile device; and</claim-text>
<claim-text>operating from the new computing device the computer software.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A computer system having a processor and a memory, the computer system operable to execute a method for operating a computing device and a mobile device to access one or more computer software with a secure access and to access a packet network, comprising:
<claim-text>communicating between the computing device and the mobile device over a connection, wherein the connection is selected from a group including a USB connection, an Ethernet connection, a serial port connection, a parallel port connection, and a wireless connection, and wherein the wireless connection is selected from a group including Bluetooth, infrared, WiFi, and WiMax;</claim-text>
<claim-text>accessing a set of information on the mobile device from the computing device for an authentication;</claim-text>
<claim-text>authenticating, with authentication information on the mobile device, a user at the computing device by validating at least a digital rights management (DRM) access for the user to execute a computer software located on the mobile device;</claim-text>
<claim-text>operating from the computing device the computer software executed on the mobile device; and</claim-text>
<claim-text>accessing from the computing device the packet network through the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein authenticating with the mobile device the user at the computing device comprises validating a digital rights management (DRM) access for the user.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein authenticating with the mobile device the user at the computing device comprises verifying a security access for the user to access the computer software.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The system of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein verifying the security access comprises at least one of validating the set of information stored in the mobile device and providing the set of information stored in the mobile device to another computing device.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The system of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the set of information is selected from a group including a username, a telephone number, a password, an IP address, an ESN, and an IMEI.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The system of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the another computing device is a server.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising making a telephone call using at least one of the mobile device or a software program on the computing device.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:
<claim-text>disconnecting the mobile device from the computing device;</claim-text>
<claim-text>reconnecting the mobile device to a new computing device;</claim-text>
<claim-text>accessing the set of information on the mobile device from the new computing device for the authentication;</claim-text>
<claim-text>authenticating with authentication information on the mobile device the user at the new computing device to operate the computer software on the mobile device;</claim-text>
<claim-text>operating from the new computing device the computer software; and</claim-text>
<claim-text>accessing from the new computing device the packet network through the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the packet network is selected from a group including the Internet.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. One or more non-transitory computer-readable media containing thereon computer-readable code executed by a mobile device for causing the mobile device to perform a method for authenticating a user at a computing device, the method comprising:
<claim-text>receiving at the mobile device one or more notifications that the user at the computing device is attempting to execute a computer software program installed on the mobile device via the computing device;</claim-text>
<claim-text>receiving at the mobile device a set of data associated with the computer software program;</claim-text>
<claim-text>performing, at the mobile device, an authorization for the user at the computing device by validating at least a digital rights management (DRM) access for the user to access the computer software program located on the mobile device from one or more information stored on at least one of the mobile device and another computing device; and</claim-text>
<claim-text>providing one or more other information based on the authorization provided by the mobile device to the computing device to allow the access to the computer software program to allow operation of the computer software program on the computing device via execution of the computer software program on the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The computer-readable media of <claim-ref idref="CLM-00018">claim 18</claim-ref>, further comprising providing an access to a packet network.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The computer-readable media of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the packet network is selected from a group including the Internet.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The computer-readable media of <claim-ref idref="CLM-00018">claim 18</claim-ref>, further comprising facilitating a telephone call on the mobile device.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A computer system having a processor and a memory, the computer system operable to execute a method for operating a first computer software program located on a mobile device with different computing devices, comprising:
<claim-text>installing the first computer software program onto the mobile device;</claim-text>
<claim-text>providing a unique identifier to associate with the mobile device, wherein the unique identifier is stored with the first computer software program or stored in the mobile device;</claim-text>
<claim-text>configuring the first computer software program to execute from the mobile device with the unique identifier by validating at least a digital rights management (DRM) access for the first computer program; and</claim-text>
<claim-text>connecting the mobile device to a first computing device, wherein the first computing device operates the first computer software program executed on the mobile device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The system of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the unique identifier is selected from a group including a username, a telephone number, a password, an IP address, an ESN, and an IMEI.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The system of <claim-ref idref="CLM-00022">claim 22</claim-ref>, further comprising:
<claim-text>disconnecting the mobile device from the first computing device wherein the first computing device no longer operates the first computer software program;</claim-text>
<claim-text>reconnecting the mobile device to a second computing device wherein the second computing device operates the first computer software program.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The system of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein configuring the first computer software program to execute from the mobile device with the unique identifier comprises verifying a user access to the first computer software program by accessing a packet network with the mobile device and providing the unique identifier to one or more other computing device for a verification. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353049-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353049</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12105260</doc-number>
<date>20080417</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>934</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 27</main-classification>
<further-classification>713158</further-classification>
<further-classification>713189</further-classification>
<further-classification>713193</further-classification>
<further-classification>726  7</further-classification>
<further-classification>726 31</further-classification>
<further-classification>726 32</further-classification>
<further-classification>726 33</further-classification>
</classification-national>
<invention-title id="d2e53">Separating keys and policy for consuming content</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>2002/0114466</doc-number>
<kind>A1</kind>
<name>Tanaka et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380232</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2002/0157002</doc-number>
<kind>A1</kind>
<name>Messerges et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713155</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2004/0039594</doc-number>
<kind>A1</kind>
<name>Narasimhan et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2004/0078293</doc-number>
<kind>A1</kind>
<name>Iverson et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 27</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2004/0139312</doc-number>
<kind>A1</kind>
<name>Medvinsky</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2004/0249768</doc-number>
<kind>A1</kind>
<name>Kontio et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 65</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2005/0049886</doc-number>
<kind>A1</kind>
<name>Grannan et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2005/0091216</doc-number>
<kind>A1</kind>
<name>Kranz et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707 10</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2006/0190408</doc-number>
<kind>A1</kind>
<name>Cook et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2007/0014413</doc-number>
<kind>A1</kind>
<name>Oliveira et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2007/0016532</doc-number>
<kind>A1</kind>
<name>Zhang et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2007/0178938</doc-number>
<kind>A1</kind>
<name>Kravitz et al.</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2007/0192810</doc-number>
<kind>A1</kind>
<name>Pritchett et al.</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2007/0192864</doc-number>
<kind>A1</kind>
<name>Bryant et al.</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 23</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2007/0204078</doc-number>
<kind>A1</kind>
<name>Boccon-Gibod et al.</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2008/0172718</doc-number>
<kind>A1</kind>
<name>Bradley</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2011/0035577</doc-number>
<kind>A1</kind>
<name>Lin et al.</name>
<date>20110200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713150</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00018">
<othercit>Microsoft Developers Network (MSDN), How license chaining works, copyright 2007, retrieved from http://msdn.microsoft.com/en-us/library/bb614606(v=vs.85).aspx on Mar. 31, 2011.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>Garcia, et al., &#x201c;Formalising ODRL Semantics using Web Ontologies&#x201d;, retrieved at &#x3c;&#x3c;http://odrl.net/workshop2005/program/odrl-workshop2005.pdf#page=33&#x3e;&#x3e;, pp. 1-10.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>Liu, &#x201c;Protecting Privacy of Personal Content on an OMA DRM Platform&#x201d;, Jun. 2005, pp. 68.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>Arnab, et al., &#x201c;Fairer Usage Contracts for DRM&#x201d;, Proceedings of the 5th ACM workshop on Digital Rights Management, Nov. 7, 2005, ACM, pp. 1-7.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00022">
<othercit>&#x201c;Microsoft Windows 2000 Terminal Services Licensing&#x201d;, Microsoft Corporation, 2008, pp. 6.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>16</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726  7</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 31- 33</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713158</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090265561</doc-number>
<kind>A1</kind>
<date>20091022</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Bromley</last-name>
<first-name>Dennis N.</first-name>
<address>
<city>Issaquah</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Burns</last-name>
<first-name>Quintin S.</first-name>
<address>
<city>Fort Mills</city>
<state>SC</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Wolfe-SBMC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Microsoft Corporation</orgname>
<role>02</role>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Colin</last-name>
<first-name>Carl</first-name>
<department>2493</department>
</primary-examiner>
<assistant-examiner>
<last-name>Lavelle</last-name>
<first-name>Gary</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">In accordance with one or more aspects of the separating keys and policy for consuming content, content has a corresponding leaf license, and the leaf license has one or more associated root policy addenda. Each root policy addenda includes policy identifying when it is permissible to decrypt and consume the content, but excludes a content key to decrypt the content. The content can be decrypted and consumed only if the policy identifies that it is permissible to decrypt and consume the content.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="130.47mm" wi="179.92mm" file="US08353049-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="164.68mm" wi="105.24mm" file="US08353049-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="160.19mm" wi="182.20mm" file="US08353049-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="200.49mm" wi="179.83mm" file="US08353049-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="258.23mm" wi="180.68mm" file="US08353049-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="151.72mm" wi="138.51mm" file="US08353049-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="129.96mm" wi="135.89mm" file="US08353049-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">Various digital content, such as audio and/or video content, text content, computer programs, and so forth is available to computers and other digital devices. In order to protect their content and ensure only those who have acquired rights to use the content can indeed use the content, content is frequently encrypted using a cryptographic key. However, many current techniques employing cryptographic keys suffer from attacks where if the cryptographic key can be broken, then a large amount of content is no longer protected. This can be problematic for content owners and distributors as a single successful attack can leave a large amount of content unprotected.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0003" num="0002">This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter, nor is it intended to be used to limit the scope of the claimed subject matter.</p>
<p id="p-0004" num="0003">In accordance with one or more aspects of the separating keys and policy for consuming content, a request is received to perform an action at the device with content, and one or more root policy addenda associated with a leaf license corresponding to the content are identified. If the one or more root policy addenda permit the action, then a key associated with the device is used to decrypt a content key in the leaf license, the leaf license being separate from the one or more root policy addenda. The content key is used to decrypt the content, and the action is performed with the content. However, if the one or more root policy addenda do not permit the action, then the action is not performed.</p>
<p id="p-0005" num="0004">In accordance with one or more aspects of the separating keys and policy for consuming content, a root policy addenda corresponding to content on the device is received. The root policy addenda includes policy identifying when it is permissible to decrypt and consume the content but excludes a content key to decrypt the content. The root policy addenda is associated with a leaf license for the content, the leaf license including the content key to decrypt the content. The root policy addenda is stored in a root policy addenda store.</p>
<p id="p-0006" num="0005">In accordance with one or more aspects of the separating keys and policy for consuming content, a device includes a first store to store content for use on the device, and a second store to store a leaf license for content in the first store and one or more root policy addenda bound to the leaf license. Each root policy addenda includes policy identifying when it is permissible to decrypt and consume the content but excludes a content key to decrypt the content. The device also includes a consumption module, coupled to the first store and the second store, to consume the content only if the policy identifies that it is permissible to decrypt and consume the content.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0007" num="0006">The same numbers are used throughout the drawings to reference like features.</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an example device implementing the separating keys and policy for consuming content in accordance with one or more embodiments.</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an example leaf license and root policy addenda employing the separating keys and policy for consuming content in accordance with one or more embodiments.</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 3</figref> illustrates example leaf licenses and root policy addenda employing the separating keys and policy for consuming content in accordance with one or more embodiments.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating an example process for a device consuming content using the separating keys and policy for consuming content in accordance with one or more embodiments.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart illustrating an example process for a device updating root policy addenda using the separating keys and policy for consuming content in accordance with one or more embodiments.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 6</figref> illustrates an example computing device that can be configured to implement the separating keys and policy for consuming content in accordance with one or more embodiments.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0014" num="0013">Separating keys and policy for consuming content are discussed herein. Content is encrypted using a content key in a leaf license corresponding to the content, and the content key in turn is encrypted with a key associated with the device on which the content is being used. One or more root policy addenda are bound to the leaf license. Each root policy addenda is separate from the leaf license and content key, and each root policy addenda includes policy describing when it is permissible to decrypt and consume the content.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an example device <b>100</b> implementing the separating keys and policy for consuming content in accordance with one or more embodiments. Device <b>100</b> can be a variety of different devices capable of playing, storing, or otherwise using content. For example, device <b>100</b> can be a desktop computer, a server computer, a mobile station, an entertainment appliance, a set-top box communicatively coupled to a display device, a wireless phone, a game console, an automotive computer, a kiosk, and so forth. Thus, device <b>100</b> may range from a full resource device with substantial memory and processor resources (e.g., personal computers, game consoles) to a low-resource device with limited memory and/or processing resources (e.g., traditional set-top boxes, hand-held game consoles).</p>
<p id="p-0016" num="0015">Device <b>100</b> can play, store, transfer, and/or otherwise access or use digital content. Digital content, or simply content, as used herein refers to a variety of different digital or electronic content, such as audio content (e.g., songs), audio/video content (e.g., television shows, movies, documentaries, cartoons, etc.), image content (e.g., digital pictures), text content (e.g., electronic books), compiled or uncompiled computer programs or portions thereof, Java games, zipped or otherwise compressed files, email messages and attachments, and so forth, as well as combinations thereof. Whether and how particular content can be accessed by device <b>100</b> is determined based at least in part on a leaf license corresponding to that particular content and one or more root policy addenda associated with that leaf license, as discussed in more detail below.</p>
<p id="p-0017" num="0016">Device <b>100</b> includes a consumption module <b>102</b>, a content store <b>104</b>, a license and root policy addenda store <b>106</b>, and an update module <b>108</b>. Content store <b>104</b> includes content <b>112</b>, which can be multiple different digital content as discussed above (e.g., multiple songs, multiple movies, multiple programs, and so forth). Consumption module <b>102</b> manages the consumption of content <b>112</b> at device <b>100</b>. How particular content <b>112</b> is consumed can vary based on a particular request received from a user to use content <b>112</b> as well as the type of content <b>112</b>. For example, this consumption can include playback of content <b>112</b>, transferring content <b>112</b> to another device, burning content <b>112</b> to a CD (compact disc) or other optical disc, printing a hard copy of content <b>112</b>, emailing content <b>112</b>, as well as other uses.</p>
<p id="p-0018" num="0017">License and root policy addenda store <b>106</b> stores leaf licenses and root policy addenda for content <b>112</b>. Although illustrated as a single store, leaf license and root policy addenda can alternatively be stored in separate stores. A license store of device <b>100</b> refers to a license store that is accessible to device <b>100</b>. Such a license store can be one or more of store <b>106</b>, one or more additional license stores located on another device (e.g., another device <b>100</b>, a server computer or network storage device, a removable memory device, and so forth), a portion of content <b>112</b> in which embedded licenses can be stored, and so forth. Update module <b>108</b> manages updating of leaf licenses and root policy addenda on device <b>100</b>, as discussed in more detail below.</p>
<p id="p-0019" num="0018">Content <b>112</b> can be obtained by device <b>100</b> from one or more other devices (not shown) in a variety of different manners. In one or more embodiments, content is transferred to device <b>100</b> via a network, such as the Internet, a local area network (LAN), a public telephone network, an intranet, other public and/or proprietary networks, combinations thereof, and so forth. In other embodiments, content is transferred to device <b>100</b> from another device or storage component via a direct wired or wireless connection, such as a Universal Serial Bus (USB) connection, an IEEE 1394 compliant connection, a wireless USB connection, a Bluetooth connection, and so forth.</p>
<p id="p-0020" num="0019">References are made herein to symmetric key cryptography, public key cryptography and public/private key pairs. Although such key cryptography is well-known to those skilled in the art, a brief overview of such cryptography is included here to assist the reader. In public key cryptography, an entity (such as a hardware or software component, a device, a domain, and so forth) has associated with it a public/private key pair. The public key can be made publicly available, but the entity keeps the private key a secret. Without the private key it is computationally very difficult to decrypt data that is encrypted using the public key. So, data can be encrypted by any entity with the public key and only decrypted by an entity with the corresponding private key. Additionally, a digital signature for data can be generated by using the data and the private key. Without the private key it is computationally very difficult to create a signature that can be verified using the public key. Any entity with the public key can use the public key to verify the digital signature by comparing a verification value obtained using the public key with the original data, and if the two are the same then be assured that no one has tampered with or altered the data that was digitally signed.</p>
<p id="p-0021" num="0020">In symmetric key cryptography, on the other hand, a shared key is known by and kept secret by the two entities. Any entity having the shared key is typically able to decrypt data encrypted with that shared key. Without the shared key it is computationally very difficult to decrypt data that is encrypted with the shared key. So, if two entities both know the shared key, each can encrypt data that can be decrypted by the other, but other entities cannot decrypt the data if the other entities do not know the shared key.</p>
<p id="p-0022" num="0021">Reference is also made herein to digital certificates. Digital certificates are well-known to those skilled in the art. Nonetheless, a brief overview of digital certificates is included here to assist the reader. A digital certificate can be generated by a trust authority that attests to the trustworthiness of a particular entity. The digital certificate is digitally signed by a trust authority using a private key of the trust authority. If entity A desires to verify the trustworthiness of entity B, then entity A can obtain the public key of the trust authority (which in some embodiments can be entity A) and verify the digital signature of the digital certificate. As the trust authority is trusted by entity A, entity B can be verified as being trusted if the digital signature of the digital certificate is verified as being correct.</p>
<p id="p-0023" num="0022">Consumption module <b>102</b> enforces digital rights management (DRM) on device <b>100</b>. Digital rights management refers to the protection of the rights of the artists, publishers, and/or copyright owners of digital content. The DRM techniques employed by consumption module <b>102</b> restrict the consumption of content <b>112</b> on device <b>100</b>. A variety of different accesses or consumption of content <b>112</b> can be restricted, such as playback of content <b>112</b>, burning content <b>112</b> to a CD or other optical disc, copying content <b>112</b> to another device, printing a hard copy of content <b>112</b>, sending content <b>112</b> via email, and so forth.</p>
<p id="p-0024" num="0023">The DRM techniques are employed by consumption module <b>102</b> to protect content <b>112</b> from improper uses or actions on device <b>100</b>. The constraints on the use of content <b>112</b> are made known to device <b>100</b>, typically as part of a leaf license and/or root policy addenda as discussed in more detail below. Alternatively, one or more constraints could be made known in other manners, such as pre-programmed into consumption module <b>102</b>, separate notification being given of the constraints (e.g., a separate message sent to device <b>100</b>, or obtaining the constraints from a web site, etc.), and so forth.</p>
<p id="p-0025" num="0024">Content <b>112</b> is typically protected by being encrypted so that content <b>112</b> can only be consumed in an intelligible manner if the proper decryption key is known. Consumption module <b>102</b> employs various DRM techniques to determine when it is permissible to decrypt and consume the content (in accordance with the constraints on the use of content <b>112</b>). The DRM techniques can be implemented in a variety of different manners. For example, the DRM techniques can include verification that the operating system and/or other software executing on device <b>100</b> is trustworthy, verification that the constraints dictated by the owner of the copyright of content <b>112</b> and/or the distributor of content <b>112</b> have been satisfied, and so forth. Various different DRM techniques are known to those skilled in the art, and one or more of such techniques can be used by consumption module <b>102</b>.</p>
<p id="p-0026" num="0025">One or more constraints on the use of particular content <b>112</b> are identified based on a leaf license and one or more corresponding root policy addenda. A leaf license for particular content <b>112</b> includes both a policy identifying when it is permissible to decrypt the particular content <b>112</b> (and/or when it is not permissible to decrypt the particular content <b>112</b>) and a content key for decrypting the particular content <b>112</b>. This content key is oftentimes a shared key used with symmetric key encryption, although can alternatively be a private key used with public key encryption.</p>
<p id="p-0027" num="0026">The policy identifies one or more actions that can be taken with the corresponding content <b>112</b>, one or more parties that can take those one or more actions, and/or one or more constraints or conditions to be satisfied in order to take those actions. Alternatively, or in addition, the policy can identify one or more actions that cannot be taken with corresponding content <b>112</b>, and/or one or more parties that cannot take one or more actions. Examples of actions that the policy can identify that can be taken (or alternatively cannot be taken) include playback of the corresponding content <b>112</b>, burning the corresponding content <b>112</b> to a CD or other optical disc, copying the corresponding content <b>112</b> to another device, printing a hard copy of content <b>112</b>, emailing content <b>112</b>, and so forth. Examples of parties that the policy can identify that can take (or alternatively cannot take) such actions include a particular device <b>100</b>, a particular user of device <b>100</b>, a particular operating system or program running on device <b>100</b>, and so forth. Examples of constraints or conditions to be satisfied include a particular consumption module <b>102</b> running on device <b>100</b>, a particular operating system running on device <b>100</b>, a particular time of the day, a particular day of the week, and so forth.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an example leaf license and root policy addenda employing the separating keys and policy for consuming content in accordance with one or more embodiments. <figref idref="DRAWINGS">FIG. 2</figref> shows a leaf license <b>202</b>, a device and/or domain key <b>204</b>, and multiple (x) root policy addenda <b>206</b>(<b>1</b>), . . . , <b>206</b>(<i>x</i>). Leaf license <b>202</b> is bound to device and/or domain key <b>204</b>, and also corresponds to particular content (e.g., particular content <b>112</b> of <figref idref="DRAWINGS">FIG. 1</figref>) and one or more root policy addenda <b>206</b> correspond to leaf license <b>202</b>.</p>
<p id="p-0029" num="0028">Leaf license <b>202</b> can be stored in a license store of a device (e.g., store <b>106</b> of <figref idref="DRAWINGS">FIG. 1</figref>), another license store on another device, and/or can be embedded in the content associated with leaf license <b>202</b>. Similarly, one or more of root policy addenda <b>206</b> can be stored in a license store of a device (e.g., store <b>106</b> of <figref idref="DRAWINGS">FIG. 1</figref>), another license store on another device, and/or can be embedded in the content associated with leaf license <b>202</b>. An embedded license refers to a license that is included in the associated content rather than being a separate component from the associated content. Regardless of whether leaf license <b>202</b> is embedded in the associated content, leaf license <b>202</b> is separate from each of root policy addenda <b>206</b>. For example, license <b>202</b> and each addenda <b>206</b> can be stored as separate files, as separate records within a database or file, and so forth.</p>
<p id="p-0030" num="0029">Leaf license <b>202</b> corresponds to (or is associated with) particular content (e.g., particular content <b>112</b> of <figref idref="DRAWINGS">FIG. 1</figref>). Multiple different leaf licenses <b>202</b> can correspond to multiple different content (e.g., different content <b>112</b> of <figref idref="DRAWINGS">FIG. 1</figref>). This correspondence between content and leaf license <b>202</b> can be maintained in different manners. In one or more embodiments, leaf license <b>202</b> corresponds to the content in which leaf license <b>202</b> is embedded. In other embodiments, leaf license <b>202</b> includes an identifier of content to which license <b>202</b> corresponds. This correspondence can also be maintained in other manners, such as by using a naming convention that associates a name of a file including leaf license <b>202</b> with a name of a file including particular content, by including an identifier of leaf license <b>202</b> in the content to which license <b>202</b> corresponds, and so forth.</p>
<p id="p-0031" num="0030">Additionally, in one or more embodiments leaf license <b>202</b> and/or root policy addenda <b>206</b> can be copied among various license stores. Such stores can include an embedded license portion of the content associated with the license, a license store included in the device accessing the associated content, a license store on another device, a license store on a removable memory device, and so forth. Licenses can be copied among these various license stores by, for example, a module implementing the DRM for the device (e.g., consumption module <b>122</b> of <figref idref="DRAWINGS">FIG. 1</figref>).</p>
<p id="p-0032" num="0031">Leaf licenses are bound to a particular key associated with the device on which the content is being used. This key corresponding to the device can be a device key or a domain key. A device key refers to a key of the device itself. A particular device key is typically known only to a particular device, and only that particular device is able to decrypt leaf licenses that are bound to that particular device key. A domain key on the other hand refers to a key that can be used by multiple devices. Individual devices can register to become part of a domain, or alternatively a user can register to become part of a domain. A particular domain key is typically known only to a set of one or more devices, and only that set of one or more devices is able to decrypt leaf licenses that are bound to that particular domain key. For example, a user could own multiple devices and register all those devices as part of a single domain, and all those devices could decrypt leaf licenses that are bound to the domain key of that domain. By way of another example, a user could log onto a particular device using a user ID associated with a particular domain, and while the user is logged in with that user ID that particular device can decrypt leaf licenses that are bound to the domain key of that domain.</p>
<p id="p-0033" num="0032">Leaf license <b>202</b> includes a content key <b>212</b> and policy <b>214</b>. In one or more embodiments, leaf license <b>202</b> is bound to key <b>204</b> by encrypting content key <b>212</b> such that it can only be decrypted with key <b>204</b>. Key <b>204</b> can be a private key of a public/private key pair, in which case content key <b>212</b> is encrypted using the public key corresponding to key <b>204</b>. Alternatively, key <b>204</b> could be a symmetric key.</p>
<p id="p-0034" num="0033">The content associated with leaf license <b>202</b> is encrypted using content key <b>212</b>. A module of the device accessing the content (e.g., consumption module <b>102</b> of <figref idref="DRAWINGS">FIG. 1</figref>) extracts content key <b>212</b> from leaf license <b>202</b> and uses key <b>212</b> to decrypt the corresponding content only if policy <b>214</b> indicates that the module is permitted to use the content.</p>
<p id="p-0035" num="0034">Leaf license <b>202</b> corresponds to one or more root policy addenda <b>206</b>, and policy <b>214</b> indicates that at least one of these corresponding root policy addenda <b>206</b> is to be satisfied in order for the module to be permitted to use the content. Each root policy addenda <b>206</b> includes policy <b>208</b> that identifies one or more actions, one or more parties, and/or one or more constraints as discussed above. Policy <b>214</b> can optionally identify one or more actions, one or more parties, and/or one or more constraints as discussed above. Alternatively, policy <b>214</b> can only identify at least one of the corresponding root policy addenda <b>206</b> that is to be satisfied, and rely on the root policy addenda <b>206</b> to identify one or more actions, one or more parties, and/or one or more constraints as discussed above.</p>
<p id="p-0036" num="0035">Leaf license <b>202</b> is bound to or associated with one or more root policy addenda <b>206</b>. Binding root policy addenda <b>206</b> to leaf license <b>202</b> ensures that only those root policy addenda <b>206</b> intended to be associated with leaf license <b>202</b> are indeed associated with leaf license <b>202</b>. A rogue or malicious root policy addenda <b>206</b> would not be bound to leaf license <b>202</b>, and accordingly any policy included in such a root policy addenda would not be used in determining whether particular use of the associated content is permitted.</p>
<p id="p-0037" num="0036">This binding or association between leaf license <b>202</b> and root policy addenda <b>206</b> can be maintained in a variety of different manners. In one or more embodiments, this binding or association is maintained by assigning an identifier to a particular binding. This identifier is included in both leaf license <b>202</b> and each associated root policy addenda <b>206</b>, and these identifiers in license <b>202</b> and addenda <b>206</b> are signed using a private key of a trust authority. Thus, only those root policy addenda <b>206</b> that include the appropriate identifier and are digitally signed by a trust authority are associated with leaf license <b>202</b>. Digital signatures can be verified by a module implementing the DRM to ensure that the identifiers have not been altered after signing.</p>
<p id="p-0038" num="0037">In one or more other embodiments, this binding or association is maintained by following a particular naming convention for files including license <b>202</b> and files including associated root policy addenda <b>206</b>. This naming convention can use different names for different sets of leaf license <b>202</b> and corresponding root policy addenda <b>206</b>, allowing these bindings to be readily identified. The names of these files following this naming convention can be digitally signed using a private key of a trust authority to ensure that the filenames have not been altered after signing. Digital certificates can also be associated with these filenames to ensure that the filenames and files were generated by a trusted entity.</p>
<p id="p-0039" num="0038">In one or more other embodiments, this binding or association is maintained by having a trust authority issue a digital certificate that identifies leaf license <b>202</b> and the root policy addenda <b>206</b> associated with license <b>202</b>. As the trust authority is trusted by the module implementing the DRM, the root policy addenda <b>206</b> identified in the digital certificate can be trusted as being associated with the leaf license <b>202</b> identified in the digital certificate.</p>
<p id="p-0040" num="0039">In one or more other embodiments, this binding or association is maintained by encrypting the root policy addenda <b>206</b> associated with a key of leaf license <b>202</b>. This encryption can be performed in different manners, such as symmetric encryption using content key <b>212</b> or another key, public key encryption using a public key of leaf license <b>202</b>, and so forth. By encrypting the root policy addenda <b>206</b> so that only leaf license <b>202</b> can decrypt the addenda <b>206</b>, the addenda <b>206</b> is bound to that leaf license <b>202</b>.</p>
<p id="p-0041" num="0040">In one or more other embodiments, this binding or association is maintained implicitly. This implicit binding can assume that a secret (e.g., a key) is maintained and is to be known in order for root policy addenda <b>206</b> to be used. For example, root policy addenda <b>206</b> can be encrypted using a particular key known by or accessible to leaf license <b>202</b>, and it is simply assumed that leaf license <b>202</b> is associated with root policy addenda <b>206</b> if leaf license <b>202</b> can decrypt root policy addenda <b>206</b>. If leaf license <b>202</b> cannot decrypt root policy addenda <b>206</b>, then there is no binding or association between the two. Similarly, the integrity of root policy addenda <b>206</b> can be verified by leaf license <b>202</b> simply assuming that root policy addenda <b>206</b> is encrypted using a particular key. If leaf license <b>202</b> can decrypt root policy addenda <b>206</b> with the particular key then leaf license <b>202</b> is associated with root policy addenda <b>206</b>. If leaf license <b>202</b> cannot decrypt root policy addenda <b>206</b> with the particular key (regardless of whether another key could be used, or whether addenda <b>206</b> is not encrypted), then there is no binding or association between the two.</p>
<p id="p-0042" num="0041">It is to be appreciated that leaf license <b>202</b> and each of root policy addenda <b>206</b> can also be digitally signed by a trust authority. These digital signatures can be verified by a module implementing the DRM to ensure that the license <b>202</b> and each addenda <b>206</b> have not been altered after signing.</p>
<p id="p-0043" num="0042">It should be noted that, as illustrated in <figref idref="DRAWINGS">FIG. 2</figref>, leaf license <b>202</b> includes content key <b>212</b>. However, no such content key is included in root policy addenda <b>206</b>. Content keys are excluded from root policy addenda <b>206</b>, although the policies in root policy addenda <b>206</b> can still be associated with leaf license <b>202</b> as discussed above.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 3</figref> illustrates example leaf licenses and root policy addenda employing the separating keys and policy for consuming content in accordance with one or more embodiments. <figref idref="DRAWINGS">FIG. 3</figref> shows multiple leaf licenses <b>302</b>(<b>1</b>), . . . , <b>302</b>(<i>y</i>) (each analogous to leaf license <b>202</b> of <figref idref="DRAWINGS">FIG. 2</figref>), a device and/or domain key <b>304</b> (analogous to key <b>204</b> of <figref idref="DRAWINGS">FIG. 2</figref>), and root policy addenda <b>306</b> (analogous to a root policy addenda <b>206</b> of <figref idref="DRAWINGS">FIG. 2</figref>) including policy <b>308</b> (analogous to a policy <b>208</b> of <figref idref="DRAWINGS">FIG. 2</figref>). Each leaf license <b>302</b> includes a content key <b>312</b> (each analogous to content key <b>212</b> of <figref idref="DRAWINGS">FIG. 2</figref>) and policy <b>314</b> (each analogous to policy <b>214</b> of <figref idref="DRAWINGS">FIG. 2</figref>).</p>
<p id="p-0045" num="0044">Analogous to the discussion of <figref idref="DRAWINGS">FIG. 2</figref> above, each leaf license <b>302</b> is bound to device and/or domain key <b>304</b>. Each leaf license <b>302</b> also corresponds to particular content. In one or more embodiments each leaf license <b>302</b> corresponds to different content, although multiple leaf licenses <b>302</b> can correspond to the same content. Additionally, each leaf license <b>302</b> is bound to the same root policy addenda <b>306</b>. These bindings can occur in a variety of different manners as discussed above. <figref idref="DRAWINGS">FIG. 3</figref> shows multiple leaf licenses bound to the same root policy addenda, whereas <figref idref="DRAWINGS">FIG. 2</figref> shows multiple root policy addenda bound to the same leaf license.</p>
<p id="p-0046" num="0045">Although not shown in <figref idref="DRAWINGS">FIG. 3</figref>, it is to be appreciated that one or more leaf licenses <b>302</b> can be bound to one or more additional root policy addenda <b>306</b>. Such additional root policy addenda can be bound to multiple leaf licenses <b>302</b>, or alternatively to a single leaf license <b>302</b>. Thus, as shown in <figref idref="DRAWINGS">FIGS. 2 and 3</figref>, each leaf license can be bound to multiple root policy addenda, and each root policy addenda can be bound to multiple leaf licenses.</p>
<p id="p-0047" num="0046">Referring to <figref idref="DRAWINGS">FIGS. 2 and 3</figref>, the leaf licenses and associated root policy addenda allow different policies to be easily updated on a device. This updating can be performed, for example, by update module <b>108</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and can include adding new root policy addenda, deleting root policy addenda, and so forth. If a new policy is to added for particular content, a new root policy addenda <b>206</b> (or <b>306</b>) with that new policy is stored in a license store of the device and a binding between that new root policy addenda <b>206</b> (or <b>306</b>) and leaf license <b>202</b> (or <b>302</b>) is established. Aside from creating this binding, no changes need be made to leaf license <b>202</b> (or <b>302</b>) to accommodate this new policy.</p>
<p id="p-0048" num="0047">By way of example, assume that a device downloads content as part of a subscription service in which the user of the device pays a monthly fee for the ability to playback the content. Each content (e.g., each song, movie, etc.) downloaded has an associated leaf license <b>202</b> (or <b>302</b>), and each of these leaf licenses <b>202</b> (or <b>302</b>) are bound to the same root policy addenda <b>206</b> (or <b>306</b>). This root policy addenda <b>206</b> (or <b>306</b>) can be updated every month as the monthly fee is paid. Thus, a single root policy addenda <b>206</b> (or <b>306</b>) update can be performed once per month to allow access to all of the downloaded content for another month.</p>
<p id="p-0049" num="0048">Furthermore, following the previous example assume that the monthly fee allows for playback of the content but not burning the content to an optical disc. Accordingly, any attempts by the user to burn the content to an optical disc will not be allowed by the DRM. If a user desires to burn particular content to an optical disc then the user can pay an additional fee for that ability. Once the fee is paid, a new root policy addenda <b>206</b> (or <b>306</b>) can be downloaded by the device and bound to leaf license <b>202</b> (or <b>302</b>). Once bound to leaf license <b>202</b> (or <b>302</b>), subsequent attempts to burn the content to an optical disc will be successful.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating an example process <b>400</b> for a device consuming content using the separating keys and policy for consuming content in accordance with one or more embodiments. Process <b>400</b> is carried out by a device, such as device <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and can be implemented in software, firmware, hardware, or combinations thereof. Process <b>400</b> is an example process for consuming content using the separating keys and policy for consuming content; additional discussions of consuming content using the separating keys and policy for consuming content are included herein with reference to different figures.</p>
<p id="p-0051" num="0050">Initially, a request to perform an action at a device with content is received (act <b>402</b>). This action is an action to consume the content in some manner, such as play, store, transfer, and/or otherwise access or use the content at the device. In response to receiving this request, a leaf license for the content is accessed (act <b>404</b>) and one or more root policy addenda associated with the leaf license are identified (act <b>406</b>). The root policy addenda can be associated with the leaf license in any of a variety of different manners as discussed above.</p>
<p id="p-0052" num="0051">A check is then made as to whether the leaf license or one or more of the root policy addenda includes policy permitting the requested action (act <b>408</b>). If no such policy permitting the requested action can be found, then the requested action is not performed (act <b>410</b>).</p>
<p id="p-0053" num="0052">However, if policy permitting the requested action is found in the leaf license or a root policy addenda associated with the leaf license, then a key associated with the device is used to decrypt a content key in the leaf license (act <b>412</b>). This key associated with the device can be a device and/or domain key as discussed above, and is the key to which the leaf license is bound. The content key is then used to decrypt the content for which the action was requested (act <b>414</b>), and the requested action is performed (act <b>416</b>).</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart illustrating an example process <b>500</b> for a device updating root policy addenda using the separating keys and policy for consuming content in accordance with one or more embodiments. Process <b>500</b> is carried out by a device, such as device <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>, and can be implemented in software, firmware, hardware, or combinations thereof. Process <b>500</b> is an example process for updating root policy addenda using the separating keys and policy for consuming content; additional discussions of updating root policy addenda using the separating keys and policy for consuming content are included herein with reference to different figures.</p>
<p id="p-0055" num="0054">Initially, a root policy addenda for content is received (act <b>502</b>). The root policy addenda received in act <b>502</b> is stored (act <b>504</b>), and a leaf license corresponding to the content is identified (act <b>506</b>). The leaf license corresponding to particular content can be identified in a variety of different manners as discussed above. The root policy addenda received in act <b>502</b> is associated with the identified leaf license (act <b>508</b>). This association or binding of the root policy addenda to the leaf license can be performed in a variety of different manners as discussed above. In one or more embodiments the root policy addenda may already be associated with the leaf license (e.g., an identifier included in the leaf license is already included in the root policy addenda), in which case the associating in act <b>508</b> is performed before receipt of the root policy addenda.</p>
<p id="p-0056" num="0055">Thus, as can be seen from the discussions herein, the content keys used to decrypt content are bound to a device and/or domain key. If the device and/or domain key is compromised (e.g., a rogue or malicious application or user is able to access the device and/or domain key), then a new device and/or domain key can be issued and the content keys re-bound to this new device and/or domain key. The content is thus protected because the compromised device and/or domain key can no longer be used to decrypt the content keys.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 6</figref> illustrates an example computing device <b>600</b> that can be configured to implement the separating keys and policy for consuming content in accordance with one or more embodiments. Computing device <b>600</b> can be, for example, device <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0058" num="0057">Computing device <b>600</b> includes one or more processors or processing units <b>602</b>, one or more computer readable media <b>604</b> which can include one or more memory and/or storage components <b>606</b>, one or more input/output (I/O) devices <b>608</b>, and a bus <b>610</b> that allows the various components and devices to communicate with one another. Computer readable media <b>604</b> and/or I/O device(s) <b>608</b> can be included as part of, or alternatively may be coupled to, computing device <b>600</b>. Bus <b>610</b> represents one or more of several types of bus structures, including a memory bus or memory controller, a peripheral bus, an accelerated graphics port, a processor or local bus, and so forth using a variety of different bus architectures. Bus <b>610</b> can include wired and/or wireless buses.</p>
<p id="p-0059" num="0058">Memory/storage component <b>606</b> represents one or more computer storage media. Component <b>606</b> can include volatile media (such as random access memory (RAM)) and/or nonvolatile media (such as read only memory (ROM), Flash memory, optical disks, magnetic disks, and so forth). Component <b>606</b> can include fixed media (e.g., RAM, ROM, a fixed hard drive, etc.) as well as removable media (e.g., a Flash memory drive, a removable hard drive, an optical disk, and so forth).</p>
<p id="p-0060" num="0059">The techniques discussed herein can be implemented in software, with instructions being executed by processing unit(s) <b>602</b>. It is to be appreciated that different instructions can be stored in different components of computing device <b>600</b>, such as in a processing unit <b>602</b>, in various cache memories of a processing unit <b>602</b>, in other cache memories of device <b>600</b> (not shown), on other computer readable media, and so forth. Additionally, it is to be appreciated that the location where instructions are stored in computing device <b>600</b> can change over time.</p>
<p id="p-0061" num="0060">One or more input/output devices <b>608</b> allow a user to enter commands and information to computing device <b>600</b>, and also allows information to be presented to the user and/or other components or devices. Examples of input devices include a keyboard, a cursor control device (e.g., a mouse), a microphone, a scanner, and so forth. Examples of output devices include a display device (e.g., a monitor or projector), speakers, a printer, a network card, and so forth.</p>
<p id="p-0062" num="0061">Various techniques may be described herein in the general context of software or program modules. Generally, software includes routines, programs, objects, components, data structures, and so forth that perform particular tasks or implement particular abstract data types. An implementation of these modules and techniques may be stored on or transmitted across some form of computer readable media. Computer readable media can be any available medium or media that can be accessed by a computing device. By way of example, and not limitation, computer readable media may comprise &#x201c;computer storage media&#x201d; and &#x201c;communications media.&#x201d;</p>
<p id="p-0063" num="0062">&#x201c;Computer storage media&#x201d; include volatile and non-volatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules, or other data. Computer storage media include, but are not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to store the desired information and which can be accessed by a computer.</p>
<p id="p-0064" num="0063">&#x201c;Communication media&#x201d; typically embody computer readable instructions, data structures, program modules, or other data in a modulated data signal, such as carrier wave or other transport mechanism. Communication media also include any information delivery media. The term &#x201c;modulated data signal&#x201d; means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media include wired media such as a wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared, and other wireless media. Combinations of any of the above are also included within the scope of computer readable media.</p>
<p id="p-0065" num="0064">Generally, any of the functions or techniques described herein can be implemented using software, firmware, hardware (e.g., fixed logic circuitry), manual processing, or a combination of these implementations. The terms &#x201c;module,&#x201d; &#x201c;functionality,&#x201d; and &#x201c;logic&#x201d; as used herein generally represent software, firmware, hardware, or combinations thereof. In the case of a software implementation, the module, functionality, or logic represents program code that performs specified tasks when executed on a processor (e.g., CPU or CPUs). The program code can be stored in one or more computer readable memory devices, further description of which may be found with reference to <figref idref="DRAWINGS">FIG. 6</figref>. The features of the embedded licenses for content techniques described herein are platform-independent, meaning that the techniques can be implemented on a variety of commercial computing platforms having a variety of processors.</p>
<p id="p-0066" num="0065">Although the subject matter has been described in language specific to structural features and/or methodological acts, it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather, the specific features and acts described above are disclosed as example forms of implementing the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. One or more computer storage media devices having stored thereon multiple instructions that, when executed by one or more processors of a computing device, cause the one or more processors to:
<claim-text>receive a request to perform an action at the computing device with content;</claim-text>
<claim-text>identify one or more root policy addenda associated with a leaf license corresponding to the content, at least one of the one or more root policy addenda being associated with multiple leaf licenses that each correspond to a particular one of multiple different content;</claim-text>
<claim-text>if the one or more root policy addenda permit the action, then:
<claim-text>use a key associated with the computing device to decrypt a content key included in the leaf license, the leaf license being separate from the one or more root policy addenda, the content key to decrypt the content being excluded from the root policy addenda;</claim-text>
<claim-text>use the content key to decrypt the content; and</claim-text>
<claim-text>perform the action with the content; and</claim-text>
</claim-text>
<claim-text>if the one or more root policy addenda do not permit the action then do not perform the action.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. One or more computer storage media devices as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein to identify the one or more root policy addenda is to access the leaf license and identify the one or more root policy addenda bound to the leaf license.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. One or more computer storage media devices as recited in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein to identify the one or more root policy addenda bound to the leaf license is to obtain an identifier from the leaf license and identify the one or more root policy addenda that include the identifier.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. One or more computer storage media devices as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the key associated with the computing device is a domain key for a domain of which the computing device is a part.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. One or more computer storage media devices as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein each of the one or more root policy addenda includes policy identifying when it is permissible to decrypt and consume the content.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. One or more computer storage media devices as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the leaf license is embedded in the content.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. One or more computer storage media devices as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the action comprises playback of the content at the computing device.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A method implemented on a device, the method comprising:
<claim-text>receiving a root policy addenda corresponding to a request to perform an action with content on the device, the root policy addenda including policy identifying when it is permissible to decrypt and consume the content but excluding a content key to decrypt the content, the root policy addenda being associated with a leaf license for the content, the leaf license being separate from the root policy addenda and including the content key to decrypt the content;</claim-text>
<claim-text>storing the root policy addenda in a root policy addenda store;</claim-text>
<claim-text>associating the root policy addenda with one or more additional leaf licenses that each correspond to a particular one of different content on the device;</claim-text>
<claim-text>if the one or more root policy addenda permit the action, then:</claim-text>
<claim-text>utilizing a device key that is associated with the device to decrypt the content key included in the leaf license;</claim-text>
<claim-text>utilizing the content key to decrypt the content on the device if the root policy addenda permits a requested action with the content on the device; and</claim-text>
<claim-text>performing the requested action with the content when decrypted;</claim-text>
<claim-text>if the one or more root policy addenda do not permit the action then do not perform the action.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A method as recited in <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising:
<claim-text>identifying the leaf license corresponding to the content; and</claim-text>
<claim-text>associating the root policy addenda with the leaf license.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A method as recited in <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the content key is encrypted with a domain key for a domain of which the device is a part.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A method as recited in <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the leaf license is embedded in the content.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A device comprising:
<claim-text>a first store implemented in memory storage to store, in response to a request, content for use on the device;</claim-text>
<claim-text>a second store implemented in the memory storage to store a leaf license for the content in the first store and one or more root policy addenda bound to the leaf license, at least one of the one or more root policy addenda being bound to multiple additional leaf licenses that each correspond to a particular one of multiple different content, each root policy addenda including policy identifying when it is permissible to decrypt and consume the content but excluding a content key to decrypt the content, the content key being included in the leaf license; and</claim-text>
<claim-text>a consumption module, coupled to the first store and the second store, the consumption module to consume the content only if the policy identifies that it is permissible to decrypt and consume the content, the consumption module further to use a device key associated with the device to decrypt the content key included in the leaf license, and use the content key to decrypt the content to consume the content.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A device as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref>, further comprising an update module to:
<claim-text>receive a new root policy addenda corresponding to the content, the new root policy addenda including policy identifying when it is permissible to decrypt and consume the content but excluding the content key to decrypt the content;</claim-text>
<claim-text>store the root policy addenda in the second store;</claim-text>
<claim-text>identify the leaf license; and</claim-text>
<claim-text>associate the new root policy addenda with the leaf license.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A device as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the one or more root policy addenda are bound to the leaf license by being encrypted using a key of the leaf license.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A device as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein to consume the content is to playback audio/video content.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A device as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the leaf license includes a policy identifying the one or more root policy addenda. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353050-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353050</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12552836</doc-number>
<date>20090902</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<rule-47-flag/>
<us-term-of-grant>
<us-term-extension>434</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>M</subclass>
<main-group>15</main-group>
<subgroup>12</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 27</main-classification>
<further-classification>455405</further-classification>
<further-classification>380255</further-classification>
</classification-national>
<invention-title id="d2e55">Mobile device management</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>7197321</doc-number>
<kind>B2</kind>
<name>Erskine et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7290132</doc-number>
<kind>B2</kind>
<name>Aboba et al.</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7302272</doc-number>
<kind>B2</kind>
<name>Ackley</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0005329</doc-number>
<kind>A1</kind>
<name>Ikonen</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0250472</doc-number>
<kind>A1</kind>
<name>Silvester et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2008/0292101</doc-number>
<kind>A1</kind>
<name>Macchi</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380270</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2009/0136035</doc-number>
<kind>A1</kind>
<name>Lee</name>
<date>20090500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2009/0298469</doc-number>
<kind>A1</kind>
<name>Kim et al.</name>
<date>20091200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455411</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2010/0330961</doc-number>
<kind>A1</kind>
<name>Rogel</name>
<date>20101200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455411</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>EP</country>
<doc-number>1845692</doc-number>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Anonymous, Web site lets parents monitor teens' cell phone use, Online forum posting, posted Sep. 4, 2007, http://www.broadbandreports.com/forurn/r19007350-web-site-lets-parents-monitor-teens-cell-phone-use.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Stefanie Olsen, Software lets parents monitor kids' calls, Article, Jul. 10, 2007, http://news.cnet.com/software-lets-parents-monitor-kinds-calls/2009-1025<sub>&#x2014;</sub>3-6195666.html.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Mobile-Spy Home Page, http://www.mobile-spy.com/, Accessed Nov. 24, 2009.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>My Mobile Watchdog company &#x201c;Product Features&#x201d; web page, http://www.mymobilewatchdog.com/features.shtml, Accessed Nov. 24, 2009.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>SPEKE (Cryptography), Article, http://en.wikipedia.org/wiki/SPEKE<sub>&#x2014;</sub>(cryptography), Accessed Oct. 7, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>http://www.w2forum.com/i/SMS<sub>&#x2014;</sub>is<sub>&#x2014;</sub>still<sub>&#x2014;</sub>mobile<sub>&#x2014;</sub>data<sub>13 </sub>king<sub>&#x2014;</sub>on<sub>&#x2014;</sub>GSM<sub>&#x2014;</sub>networks/, Web site.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>Yehuda Shiran, Ph.D., The Netscape 6 Event Listener, Article, Jan. 1, 2001, http://www.webreference.com/js/tips/010101.html, Accessed Nov. 24, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>Verizon, How to Use Guide: Chaperone, http://wirelesssupport.verizon.com/how<sub>&#x2014;</sub>to<sub>&#x2014;</sub>use<sub>&#x2014;</sub>chaperone.html?t=5, Accessed Oct. 8, 2008.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>European Search Report, European Patent Application No. 09169303.6, Mar. 3, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>Dilger, Daniel Eran, Is Apple's MobileMe Secure?, Aug. 22, 2008, Retrieved from the Internet: URL: http://www.roughlydrafted.com/2008/08/22/is-apples-mobileme-secure/, retrieved on Apr. 9, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>11</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726  1</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726  2</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713168-171</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380255</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380270</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20110055546</doc-number>
<kind>A1</kind>
<date>20110303</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Klassen</last-name>
<first-name>Gerhard Dietrich</first-name>
<address>
<city>Waterloo</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Major</last-name>
<first-name>Harry Richmond</first-name>
<address>
<city>Waterloo</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Gagne</last-name>
<first-name>Alain Rene</first-name>
<address>
<city>Cambridge</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Creditor</last-name>
<first-name>Karen Jean</first-name>
<address>
<city>Waterloo</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
<applicant sequence="005" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Boudreau</last-name>
<first-name>Jesse J.</first-name>
<address>
<city>Kanata</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Riodout &#x26; Maybee LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Research In Motion Limited</orgname>
<role>03</role>
<address>
<city>Waterloo</city>
<country>CA</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Barron, Jr.</last-name>
<first-name>Gilberto</first-name>
<department>2432</department>
</primary-examiner>
<assistant-examiner>
<last-name>Cribbs</last-name>
<first-name>Malcolm</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A device management method, is disclosed in which available features on a slave mobile device are managed (monitored or controlled) by a slave manager module commanded by a master device through secure messages exchanged between the two devices using respective electronic messaging capabilities on the two devices. Selection of the features of the slave mobile device to be controlled or monitored is facilitated on the master device through a master manager module resident thereon. The features that are controlled or monitored may comprise any user-accessible feature incorporated or installed on the slave mobile device and user access to the feature may be prevented according to at least one criterion, such as: date of use, time of day of use, number of times of use, originator and recipient. User access to the feature may be prevented access to the user-accessible feature when usage limitations for the feature have been reached.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="118.62mm" wi="132.93mm" file="US08353050-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="135.97mm" wi="132.59mm" file="US08353050-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="155.02mm" wi="144.19mm" file="US08353050-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="168.66mm" wi="129.88mm" file="US08353050-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="161.04mm" wi="125.65mm" file="US08353050-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="159.60mm" wi="121.07mm" file="US08353050-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="163.07mm" wi="123.61mm" file="US08353050-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present disclosure relates generally to mobile communications devices and methods and more particularly to methods, devices and system for monitoring mobile communications devices.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Monitoring the use of mobile communications devices is an ongoing issue. Users of such devices can move about, whether or not the users are authorized to do so. Also, users can use the devices in ways that are not authorized. Such use can result in significant expenses.</p>
<p id="p-0004" num="0003">Improvements to monitoring of mobile communications devices are desirable.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0005" num="0004"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an example embodiment of a mobile device management system incorporating features of the present disclosure;</p>
<p id="p-0006" num="0005"><figref idref="DRAWINGS">FIG. 2</figref> is a flow chart showing example processing actions performed by a master manager module on a master device according to an example embodiment of the present disclosure;</p>
<p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart showing example processing actions performed by a slave manager module on a slave mobile device according to an example embodiment of the present disclosure;</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 4</figref> is a graphical representation of a front view of an example of a mobile device suitable for performing the example processing actions of <figref idref="DRAWINGS">FIG. 3</figref> or <figref idref="DRAWINGS">FIG. 2</figref>, or both;</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 5</figref> is a simplified block diagram of the example mobile device of <figref idref="DRAWINGS">FIG. 4</figref>; and</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 6</figref> is a simplified block diagram of a communications environment suitable for the example mobile device of <figref idref="DRAWINGS">FIG. 4</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0011" num="0010">Like reference numerals are used in the drawings to denote like elements and features.</p>
<heading id="h-0004" level="1">DESCRIPTION</heading>
<p id="p-0012" num="0011">A device management system is described, in which a first mobile communications device (slave) is managed under the command of a second device (master). The slave mobile device is managed through a slave manager module resident on the slave mobile device. The master device commands the slave mobile device through the slave manager module. A master manager module is resident on the master device. The master device commands the slave manager module through at least one command message from the master device to the slave mobile device. The slave mobile device can be managed by controlling user-accessible features on the device, by monitoring user-accessible features, or both.</p>
<p id="p-0013" num="0012">The user-accessible features that are managed by the slave manager module can comprise, for example, any user-accessible feature incorporated or installed on the slave mobile device, such as, cellular telephone functions, text messaging functions such as SMS or PIN messaging, e-mail functions, web browsers, games, multimedia applications including multimedia players or camera applications, social networking applications, calendars, address books, or GPS or mapping functions.</p>
<p id="p-0014" num="0013">The slave manager module can be commanded to control the slave mobile device to prevent access by a user of the slave mobile device to one or more features according to certain criteria, such as for example, outside specified periods of time or dates, above a maximum usage level, to communicate except other than to permitted third parties, to communicate with prohibited third parties, or any combination of one or more of the foregoing.</p>
<p id="p-0015" num="0014">The slave manager module can be commanded, for example, to monitor any of the above user-accessible features. Monitoring of one or more user-accessible features on the slave mobile device may comprise a periodic or on-demand transfer of data to the master device, such as recent accesses to user-accessible features. Additionally or alternatively, the slave manager module can provide an immediate notification of current status or prohibited activity.</p>
<p id="p-0016" num="0015">Management commands can, for example, be communicated by the master manager module on the master device to the slave manager module on the slave mobile device and confirmed by the slave manager module to the master manager module, and monitored activity or status information can, for example, be communicated by the slave manager module to the master manager module in a message through any device-readable messaging capability, such as, for example, PIN messaging, SMS messaging and e-mail messages. Such messages are in some example embodiments, encrypted to provide security and reliability.</p>
<p id="p-0017" num="0016">The master manager module and slave manager module can listen for such messages by periodically accessing incoming message queues of the message capability or setting forwarding capabilities of such messaging capabilities.</p>
<p id="p-0018" num="0017">The present disclosure will now be described in detail for the purposes of illustration only, in conjunction with certain embodiments shown in the enclosed drawings.</p>
<p id="p-0019" num="0018">Turning now to <figref idref="DRAWINGS">FIG. 1</figref>, there is shown a block diagram of an example embodiment of a mobile device management system incorporating features of the present disclosure. The system, shown generally at <b>100</b>, comprises a first mobile device <b>110</b>, designated the slave mobile device, and a second device <b>120</b>, designated the master device. As an example, the slave mobile device <b>110</b> and the master device <b>120</b> may be used, respectively, by a child and parent, or by spouses, or by an employee and employer.</p>
<p id="p-0020" num="0019">The slave mobile device <b>110</b> incorporates one or more mobile communication device features <b>112</b> which can be incorporated in one or more software applications on the slave mobile device <b>110</b>, and a slave manager module <b>115</b> which can also be incorporated in one or more software applications on the slave mobile device <b>110</b>. The slave manager module <b>115</b> receives one or more command messages from the master device <b>120</b> and manages the slave mobile device <b>110</b> in accordance with the command messages, by controlling or monitoring, access to one or more user-features <b>112</b>.</p>
<p id="p-0021" num="0020">Additionally, the slave manager module <b>115</b> can generate and transmit one or more confirmation messages to the master device <b>120</b> to confirm that command messages received from the master device <b>120</b> have been given effect. Further, the slave manager module <b>115</b> can generate and transmit one or more status report messages to the master device <b>120</b> providing updates as to the occasion, status and details of access to one or more monitored features of the slave mobile device <b>110</b>.</p>
<p id="p-0022" num="0021">The master device <b>120</b> can be a mobile device similar to the slave mobile device <b>110</b>, except with a master manager module <b>125</b> in place of the slave manager module <b>115</b> which may be incorporated in one or more software applications on the master device <b>120</b>. The master manager module <b>125</b> provides a user interface to display command options to command a slave manager module <b>115</b> and to accept command inputs from a user, and generates one or more command messages that the master manager module <b>125</b> transmits, to the slave manager module <b>115</b> of the slave mobile device <b>110</b>. Additionally, the master manager module <b>125</b> accepts one or more confirmation messages from the slave manager module <b>115</b> or one or more status report messages from the slave manager module <b>115</b>.</p>
<p id="p-0023" num="0022">While the master device <b>120</b> is described above as being a mobile communications device similar to the slave mobile device <b>110</b>, the master device <b>120</b> may be a device other than a mobile device, for example, a desktop computer (not shown) with SMS or other suitable device-readable messaging capability.</p>
<p id="p-0024" num="0023">The slave mobile device <b>110</b> and the master device <b>120</b> each transmit and receive messages through two-way electronic (or device-readable) messaging capability <b>130</b> such that the slave manager module <b>115</b> and the master manager module <b>125</b> can read the content of the messages to perform the functions described herein. For example, the two-way electronic messaging capability <b>130</b> can use text-based electronic messaging such as email, personal identification number (PIN) messaging or short message service (SMS) text messaging functions, or other forms of electronic messaging. The two-way electronic messaging capability <b>130</b> may use other transport layers and protocols to the extent available to the slave manager module <b>115</b> and the master manager module <b>125</b>. Such two-way electronic messaging capability <b>130</b> facilitates communication of messages between the slave mobile device <b>110</b> and the master device <b>120</b> and may involve network communications through one or more nodes, one of which may be a central enterprise server <b>140</b>.</p>
<p id="p-0025" num="0024">One or more listeners <b>142</b> may exist on the master device <b>120</b> to be utilized by the master manager module <b>125</b> to listen for messages communicated by the slave manager module <b>115</b> and one or more listeners <b>144</b> may exist on the slave mobile device <b>110</b> to be utilized by the slave manager module <b>115</b> to listen for messages communicated to it by the master manager module <b>125</b> or the occurrence of events or both.</p>
<p id="p-0026" num="0025">Messages between the slave mobile device <b>110</b> and the master device <b>120</b> constitute a communications channel <b>132</b> extending between the slave mobile device <b>110</b> and the master device <b>120</b>.</p>
<p id="p-0027" num="0026">To address privacy concerns of users of the system <b>100</b>, messages exchanged between the slave manager module <b>115</b> and the master manager module <b>125</b> are encrypted in some example embodiments by using a shared secret so that communications across the communications channel <b>132</b> can be authenticated by modules <b>115</b>, <b>125</b> as having been sent by the corresponding other module <b>125</b>, <b>115</b>, and not altered or understood by a third party, including an enterprise server <b>140</b> that gives effect to the communications channel <b>132</b>.</p>
<p id="p-0028" num="0027">Methods of performing such encryption may include a unique password, commonly referred to as an encryption key, known to both modules <b>115</b>, <b>125</b>. For example, a message may be encrypted by the master manager module <b>125</b> using the password, and decrypted by the slave manager module <b>115</b> using the same password. Other example embodiments may use public-key encryption employing a private key and a public key.</p>
<p id="p-0029" num="0028">One or more encryption keys can be manually input into the modules <b>115</b>, <b>125</b> through human interface devices, such as keyboards, of the devices <b>110</b>, <b>120</b> and appropriate user interface screens of the modules <b>115</b>, <b>125</b>. Alternatively, one or more encryption keys can be generated by one of modules <b>115</b> and <b>125</b> and manually input into the other module <b>125</b>, <b>115</b>. For example, one or more keys can be generated on master manager module <b>125</b> and manually input into the slave manager module <b>115</b> through a human interface device, such as a keyboard, of the slave mobile device <b>110</b> and an appropriate user interface screen of the slave manager module <b>115</b>. As a further alternative, the keys can be exchanged between the modules <b>115</b>, <b>125</b> over a secure network or other connection, such as a peer to peer network over a USB, or other physical, cable.</p>
<p id="p-0030" num="0029">If desired, one or more keys can be exchanged between the modules <b>115</b>, <b>125</b> using a key exchange protocol to jointly establish a shared key or otherwise exchange a key on an insecure network or other communications channel prior to establishment of a secure communications channel <b>132</b>. A number of different protocols, such as Diffie-Hellman key exchange or SPEKE (Simple Password Exponential Key Exchange) can be used. Other protocols can also be used. Such protocols can be incorporated into the modules <b>115</b>, <b>125</b> as desired to eliminate or minimize user input. Where encryption keys are to be exchanged, the keys could be generated on the respective devices apart from the modules <b>115</b>, <b>125</b>, such as an existing public key&#x2014;private key pair, and exchanged, or created automatically by the modules <b>115</b>, <b>125</b> upon installation, or upon request thereafter.</p>
<p id="p-0031" num="0030">The exchanging or inputting of one or more encryption keys into the slave mobile device <b>110</b> and master device <b>120</b> to enable the secure communications channel is referred to as pairing, and results in a paired slave mobile device <b>110</b> and master device <b>120</b>.</p>
<p id="p-0032" num="0031">Pairing will typically be performed by a user of the master device <b>120</b> where tampering by the user of the slave mobile device <b>110</b> is a concern. Where such tampering is a concern, the slave manager module <b>115</b> can be configured to be non-user-accessible such that its encryption key and configuration cannot be altered once input except by a request message from the master manager module <b>120</b>.</p>
<p id="p-0033" num="0032">More than one slave mobile device <b>110</b> can be paired with any given master device <b>120</b>, although, in some example embodiments there is only one master device <b>120</b> paired with each slave mobile device <b>110</b>. A configuration allowing more than one master device <b>120</b> for a slave mobile device <b>110</b> may be appropriate, for example, if two parents, each having a master device <b>120</b>, would like to manage the slave mobile device <b>110</b> of a child.</p>
<p id="p-0034" num="0033">Because of the possibility of mischief by establishing a pairing between the slave mobile device <b>110</b> and a device (not shown) seeking to stand in as a master device <b>120</b>, in some example embodiments a security mechanism is employed to reduce the likelihood of such other device (not shown) infiltrating itself as one of, or as, the master device <b>120</b>. One example security mechanism may ensure that once a pairing is created between a slave mobile device <b>110</b> and a master device <b>120</b>, no further pairing can be created between the slave mobile device <b>110</b> and any other device (not shown) as a master device <b>120</b>, either at all, or without the participation of the existing master device <b>120</b>, by way of authorization from the master device <b>120</b>. Such an example embodiment prevents the creation of an undesired pairing between the slave mobile device <b>110</b> and such other device (not shown), should the slave mobile device <b>110</b> fall into the hands of a third party in possession of such other device (not shown), for example, where a child provides the slave mobile device <b>110</b> to another person.</p>
<p id="p-0035" num="0034">Moreover, as also discussed later, depending upon the context, a particular mobile device may operate as both a slave mobile device <b>110</b> and as a master device <b>120</b> in a pairing with a third device (not shown).</p>
<p id="p-0036" num="0035">A mobile communications device may have either or both of a slave manager module <b>115</b> and a master manager module <b>125</b>, or a combined master/slave manager module (not shown) that operates in a master mode similar to the master manager module <b>125</b> and a slave mode similar to the slave manager module <b>115</b>.</p>
<p id="p-0037" num="0036">Two devices may be paired so that one acts as the slave mobile device <b>110</b> to the other's master device <b>120</b> and vice versa. Such an embodiment provides a mutual monitoring capability, for example, between spouses, where a mutual decision has been made to limit access to a text messaging capability to subscribed usage limits.</p>
<p id="p-0038" num="0037">In such a scenario, each of the two sets of modules <b>115</b>, <b>125</b> may be separately paired. Alternatively, they may share a common key if security between the users is not a concern.</p>
<p id="p-0039" num="0038">User-accessible features on the slave mobile device <b>110</b> are managed by the master device <b>120</b> through the respective slavemanager module <b>115</b> and the master manager module <b>125</b>. Such features <b>112</b> can comprise, for example, any user-accessible feature <b>112</b> incorporated or installed on the slave mobile device <b>110</b>, such as, cellular telephone functions, text messaging functions such as SMS or PIN messaging, e-mail functions, web browsers, games, multimedia applications including multimedia players or camera applications, social networking applications, calendars, address books, or GPS or mapping functions.</p>
<p id="p-0040" num="0039">The management of such user-accessible features <b>112</b> on the slave mobile device <b>110</b> may be controlled in some example embodiments by use of one or more processes <b>146</b> actuated and created by the slave manager module <b>115</b>.</p>
<p id="p-0041" num="0040">The slave mobile device <b>110</b> can be controlled by the master device <b>120</b> to prevent access by a user of the slave mobile device <b>110</b> to one or more features <b>112</b> according to certain criteria, such as for example, outside specified periods of time or dates, above a maximum usage limit, to communicate except other than to permitted third parties, to communicate with prohibited third parties, or any combination of one or more of the foregoing.</p>
<p id="p-0042" num="0041">Thus, for example, a slave mobile device <b>110</b> may be controlled by the slave manager module <b>115</b> under the command of a paired master manager module <b>125</b> to prevent the slave mobile device <b>110</b> sending or receiving text messages, answering the phone or placing phone calls, accessing the internet or using multimedia applications, games or social networking applications during the week between the hours of 9:00 am and 3:00 pm, that is, during school hours.</p>
<p id="p-0043" num="0042">Furthermore, a slave mobile device <b>110</b> may be controlled by the slave manager module <b>115</b> under the command of a paired master manager module <b>125</b> to prevent internet, text messaging, e-mail, cell phone usage or other fee-based services usage above given limits to limit excess use charges. As well, certain phone numbers (e.g. &#x201c;900&#x201d; or &#x201c;976&#x201d; pay per call services) or Internet sites could be forbidden, irrespective of when the attempted access occurred.</p>
<p id="p-0044" num="0043">In some example embodiments, some monitoring settings on the slave manager module <b>115</b> can cause a status report to be sent from the slave manager module <b>115</b> to the master manager module <b>125</b> in the event that limits are reached or forbidden access is attempted.</p>
<p id="p-0045" num="0044">By way of example, the master manager module <b>125</b> can command the slave manager module <b>115</b> through one or more control settings in the slave manager module <b>115</b> to selectively override usage limits, for example, to allow communications at any time by way of text message, e-mail or telephone to or from certain authorized persons, such as a 911 emergency call centre, parents, grandparents or siblings, or spouses, or employers, depending on the particular circumstances of use of the paired devices <b>110</b>, <b>120</b>. Methods of communication with authorized persons can be identified directly by device addressing data such as phone numbers, email addresses, SMS or PIN numbers, or the like, or by name through an address book to such addressing data, for example.</p>
<p id="p-0046" num="0045">Additionally, certain features <b>112</b> may be monitored only, including without limitation, any of the above-referenced controllable user features <b>112</b>.</p>
<p id="p-0047" num="0046">Monitoring of one or more user-accessible features <b>112</b> on the slave mobile device <b>110</b> may comprise a periodic or on-demand download of pertinent information relating to recent accesses via one or more messages sent along communications channel <b>132</b>, a current status or an immediate notification of certain prohibited or suspect activity in a message comprising a status report from the slave manager module <b>115</b> to the master manager module <b>125</b>.</p>
<p id="p-0048" num="0047">For example, as a safety measure for a user of the slave mobile device <b>110</b>, the slave manager module <b>115</b> could be configured to provide one or more messages comprising status reports on a periodic basis (for example, at the end of the week) providing call, e-mail or text message logs. Additionally, the contents of the contact list relationships for a social networking module or subscriber identification module (SIM) card of the slave mobile device <b>110</b> could be downloaded in one or more messages comprising a status report on a periodic basis.</p>
<p id="p-0049" num="0048">Thus, in the case of an abduction of a user of the slave mobile device <b>110</b>, such logs could be retrieved from the master manager module <b>125</b> and analyzed to understand the user's recent activities with a view to establishing clues to the user's potential whereabouts and the contacts of the user could be contacted if the user is missing.</p>
<p id="p-0050" num="0049">In the same vein, if a user of the slave mobile device <b>110</b> has disappeared and the slave mobile device <b>110</b> is equipped with a GPS receiver and mapping module, additional messages comprising status reports could be requested by a user of the master device <b>120</b> using the functionality of the master manager module <b>125</b> on an as-needed basis. For example, the slave manager module <b>115</b> could report the present whereabouts of the slave mobile device <b>110</b> by accessing its mapping module.</p>
<p id="p-0051" num="0050">The mapping module can be controlled by the slave manager module <b>115</b> under direction of the master manager module <b>125</b> to keep data regarding the location of the slave mobile device <b>110</b> for a rolling period of time, and to provide such data upon request in one or more messages comprising a status report. For example, such a message could report the location of the slave mobile device <b>110</b> the previous evening (including when it was returned home), or whether the slave mobile device <b>110</b> deviated from a predetermined path, for example, from school to home after school (useful in the case of a younger child, whether walking or travelling by bus).</p>
<p id="p-0052" num="0051">Additional capabilities for the system <b>100</b>, the slave mobile device <b>110</b>, and the master device <b>120</b> are possible. Furthermore, as more and varied user-accessible features <b>112</b> become available and more prevalent on slave mobile devices <b>110</b>, the system <b>100</b> may be configured to manage (through monitoring or controlling, or both) such additional user-accessible features <b>112</b> to provide a richer and more varied capability set.</p>
<p id="p-0053" num="0052">The master manager module <b>125</b> provides suitable user interface screens to display management options to a user of the master device <b>120</b> and the user-selection of such options by a user of the master device <b>120</b>.</p>
<p id="h-0005" num="0000">Master Manager Module Processing</p>
<p id="p-0054" num="0053">Turning now to <figref idref="DRAWINGS">FIG. 2</figref>, there is shown a flow chart showing example processing actions for the general operation of a master manager module, such as the master manager module <b>125</b> of <figref idref="DRAWINGS">FIG. 1</figref> operating on a master device, such as the master device <b>120</b> of <figref idref="DRAWINGS">FIG. 1</figref> as part of the management of a slave mobile device, such as slave mobile device <b>110</b> of <figref idref="DRAWINGS">FIG. 1</figref>. The operation of the master manager module <b>125</b> is not limited to the shown processing actions, nor are the shown processing actions limited to operation on the master device <b>120</b>.</p>
<p id="p-0055" num="0054">The master manager module <b>125</b> is initially paired (action <b>205</b>) for secure communication of messages with the slave manager module <b>115</b> of <figref idref="DRAWINGS">FIG. 1</figref> by the input of one or more encryption keys into the master device <b>120</b> and the slave device <b>110</b> as discussed in relation to <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0056" num="0055">Thereafter, the master manager module <b>125</b> waits (action <b>240</b>) for an input to process, which may be either a user input at the master manager module <b>125</b> or a response from the slave manager module <b>115</b>. Such user inputs are understood to be in relation to the master manager module <b>125</b> if the user interface screen of the master manager module <b>125</b> is the currently active window on the display of the master device <b>120</b> and user inputs are understood to be in relation to the user interface screen. Such responses from the slave manager module <b>115</b> are recognized by one or more listeners <b>142</b>, which detect the receipt of a response from the slave manager module <b>115</b>.</p>
<p id="p-0057" num="0056">In one example embodiment, the processing flow first determines whether the input was a user input (action <b>245</b>) and if this is not the case, processes the input as a response (path <b>247</b>). In some example embodiments (not shown), the processing flow determines whether the input was a response and if this is not the case, processes the input as a user input. In other example embodiments, the determination of whether the input was a user input and of whether the input was a response may be performed effectively simultaneously.</p>
<p id="p-0058" num="0057">If the input is a user input (path <b>246</b>), then the master manager module <b>125</b> determines (action <b>250</b>) if the user input is indicative of a request to change the configuration of the slave mobile device <b>110</b> or else to retrieve the logs(s) or status report(s) of the slave mobile device <b>110</b>. Such log(s) or status report(s) are derived from one or more responses previously communicated by the slave manager module <b>115</b> to the master manager module <b>125</b> and stored by the master manager module <b>125</b> or the master device <b>120</b>, for example, in memory.</p>
<p id="p-0059" num="0058">If the user input is indicative of a request to change the configuration of the slave mobile device <b>110</b> (path <b>251</b>), the master manager module <b>125</b> generates (action <b>255</b>) a request that the configuration of the slave mobile device <b>110</b> be altered in accordance with the user input, encrypts the request (action <b>260</b>) and transmits the request (action <b>265</b>) to the slave manager module <b>115</b> of the slave mobile device <b>110</b>. Thereafter, the master manager module <b>125</b> updates a user interface screen displaying a configuration of the slave mobile device <b>110</b>, with the requested configuration change marked or highlighted to indicate that the configuration selection has not been confirmed (action <b>270</b>). Thereafter, the loop processing resumes by waiting (action <b>240</b>).</p>
<p id="p-0060" num="0059">If the user input is indicative of a request to retrieve the log(s) or status report(s) of the slave mobile device <b>110</b> (path <b>252</b>), the master manager module <b>125</b> retrieves this information (action <b>275</b>). The retrieved log or status report information is output through one or more ports of the master device <b>120</b>, displayed on one of the displays associated with the master device <b>120</b>, or by any other suitable mechanism. Thereafter, the loop processing resumes waiting (action <b>240</b>).</p>
<p id="p-0061" num="0060">If the input is a response from the slave manager module <b>115</b> (path <b>247</b>), then the response is decrypted (action <b>280</b>). Thereafter, the response may be interpreted (action <b>285</b>) to see if it contains a confirmation that a configuration change requested by the master manager module <b>125</b> to the slave manager module <b>115</b> (action <b>265</b>) has been given effect by the slave manager module <b>115</b>, or a status report.</p>
<p id="p-0062" num="0061">If the response is a confirmation (path <b>286</b>), then the master manager module <b>125</b> updates (action <b>290</b>) the user interface screen displaying the configuration of the slave mobile device <b>110</b>, with the requested change marked or highlighted to indicate that the configuration selection has been confirmed. Thereafter, the loop processing resumes waiting (action <b>240</b>).</p>
<p id="p-0063" num="0062">If the response is a status report (path <b>287</b>), then the master manager module <b>125</b> can update (action <b>295</b>) the log or status information stored by the master device <b>120</b> corresponding to the status of the slave mobile device <b>110</b> as indicated by the status report. For some reports the master manager module <b>125</b> can be configured to present an alert by way of a user interface display a voice message, or both, in combination with one or more visual, audible, or tactile alerts. For other reports, log or status information are simply stored by the master device <b>120</b> for later retrieval and/or display (action <b>275</b>). After updating the logor status information, the loop processing resumes waiting (action <b>240</b>).</p>
<p id="p-0064" num="0063">In some embodiments (not shown) the step of retrieving information (<b>275</b>) from slave mobile device <b>110</b> may comprise generating a request, encrypting a request, and transmitting a request (similar to steps <b>255</b>, <b>260</b> and <b>265</b>).</p>
<p id="h-0006" num="0000">Slave Manager Module Processing</p>
<p id="p-0065" num="0064">Turning now to <figref idref="DRAWINGS">FIG. 3</figref>, there is shown a flow chart showing example processing actions for the general operation of a slave manager module, such as the slave manager module <b>115</b> of <figref idref="DRAWINGS">FIG. 1</figref>. The operation of the slave manager module <b>115</b> is not limited to the shown processing actions, nor are the shown processing actions limited to operation on the slave mobile device <b>110</b>.</p>
<p id="p-0066" num="0065">The slave manager module <b>115</b> is initially paired (action <b>305</b>) for secure communication of messages with the master manager module <b>125</b> according to one of the embodiments described in relation to <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0067" num="0066">Thereafter, the slave manager module <b>115</b> waits (action <b>335</b>) for an input to process, signaled by one or more of the event listeners <b>144</b>. Event listener <b>144</b> is configured to signal an input upon the receipt of a request from the master manager module <b>125</b> and upon the occurrence of an event at mobile slave device <b>110</b>.</p>
<p id="p-0068" num="0067">In one example embodiment, the processing flow first determines whether the input signaled by event listener <b>144</b> is a request from the master manager module <b>125</b> (action <b>340</b>) and if this is not the case, the signaled event is processed as an event (action <b>370</b>). In some example embodiments (not shown) the processing flow first determines whether the input was an event and if this is not the case, processes the input as a request. In example embodiments, the determination of whether the input was a request and of whether the input was an event may be performed effectively simultaneously.</p>
<p id="p-0069" num="0068">If the input is a request (path <b>341</b>), then the slave manager module <b>115</b> decrypts the request (action <b>343</b>) and updates an internal configuration of the slave mobile device <b>110</b> maintained by the slave manager module <b>115</b> (action <b>345</b>) to reflect a requested configuration change embodied in the request. Thereafter, the slave manager module <b>115</b> activates (which may involve creating) one or more processes <b>146</b> (action <b>350</b>) to give effect to the request and as appropriate, creates one or more event listeners <b>144</b> to trigger upon the occurrence of a described event in the process(es) thus activated.</p>
<p id="p-0070" num="0069">For a first example, if the requested configuration change was to indicate that outgoing calls are thereafter to be prohibited during the week between the hours of 9:00 am and 3:00 pm, that is, during school hours, an event listener <b>144</b> could be created against a telephone module, to be triggered whenever an outgoing call is being attempted. If an outgoing call was thereafter initiated, the listener <b>144</b> is triggered (action <b>335</b>) and the event may be processed (action <b>370</b>) by the slave manager module <b>115</b>.</p>
<p id="p-0071" num="0070">For a second example, if the requested configuration change indicates that outgoing text messaging are thereafter to be limited to a maximum of 200 messages in a calendar month, an event listener could be created against an electronic messaging module, to be triggered whenever a text message is being attempted. Similarly, an event listener <b>144</b> could be created if the requested configuration change was to indicate that cell phone usage was therefore to be restricted to a maximum number of minutes per month to be triggered whenever a cell phone call is attempted.</p>
<p id="p-0072" num="0071">For a third example, if the requested configuration change indicates that the master device <b>120</b> is to be notified by a status report in the event that the location of the slave mobile device <b>110</b> varied by a specified distance from a pre-determined path at a certain time of day, for example, during the week starting at 3:00 pm, one or more event listeners could be created against a mapping module, to be triggered when the speed or direction of the slave mobile device <b>110</b> deviates beyond a threshold, when the position of the slave mobile device <b>110</b> deviates from the path by a pre-determined amount, or when the position of the slave mobile device <b>110</b> exceeds a geo-fence established about the destination or the path.</p>
<p id="p-0073" num="0072">For a fourth example, if the requested configuration change indicates that a status report containing certain log data or status information was to be periodically transmitted by the slave mobile device <b>110</b> to the master device <b>120</b>, an event listener could be created, to be triggered upon the expiry of the specified or pre-determined period.</p>
<p id="p-0074" num="0073">Further processes <b>146</b> or event listeners <b>144</b> can be utilized to listen for events and carry out additional processes, or both, according to other configurations that may be requested from time to time by the master management module <b>125</b> such as in response to user inputs at the master device <b>120</b>.</p>
<p id="p-0075" num="0074">Once the processes <b>141</b> or listeners <b>144</b> have been activated or created (action <b>350</b>), the slave manager module <b>115</b> generates a confirmation (action <b>355</b>), encrypts the confirmation (action <b>360</b>) and transmits the encrypted confirmation as a response (action <b>365</b>) to the master manager module <b>125</b> of the master device <b>120</b> for processing by the master manager module <b>125</b> as discussed above (action <b>290</b>). This confirmation signifies that the configuration request message received by the slave manager module <b>115</b> has been processed and the appropriate processes <b>146</b> and event listeners <b>144</b>, or both, have been seen activated or created.</p>
<p id="p-0076" num="0075">If the input is the occurrence of an event (path <b>347</b>), the slave manager module <b>115</b> performs (action <b>370</b>) processing associated with the event (usually through one or more activated or created process(es) <b>146</b> established at action <b>350</b>). Depending upon the context of the configuration scenario represented by the event, the slave manager module <b>115</b> may display (action <b>375</b>) information or a notification on a display (such as display <b>410</b> shown in <figref idref="DRAWINGS">FIG. 4</figref>) of the slave mobile device <b>110</b>, or may generate (action <b>380</b>) a status report message to advise the master manager module <b>125</b> of certain activity, or both.</p>
<p id="p-0077" num="0076">In the case of the first example discussed above, the slave manager module <b>115</b>, when triggered (action <b>370</b>) by an event listener <b>144</b> may activate or create a process <b>146</b> that would compare system time on the slave device <b>110</b> against the permitted hours. If the system time fell within the prohibited range, the process <b>146</b>, or in some example embodiments the slave management module <b>115</b> or both would not permit the call to be completed. For example, a telephone module (such as telephone module <b>543</b> shown in <figref idref="DRAWINGS">FIG. 5</figref>) could allow the installation of a hook or call back before the call is placed. Then, when the call is being requested, the telephone module <b>543</b> would first advise the slave manager module <b>115</b> of any pertinent details, such as the phone number, to request permission to place the call. If permission is denied by the slave manager module <b>115</b> this status could be returned to the telephone module <b>543</b> so that the denial of access could be reported in a standard message format to the user of the slave mobile device <b>110</b>.</p>
<p id="p-0078" num="0077">Alternatively or in addition, the slave manager module <b>115</b> could report this scenario to the user of the master device <b>120</b>. In such an instance, the slave manager module <b>115</b> may generate (action <b>380</b>) a status report to advise the master manager module <b>125</b> that an attempt to place a phone call within a prohibited time period had been made, encrypt (action <b>360</b>) the status report and transmit (action <b>365</b>) the encrypted status report as a response to the master manager module <b>125</b> of the master device <b>120</b> for processing as discussed above (action <b>295</b> of <figref idref="DRAWINGS">FIG. 2</figref>). As well or alternatively, a message could be displayed (action <b>375</b>) on a display <b>410</b> (<figref idref="DRAWINGS">FIG. 4</figref>) of the slave mobile device <b>110</b> advising that the attempted phone call had failed or that the master device <b>120</b> had been notified.</p>
<p id="p-0079" num="0078">If the system time fell outside the prohibited range, the phone call would be allowed to proceed in conventional fashion.</p>
<p id="p-0080" num="0079">In the case of the second example discussed above, the slave manager module <b>115</b>, when triggered (action <b>370</b>) by an event listener may activate or create a process <b>146</b> that could maintain an internal count of outgoing text messages for a given calendar month and upon being triggered would, attempt to increment this count. If the incremented internal count exceeds the maximum, the count is not incremented and the attempt to send the text message is stopped in a similar manner as described in connection with the first non-limiting example. As before, the slave manager module <b>115</b> can generate (action <b>380</b>) a status report to advise the master manager module <b>125</b> that the maximum number of text messages had been reached for that month, encrypt (action <b>360</b>) it and transmit the encrypted message to the master manager module <b>125</b> of the master device <b>120</b> for processing as discussed above. As well or alternatively, a message can be displayed (action <b>375</b>) on a display <b>410</b> (<figref idref="DRAWINGS">FIG. 4</figref>) of the slave mobile device <b>110</b>, advising that the attempt had failed and that the master device <b>120</b> had been notified.</p>
<p id="p-0081" num="0080">Alternatively, if the incremented internal count has not yet reached the threshold value, the outgoing text message is allowed to proceed in conventional fashion.</p>
<p id="p-0082" num="0081">In the case of the third example discussed above, the slave manager module <b>115</b>, when triggered (action <b>370</b>) by an event listener <b>144</b>, may activate or create a process <b>146</b> which would compare the location of the slave mobile device <b>110</b>, returned by the event listener <b>144</b>, against the path. If the location exceeds a pre-determined geo-fence or polygon about the path, the slave mobile device <b>110</b> deviates from the path beyond a threshold distance, or the slave mobile device <b>110</b> exceeds a predetermined geo-fence about the destination after a predetermined time period, the slave manager module <b>115</b> can generate (action <b>380</b>) a status report message to advise the master manager module <b>125</b> that the slave mobile device <b>110</b> had deviated unacceptably from its pre-determined path. The slave manager module <b>115</b> encrypts (action <b>360</b>) the status report and transmits (action <b>365</b>) the encrypted response to the master manager module <b>125</b> of the master device <b>120</b> as discussed above. As well or alternatively, a message could be displayed (action <b>370</b>) on a display <b>410</b> (see <figref idref="DRAWINGS">FIG. 4</figref>) of the slave mobile device <b>110</b> advising that the device was deviating unacceptably from its pre-determined path and that the master device <b>120</b> had been notified.</p>
<p id="p-0083" num="0082">In the case of the fourth example discussed above, the slave management module <b>115</b> when triggered (action <b>370</b>) by an event listener <b>144</b> may activate or create a process <b>146</b> that generates (action <b>380</b>) one or more status reports in one or more messages. Such status reports may contain desired log data or status information, for example, the time, length and phone number of all incoming or outgoing calls, the time of all incoming or outgoing e-mails or text messages and the part(ies) with whom the e-mails or text messages were communicated, any new entries in the address book of the slave mobile device <b>110</b>, or any new relationships created through one or more of the social networking sites subscribed by the social networking module. The slave management module <b>115</b> encrypts (action <b>360</b>) the status report and transmits (action <b>365</b>) the encrypted response to the master manager module <b>125</b> of the master device <b>120</b> as discussed above. As well or alternatively, a message can be displayed (action <b>375</b>) on a display <b>410</b> (<figref idref="DRAWINGS">FIG. 4</figref>) of the slave mobile device <b>110</b> advising that such data was being distributed.</p>
<p id="p-0084" num="0083">It will be appreciated that the nature of the processing performed, and the four examples set out above are by way of illustrative example only and not intended to be limiting in any fashion.</p>
<p id="p-0085" num="0084">It will also be appreciated that some of the event processing for a given requested configuration may be shared with other control configurations or that multiple event listeners <b>144</b> could be created, one or more for each associated control configuration.</p>
<p id="h-0007" num="0000">Example Mobile Device</p>
<p id="p-0086" num="0085">Referring now to <figref idref="DRAWINGS">FIG. 4</figref>, there is shown a graphical representation of a front view of an example of a mobile device <b>400</b> can serve as either or both of the slave mobile device <b>110</b> and the master device <b>120</b>. The mobile device <b>400</b> has two-way wireless electronic messaging capabilities and possibly also wireless voice communications capabilities. The mobile device <b>400</b>, in various embodiments the mobile device <b>400</b> can be, for example, a wireless handset. A mobile device configured as a wireless handset can be further configured as either a data communications device, a multiple-mode communications device configured for both data and voice communication, a mobile telephone, a pager, a personal digital assistant (PDA) enabled for wireless communications, a personal entertainment device enabled for wireless communications. The mobile device <b>400</b> can be, for example, a telecommunications device installed within a vehicle, a portable or laptop or notebook or tablet computer with a wireless modem or wireless network card.</p>
<p id="p-0087" num="0086">The mobile device <b>400</b> includes a display screen <b>410</b>, an alphanumeric keyboard or keypad <b>420</b>, optionally one or more non-keyboard inputs, such as buttons <b>421</b>-<b>428</b>, which may be navigational, function, exit or escape keys, which may be inwardly depressed to provide further input function, or touch-sensitive areas (not shown) within the display screen <b>410</b>, or a rotatable input device such as a trackball <b>430</b> or scrollwheel or trackwheel or trackpad (not shown) and a speaker <b>441</b>, visible indicator <b>442</b> or other alert <b>537</b> (shown on <figref idref="DRAWINGS">FIG. 5</figref>).</p>
<p id="p-0088" num="0087">The keyboard or keypad <b>420</b> may comprise a touch-sensitive surface (not shown). In some example embodiments keys in the keyboard <b>420</b> may contain one or more letters aligned in a QWERTY layout. In some example embodiments the keys in the keyboard <b>420</b> may not be actual physical keys but may be virtual keys displayed on a touch screen display (not shown). In some example embodiments, the keyboard <b>420</b> includes a QWERTZ layout, an AZERTY layout, a Dvorak layout, sequential type layouts or the like, or a traditional numeric keypad (not shown) with alphabetic letters associated with a telephone keypad. In some example embodiments, the keyboard <b>420</b> layout has reduced keys, such as a reduced QWERTY layout.</p>
<p id="p-0089" num="0088">Referring now to <figref idref="DRAWINGS">FIG. 5</figref>, the mobile device <b>400</b> includes a controller that includes at least one processor or digital signal processor (DSP) <b>510</b> for controlling the overall operation of the mobile device <b>400</b>. The processor <b>510</b> interacts with a communications subsystem shown generally at <b>520</b>, and with further device subsystems such as display <b>410</b>, which may include a touch-sensitive surface, keyboard or keypad <b>420</b>, one or more auxiliary input/output (I/O) subsystems or devices <b>533</b> (e.g. trackball <b>430</b>, non-keyboard inputs <b>421</b>-<b>428</b> or a scrollwheel, trackpad or trackwheel (not shown) and their associated controllers), one or more alerts <b>537</b> (which may be audible <b>441</b>, visible <b>442</b> and/or tactile (not shown)) or a headset port (not shown), a microphone <b>535</b>, a serial port <b>536</b>, which may be a universal serial bus (USB) port, a flash memory <b>540</b>, random access memory (RAM) <b>550</b>, a removable memory card <b>551</b>, a charge-coupled device (CCD) camera <b>580</b>, a global positioning system (GPS) (or other navigation) satellite receiver <b>560</b>, and any other device subsystems generally designated as <b>570</b>.</p>
<p id="p-0090" num="0089">The processor <b>510</b> operates under stored program control of the operating system software or firmware <b>541</b> and various software or firmware applications <b>549</b> used by the microprocessor <b>510</b>, which are, in one example embodiment, stored in a persistent store such as flash memory <b>540</b> or similar storage element. The operating system <b>541</b> software applications shown generally at <b>549</b>, or parts thereof, may be temporarily loaded into a volatile store such as RAM <b>550</b>.</p>
<p id="p-0091" num="0090">The processor <b>510</b> executes operating system software drivers <b>590</b> that provide a platform from which the rest of the software <b>541</b>, <b>549</b> operates. The operating system software drivers <b>590</b> provide drivers for the device hardware with standardized interfaces that are accessible to application software. The operating system software drivers <b>590</b> include application management services (&#x201c;AMS&#x201d;) (not shown) that transfer control between applications running on the mobile device <b>400</b>.</p>
<p id="p-0092" num="0091">The processor <b>510</b>, in addition to its operating system <b>541</b> functions, in example embodiments, enables execution of software applications <b>549</b> for interacting with the various device subsystems of the mobile device <b>400</b>, by presenting options for user-selection, controls for user-actuation, or cursors or other indicators for user-direction. The mobile device <b>400</b> may further accept user data entry, including numbers to dial or various parameter values for configuring the operation of the mobile device <b>400</b>.</p>
<p id="p-0093" num="0092">A predetermined set of software applications <b>549</b> may be executed in response to user commands to control basic device operations, including data and voice communication applications, such as a web browser module <b>542</b>, a telephone module <b>543</b>, an address book module <b>544</b>, an electronic messaging module <b>545</b> (which may include e-mail, SMS messaging or PIN messaging) and a calendar module <b>546</b>, for example, will normally be installed on the mobile device <b>400</b> during manufacture. Further software applications <b>548</b>, such as the master manager module <b>125</b>, the slave manager module <b>115</b>, a mapping module <b>547</b>, a game (not shown), a media player (not shown), a camera (not shown), one or more Java applications (not shown), and in some example embodiments, the master manager module <b>125</b> may also be loaded onto the mobile device <b>400</b> during manufacture, or through wired or wireless communications along the communications subsystem <b>520</b>, the auxiliary I/O subsystem <b>533</b>, serial port <b>536</b>, information carrier media such as portable data storage media like the removable memory card <b>551</b>, or any other suitable subsystem <b>570</b>, and installed in the RAM <b>550</b> or a non-volatile store such as the flash memory <b>540</b> for execution by the processor <b>510</b>. These applications may configure the mobile device <b>400</b> to perform various functions in response to user interaction. Such flexibility in application installation increases the functionality of the mobile device <b>400</b> and may provide enhanced on-device functions, communication-related functions, or both. In some embodiments, some or part of the functionality of the functional modules can be implemented through firmware or hardware components instead of, or in combination with, computer software instructions executed by the processor <b>510</b> (or other processors (not shown)).</p>
<p id="p-0094" num="0093">The various software applications <b>548</b>, <b>549</b> may constitute the user-accessible features <b>112</b> of the slave mobile device <b>110</b>, including various modules referred to previously in this description with respect to the slave mobile device <b>110</b>, such as browser module <b>542</b>, telephone module <b>543</b>, address book module <b>544</b>, electronic messaging module <b>545</b> (providing two-way electronic messaging capability <b>130</b>), calendar module <b>546</b>, mapping module <b>547</b>, game module, media player, and camera.</p>
<p id="p-0095" num="0094">Under instructions from various software applications <b>549</b> resident on the mobile device <b>400</b>, the processor <b>510</b> is configured to implement various functional components or modules, for interacting with the various device subsystems of the mobile device <b>400</b>. Additionally, the processor <b>510</b> may be configured or programmed over-the-air, for example from a wireless base station <b>610</b>, a wireless access point <b>621</b> (shown on <figref idref="DRAWINGS">FIG. 6</figref>), or a peer mobile device <b>400</b>, for example, in the case of the slave mobile device <b>110</b>, the master device <b>120</b> as disclosed herein, The software applications <b>549</b> may comprise a compiled set of machine-readable instructions that configure the processor <b>510</b> to provide the desired functionality, or the software applications <b>549</b> may be high-level software instructions to be processed by an interpreter or compiler to indirectly configure the processor <b>510</b>.</p>
<p id="p-0096" num="0095">An icon is shown highlighted or focused by a caret or selection symbol <b>460</b> which can be navigated by a device user among the displayed icons through manipulation of the trackball <b>430</b> (or other navigational input device). The trackball <b>430</b> is also depressible, such that depression of the trackball <b>430</b> when an icon is highlighted or focused by selection symbol <b>460</b> results in the launch of functions of the associated module.</p>
<p id="p-0097" num="0096">Each of the software applications <b>549</b> may include layout information defining the placement of particular fields, such as text fields, input fields, etc., in a user interface for the software application <b>549</b>.</p>
<p id="p-0098" num="0097">In <figref idref="DRAWINGS">FIG. 5</figref>, the communications subsystem <b>520</b> acts as an interface between the mobile device <b>400</b> and a communications environment <b>600</b> shown in <figref idref="DRAWINGS">FIG. 6</figref>. The particular configuration of the communications subsystem <b>520</b> will be dependent upon the communications network(s) in the communications environment <b>600</b> in which the mobile device <b>400</b> is intended to operate.</p>
<p id="p-0099" num="0098">In <figref idref="DRAWINGS">FIG. 6</figref>, the communications environment <b>600</b> is shown to include one or more mobile devices <b>400</b> (only one of which is shown in <figref idref="DRAWINGS">FIG. 6</figref>), a wireless Wide Area Network (WWAN) <b>610</b> and associated base station <b>611</b>, a Wireless Local Area Network (WLAN) <b>620</b>, or other interfaces. In some example embodiments, the mobile device <b>400</b> is configured to communicate in both data and voice modes over both WWAN <b>610</b> and WLAN <b>620</b> networks and to roam between such networks.</p>
<p id="p-0100" num="0099">Thus, in the example embodiment shown in <figref idref="DRAWINGS">FIG. 5</figref>, the communications subsystem <b>520</b> includes a WWAN communications module <b>521</b>, a WLAN communications module <b>522</b> and a short range communications module <b>523</b>.</p>
<p id="p-0101" num="0100">The WWAN communications module <b>521</b> provides two-way communications with the WWAN <b>610</b> and the WLAN communications module <b>522</b> provides two-way communications with the WLAN <b>620</b> along an access point <b>621</b> associated therewith.</p>
<p id="p-0102" num="0101">The processor <b>510</b> may communicate with a wireless network via the analog baseband processing unit. In some embodiments, the communication may provide Internet connectivity, enabling a user to gain access to content on the Internet and to send and receive e-mail or text messages, such as the messages exchanged between the slave manager module <b>115</b> on the slave mobile device <b>110</b> and the master manager module <b>125</b> on the master device <b>120</b>. The flash memory <b>540</b>, RAM <b>550</b> and the removable memory card <b>551</b> may provide software and data to configure the operation of the processor <b>510</b>. Among the interfaces may be the serial port <b>536</b> and the short range wireless communication sub-system <b>523</b>. The serial port <b>536</b> may be used to charge the mobile device <b>400</b> and may also enable the mobile device <b>400</b> to function as a peripheral device to exchange information with a personal computer or other computer system. The short range wireless communication sub-system <b>523</b> may include an infrared port, a Bluetooth interface, an IEEE 802.11 compliant wireless interface, or any other short range wireless communication sub-system, which may enable the mobile device <b>400</b> to communicate wirelessly with other nearby mobile devices or wireless base stations (not shown).</p>
<p id="p-0103" num="0102">In a data communications mode, a received signal such as a text message or web page download will be processed by the communications subsystem <b>520</b> and output to the processor <b>510</b>, which further processes the received signal for output to the display <b>410</b>, or alternatively to an auxiliary I/O device <b>533</b>.</p>
<p id="p-0104" num="0103">The flash memory <b>540</b> or other persistent storage of the mobile device <b>400</b> may house, in addition to software or firmware stored program instructions, certain information including address book information such as telephone numbers, email or instant text messaging addresses and PIN numbers. Such information may also be at least partially stored at least some of the time in memory of a Subscriber Identity Module (SIM) card (not shown) used with the mobile device <b>400</b>, in volatile device memory (such as the RAM <b>450</b>), or at a location accessible to the mobile device <b>400</b> over WWAN <b>610</b>. Additionally, the flash memory <b>540</b> may be used to store data structures, preferences or parameters, including without limitation, requests and status information.</p>
<p id="p-0105" num="0104">The RAM <b>550</b>, which may constitute non-volatile or volatile memory, with or without battery backup, may be used as a supplement to, or in place of, flash memory <b>540</b>, and to maintain data or program instructions for use by the processor <b>510</b> in executing one or more of the functions of operating system <b>541</b> or the software applications <b>549</b>.</p>
<p id="h-0008" num="0000">Example Communications Environment</p>
<p id="p-0106" num="0105">Turning now to <figref idref="DRAWINGS">FIG. 6</figref>, the WWAN <b>610</b> may be implemented as a packet-based cellular network that includes a number of base stations <b>611</b> (only one of which is shown), where each of the base stations <b>611</b> provides wireless Radio Frequency (RF) coverage to a corresponding area or cell. The WWAN <b>610</b> is typically operated by a cellular network service provider that sells subscription packages to users of mobile electronic devices. The WWAN <b>610</b> comprises a number of different types of networks, for example, Mobitex Radio Network, DataTAC, GSM (Global System for Mobile Communication), GPRS (General Packet Radio System), TDMA (Time Division Multiple Access), CDMA (Code Division Multiple Access), CDPD (Cellular Digital Packet Data), IDEN (Integrated Digital Enhanced Network) or various other networks such as EDGE (Enhanced Data rates for GSM Evolution) or UMTS (Universal Mobile Telecommunications Systems).</p>
<p id="p-0107" num="0106">The communications environment <b>600</b> also includes a wireless network gateway <b>612</b> and one or more network provider systems <b>640</b>. The wireless network gateway <b>612</b> provides translation and routing services between the network provider system(s) <b>640</b> and the WWAN <b>610</b>, which facilitates communication between the mobile device <b>400</b> and other devices (not shown) connected, directly or indirectly, to the network provider system <b>640</b>.</p>
<p id="p-0108" num="0107">The WLAN <b>620</b> comprises a network which, in some example embodiments, conforms to IEEE 802.11 standards such as 802.11b or 802.11g; however, other communications protocols may also be used for the WLAN <b>620</b>. The WLAN <b>620</b> includes one or more wireless RF Access Points (AP) <b>621</b> (one of which is shown), that collectively provide a WLAN coverage area. The WLAN <b>620</b> may be operated by an enterprise (for example, a business or university) and the access points <b>621</b> are connected to an access point (AP) interface <b>622</b>. The AP interface <b>622</b> provides translation and routing services between the access points <b>621</b> and the network provider system <b>640</b> to facilitate communication between the mobile device <b>400</b> and other devices (not shown) connected directly or indirectly, to the network provider system <b>640</b>. The AP interface <b>622</b> is implemented using a computer, for example, a server running a suitable computer program or software.</p>
<p id="p-0109" num="0108">According to one embodiment, other interfaces may be implemented using a physical interface <b>630</b>. The physical interface <b>630</b> may include an Ethernet, Universal Serial Bus (USB), Firewire or infrared (IR) connection implemented to exchange information between the network provider system <b>640</b> and the mobile device <b>400</b> when physically connected therewith.</p>
<p id="p-0110" num="0109">The network provider system <b>640</b> comprises a server which is located behind a firewall (not shown). The network provider system <b>640</b> provides access for the mobile device <b>400</b>, through either the WWAN <b>610</b>, the WLAN <b>620</b>, or one of the physical interfaces <b>630</b> to the devices connected, for example, through an enterprise network <b>650</b> (e.g. an intranet), to the network provider system <b>640</b>, such as a network <b>650</b>, an email server <b>655</b>, one or more application/content servers <b>660</b>, a second WWAN <b>670</b> or an origin server <b>680</b>.</p>
<p id="p-0111" num="0110">According to one embodiment, a mobile data delivery module <b>645</b> provides HTTP connectivity between the WWAN <b>610</b> and the WLAN <b>620</b> and the other physical connections <b>630</b> and devices or networks connected directly or indirectly to the network provider system <b>640</b>. In one embodiment, the mobile data delivery module <b>645</b> is implemented on a computer, such as one housing the network provider system <b>640</b>. The network <b>650</b>, the email server <b>655</b>, the application/content server <b>660</b>, the second WWAN <b>670</b> and the origin server <b>680</b> are individually or collectively in various combinations, a content source for the network provider system <b>640</b>. It will be appreciated that the system shown in <figref idref="DRAWINGS">FIG. 6</figref> comprises one possible communications network or configuration for use with the mobile device <b>400</b>.</p>
<p id="p-0112" num="0111">The network <b>650</b> may comprise a local area network, an intranet, the Internet, a direct connection, or combinations thereof. According to one embodiment, the network <b>650</b> comprises an intranet for a corporation or other type of organization.</p>
<p id="p-0113" num="0112">In one example configuration, the email server <b>655</b> is connected to the network <b>650</b>. This server <b>655</b> is configured to direct or redirect email messages received over the second WWAN <b>670</b> and internally within the enterprise network <b>650</b> to be addressed to the mobile device <b>400</b>.</p>
<p id="p-0114" num="0113">The application/content server <b>660</b> may be connected to the network <b>650</b> and also to another network, for example, the second WWAN <b>670</b>.</p>
<p id="p-0115" num="0114">The second WWAN <b>670</b> may further connect to other networks. In one embodiment, the second WWAN <b>670</b> comprises or is configured with the Internet, a direct connection, a LAN, a wireless communication link, or any combination thereof.</p>
<p id="p-0116" num="0115">Content providers, such as the origin server <b>680</b>, or Web servers, may be connected to the second WWAN <b>670</b>.</p>
<p id="p-0117" num="0116">The communications environment <b>600</b> may also include a network of Global Positioning System (GPS) or other system of navigation satellites <b>690</b>.</p>
<p id="p-0118" num="0117">In the foregoing disclosure, for purposes of explanation and not limitation, specific details are set forth such as particular architectures, interfaces, techniques, etc. in order to provide a thorough understanding of the present disclosure. However, it will be apparent to those having ordinary skill in this art that the present disclosure may be practiced in other embodiments that depart from these specific details.</p>
<p id="p-0119" num="0118">In some instances, detailed descriptions of well-known devices, circuits, and methods are omitted so as not to obscure the description of the present disclosure with unnecessary detail. All statements herein reciting principles, aspects and embodiments of the disclosure, as well as specific examples thereof, are intended to encompass both structural and functional equivalents thereof. Additionally, it is intended that such equivalents include both currently known equivalents as well as equivalents developed in the future, i.e., any elements developed that perform the same function, regardless of structure.</p>
<p id="p-0120" num="0119">Thus, for example, it will be appreciated that block diagrams reproduced herein can represent conceptual views of illustrative components embodying the principles of the technology.</p>
<p id="p-0121" num="0120">Similarly, it will be appreciated that any flow charts, state transition diagrams, pseudocode, and the like represent various processes, which may be substantially represented in computer-readable medium and so executed by a computer or processor, whether or not such computer or processor is explicitly shown.</p>
<p id="p-0122" num="0121">The present disclosure can be implemented in digital electronic circuitry, or in computer hardware, firmware, software, or in combination thereof. Apparatus of the disclosure can be implemented in a computer program product tangibly embodied in a machine-readable storage device for execution by a programmable processor; and methods and actions can be performed by a programmable processor executing a program of instructions to perform functions of the disclosure by operating on input data and generating output.</p>
<p id="p-0123" num="0122">The functions of the various elements including functional blocks labelled as &#x201c;modules&#x201d;, &#x201c;processors&#x201d; or &#x201c;controllers&#x201d; may be provided through the use of dedicated hardware, as well as hardware capable of executing software in association with appropriate software with sufficient processing power, memory resources, and network throughput capability to handle the necessary workload placed upon it.</p>
<p id="p-0124" num="0123">When provided by a processor, the functions may be provided by a single dedicated processor, by a single shared processor, or by a plurality of individual processors, some of which may be shared or distributed. Moreover, explicit use of the term &#x201c;module&#x201d;, &#x201c;processor&#x201d; or &#x201c;controller&#x201d; should not be construed to refer exclusively to hardware capable of executing software, and may include, without limitation, digital signal processor (DSP) hardware, read-only memory (ROM) for storing software, random access memory (RAM) and non-volatile storage.</p>
<p id="p-0125" num="0124">The disclosure can be implemented advantageously on a programmable system including at least one input device, and at least one output device. Each computer program can be implemented in a high-level procedural or object-oriented programming language, or in assembly or machine language, if desired; and in any case, the language can be a compiled or interpreted language.</p>
<p id="p-0126" num="0125">Suitable processors include, by way of example, both general and specific microprocessors. Generally, a processor will receive instructions and data from a read-only memory or a random access memory. Generally, a computer will include one or more mass storage devices for storing data file; such devices include magnetic disks and cards, such as internal hard disks, and removable disks and cards; magneto-optical disks; and optical disks. Storage devices suitable for tangibly embodying computer program instructions and data include all forms of volatile and non-volatile memory, including by way of example semiconductor memory devices, such as EPROM, EEPROM, and flash memory devices; magnetic disks such as internal hard disks and removable disks; magneto-optical disks; CD-ROM and DVD-ROM disks; and buffer circuits such as latches or flip flops. Any of the foregoing can be supplemented by, or incorporated in ASICs (application-specific integrated circuits), FPGAs (field-programmable gate arrays) or DSPs (digital signal processors).</p>
<p id="p-0127" num="0126">Examples of such types of computer are programmable processing systems contained in the processor <b>510</b> and other DSPs (not shown) suitable for implementing or performing the apparatus or methods of the disclosure. The system may comprise a processor, (which may be referred to as a central processor unit or CPU), which may be implemented as one or more CPU chips, and that is in communication with memory devices including secondary storage, read only memory (ROM), a random access memory, a hard drive controller, or an input/output devices or controllers, and network connectivity devices, coupled by a processor bus.</p>
<p id="p-0128" num="0127">The secondary storage is typically comprised of one or more disk drives or tape drives and is used for non-volatile storage of data and as an over-flow data storage device if RAM is not large enough to hold all working data. Secondary storage may be used to store programs which are loaded into RAM when such programs are selected for execution. The ROM is used to store instructions and perhaps data which are read during program execution. ROM is a non-volatile memory device which typically has a small memory capacity relative to the larger memory capacity of secondary storage. The RAM is used to store volatile data and perhaps to store instructions. Access to both ROM and RAM is typically faster than to secondary storage.</p>
<p id="p-0129" num="0128">I/O devices may include printers, video monitors, liquid crystal displays (LCDs), touch screen displays, keyboards, keypads, switches, dials, mice, track balls, voice recognizers, card readers, paper tape readers, or other well-known input devices.</p>
<p id="p-0130" num="0129">The network connectivity devices may take the form of modems, modem banks, ethernet cards, universal serial bus (USB) interface cards, serial interfaces, token ring cards, fiber distributed data interface (FDDI) cards, wireless local area network (WLAN) cards, radio transceiver cards such as code division multiple access (CDMA) or global system for mobile communications (GSM) radio transceiver cards, and other well-known network devices. These network connectivity devices may enable the processor to communicate with an Internet or one or more intranets. With such a network connection, it is contemplated that the processor might receive information from the network, or might output information to the network in the course of performing the above-described method steps. Such information, which is often represented as a sequence of instructions to be executed using the processor, may be received from and outputted to the network, for example, in the form of a computer data signal embodied in a carrier wave. The network connectivity devices may also include one or more transmitter and receivers for wirelessly or otherwise transmitting and receiving signal as are well known.</p>
<p id="p-0131" num="0130">Such information, which may include data or instructions to be executed using the processor for example, may be received from and outputted to the network, for example, in the form of a computer data baseband signal or signal embodied in a carrier wave. The baseband signal or signal embodied in the carrier wave generated by the network connectivity devices may propagate in or on the surface of electrical conductors, in coaxial cables, in waveguides, in optical media, for example optical fiber, or in the air or free space. The information contained in the baseband signal or signal embedded in the carrier wave may be ordered according to different sequences, as may be desirable for either processing or generating the information or transmitting or receiving the information. The baseband signal or signal embedded in the carrier wave, or other types of signals currently used or hereafter developed, referred to herein as the transmission medium, may be generated according to several well known methods.</p>
<p id="p-0132" num="0131">The processor executes instructions, codes, computer programs, scripts which it accesses from hard disk, floppy disk, optical disk (these various disk based systems may all be considered secondary storage), ROM, RAM, or the network connectivity devices. Multiple processors may be present. Thus, while instructions may be discussed as executed by a processor, the instructions may be executed simultaneously, serially, or otherwise executed by one or multiple processors.</p>
<p id="p-0133" num="0132">It will be apparent that various modifications and variations may be made to the embodiments disclosed herein, consistent with the present disclosure, without departing from the spirit and scope of the present disclosure.</p>
<p id="p-0134" num="0133">While example embodiments are disclosed, this is not intended to be limiting. Rather, the general principles set forth herein are considered to be merely illustrative of the scope of the present disclosure and it is to be further understood that numerous changes covering alternatives, modifications and equivalents may be made without straying from the scope of the present disclosure, as defined by the appended claims.</p>
<p id="p-0135" num="0134">For example, the various elements or components may be combined or integrated in another system or certain features may be omitted, or not implemented. Also, techniques, systems, subsystems and methods described and illustrated in the various embodiments as discrete or separate may be combined or integrated with other systems, modules, techniques, or methods without departing from the scope of the present disclosure. Other examples of changes, substitutions, and alterations are easily ascertainable and could be made without departing from the spirit and scope disclosed herein.</p>
<p id="p-0136" num="0135">Further, the foregoing description of one or more specific embodiments does not limit the implementation of the invention to any particular computer programming language, operating system, system architecture or device architecture. Moreover, although some embodiments may include mobile devices, not all embodiments are limited to mobile devices; rather, various embodiments may be implemented within a variety of communications devices or terminals, including handheld devices, mobile telephones, personal digital assistants (PDAs), personal computers, audio-visual terminals, televisions and other devices.</p>
<p id="p-0137" num="0136">Also, the terms &#x201c;couple&#x201d; or &#x201c;communicate&#x201d; in any form are intended to mean either a direct connection or indirect connection through some interface, device, intermediate component or connection, whether electrically, mechanically, chemically, or otherwise.</p>
<p id="p-0138" num="0137">Moreover, all dimensions described herein are intended solely to be by way of example for purposes of illustrating certain embodiments and are not intended to limit the scope of the disclosure to any embodiments that may depart from such dimensions as may be specified.</p>
<p id="p-0139" num="0138">Directional terms such as &#x201c;upward&#x201d;, &#x201c;downward&#x201d;, &#x201c;left&#x201d; and &#x201c;right&#x201d; are used to refer to directions in the drawings to which reference is made unless otherwise stated. Similarly, words such as &#x201c;inward&#x201d; and &#x201c;outward&#x201d; are used to refer to directions toward and away from, respectively, the geometric center of a device, area or volume or designated parts thereof.</p>
<p id="p-0140" num="0139">References in the singular form include the plural and vice versa, unless otherwise noted.</p>
<p id="p-0141" num="0140">The terms &#x201c;including&#x201d; and &#x201c;comprising&#x201d; are used in an open-ended fashion, and thus should be interpreted to mean &#x201c;including, but not limited to&#x201d;. The terms &#x201c;example&#x201d; and &#x201c;exemplary&#x201d; are used simply to identify instances for illustrative purposes and should not be interpreted as limiting the scope of the invention to the stated instances. In particular, the term &#x201c;exemplary&#x201d; should not be interpreted to denote or confer any laudatory, beneficial or other quality to the expression with which it is used, whether in terms of design, performance or otherwise.</p>
<p id="p-0142" num="0141">Certain terms are used throughout to refer to particular components. Manufacturers may refer to a component by different names. It is not intended to distinguish between components that differ in name but not in function.</p>
<p id="p-0143" num="0142">The purpose of the Abstract is to enable the relevant patent office or the public generally, skill in the art who are not familiar with patent or legal terms or phraseology, to quickly determine from a cursory inspection the nature of the technical disclosure. The Abstract is neither intended to define the scope of this disclosure, which is measured by its claims, nor is it intended to be limiting as to the scope of this disclosure in any way.</p>
<p id="p-0144" num="0143">In accordance with a first broad aspect of an embodiment of the present disclosure there is provided a slave mobile device including a user-accessible feature, a two way electronic messaging capability, and a slave manager module adapted to decrypt an electronic message received through the electronic messaging capability, the electronic message containing a request, and to manage the user-accessible feature in accordance with the request.</p>
<p id="p-0145" num="0144">The user-accessible feature can be selected from a group consisting of: a telephone module, an electronic messaging module, a browser module, a game, a multimedia player, a camera, a social networking module, a calendar module, an address book module and a mapping module.</p>
<p id="p-0146" num="0145">The electronic messaging capability can be selected from a group consisting of: an e-mail function, an SMS messaging function and a PIN messaging function.</p>
<p id="p-0147" num="0146">The slave manager module can be adapted for managing the user-accessible feature by preventing user access to the feature according to at least one criterion. The at least one criterion can be selected from a group consisting of: date of use, time of day of use, number of times of use, originator and recipient.</p>
<p id="p-0148" num="0147">The user-accessible feature can be a communications feature and the slave manager module can be adapted to manage the user-accessible feature by controlling the slave device to prevent access to the user-accessible feature when usage limitations for the feature have been reached.</p>
<p id="p-0149" num="0148">The slave manager module can be further adapted to override usage limitations to permit the user-accessible feature to communicate with authorized persons.</p>
<p id="p-0150" num="0149">The slave mobile device can be a handset.</p>
<p id="p-0151" num="0150">The slave manager module can be adapted to pair with a master device to permit encrypted communication between the slave mobile device and the master device through the electronic messaging capability.</p>
<p id="p-0152" num="0151">The slave manager module can be adapted to pair with the master device utilizing a key exchange protocol to jointly establish a shared secret key over an insecure communications channel.</p>
<p id="p-0153" num="0152">In accordance with a second broad aspect of an embodiment of the present disclosure there is provided a master device including a two way electronic messaging capability, and a master manager module adapted to generate, encrypt, and transmit an electronic message to a paired slave mobile device, the message being transmitted through the electronic messaging capability and containing a request to manage a user-accessible feature of the slave mobile device in accordance with the request.</p>
<p id="p-0154" num="0153">In accordance with a third broad aspect of an embodiment of the present disclosure there is provided a method of managing a slave mobile device including decrypting an electronic message received through a two-way electronic messaging capability of the slave mobile device which message contains a request, and managing a user-accessible feature of the slave mobile device in accordance with the request.</p>
<p id="p-0155" num="0154">The user-accessible feature can be selected from a group consisting of a telephone module, an electronic messaging module, a browser module, a game, a multimedia player, a camera, a social networking module, a calendar module, an address book module and a mapping module.</p>
<p id="p-0156" num="0155">The electronic messaging capability can be selected from a group consisting of an e-mail function, an SMS messaging function and a PIN messaging function.</p>
<p id="p-0157" num="0156">The user-accessible feature can be managed by preventing user access to the feature according to at least one criterion.</p>
<p id="p-0158" num="0157">The at least one criterion can be selected from a group consisting of date of use, time of day of use, number of times of use, originator and recipient.</p>
<p id="p-0159" num="0158">The user-accessible feature can be a communications feature and a slave manager module manages the user-accessible feature by controlling the slave device to prevent access to the user-accessible feature when usage limitations for the feature have been reached.</p>
<p id="p-0160" num="0159">The method can further include overriding the usage limitations to permit the user-accessible feature to communicate with authorized persons.</p>
<p id="p-0161" num="0160">The slave mobile device can be a handset.</p>
<p id="p-0162" num="0161">The method can further include pairing the slave device with the master device to permit encrypted communication between the slave mobile device and the master device through the electronic messaging capability.</p>
<p id="p-0163" num="0162">In accordance with a fourth broad aspect of an embodiment of the present disclosure there is provided a system including the slave mobile device of the first broad aspect, and the master device of the second broad aspect.</p>
<p id="p-0164" num="0163">In accordance with a fifth broad aspect of an embodiment of the present disclosure there is provided a computer program product including a computer readable medium, and computer-readable instructions stored on the computer readable medium, which when operating on a processor of a slave mobile device cause the device to decrypt an electronic message received through a two-way electronic messaging capability of the slave mobile device which message contains a request, and to manage a user-accessible feature of the slave mobile device in accordance with the request.</p>
<p id="p-0165" num="0164">In accordance with a sixth broad aspect of an embodiment of the present disclosure there is provided a computer program product including a computer readable medium, and computer-readable instructions stored on the computer readable medium, which when operating on a processor of a master device cause the device to generate, encrypt, and transmit an electronic message to a paired slave mobile device, the message being transmitted through the messaging capability and containing a request to manage a user-accessible feature of the slave mobile device in accordance with the request.</p>
<p id="p-0166" num="0165">In accordance with a seventh broad aspect of an embodiment of the present disclosure there is provided a method including generating and encrypting on a master mobile device an electronic message containing a request to manage a user-accessible feature of a paired slave mobile device in accordance with the request, and transmitting the message to the paired slave mobile device through a two-way electronic messaging capability of the master mobile device.</p>
<p id="p-0167" num="0166">In accordance with an eighth broad aspect of an embodiment of the present disclosure there is provided a method of operating a mobile device management system, the method including generating and encrypting on a master device an electronic message containing a request to manage a user-accessible feature of a paired slave mobile device in accordance with the request, transmitting the message to the paired slave mobile device through a two-way electronic messaging capability of the master mobile device across an insecure communications channel secured by encrypting the message on the master device, and decrypting an electronic message received through a two-way electronic messaging capability of the slave mobile device which message contains a request received from a paired master device, and managing a user-accessible feature of the slave mobile device in accordance with the request.</p>
<p id="p-0168" num="0167">Other embodiments consistent with the present disclosure will be apparent from consideration of the specification and the practice of the disclosure disclosed herein.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A slave mobile device comprising:
<claim-text>a user-accessible communications feature;</claim-text>
<claim-text>a two way electronic messaging capability; and</claim-text>
<claim-text>a non-transitory computer-readable medium having computer-readable instructions stored thereon for execution by a processor, the instructions for implementing a slave manager module capable of:
<claim-text>decrypting at least one of an email, a Short Message Service (SMS) and a Personal Identification Number (PIN) message received through the electronic messaging capability from a paired master device using a secret shared by the slave mobile device and the paired master device, the message including a request,</claim-text>
<claim-text>managing the user-accessible communications feature in accordance with the request by preventing user access to the feature according to at least one criterion comprising reaching a maximum usage limitation, and</claim-text>
<claim-text>overriding the maximum usage limitation to permit the user-accessible communications feature to communicate with authorized persons.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The slave mobile device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the user-accessible communications feature is selected from a group consisting of: a telephone module, an electronic messaging module, a browser module, a game, and a social networking module.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The slave mobile device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the at least one criterion is selected from a group consisting of: number of times of use and number of minutes of use.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The slave mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the slave mobile device is a handset.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The slave mobile device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the slave manager module is capable of pairing with a master device to permit encrypted communication between the slave mobile device and the master device through the electronic messaging capability.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The slave mobile device of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the slave manager module is capable of pairing with the master device utilizing a key exchange protocol to jointly establish a shared secret key over an insecure communications channel.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A master device comprising:
<claim-text>a two way electronic messaging capability; and</claim-text>
<claim-text>a non-transitory computer-readable medium having computer-readable instructions stored thereon for execution by a processor, the instructions for implementing a master management module capable of generating, encrypting, and transmitting at least one of an email, Short Message Service (SMS) and Personal Identification Number (PIN) message to a paired slave mobile device, the message being transmitted through the electronic messaging capability and including a request to manage a user-accessible communications feature of the slave mobile device in accordance with the request by preventing user access to the feature according to at least one criterion comprising reaching a maximum usage limitation while permitting the usage limitation to be overridden to permit the user-accessible communications feature to communicate with authorized persons, and being encrypted using a secret shared by the master device and the paired slave device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A method of managing a slave mobile device comprising:
<claim-text>decrypting at least one of an email, Short Message Service (SMS) and a Personal Identification Number (PIN) message received through a two-way electronic messaging capability of the slave mobile device using a secret shared by the slave mobile device and the paired master device, the message including a request from a paired master device; and</claim-text>
<claim-text>managing a user-accessible communications feature of the slave mobile device in accordance with the request by preventing user access to the feature according to at least one criterion comprising reaching usage limitations and overriding the maximum usage limitation to permit the user-accessible communications feature to communicate with authorized persons.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the user-accessible communications feature is selected from a group consisting of: a telephone module, an electronic messaging module, a browser module, a game, and a social networking module.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the at least one criterion is selected from a group consisting of: number of times of use and number of minutes of use.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the slave mobile device is a handset. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353051-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353051</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11608970</doc-number>
<date>20061211</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2005-363353</doc-number>
<date>20051216</date>
</priority-claim>
<priority-claim sequence="02" kind="national">
<country>JP</country>
<doc-number>2006-324750</doc-number>
<date>20061130</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>1417</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 28</main-classification>
<further-classification>726 26</further-classification>
<further-classification>726 27</further-classification>
<further-classification>707999</further-classification>
<further-classification>358  114</further-classification>
<further-classification>358  115</further-classification>
<further-classification>709226</further-classification>
</classification-national>
<invention-title id="d2e90">Image forming apparatus, access control method, access control program and computer readable information recording medium</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6607139</doc-number>
<kind>B1</kind>
<name>Jui-Chang et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>235492</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2003/0101254</doc-number>
<kind>A1</kind>
<name>Sato</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709223</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2004/0199538</doc-number>
<kind>A1</kind>
<name>Matsuda et al.</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707102</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2005/0047812</doc-number>
<kind>A1</kind>
<name>Takemura</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>399 75</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0066069</doc-number>
<kind>A1</kind>
<name>Kaji</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2005/0234859</doc-number>
<kind>A1</kind>
<name>Ebata</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2005/0241001</doc-number>
<kind>A1</kind>
<name>Parry et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 27</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2006/0018223</doc-number>
<kind>A1</kind>
<name>Ji et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>369 4712</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2006/0290967</doc-number>
<kind>A1</kind>
<name>Sumitomo et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  114</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>07-297818</doc-number>
<kind>A</kind>
<date>19951100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>JP</country>
<doc-number>9-37011</doc-number>
<kind>A</kind>
<date>19970200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>JP</country>
<doc-number>11-191797</doc-number>
<date>19990700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>JP</country>
<doc-number>2002-222397</doc-number>
<kind>A</kind>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>JP</country>
<doc-number>2003-16176</doc-number>
<kind>A</kind>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>JP</country>
<doc-number>2003-44435</doc-number>
<kind>A</kind>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>JP</country>
<doc-number>2003-167641</doc-number>
<kind>A</kind>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>JP</country>
<doc-number>2004-252727</doc-number>
<kind>A</kind>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>JP</country>
<doc-number>2004-326603</doc-number>
<kind>A</kind>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>JP</country>
<doc-number>2005-182279</doc-number>
<kind>A</kind>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>JP</country>
<doc-number>2005-202770</doc-number>
<date>20050700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>JP</country>
<doc-number>2005-269619</doc-number>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>JP</country>
<doc-number>2005-300605</doc-number>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>JP</country>
<doc-number>2005-301500</doc-number>
<kind>A</kind>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>JP</country>
<doc-number>2006-148876</doc-number>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00025">
<othercit>Office Action issued Apr. 5, 2011 in Japanese Patent Application No. 2006-324750.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00026">
<othercit>Japanese Office Action mailed on Jul. 17, 2012, issued for JP Application No. 2011-123086.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00027">
<othercit>Japanese Office Action in Applications No. JP 2011-123086 dated Nov. 6, 2012.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>11</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 28</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 27</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  115</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  114</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>19</number-of-drawing-sheets>
<number-of-figures>20</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20070143861</doc-number>
<kind>A1</kind>
<date>20070621</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ohishi</last-name>
<first-name>Tsutomu</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Oblon, Spivak, McClelland, Maier &#x26; Neustadt, L.L.P.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Ricoh Company, Ltd.</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Arani</last-name>
<first-name>Taghi</first-name>
<department>2438</department>
</primary-examiner>
<assistant-examiner>
<last-name>Lee</last-name>
<first-name>Jason</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An image forming apparatus provided with an interface for a portable information recording medium, has an access control part carrying out access control, for respective ones of a plurality of resources which the image forming apparatus has, based on access control information defining whether or not usage thereof by a user is allowed, wherein the access control part carries out access control based on the access control information stored in the portable information recording medium.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="161.29mm" wi="266.28mm" file="US08353051-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="268.82mm" wi="173.74mm" orientation="landscape" file="US08353051-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="273.90mm" wi="140.55mm" orientation="landscape" file="US08353051-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="82.47mm" wi="175.60mm" file="US08353051-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="241.64mm" wi="168.83mm" orientation="landscape" file="US08353051-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="265.60mm" wi="171.53mm" orientation="landscape" file="US08353051-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="261.96mm" wi="126.32mm" file="US08353051-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="273.47mm" wi="180.68mm" file="US08353051-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="161.37mm" wi="102.95mm" file="US08353051-20130108-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="252.81mm" wi="175.43mm" orientation="landscape" file="US08353051-20130108-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="271.10mm" wi="177.72mm" file="US08353051-20130108-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="265.94mm" wi="169.93mm" orientation="landscape" file="US08353051-20130108-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="269.49mm" wi="180.34mm" file="US08353051-20130108-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="273.47mm" wi="180.42mm" file="US08353051-20130108-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="271.86mm" wi="181.36mm" file="US08353051-20130108-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="207.26mm" wi="131.49mm" orientation="landscape" file="US08353051-20130108-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="208.28mm" wi="135.47mm" orientation="landscape" file="US08353051-20130108-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="194.90mm" wi="149.94mm" file="US08353051-20130108-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="94.66mm" wi="91.44mm" file="US08353051-20130108-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="259.08mm" wi="153.50mm" file="US08353051-20130108-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to an image forming apparatus, an access control method, an access control program and a computer readable information recording medium and, in particular, to an image forming apparatus provided with an interface for a potable information recording medium, an access control method therefor, an access control program for causing a computer to execute the access control method, and a computer readable information recording medium storing the access control program.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">A recent image forming apparatus, such as a multi-function peripheral as a typical example, can execute various applications. For example, see Japanese Laid-Open Patent Application No. 2005-269619. Further, it becomes possible to store image data, obtained from scanning in copying operation, as a result of providing with a storage device having a large storage capacity such as a hard disk drive. In consideration that a plurality of users use an image forming apparatus in an office or such in a sharing manner, security for these resources such as the various applications, image data and so forth should be ensured appropriately. That is, in order to protect these resources from a bad faith user, it is necessary to control a usage right for each resource. Further, even for a good faith user, available functions should be limited in some case. For example, the cost required for color copying is higher than that for monochrome copying. Accordingly, if color copying is allowed for any users without limitations, such a situation may be problematic in consideration of cost control. Therefore, for example, depending on a post of each user or such, the usage right should be controlled.</p>
<p id="p-0006" num="0005">A function to achieve such a control of usage right is called an access control function, and, generally speaking, the function is achieved with the use of access control information such as an ACL (access control list), policy data, or such.</p>
<p id="p-0007" num="0006">In the related art, the access control information in an image forming apparatus is controlled in a unified manner in a server computer connected via a communication network, or, is controlled in each apparatus. The former way may be suitable for a large-scale user where hundreds of apparatuses are handled, while, the latter way may be suitable for a small-scale user where several apparatuses are handled, for example.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0008" num="0007">However, for a medium-scale user where tens of apparatuses are handled for example, any one of these ways may not be suitable. That is, the above-mentioned former way of introducing a server computer to control in a unified manner may be problematic in terms of cost performance in consideration of the costs required for actually introducing the server computer. On the other hand, in the latter way of controlling in each apparatus, the access control information should be maintained for each image forming apparatus, for each occasion of a personal change or such, which may cause a change in the access control information accordingly, and thus, a troublesome work may be required.</p>
<p id="p-0009" num="0008">The present invention has been devised in consideration of this problem, and an object of the present invention is to provide an image forming apparatus, an access control method, an access control program and a computer readable information recording medium, by which appropriate access control can be easily achieved.</p>
<p id="p-0010" num="0009">For the purpose of achieving the object, according to the present invention, an image forming apparatus provided with an interface for a portable information recording medium, has an access control part carrying out access control, for respective ones of a plurality of resources which the image forming apparatus has, based on access control information defining whether or not usage thereof by a user is allowed, wherein the access control part carries out the access control based on the access control information stored in the portable information recording medium.</p>
<p id="p-0011" num="0010">In this configuration, it is possible to easily carry out appropriate access control.</p>
<p id="p-0012" num="0011">Further, in order to achieve the above-mentioned object, the present invention may be realized in a form of an access control method executed in the above-mentioned image forming apparatus, an access control program for causing an image forming apparatus to execute the access control method, or a computer readable information recording medium storing the access control program.</p>
<p id="p-0013" num="0012">As a result, it is possible to provide an image forming apparatus, an access control method, an access control program and a computer readable information recording medium, by which appropriate access control can be easily carried out.</p>
<p id="p-0014" num="0013">Other objects and further features of the present invention will become more apparent from the following detailed description when read in conjunction with the accompanying drawings:</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> shows an example of a static configuration of a multi-function peripheral in one embodiment of the present invention for when software is executed;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref> shows an example of a hardware configuration of the multi-function peripheral in the embodiment of the present invention;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 3</figref> shows an operation panel;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 4</figref> shows an example of a static arrangement of software used in the multi-function peripheral in the embodiment of the present invention;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 5</figref> shows an example of definitions of policy data in the embodiment of the present invention;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 6</figref> shows a flow chart illustrating a processing procedure in a multi-function peripheral in a first embodiment of the present invention when the apparatus is started up;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 7</figref> shows a flow chart illustrating a processing procedure of the multi-function peripheral in the first embodiment of the present invention for when a standard application is used;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 8</figref> shows an example of a system for detecting insertion of a USB memory;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 9</figref> shows an example of a static arrangement of software used in a multi-function peripheral in a second embodiment of the present invention;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 10</figref> shows a flow chart illustrating a processing procedure for when an SDK application is used in the second embodiment;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 11</figref> shows an example of a static arrangement of software used in a multi-function peripheral in a third embodiment of the present invention;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 12</figref> shows a flow chart illustrating a processing procedure for when the multi-function peripheral in the third embodiment is started up;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 13</figref> shows a flow chart illustrating a processing procedure of the multi-function peripheral in the third embodiment for when a standard application is used in a case where a USB memory is not inserted when the apparatus is started up;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 14</figref> shows a flow chart illustrating a processing procedure of the multi-function peripheral in the third embodiment for when a standard application is used in a case where a USB memory is inserted when the apparatus is started up;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 15</figref> shows an example of a filter configuration of a copy application;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 16</figref> shows an example of a filter configuration of an ftp transfer application;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 17</figref> shows an example of policy data in an application level;</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 18</figref> shows an example of policy data in a filter level;</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 19</figref> shows an example of policy data in a hardware resource level; and</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 20</figref> shows a flow chart illustrating determining processing for a usable application in a fourth embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0035" num="0034">Embodiments of the present invention will now be described.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 1</figref> shows a configuration example of software in a multi-function peripheral in an embodiment of the present invention</p>
<p id="p-0037" num="0036">The multi-function peripheral <b>101</b> in the embodiment shown in <figref idref="DRAWINGS">FIG. 1</figref> includes various hardware <b>111</b> and various software <b>112</b>.</p>
<p id="p-0038" num="0037">The hardware <b>111</b> of the multi-function peripheral <b>101</b> includes an image pickup part <b>121</b>, a printing part <b>122</b>, and other hardware <b>123</b>. The image pickup part <b>121</b> reads an image (image data) from a reading original. The printing part <b>122</b> prints out image (image data) on a printing paper sheet.</p>
<p id="p-0039" num="0038">The software <b>112</b> of the multi-function peripheral <b>101</b> includes various applications <b>131</b> and various platforms <b>132</b>. These programs are executed in parallel by means of an OS (operating system) of UNIX (registered trademark) or such.</p>
<p id="p-0040" num="0039">The applications <b>131</b> include a copy application <b>141</b> for copying, a printer application <b>142</b> for printing, a scanner application <b>143</b> for scanning and a facsimile application <b>144</b> for facsimile. Further, a Web browser <b>146</b> for viewing a Web page, a Web server software <b>147</b> for delivering a Web page, an SDK application service (SAS) <b>148</b> for controlling an CSDK application <b>181</b> or a JSDK application <b>182</b>. However, these applications should not necessarily be installed in a ROM, a hard disk drive or such, of the multi-function peripheral <b>101</b>. That is, these applications may be read and started up from a computer readable information recording medium outside of the multi-function peripheral <b>101</b> when they are actually executed. In this view, the configuration example of <figref idref="DRAWINGS">FIG. 1</figref> does not necessarily show the applications which are not statically installed, but may be realized as a result of being expanded in the ROM when they are actually executed.</p>
<p id="p-0041" num="0040">The applications <b>131</b> include those developed and added by a user or a software vendor after the shipment of the multi-function peripheral <b>101</b>, with the use of a special SDK (software development kit) provided by the multi-function peripheral <b>101</b>. The applications <b>131</b> thus developed with the use of the special SDK is referred to as SDK applications. As the special SDK, CSDK for developing the application in C language, JSDK for developing the application in Java (registered trademark) language are provided. The applications <b>131</b> developed with the use of CSDK are referred to as CSDK applications, and the applications <b>131</b> developed with the use of JSDK are referred to as JSDK applications. The multi-function peripheral <b>101</b> includes the CSDK applications <b>181</b> and the JSDK applications <b>182</b>. Further the multi-function peripheral <b>101</b> includes a JSDK platform <b>183</b> as the software <b>112</b> acting as an agency between the JSDK applications described in Java (registered trademark) language, and other software described in C language.</p>
<p id="p-0042" num="0041">As the platforms <b>132</b>, various control services <b>151</b>, a system resource manager <b>152</b>, and various handlers <b>153</b>, are included. As the control services <b>151</b>, an operation panel control service (OCS) <b>161</b> and a certification control service (CCS) <b>162</b> are included. As the handlers <b>153</b>, a facsimile control unit handler (FCUH) <b>171</b> and an image memory handler (IMH) are included.</p>
<p id="p-0043" num="0042">A process of the OCS <b>161</b> carries out control concerning an operation panel. A process of the CCS <b>162</b> carries out control concerning authentication processing, access processing and fee charging processing. Other than these, although not shown, as the control services <b>151</b>, for example, a process for acting as an agency for network communication, a process providing an API for facsimile, a process carrying out stored document delivering processing, a process carrying out control concerning the image pickup part <b>121</b> and the printing part <b>122</b>, a process carrying out control concerning a memory or the hard disk drive, a process carrying out control concerning management of user information, a process carry out system management and so forth are also included.</p>
<p id="p-0044" num="0043">As the software acting as an agency between the applications <b>131</b> and the platform <b>132</b>, a virtual application service (VAS) <b>135</b> is included. The VAS <b>135</b> acts as a server process for the applications <b>131</b> acting as clients, and also, acts as a server process for the platforms <b>132</b> acting as client processes. The VAS <b>135</b> has a wrapping function for hiding the platforms <b>132</b> from the applications <b>132</b>, and acts to absorb a version difference caused by a version upgrade of the platforms <b>132</b>.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 2</figref> shows a configuration example of hardware of the multi-function peripheral <b>101</b> in the embodiment of the present invention.</p>
<p id="p-0046" num="0045">The hardware <b>111</b> of the multi-function peripheral <b>101</b> includes a CPU <b>211</b>, an SD memory card slot <b>234</b>, a USB device <b>242</b>, a ROM <b>231</b><i>a</i>, a RAM <b>231</b><i>b</i>, an NVRAM <b>231</b><i>c</i>, the HDD <b>233</b>, a NIC (network interface controller) <b>241</b>, the operation panel <b>202</b>, the image pickup part <b>121</b> and the printing part <b>122</b>.</p>
<p id="p-0047" num="0046">The CPU <b>211</b> is an IC for various information processing. The SD memory card slot <b>234</b> is a slot for inserting an SD memory card <b>235</b>. The USB device <b>242</b> is a device providing a connection terminal in a USB standard for connecting a USB memory <b>2422</b>. The HDD <b>233</b> is storage of the multi-function peripheral <b>101</b>. The NIC <b>2431</b> is a controller for network communication with the use of MAC addresses. The operation panel <b>202</b> is hardware (operating part) for inputting in the multi-function peripheral <b>101</b> from an operator, and also, is hardware (display part) for outputting information from the multi-function peripheral <b>101</b> to the operator.</p>
<p id="p-0048" num="0047">As shown in <figref idref="DRAWINGS">FIG. 3</figref>, the operation panel <b>202</b> includes a touch panel <b>311</b>, a ten key <b>312</b>, a start button <b>313</b>, a reset button <b>314</b>, a function key <b>315</b> and an initial setting button <b>316</b>. The touch panel <b>311</b> is hardware (touch operating part) for inputting with touching operation, and also, is hardware (displaying part) for outputting with screen display. The ten key <b>312</b> is hardware for inputting numerals with key (button) operation. The start button <b>313</b> is hardware for starting operation with button operation. The reset button <b>314</b> is hardware for reset operation with button operation. The function key <b>315</b> is hardware for causing operating pages of the CSDK applications <b>181</b> or the JSDK applications <b>182</b> to be displayed with button operation. The initial setting button <b>316</b> is hardware for causing an initial setting page to be displayed with button operation.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 4</figref> shows a static arrangement of software used in a multi-function peripheral in a first embodiment of the present invention.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 4</figref> shows the arrangement example in a static state, i.e., a state in which execution is actually not made yet, of typical software in a hardware configuration, extracted from the hardware configuration shown in <figref idref="DRAWINGS">FIG. 2</figref>, relevant to description below,</p>
<p id="p-0051" num="0050">As shown in <figref idref="DRAWINGS">FIG. 4</figref>, in the first embodiment, the OS, various control services (CS) <b>151</b> (OCS <b>161</b>, CCS <b>162</b> and so forth) and the standard applications <b>140</b> are stored in the ROM <b>231</b><i>a</i>. The SDK applications <b>180</b> are stored in a SD memory card <b>235</b>. The policy data <b>501</b><i>a </i>is stored in a USB memory <b>2422</b>, which is one example of a portable information recording medium.</p>
<p id="p-0052" num="0051">The standard applications <b>140</b> mean applications other than the SDK applications, from among the applications <b>131</b>, and include the copy application <b>141</b>, the printer application <b>142</b>, the scanner application <b>143</b>, the facsimile application <b>144</b>, the network application <b>145</b>, the Web browser <b>146</b>, the Web server software and so forth.</p>
<p id="p-0053" num="0052">The policy data <b>501</b><i>a </i>is data defining access control information for various resources of the multi-function peripheral <b>101</b>, i.e., the software resources and the hardware resources. A definition format in the policy data <b>501</b><i>a </i>is not limited to a predetermined one, and, in each embodiment of the present invention (including those described below), one shown in <figref idref="DRAWINGS">FIG. 5</figref> is applied.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 5</figref> shows an example of definitions in the policy data in the embodiments of the present invention. In the policy data of <figref idref="DRAWINGS">FIG. 5</figref>, for the multi-function peripheral <b>101</b>, for each application provided to a user (the standard applications <b>140</b>, the SDK applications <b>180</b> and so forth), or each processing unit included in each application, the user's usage rights (i.e., execution right (x), reading right (r) and writing right (w)) are defined. &#x2018;Provided to the user&#x2019; means &#x2018;directly operated by the user&#x2019;.</p>
<p id="p-0055" num="0054">For example, a user <b>1</b> can execute (x) operation of the copy application <b>141</b> according to the first line of the policy data of <figref idref="DRAWINGS">FIG. 5</figref>. Also, the user <b>1</b> can cause image data to be read (r) from an original in color scanning, according to the fourth line. Further, according to the fifth line, the user <b>1</b> can cause image data to be written (w) on a printing paper sheet in color printing in copying.</p>
<p id="p-0056" num="0055">In <figref idref="DRAWINGS">FIG. 5</figref>, a reference numeral <b>2422</b>-<i>n </i>(n: <b>1</b> through <b>5</b>) represents each different USB memory <b>2422</b>. For example, a USB memory <b>2422</b>-<b>1</b> stores the policy data <b>501</b>-<b>1</b><i>a </i>of the user <b>1</b>. A USB memory <b>2422</b>-<b>2</b> stores the policy data <b>501</b>-<b>2</b><i>a </i>of a user <b>2</b>. In each of the other USB memories <b>2422</b>-<i>n</i>, the policy data <b>501</b>-<i>na </i>(n: <b>1</b> through <b>5</b>) for one user is stored.</p>
<p id="p-0057" num="0056">That is, the policy data, which was managed in a unified manner in the NVRAM <b>231</b><i>c</i>, HDD <b>233</b> or a server computer, connected via a communication network with the multi-function peripheral <b>101</b>, for example, in the related art, is stored in the USB memory <b>2422</b> which is a portable information recording medium for each user in the embodiment of the present invention. However, a part or all of the policy data <b>501</b> may also be stored in the NVRAM <b>213</b><i>c </i>in the embodiment of the present invention. By this view (i.e., the policy data <b>501</b> should not necessarily be stored in the NVRAM <b>231</b><i>c</i>), the policy data <b>501</b><i>b </i>in the NVRAM <b>231</b><i>c </i>is shown by a broken line.</p>
<p id="p-0058" num="0057">It is noted that, the definition contents may be or may not be duplicated between the policy data <b>501</b><i>a </i>and policy data <b>501</b><i>b</i>. That is, when the definitions for the users <b>1</b> through <b>9</b> are included in the policy data <b>501</b><i>a</i>, the definitions for users <b>10</b>, . . . , or those for users <b>5</b>, . . . , may be included in the policy data <b>501</b><i>b</i>. In the description below, the policy data is referred to as policy data <b>501</b>, when the policy data <b>501</b><i>a </i>and <b>501</b><i>b </i>are distinguished therebetween.</p>
<p id="p-0059" num="0058">Next, a processing procedure in the multi-function peripheral <b>101</b> in the first embodiment of the present invention will be described. <figref idref="DRAWINGS">FIG. 6</figref> shows a flow chart illustrating a processing procedure when the multi-function peripheral <b>101</b> in the first embodiment is started up.</p>
<p id="p-0060" num="0059">When a main power supply in the multi-function peripheral <b>101</b> is started by a user (Step S<b>101</b>), the CPU <b>211</b> starts up (Step S<b>102</b>). The CPU <b>211</b> reads a bootstrap from the ROM <b>231</b><i>a </i>(Step S<b>103</b>), recognizes a file system in the ROM <b>231</b><i>a</i>, and reads a boot sector (Step S<b>104</b>). Then, the CPU <b>211</b> loads a kernel of UNIX (registered trademark) OS, and starts up the UNIX system (Step S<b>105</b>). Then, a root process in the OS (corresponding to an init process) starts up a predetermined process as a child process (Step S<b>106</b>). For example, from the ROM <b>231</b><i>a</i>, various control services in the CS <b>151</b><i>b </i>are loaded and started up (Step S<b>107</b>).</p>
<p id="p-0061" num="0060">Then, the CCS <b>162</b> having the authentication function and the access control function in the CS <b>151</b>, occupies display control of the touch panel <b>311</b> of the operation panel <b>202</b>, and displays an authentication page on the touch panel <b>311</b> (Step S<b>108</b>). It is noted that the authentication page means a page for the user to input authentication information (for example, a user ID, a password and so forth).</p>
<p id="p-0062" num="0061">Then, the CPU <b>211</b> starts up the standard application <b>140</b> from the ROM <b>231</b><i>a </i>(Step S<b>109</b>). It is noted that, although the standard application <b>140</b> intends to display an initial page for operation of the standard application <b>140</b> on the touch panel <b>311</b>, the touch panel <b>311</b> is thus occupied by the CCS <b>162</b> as mentioned above, and thus, the multi-function peripheral <b>101</b> enters a standby state in a condition in which the authentication page is displayed. However, the authentication page is grayed out, the user thus cannot input the authentication information, and thus, the user cannot actually use the various resources of the multi-function peripheral <b>101</b>.</p>
<p id="p-0063" num="0062">Next, a processing procedure by the multi-function peripheral <b>101</b> when the user actually uses the standard application <b>140</b> of the multi-function peripheral <b>101</b> will be described. <figref idref="DRAWINGS">FIG. 7</figref> shows a flow chart illustrating the processing procedure by the multi-function peripheral <b>101</b> when the user uses the standard application <b>140</b> of the multi-function peripheral <b>101</b> in the first embodiment.</p>
<p id="p-0064" num="0063">When the user inserts (or connects) the USB memory <b>2422</b> storing the policy data <b>501</b><i>a</i>, into the USB device <b>242</b> of the multi-function peripheral <b>101</b> (Step S<b>151</b>), the CCS <b>162</b> detects the insertion (connection) of the USB memory <b>2422</b> (Step S<b>152</b>).</p>
<p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. 8</figref> shows an example of a system for detecting the insertion of the USB memory. As shown in <figref idref="DRAWINGS">FIG. 8</figref>, when the USB memory <b>2422</b> is inserted in the USB device (S<b>501</b>), this fact is notified of to an usbhd (i.e., a USB hardware daemon) <b>2424</b> by means of the USB driver <b>2423</b> in the OS. The usbhd <b>2424</b> is the daemon process, which carries out automatic mounting/unmounting of the USB memory, connection monitoring for the USB memory, starting up of the application stored in the USB memory or such, and operates in the same layer as that of the various control services.</p>
<p id="p-0066" num="0065">The usbhd <b>2424</b> notifies of the fact that the USB memory <b>2422</b> has been inserted, to a module which links to an umass library. Accordingly, in order that the CCS <b>162</b> receives the notification that the USB memory <b>2422</b> has been inserted, the CCS <b>162</b> should link to the umass library (Step S<b>503</b>). After that, the CCS <b>162</b> determines whether or not a preparation for actually accessing the USB memory <b>2422</b> via the USB driver <b>2423</b> has been completed (Step S<b>504</b>).</p>
<p id="p-0067" num="0066">When detecting the insertion of the USB memory <b>2422</b>, the CCS <b>162</b> cancels the graying out of the authentication page, and thus, allows input of the authentication information from the authentication page (Step S<b>153</b>). Then, when the user inputs the authentication information from the authentication page (Step S<b>154</b>), the CCS <b>162</b> carries out authentication based on the thus-input authentication information (Step S<b>155</b>).</p>
<p id="p-0068" num="0067">When the user is thus authenticated (Yes in Step S<b>155</b>), the CCS <b>162</b> obtains the policy data <b>501</b><i>a </i>from the thus-inserted USB memory <b>2422</b>, and expands it in the RAM <b>231</b><i>b </i>(Step S<b>156</b>). The CCS <b>162</b> also obtains the policy data <b>501</b><i>b </i>from the NVRAM <b>231</b><i>c </i>if any, and expands it in the RAM <b>231</b><i>b. </i></p>
<p id="p-0069" num="0068">Then, the CCS <b>162</b> determines for the standard application <b>140</b> operable by the user, based on the policy data <b>501</b> thus expanded in the RAM <b>231</b><i>b </i>in the above-described manner (Step S<b>157</b>). That is, for example, when the current user corresponds to the &#x2018;user <b>1</b>&#x2019;, based on the policy data <b>501</b>-<b>1</b><i>a </i>shown in <figref idref="DRAWINGS">FIG. 5</figref>, the user is allowed to operate the copy application <b>141</b> and the scanner application <b>143</b>. It is noted that, when the NVRAM <b>231</b><i>c </i>also stores the policy data <b>501</b><i>b </i>and also the definition contents in the policy data <b>501</b><i>b </i>and the definition contents in the policy data <b>501</b><i>a </i>of the USB memory <b>2422</b> have a duplicate part therebetween, the definition contents in the USB memory <b>2422</b> are given priority to be actually applied.</p>
<p id="p-0070" num="0069">Then, the standard application <b>140</b>, which is thus determined as being operable by the current user, displays the operating page of this standard application <b>140</b> on the touch panel <b>311</b> (Step S<b>158</b>). It is noted that, when the plurality of standard applications are determined as being operable by the current user, the actual order as to which one thereof should be first selected to display its operating page should be previously determined. Further, a provision may be made such that, in Step S<b>158</b>, instead of displaying the operating page for the specific application, a page for the user to actually select a specific application is first displayed, and the operating page of the thus-selected application is then displayed. Here, it is assumed that the copy application <b>141</b> displays the operating page of the copy application <b>141</b>, as one example.</p>
<p id="p-0071" num="0070">Then, it is assumed that, for example, the user sets an original on an ADF (automatic draft feeding device) of the multi-function peripheral <b>101</b>, and provides an instruction for a color copy function (i.e., scanning the original in color, storing the scanned image and also, outputting the same on a printing paper sheet) via the operation panel <b>202</b> (Step S<b>159</b>). In this case, first, the copy application <b>141</b> then determines whether or not the current user has the reading right (r) on image data in &#x2018;color scanning in copying&#x2019; (Step S<b>160</b>). In more detail, the copy application <b>141</b> inquires of the CCS <b>162</b> the right of the current user. The CCS <b>162</b> determines the existence/absence of the right, based on the policy data <b>501</b> expanded in the RAM <b>231</b><i>b</i>, and returns the determination result to the copy application <b>141</b>. For example, when the current user corresponds to the &#x2018;user <b>1</b>&#x2019;, this user has the right, and thus, it is determined in Step S<b>160</b> that the user has the right.</p>
<p id="p-0072" num="0071">When the user does not have the right (No in Step S<b>160</b>), the copy application <b>141</b> finishes the processing (Step S<b>166</b>). Thereby, the display of the touch panel <b>311</b> is returned to the operating page of the copy application <b>141</b>.</p>
<p id="p-0073" num="0072">On the other hand, when the user has the right (Yes in Step S<b>160</b>), the copy application <b>141</b> causes the image pickup part <b>121</b> to carry out the color scanning (Step S<b>161</b>).</p>
<p id="p-0074" num="0073">Then, the copy application <b>141</b> inquires of the CCS <b>162</b>, as in Step S<b>160</b>, to determine whether or not the current user has the image data writing right (w) in &#x2018;image storage in copying&#x2019; (Step S<b>162</b>). When the user has the right (Yes in Step S<b>162</b>), the copy application <b>141</b> stores the image data thus scanned from the original, in the USB memory <b>2422</b> (Step S<b>163</b>).</p>
<p id="p-0075" num="0074">In the related art, a place in which image data scanned in copying operation was the HDD <b>233</b> even for a temporary occasion. However, considering a case where a confidential document is copied, storing in the HDD <b>233</b> might be problematic in terms of security. That is, the multi-function peripheral <b>101</b> would be accessible by many users, and any person might easily refer the stored contents of the HDD <b>233</b> or even bring out the HDD <b>233</b> itself.</p>
<p id="p-0076" num="0075">Therefore, the copy application <b>141</b> in the multi-function peripheral <b>101</b> in the first embodiment of the present invention stores the image data in the USB memory <b>2422</b>. For example, by previously distributing the USB memories to respective users, image data scanned in copying operation by a first user is stored in his or her USB memory <b>2422</b>, and thus, it is possible to prevent another second user from referring to the image data without the first user's permission.</p>
<p id="p-0077" num="0076">When the current user does not have the image data writing right (w) in &#x2018;image storage in copying&#x2019; (No in Step S<b>162</b>), storage of the image data in the USB memory <b>2422</b> is not actually carried out.</p>
<p id="p-0078" num="0077">In Step S<b>164</b> after Step S<b>162</b> or S<b>163</b>, the copy application <b>141</b> inquires of the CCS <b>162</b>, the same as in Step S<b>160</b>, to determine whether or not the current user has the image data writing right (w) in &#x2018;color printing in copying&#x2019;.</p>
<p id="p-0079" num="0078">When the current user does not have the right (No in Step S<b>164</b>), the copy application <b>141</b> finishes the current processing (Step S<b>166</b>). Thereby, the display on the touch panel <b>311</b> is returned to the operating page of the copy application <b>141</b>. On the other hand, when the current user has the right (Yes in Step S<b>164</b>), the copy application <b>141</b> causes the printing part <b>122</b> to carry out color printing of the image data thus scanned, and finishes the processing (Step S<b>165</b>). Thereby, the display on the touch panel <b>311</b> is then returned to the operating page of the copy application <b>141</b>.</p>
<p id="p-0080" num="0079">It is noted that, when the USB memory <b>2422</b> is removed from the multi-function peripheral <b>101</b> in a mid way of the processing of <figref idref="DRAWINGS">FIG. 7</figref>, the CCS <b>162</b> is notified of this fact, and the subsequent processing is halted. In this case, the CCS <b>162</b> displays on the touch panel <b>311</b> the grayed out authentication page, the same as in the standby state entered after the starting up. That is, the USB memory <b>2422</b> should be inserted for actual utilization of the multi-function peripheral <b>101</b> to be allowed.</p>
<p id="p-0081" num="0080">As described above, in the multi-function peripheral <b>101</b> in the first embodiment, access control is carried out with the use of the policy data <b>501</b><i>a </i>stored in the USB memory <b>2422</b>. Accordingly, by distributing the USB memories to respective users who are allowed to use the multi-function peripheral <b>101</b>, it is not necessary to manage the policy data in a recording medium provided in the multi-function peripheral <b>101</b> or in a separate server computer connected to the multi-function peripheral <b>101</b> via a communication network. As a result, it is possible to eliminate a work to maintain the policy data in each multi-function peripheral <b>101</b>, or to eliminate the extra cost for introducing the separate server computer. Further, the access control information only for each user who actually has the USB memory <b>2422</b> is stored in the USB memory <b>2422</b>. Accordingly, it is possible to increase independence of the policy data <b>501</b><i>a </i>in the USB memory <b>2422</b> of each user, and thus, even if another user's access control information should be changed, it is not necessary to change the policy data <b>501</b><i>a </i>in the USB memories of the users other than this another user, and thus, it is possible to further simplify the maintenance work of the access control information.</p>
<p id="p-0082" num="0081">It is noted that, the USB memory <b>2422</b> may be distributed, not for each user but for each group of a plurality users. In this case, in the policy data <b>501</b><i>a </i>of the USB memory <b>2422</b>, the policy data for the group, or, the policy data for each user belonging to the group should be stored.</p>
<p id="p-0083" num="0082">Next, a second embodiment of the present invention will be described. <figref idref="DRAWINGS">FIG. 9</figref> shows a static arrangement example of software used in the multi-function peripheral in the second embodiment. In <figref idref="DRAWINGS">FIG. 9</figref>, the same reference numerals are given to parts, the same as those in the multi-function peripheral in the first embodiment shown in <figref idref="DRAWINGS">FIG. 4</figref>, and the duplicate description is omitted. What is different in <figref idref="DRAWINGS">FIG. 9</figref> from the first embodiment of <figref idref="DRAWINGS">FIG. 4</figref> is a place in which the SDK application <b>180</b> is stored. That is, in <figref idref="DRAWINGS">FIG. 9</figref>, the SDK application <b>180</b> is stored, not in the SD memory card <b>235</b> but in the USB memory <b>2422</b>.</p>
<p id="p-0084" num="0083">A processing procedure in the multi-function peripheral <b>101</b> in the second embodiment will now be described. Since the processing procedure for starting up of the multi-function peripheral <b>101</b> is the same as that of the first embodiment (<figref idref="DRAWINGS">FIG. 6</figref>), the duplicate description is omitted.</p>
<p id="p-0085" num="0084">For the second embodiment, a processing procedure of the multi-function peripheral <b>101</b> for when the user uses the SDK application <b>180</b> is described. <figref idref="DRAWINGS">FIG. 10</figref> shows a flow chart illustrating the processing procedure of the multi-function peripheral <b>101</b> in the second embodiment for when the user uses the SDK application <b>180</b>. The same step numbers are given to those, the same as those in <figref idref="DRAWINGS">FIG. 7</figref>, and the duplicate description is omitted for <figref idref="DRAWINGS">FIG. 10</figref>. That is, in <figref idref="DRAWINGS">FIG. 10</figref>, Step S<b>151</b> through Step S<b>158</b> are the same as those of the first embodiment.</p>
<p id="p-0086" num="0085">Step S<b>259</b> is carried out after Step S<b>158</b>, and, when the user operates the function key <b>315</b> on the operation panel <b>202</b>, to give an instruction to display the operating page of the SDK application <b>180</b>, the CCS <b>162</b> determines for the SDK application <b>180</b> operable by the current user, based on the policy data <b>501</b> (Step S<b>260</b>). It is noted that, although <figref idref="DRAWINGS">FIG. 5</figref> shows the definitions for the standard application <b>140</b>, definitions for the SDK application should also be previously stored in the policy data <b>501</b>.</p>
<p id="p-0087" num="0086">Then, the OCS <b>161</b> displays a page (for example, a page listing the SDK applications operable by the current user) on the touch panel <b>311</b>, for the user to operate the SDK applications, determined by the CCS <b>162</b> as being operable by the current user (Step S<b>261</b>). When the user provides an instruction to execute any one of the SDK applications <b>180</b> from the displayed page (Step S<b>262</b>), the usbhd <b>2424</b> loads the relevant SDK application <b>180</b> (Step S<b>263</b>), and starts up the same in a process (Step S<b>264</b>).</p>
<p id="p-0088" num="0087">As described above, in the multi-function peripheral <b>101</b> in the second embodiment, the SDK application <b>180</b> stored in the USB memory <b>2422</b> can be executed. Accordingly, by previously distributing the USB memories to the respective users, storing the respective corresponding policy data <b>501</b><i>a</i>, and the SDK applications the respective users allowed to use, it is possible to effectively avoid illicit execution of the SDK applications by spoof. That is, although a bad faith person steels the authentication information such as a password, this person cannot actually load the SDK application <b>180</b> unless obtaining the USB memory <b>2424</b> in which the SDK application <b>180</b> is stored.</p>
<p id="p-0089" num="0088">It is noted that, when the USB memory <b>2422</b> is distributed to each user or each user group, only the SDK applications <b>180</b> for which the user or the user group is allowed to use should preferably be stored in the USB memory <b>2422</b>, for the purpose to effectively prevent a user having no usage right from illicitly utilizing the SDK applications <b>180</b>. In this case, the CCS <b>162</b> may determine that usage of the SDK applications stored in the USB memory <b>2422</b> is allowed regardless of the definitions in the policy data <b>501</b>.</p>
<p id="p-0090" num="0089">Next, a third embodiment of the present invention will be described. <figref idref="DRAWINGS">FIG. 11</figref> shows a static arrangement example of software used in the multi-function peripheral in the third embodiment. In <figref idref="DRAWINGS">FIG. 11</figref>, the same reference numerals are given to those, the same as those in the multi-function peripheral in the second embodiment shown in <figref idref="DRAWINGS">FIG. 9</figref>, and duplicate description therefor is omitted. What is different in <figref idref="DRAWINGS">FIG. 11</figref> from the second embodiment of <figref idref="DRAWINGS">FIG. 9</figref> is a place in which the standard application <b>140</b> is stored. That is, in <figref idref="DRAWINGS">FIG. 11</figref>, the standard application <b>140</b> is stored, not in the ROM <b>231</b><i>a </i>but in the USB memory <b>2422</b>.</p>
<p id="p-0091" num="0090">A processing procedure in the multi-function peripheral <b>101</b> in the third embodiment will now be described. <figref idref="DRAWINGS">FIG. 12</figref> shows a flow chart illustrating a processing procedure of the multi-function peripheral <b>101</b> in the third embodiment when it is started up. In <figref idref="DRAWINGS">FIG. 12</figref>, the same step numbers are given to steps identical to those of <figref idref="DRAWINGS">FIG. 6</figref>, and the duplicate description is omitted.</p>
<p id="p-0092" num="0091">In Step S<b>308</b> subsequent to Step S<b>107</b>, the CCS <b>162</b> determines whether or not the USB memory <b>2422</b> has been already inserted in the USB device <b>242</b>, via the USB driver <b>2423</b>. This step is provided for a case where the user may previously insert the USB memory <b>2422</b> when the power supply in the multi-function peripheral <b>101</b> is started.</p>
<p id="p-0093" num="0092">When the USB memory <b>2422</b> has not been inserted yet (No in Step S<b>308</b>), the CCS <b>162</b> occupies the display control of the touch panel <b>311</b> of the operation panel <b>202</b>, and displays the authentication page in a grayed out manner on the touch panel <b>311</b> (Step S<b>312</b>). The multi-function peripheral <b>101</b> then enters a standby state.</p>
<p id="p-0094" num="0093">On the other hand, when the USB memory has been already inserted (Yes in Step S<b>308</b>), the CCS <b>162</b> occupies the display control of the touch panel <b>311</b> of the operation panel <b>202</b>, and displays the authentication page on the touch panel <b>311</b> in such a condition that input therefrom is allowed (Step S<b>309</b>). Then, the usbhd <b>2424</b> loads the standard application <b>140</b> from the USB memory <b>2422</b> (Step S<b>310</b>), and starts up the same in a process (Step S<b>311</b>). The multi-function peripheral <b>101</b> then enters a standby state.</p>
<p id="p-0095" num="0094">Next, a processing procedure of the multi-function peripheral <b>101</b> when the standard application <b>140</b> is used will be described. <figref idref="DRAWINGS">FIG. 13</figref> shows a flow chart illustrating a processing procedure for when the standard application <b>140</b> is used for a case where the USB memory <b>2422</b> is not inserted at a time of the starting up, in the third embodiment. That is, <figref idref="DRAWINGS">FIG. 13</figref> shows the processing procedure executed after the multi-function peripheral <b>101</b> has entered in the standby state in Step S<b>312</b> of <figref idref="DRAWINGS">FIG. 12</figref>, for actual utilization of the standard application <b>140</b>. It is noted that, in <figref idref="DRAWINGS">FIG. 13</figref>, the same step numbers are given to steps identical to those of <figref idref="DRAWINGS">FIG. 7</figref>, and the duplicate description is omitted.</p>
<p id="p-0096" num="0095">In <figref idref="DRAWINGS">FIG. 13</figref>, Step S<b>357</b>-<b>1</b> and Step S<b>357</b>-<b>2</b> are newly inserted between Steps S<b>157</b> and S<b>158</b>.</p>
<p id="p-0097" num="0096">That is, in Step S<b>357</b>-<b>1</b>, the usbhd <b>2424</b> loads, from the USB memory <b>242</b>, the standard application <b>140</b> operable by the current user, determined in Step S<b>157</b>, and starts up the thus-loaded standard application <b>140</b> in a process (Step S<b>357</b>-<b>2</b>). The other processing is the same as that of the first embodiment.</p>
<p id="p-0098" num="0097"><figref idref="DRAWINGS">FIG. 14</figref> shows a flow chart illustrating a processing procedure for when the standard application <b>140</b> is actually used for a case where the USB memory <b>2422</b> is inserted at a time of the starting up, in the third embodiment. That is, <figref idref="DRAWINGS">FIG. 14</figref> shows the processing procedure executed after the multi-function peripheral <b>101</b> has entered the standby state in Step S<b>311</b> of <figref idref="DRAWINGS">FIG. 12</figref>. It is noted that, in <figref idref="DRAWINGS">FIG. 14</figref>, the same step numbers are given to steps identical to those of <figref idref="DRAWINGS">FIG. 7</figref>, and the duplicate description is omitted.</p>
<p id="p-0099" num="0098">In the processing procedure of <figref idref="DRAWINGS">FIG. 14</figref>, Steps S<b>151</b> through S<b>153</b> are removed from the processing procedure of <figref idref="DRAWINGS">FIG. 7</figref>. That is, in <figref idref="DRAWINGS">FIG. 14</figref>, the USB memory <b>2422</b> has been already inserted at the time of the starting up of the multi-function peripheral <b>101</b>, and the authentication page has been displayed in such a condition that input therefrom is allowed. Further, the standard application <b>140</b>, loaded from the USB memory <b>2422</b>, has been already started up. Accordingly, when the user inputs the authentication information and then, the user is authenticated (Yes in Step S<b>155</b>), the standard application <b>140</b> (copy application <b>141</b>) can be actually executed in the same procedure as that of the first embodiment.</p>
<p id="p-0100" num="0099">As described above, in the multi-function peripheral <b>101</b> in the third embodiment, it is possible to execute the standard application <b>140</b> stored in the USB memory <b>2422</b>. Accordingly, by previously distributing the USB memories to the respective users, storing the respective corresponding policy data <b>501</b><i>a</i>, and the standard applications <b>140</b> the respective users allowed to use, it is possible to effectively avoid illicit execution of the standard applications <b>140</b> by spoof.</p>
<p id="p-0101" num="0100">Further, since the necessity of storing the standard applications in the ROM <b>231</b><i>a </i>is eliminated, it is possible to reduce the memory consumption of the ROM <b>231</b><i>a. </i></p>
<p id="p-0102" num="0101">It is noted that, when the USB memory <b>2422</b> is distributed to each user or each user group, only the standard applications <b>140</b> for which the user or the user group is allowed to use should preferably be stored in the USB memory <b>2422</b>, for the purpose of effectively preventing a user having no usage right from illicitly utilizing the standard applications <b>140</b>. In this case, the CCS <b>162</b> may determine that usage of the standard applications stored in the USB memory <b>2422</b> is allowed regardless of the definitions in the policy data <b>501</b>.</p>
<p id="p-0103" num="0102">Next, a fourth embodiment of the present invention will be described. For the fourth embodiment, access control for when the applications (the SDK applications, the standard applications, or such) operable in the multi-function peripheral <b>101</b>, are built by means of an architecture called &#x2018;pipe and filter&#x2019;, is discussed. The filter means a program acting as a part (function module) configuring the application. In the architecture called &#x2018;pipe and filter&#x2019;, the application is configured by connection of the filters. Further, a medium connection between the filters is referred to as a pipe. The pipe is a virtual transmission medium for inputting information, output from the first filter executed first, into the second filter to be executed subsequently. The pipe is realized by a memory space provided by a hard disk drive, a RAM, a USB memory or such.</p>
<p id="p-0104" num="0103"><figref idref="DRAWINGS">FIG. 15</figref> shows an example of a filter configuration of the copy application. In <figref idref="DRAWINGS">FIG. 15</figref>, the copy application <b>141</b> is configured by a connection between a scan filter <b>191</b> and a printing filter <b>192</b>. the scan filter <b>191</b> outputs image data, read from an original by means of the image pickup part <b>121</b>, into a pipe (for example, the USB memory <b>2422</b>). The printing filter <b>192</b> causes the printing part <b>122</b> to print out the image data when detecting the input of the image data to the pipe. Accordingly, a copy function is executed as a result of the operations of the scan filter <b>191</b> and the printing filter <b>192</b> being executed in sequence.</p>
<p id="p-0105" num="0104"><figref idref="DRAWINGS">FIG. 16</figref> shows an example of a filter configuration of the ftp transfer in scanning application. In <figref idref="DRAWINGS">FIG. 16</figref>, the ftp transfer in scanning application <b>1801</b> is configured by a connection between a scan filter <b>191</b> and an ftp transfer filter <b>193</b>. In <figref idref="DRAWINGS">FIG. 16</figref>, the same reference numerals are given to those, the same as those in <figref idref="DRAWINGS">FIG. 15</figref>. Accordingly, the scan filter <b>191</b> in <figref idref="DRAWINGS">FIG. 16</figref> is identical to that of <figref idref="DRAWINGS">FIG. 15</figref>. The ftp transfer filter <b>193</b> carries out ftp transfer with the use of the NIC <b>241</b> the image data when detecting the input of the image data to the pipe.</p>
<p id="p-0106" num="0105">When the application in the multi-function peripheral <b>101</b> is configured by the pipe and filter, the policy data <b>501</b> should define the usage rights in the application level, the usage rights in the filter level and the usage rights in the hardware resource level, respectively.</p>
<p id="p-0107" num="0106"><figref idref="DRAWINGS">FIG. 17</figref> shows an example of the policy data in the application level. In the policy data <b>501</b>L<b>1</b> of <figref idref="DRAWINGS">FIG. 17</figref>, allowance/inhibition for usage of each application, i.e., the copy application, the scanner application, the ftp transfer in scanning application, the mail transfer in scanning application and so forth, are defined. In the example of <figref idref="DRAWINGS">FIG. 17</figref>, the user <b>1</b> is allowed to use the copy application and the scanner application.</p>
<p id="p-0108" num="0107"><figref idref="DRAWINGS">FIG. 18</figref> shows an example of the policy data in the filter level. In the policy data <b>501</b>L<b>2</b> of <figref idref="DRAWINGS">FIG. 18</figref>, allowance/inhibition for usage of each filter, i.e., the scan filter, the printing filter, the ftp transfer filter, the mail transfer filter and so forth, are defined. In the example of <figref idref="DRAWINGS">FIG. 18</figref>, the user <b>1</b> is allowed to use the scan filter and the printing filter.</p>
<p id="p-0109" num="0108"><figref idref="DRAWINGS">FIG. 19</figref> shows an example of the policy data in the hardware resource level. In the policy data <b>501</b>L<b>3</b> of <figref idref="DRAWINGS">FIG. 19</figref>, allowance/inhibition for usage of each hardware resource, i.e., the image pickup part <b>121</b>, the printing part <b>122</b>, the HDD <b>233</b>, the NIC <b>241</b>, the USB memory <b>2422</b>, and so forth, are defined. In the example of <figref idref="DRAWINGS">FIG. 19</figref>, the user <b>1</b> is allowed to use the image pickup part <b>121</b>, the printing part <b>122</b> and the USB memory <b>2422</b>.</p>
<p id="p-0110" num="0109">In the fourth embodiment, the policy data <b>501</b>L<b>1</b>, <b>501</b>L<b>2</b> and <b>501</b>L<b>3</b> are stored in the USB memory <b>2422</b> for each user as the policy data <b>501</b><i>a. </i></p>
<p id="p-0111" num="0110"><figref idref="DRAWINGS">FIG. 20</figref> shows a flow chart illustrating processing for determining which application is allowed to be used, in the fourth embodiment. That is, <figref idref="DRAWINGS">FIG. 20</figref> illustrates processing for determining the operable standard applications in Step S<b>157</b> of <figref idref="DRAWINGS">FIG. 7</figref>, <b>10</b>, <b>14</b> or such, and processing for determining the operable SDK applications in Step S<b>260</b> of <figref idref="DRAWINGS">FIG. 10</figref>. Accordingly, in the processing of <figref idref="DRAWINGS">FIG. 20</figref>, it is assumed that, the policy data <b>501</b>L<b>1</b>, <b>501</b>L<b>2</b> and <b>501</b>L<b>3</b> have been already expanded in the RAM <b>231</b><i>b </i>from the USB memory <b>2422</b>.</p>
<p id="p-0112" num="0111">First, the CCS <b>162</b> determines, based on the policy data <b>501</b>L<b>1</b> expanded in the RAM <b>231</b><i>c</i>, whether or not the application, for which determination is made (referred to as a target application, hereinafter), is allowed to be used, in Step S<b>401</b>. When usage of the target application is allowed according to the policy data <b>501</b>L<b>1</b> (Yes in Step S<b>402</b>), the CCS <b>162</b> then determines, based on the policy data <b>501</b>L<b>2</b> also expanded in the RAM <b>231</b><i>c</i>, whether or not each filter included in the target application is allowed to be used, in Step S<b>403</b>. The determination for each filter included in the target application should be carried out based on information indicating usage relationship between the applications and the filters, previously stored in the HDD <b>233</b> or such.</p>
<p id="p-0113" num="0112">When usage of all the filters included in the target application is allowed according to the policy data <b>501</b>L<b>2</b> (Yes in Step S<b>404</b>), the CCS <b>162</b> then determines, based on the policy data <b>501</b>L<b>3</b> also expanded in the RAM <b>231</b><i>c</i>, whether or not each hardware resource used by each filter (i.e., used by the target application) is allowed to be used, in Step S<b>405</b>. The determination for each hardware resource used by each filter should be carried out based on information indicating usage relationship between the filters and the hardware resources, previously stored in the HDD <b>233</b> or such.</p>
<p id="p-0114" num="0113">When usage of all the hardware resources used by each filter is allowed according to the policy data <b>501</b>L<b>2</b> (Yes in Step S<b>406</b>), the CCS <b>162</b> determines that the target application is usable, that is, allows usage of the target application (Yes in Step S<b>407</b>).</p>
<p id="p-0115" num="0114">On the other hand, when usage of the target application is not allowed according to the policy data <b>501</b>L<b>1</b> (No in Step S<b>402</b>), when usage of at least one of the respective filters included in the target application is not allowed according to the policy data <b>501</b>L<b>2</b> (No in Step S<b>404</b>), or when usage of at least one of the respective hardware resources used by each filter included in the target application is not allowed according to the policy data <b>501</b>L<b>3</b> (No in Step S<b>406</b>), the CCS <b>162</b> determines that usage of the target application is not allowed, i.e., inhibits usage of the target application (No in Step S<b>408</b>).</p>
<p id="p-0116" num="0115">In the fourth embodiment described above, when a new application is created from a new combination of the existing filters, even if access control information for the new application is not defined in the policy data <b>501</b>L<b>1</b>, it is possible to carry out access control for the new application based on the policy data <b>501</b>L<b>2</b> in the filter level or the policy data <b>501</b>L<b>3</b> in the hardware resource level. Further, when a new filter is created and is installed in the multi-function peripheral <b>101</b>, if access control information for the new filter is not defined in the policy data <b>501</b>L<b>2</b>, it is possible to carry out access control for the new filter based on the policy data <b>501</b>L<b>3</b> in the hardware resource level.</p>
<p id="p-0117" num="0116">It is noted that, in the above-described embodiments, the access control information defines merely whether or not the usage (operation) is allowed. However, embodiments of the present invention are not limited thereto. For example, the access control information may define that, the usage is allowed when a predetermined condition is met. For example, the usage may be allowed when a predetermined charge has been paid, the usage may be allowed only during a predetermined time zone, or such.</p>
<p id="p-0118" num="0117">Further, although, in the embodiments, the USB memory is cited as an example of a portable information recording medium, embodiments of the present invention should not be limited thereto. That is, a portable information recording medium storing the policy data <b>501</b>, the standard applications <b>140</b>, the SDK applications <b>180</b> and so forth, may be any one of various information recording media, for example, an SD memory card, an IC card, and so forth.</p>
<p id="p-0119" num="0118">The present invention is not limited to the above-described embodiments, and variations and modifications may be made without departing from the basic concept of the present invention claimed below.</p>
<p id="p-0120" num="0119">The present application is based on Japanese Priority Applications Nos. 2005-363353 and 2006-324750, filed on Dec. 16, 2005 and Nov. 30, 2006, the entire contents of which are hereby incorporated herein by reference.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An image forming apparatus provided with an interface for an external recording medium, comprising:
<claim-text>a plurality of software and hardware resources;</claim-text>
<claim-text>an access control part configured to perform access control, for respective ones of the plurality of software and hardware resources of said image forming apparatus, based on access control information defining whether usage thereof by a user is allowed; and</claim-text>
<claim-text>an internal recording medium, wherein:</claim-text>
<claim-text>said access control part performs access control based on said access control information including a plurality of software or hardware policy information stored in said external recording medium, and</claim-text>
<claim-text>when insertion of the external recording medium is detected, the access control part is configured to allow the user to input authentication information from an authentication page, and after the access control part determines a valid authentication, the access control part obtains the access control information from the external recording medium and expands the access control information in the internal recording medium,</claim-text>
<claim-text>wherein:</claim-text>
<claim-text>said access control information stored in said external recording medium defines whether the usage is allowed for a function module included in an application provided to the user or for one of the hardware resources of said image forming apparatus used by an application provided to the user; and</claim-text>
<claim-text>said access control part determines whether the usage of the application is allowed, based on whether the usage of the function module is allowed or whether the usage of the hardware resource is allowed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The image forming apparatus as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>before the external recording medium is connected to said image forming apparatus, the usage of the resources is restricted.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The image forming apparatus as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>an application executable in the image forming apparatus is stored in the external recording medium, and</claim-text>
<claim-text>said access control part determines whether the usage of the application stored in said external recording medium is allowed based on the access control information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The image forming apparatus as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>an application executable in the image forming apparatus is stored in the external recording medium, and</claim-text>
<claim-text>said access control part is configured to allow the usage of the application stored in said external recording medium regardless of the access control information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The image forming apparatus as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>image data generated in response to execution of an application provided to a user is stored in the external recording medium.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. An access control method executed by an image forming apparatus provided with an interface for an external recording medium, comprising:
<claim-text>performing access control, at the image forming apparatus, for respective ones of a plurality of software and hardware resources of said image forming apparatus, based on access control information defining whether usage thereof by a user is allowed; and</claim-text>
<claim-text>providing an internal recording medium, wherein:</claim-text>
<claim-text>the performing access control includes performing access control based on said access control information including a plurality of software or hardware policy information stored in said external recording medium, and the method further comprises:</claim-text>
<claim-text>receiving, when insertion of the external recording medium is detected, user input authentication information from an authentication page, and</claim-text>
<claim-text>obtaining, after determining a valid authentication, the access control information from the external recording medium and expanding the access control information in the internal recording medium,</claim-text>
<claim-text>wherein:</claim-text>
<claim-text>said access control information stored in said external recording medium defines whether the usage is allowed for a function module included in an application provided to the user or for one of the hardware resources of said image forming apparatus used by an application provided to the user; and</claim-text>
<claim-text>the performing access control includes determining whether the usage of the application is allowed based on whether the usage of the function module is allowed or based on whether the usage of the hardware resource is allowed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The access control method as claimed in <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein:
<claim-text>before the external recording medium is connected to said image forming apparatus, the usage of the resources is restricted.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The access control method as claimed in <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein:
<claim-text>an application executable in the image forming apparatus is stored in the external recording medium, and</claim-text>
<claim-text>the performing access control includes determining whether the usage of the application stored in said external recording medium is allowed based on the access control information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The access control method as claimed in <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein:
<claim-text>an application executable in the image forming apparatus is stored in the external recording medium, and</claim-text>
<claim-text>the performing access control includes allowing the usage of the application stored in said external recording medium regardless of the access control information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The access control method as claimed in <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein:
<claim-text>image data generated in response to execution of an application provided to a user is stored in the external recording medium.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A non-transitory computer readable storage medium encoded with instructions which, when executed by an image forming apparatus provided with an interface for an external recording medium, cause the image forming apparatus to execute an access control method, said method comprising:
<claim-text>performing access control for respective ones of a plurality of software and hardware resources of said image forming apparatus, based on access control information defining whether usage thereof by a user is allowed, wherein:</claim-text>
<claim-text>the performing access control includes performing access control based on said access control information including a plurality of software or hardware policy information stored in said external recording medium, and the method further comprises:</claim-text>
<claim-text>receiving, when insertion of the external recording medium is detected, user input authentication information from an authentication page, and</claim-text>
<claim-text>obtaining, after determining a valid authentication, the access control information from the external recording medium and expanding the access control information in an internal recording medium of the image forming apparatus,</claim-text>
<claim-text>wherein:</claim-text>
<claim-text>said access control information stored in said external recording medium defines whether the usage is allowed for a function module included in an application provided to the user or for one of the hardware resources of said image forming apparatus used by an application provided to the user; and</claim-text>
<claim-text>the performing access control includes determining whether the usage of the application is allowed based on whether the usage of the function module is allowed or based on whether the usage of the hardware resource is allowed.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353052-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353052</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11937795</doc-number>
<date>20071109</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1036</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>7</main-group>
<subgroup>16</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 29</main-classification>
<further-classification>713155</further-classification>
</classification-national>
<invention-title id="d2e53">Providing services to a guest device in a personal network</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6892225</doc-number>
<kind>B1</kind>
<name>Tu et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709217</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7188360</doc-number>
<kind>B2</kind>
<name>Gerdes et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  4</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7340769</doc-number>
<kind>B2</kind>
<name>Baugher</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  5</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7546373</doc-number>
<kind>B2</kind>
<name>Lehew et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7590246</doc-number>
<kind>B2</kind>
<name>Calmels et al.</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380270</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2004/0111520</doc-number>
<kind>A1</kind>
<name>Krantz et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2005/0250489</doc-number>
<kind>A1</kind>
<name>Lazaridis</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554261</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2006/0014520</doc-number>
<kind>A1</kind>
<name>Anderson et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455408</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2006/0149967</doc-number>
<kind>A1</kind>
<name>Lee et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2006/0183463</doc-number>
<kind>A1</kind>
<name>Falk et al.</name>
<date>20060800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455411</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2006/0264202</doc-number>
<kind>A1</kind>
<name>Hagmeier et al.</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455411</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2006/0280127</doc-number>
<kind>A1</kind>
<name>Mizuno et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370254</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2007/0056021</doc-number>
<kind>A1</kind>
<name>Annic et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  4</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2007/0168458</doc-number>
<kind>A1</kind>
<name>Costa-Requena et al.</name>
<date>20070700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709217</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2007/0254630</doc-number>
<kind>A1</kind>
<name>Moloney et al.</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455410</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2007/0266246</doc-number>
<kind>A1</kind>
<name>Lee et al.</name>
<date>20071100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2010/0135279</doc-number>
<kind>A1</kind>
<name>Petersson et al.</name>
<date>20100600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370352</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2011/0219419</doc-number>
<kind>A1</kind>
<name>Reisman</name>
<date>20110900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>725112</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>EP</country>
<doc-number>1 809 005</doc-number>
<kind>A2</kind>
<date>20070700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>EP</country>
<doc-number>1 821 493</doc-number>
<kind>A2</kind>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>Notification of Transmittal of the International Search Report and the Written Opinion of the International Searching Authority, or the Declaration corresponding to PCT/IB2008/050776, dated Mar. 3, 2009, 12 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00022">
<othercit>C.R. Livingston, et al., &#x201c;Remote Authentication Dial in User Services (RADIUS),&#x201d; Internet Engineering Task Force, Request for Comment 2058, pp. 1-53, Jan. 1997.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00023">
<othercit>C.R. Livingston, &#x201c;RADIUS Accounting,&#x201d; Internet Engineering Task Force, Request for Comment 2059, pp. 1-21, Jan. 1997.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00024">
<othercit>C.R. Livingston, et al., &#x201c;Remote Authentication Dial in User Services (RADIUS),&#x201d; Internet Engineering Task Force, Request for Comment 2138, pp. 1-54, Apr. 1997.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00025">
<othercit>C.R. Livingston, &#x201c;RADIUS Accounting,&#x201d; Internet Engineering Task Force, Request for Comment 2139, pp. 1-21, Apr. 1997.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00026">
<othercit>G. Zorn, &#x201c;Microsoft Vendor-specific RADIUS Attributes,&#x201d; Internet Engineering Task Force, Request for Comment 2548, pp. 1-34, Mar. 1999.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00027">
<othercit>B. Aboba et al., &#x201c;RADIUS Authentication Client MIB,&#x201d; Internet Engineering Task Force, Request for Comment 2618, pp. 1-12, Jun. 1999.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00028">
<othercit>G. Zorn et al., &#x201c;RADIUS Authentication Server MIB,&#x201d; Internet Engineering Task Force, Request for Comment 2619, pp. 1-14, Jun. 1999.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00029">
<othercit>B. Aboba et al., &#x201c;RADIUS Accounting Client MIB,&#x201d; Internet Engineering Task Force, Request for Comment 2620, pp. 1-11, Jun. 1999.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00030">
<othercit>G. Zorn et al., &#x201c;RADIUS Accounting Server MIB,&#x201d; Internet Engineering Task Force, Request for Comment 2621, pp. 1-13, Jun. 1999.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00031">
<othercit>B. Aboba et al., &#x201c;Implementation of L2TP Compulsory Tunneling via RADIUS,&#x201d; Internet Engineering Task Force, Request for Comment 2809, pp. 1-19, Apr. 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00032">
<othercit>C. Rigney, et al., &#x201c;Remote Authentication Dial In User Service (RADIUS),&#x201d; Internet Engineering Task Force, Request for Comment 2865, pp. 1-63, Jun. 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00033">
<othercit>C. Rigney, &#x201c;RADIUS Accounting,&#x201d; Internet Engineering Task Force, Request for Comment 2866, pp. 1-24, Jun. 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00034">
<othercit>G. Zorn et al., &#x201c;RADIUS Accounting Modifications for Tunnel Protocol Support,&#x201d; Internet Engineering Task Force, Request for Comment 2867, pp. 1-10, Jun. 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00035">
<othercit>G. Zorn et al., &#x201c;RADIUS Attributes for Tunnel Protocol Support,&#x201d; Internet Engineering Task Force, Request for Comment 2868, pp. 1-17, Jun. 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00036">
<othercit>C. Rigney, et al., &#x201c;RADIUS Extensions,&#x201d; Internet Engineering Task Force, Request for Comment 2869, pp. 1-39, Jun. 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00037">
<othercit>D. Mitton, &#x201c;Network Access Servers Requirements: Extended RADIUS Practices,&#x201d; Internet Engineering Task Force, Request for Comment 2882, pp. 1-14, Jul. 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00038">
<othercit>B. Aboba et al., &#x201c;RADIUS and IPv6,&#x201d; Internet Engineering Task Force, Request for Comment 3162, pp. 1-10, Aug. 2001.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00039">
<othercit>B. Aboba, &#x201c;IANA Considerations for RADIUS,&#x201d; Internet Engineering Task Force, Request for Comment 3575, pp. 1-7, Jul. 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00040">
<othercit>M. Chiba, et al., &#x201c;Dynamic Authorization Extensions to Remote Authentication Dial In User Service (RADIUS),&#x201d; Internet Engineering Task Force, Request for Comment 3576, pp. 1-25, Jul. 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00041">
<othercit>B. Aboba et al., &#x201c;RADIUS (Remote Authentication Dial In User Service) Support for Extensible Authentication Protocol (EAP),&#x201d; Internet Engineering Task Force, Request for Comment 3579, pp. 1-38, Sep. 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00042">
<othercit>P. Congdon, et al., &#x201c;IEEE 802.1X Remote Authentication Dial In User Service (RADIUS) Usage Guidelines,&#x201d; Internet Engineering Task Force, Request for Comment 3580, pp. 1-25, Sep. 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00043">
<othercit>R. Droms, et al., &#x201c;Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option,&#x201d; Internet Engineering Task Force, Request for Comment 4014, pp. 1-7, Feb. 2005.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00044">
<othercit>B. Sterman, et al., &#x201c;RADIUS Extension for Digest Authentication,&#x201d; Internet Engineering Task Force, Request for Comment 4590, pp. 1-27, Jul. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00045">
<othercit>D. Nelson, &#x201c;RADIUS Authentication Client MIB for IPv6,&#x201d; Internet Engineering Task Force, Request for Comment 4668, pp. 1-20, Aug. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00046">
<othercit>D. Nelson, &#x201c;RADIUS Authentication Server MIB for IPv6,&#x201d; Internet Engineering Task Force, Request for Comment 4669, pp. 1-21, Aug. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00047">
<othercit>D. Nelson, &#x201c;RADIUS Accounting Client MIB for IPv6,&#x201d; Internet Engineering Task Force, Request for Comment 4670, pp. 1-19, Aug. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00048">
<othercit>D. Nelson, &#x201c;RADIUS Accounting Server MIB for IPv6,&#x201d; Internet Engineering Task Force, Request for Comment 4671, pp. 1-20, Aug. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00049">
<othercit>S. DeCnodder, et al., &#x201c;RADIUS Dynamic Authorization Client MIB,&#x201d; Internet Engineering Task Force, Request for Comment 4672, pp. 1-19, Sep. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00050">
<othercit>S. DeCnodder, et al., &#x201c;RADIUS Dynamic Authorization Server MIB,&#x201d; Internet Engineering Task Force, Request for Comment 4673, pp. 1-20, Sep. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00051">
<othercit>P. Congdon, et al., &#x201c;RADIUS Attributes for Virtual LAN and Priority Support,&#x201d; Internet Engineering Task Force, Request for Comment 4675, pp. 1-13, Sep. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00052">
<othercit>V. Mammoliti, et al., &#x201c;DSL Forum Vendor-Specific RADIUS Attributes,&#x201d; Internet Engineering Task Force, Request for Comment 4679, pp. 1-21, Sep. 2006.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00053">
<othercit>J. Salowey, &#x201c;RADIUS Delegated-IPv6-Prefix Attribute,&#x201d; Internet Engineering Task Force, Request for Comment 4818, pp. 1-6, Apr. 2007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00054">
<othercit>B. Aboda, et al., &#x201c;Extensible Authentication Protocol (EAP),&#x201d; Internet Engineering Task Force, Request for Comment 3748, pp. 1-67, Jun. 2004.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00055">
<othercit>B. Aboda, et al., &#x201c;PPP EAP TLS Authentication Protocol,&#x201d; Internet Engineering Task Force, Request for Comment 2716, pp. 1-24, Oct. 1999.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00056">
<othercit>European Patent Office; Communication Pursuant to Article 94(3) EPC; Sep. 8, 2011; issued in European Patent Application No. 08719549.1.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>22</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>11</number-of-drawing-sheets>
<number-of-figures>11</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60969681</doc-number>
<date>20070903</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20090064346</doc-number>
<kind>A1</kind>
<date>20090305</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Larsson</last-name>
<first-name>Bo H&#xe5;kan</first-name>
<address>
<city>Malm&#xf6;</city>
<country>SE</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>SE</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Stavenow</last-name>
<first-name>Bengt Gunnar</first-name>
<address>
<city>Lund</city>
<country>SE</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>SE</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ritzau</last-name>
<first-name>Jan Robert Tobias</first-name>
<address>
<city>Veber&#xf6;d</city>
<country>SE</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>SE</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Bengtsson</last-name>
<first-name>Henrik Sven</first-name>
<address>
<city>Lund</city>
<country>SE</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>SE</country>
</residence>
</applicant>
<applicant sequence="005" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>&#xd6;stsj&#xf6;</last-name>
<first-name>Anders Wilhelm</first-name>
<address>
<city>Bj&#xe4;rred</city>
<country>SE</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>SE</country>
</residence>
</applicant>
<applicant sequence="006" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Min&#xf6;r</last-name>
<first-name>Sten H&#xe5;kan</first-name>
<address>
<city>Lund</city>
<country>SE</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>SE</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Vedantam</last-name>
<first-name>Sreenivas</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<orgname>Moore &#x26; Van Allen PLLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Sony Mobile Communications AB</orgname>
<role>03</role>
<address>
<city>Lund</city>
<country>SE</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Flynn</last-name>
<first-name>Nathan</first-name>
<department>2431</department>
</primary-examiner>
<assistant-examiner>
<last-name>Almamun</last-name>
<first-name>Abdullah</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method may include sending personal network connection information from a mobile device to a guest device; sending authentication credentials from the mobile device to the guest device; receiving the authentication credentials in the personal network from the guest device; authenticating the guest device based on the authentication credentials; and granting access to the guest device to content stored in the personal network for a guest session.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="196.43mm" wi="120.14mm" file="US08353052-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="240.79mm" wi="186.18mm" orientation="landscape" file="US08353052-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="262.47mm" wi="201.85mm" orientation="landscape" file="US08353052-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="195.16mm" wi="160.02mm" orientation="landscape" file="US08353052-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="229.02mm" wi="169.33mm" orientation="landscape" file="US08353052-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="173.06mm" wi="145.46mm" orientation="landscape" file="US08353052-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="198.63mm" wi="138.43mm" file="US08353052-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="259.16mm" wi="189.91mm" orientation="landscape" file="US08353052-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="253.66mm" wi="168.99mm" file="US08353052-20130108-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="244.94mm" wi="169.59mm" file="US08353052-20130108-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="255.02mm" wi="130.89mm" file="US08353052-20130108-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="263.57mm" wi="197.70mm" orientation="landscape" file="US08353052-20130108-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This patent application claims priority under 35 U.S.C. &#xa7;119 to U.S. Provisional Application No. 60/969,681, filed Sep. 3, 2007, the disclosure of which is incorporated herein by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">1. Technical Field</p>
<p id="p-0004" num="0003">Embodiments described herein may relate generally to providing services by devices associated with a personal network and may relate, more particularly, to providing services by a personal network to a mobile device.</p>
<p id="p-0005" num="0004">2. Description of Related Art</p>
<p id="p-0006" num="0005">Devices coupled to a network may provide a myriad of services. For example, a home network may include a device to play music (e.g., a stereo), display videos (e.g., a television), print documents, store data (such as video or music), or retrieve data. Current technology does not provide adequate management of the services that these devices provide to users.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0007" num="0006">In one aspect, a system may include a personal network; a mobile communications device including a transmitter to send authentication credentials and connection information for the personal network to a guest device for accessing the personal network; the personal network may include a proxy, the proxy may include: a receiver to receive the authentication credentials from the guest device; and a processor to authenticate the guest device based on the authentication credentials received from the guest device and to authorize the guest device to access content stored in the personal network for a guest session.</p>
<p id="p-0008" num="0007">In one aspect, the authentication credentials are first authentication credentials, and the transmitter of the mobile communications device may transmit second authentication credentials to the guest device.</p>
<p id="p-0009" num="0008">In one aspect, the first authentication credentials include information indicative of a first expiration time, and the processor of the proxy re-authenticates the guest device based on the second authentication credentials after a time based on the first expiration time.</p>
<p id="p-0010" num="0009">In one aspect, the second authentication credentials include a second expiration time after which the second authentication credentials are not valid.</p>
<p id="p-0011" num="0010">In one aspect, the proxy limits access to content by the guest device based on privilege information stored in the proxy.</p>
<p id="p-0012" num="0011">In one aspect, the mobile communications device transmits the privilege information to the proxy.</p>
<p id="p-0013" num="0012">In one aspect, the mobile communications device may include a processor to generate the authentication credentials.</p>
<p id="p-0014" num="0013">In one aspect, the transmitter of the mobile communications device includes one or more of a short-range communications transmitter or a near field communication transmitter.</p>
<p id="p-0015" num="0014">In one aspect, the processor of the proxy may further be configured to generate the authentication credentials.</p>
<p id="p-0016" num="0015">In one aspect, the proxy may further include a transmitter to send the authentication credentials to the mobile communications device.</p>
<p id="p-0017" num="0016">In one aspect, the transmitter of the mobile communications device may be further configured to send connection information about the guest device to the proxy.</p>
<p id="p-0018" num="0017">In one aspect, a method may include sending connection information about a personal network from a mobile communications device to a guest device; and sending authentication credentials from the mobile device to the guest device, where the authentication credentials may be used to authenticate the guest device in the personal network and authorize the guest device to access content stored in the personal network for a guest session.</p>
<p id="p-0019" num="0018">In one aspect, the method may further include generating the authentication credentials in the mobile communications device.</p>
<p id="p-0020" num="0019">In one aspect, the method may include sending privilege information from the mobile device to a proxy, where the privilege information is used to limit access to content by the guest device.</p>
<p id="p-0021" num="0020">In one aspect, the authentication credentials are first authentication credentials, and the mobile communications device may transmit second authentication credentials to the guest device.</p>
<p id="p-0022" num="0021">In another aspect, the first authentication credentials may include information indicative of a first expiration time and the second authentication credentials may be used to re-authenticate the guest device in the personal network after a time based on the first expiration time.</p>
<p id="p-0023" num="0022">In one aspect, the second authentication credentials may include information indicative of a second expiration time after which the second authentication credentials are not valid.</p>
<p id="p-0024" num="0023">In one aspect, transmitting the authentication credentials may include transmitting the authentication credentials with a short-range communication transmitter or a near field communication transmitter.</p>
<p id="p-0025" num="0024">In one aspect, the method may further include receiving the authentication credentials from a proxy in the personal network.</p>
<p id="p-0026" num="0025">In one aspect, the method may further include sending connection information about the guest device to the proxy in the personal network.</p>
<p id="p-0027" num="0026">In one aspect, a mobile communications device may include a transmitter to send first authentication credentials and connection information for a personal network to a guest device; where the first authentication credentials may be used to authenticate the guest device in the personal network and authorize the guest device to access content stored in the personal network for a guest session; and where the transmitter may send second authentication credentials to the guest device to re-authenticate the guest device in the personal network.</p>
<p id="p-0028" num="0027">In one aspect, the first authentication credentials may include information indicative of a first expiration time and the guest device may be re-authenticated based on the second authentication credentials after a time based on the first expiration time.</p>
<p id="p-0029" num="0028">In one aspect, the mobile communications device may include a processor to generate the authentication credentials.</p>
<p id="p-0030" num="0029">In one aspect, the transmitter of the mobile communications device may include a short-range communication transmitter or a near field communication transmitter.</p>
<p id="p-0031" num="0030">In one aspect, the mobile communications device may include a receiver to receive the first authentication credentials from a proxy in the personal network.</p>
<p id="p-0032" num="0031">In one aspect, the transmitter may be further configured to send connection information about the guest device to the proxy.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0033" num="0032">The accompanying drawings, which are incorporated in and constitute a part of this specification, illustrate one or more embodiments and, together with the description, explain the embodiments. In the drawings,</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 1</figref> shows an exemplary personal network for embodiments described herein;</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 2</figref> shows an exemplary environment for embodiments described herein;</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of exemplary components of a device;</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram of an exemplary device table;</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of an exemplary privilege table;</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIGS. 6</figref>, <b>8</b>, <b>9</b>, and <b>10</b> are flowcharts of exemplary processes for providing services in embodiments described herein; and</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIGS. 7 and 11</figref> are block diagrams of exemplary environments for embodiments described herein.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0041" num="0040">The following detailed description refers to the accompanying drawings. The same reference numbers in different drawings may identify the same or similar elements. Also, the following detailed description does not limit the scope of the claims. Rather, the claims and their equivalents define the scope of the inventions described herein.</p>
<heading id="h-0006" level="1">Overview</heading>
<p id="p-0042" num="0041">Embodiments described herein allow users to define a personal network. A personal network is a collection of devices that provide services to users. Services may include playing music or movies, viewing pictures, printing documents, storing movies and music, among other things. The devices associated with the personal network and the services that these devices provide to the users may be defined. Further, the devices allowed to access the services and devices may have limited privileges or permissions to access the devices and services. For example, a guest to a personal network may not have full access to the devices and services associated with the personal network.</p>
<heading id="h-0007" level="1">Exemplary Personal Network</heading>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 1</figref> shows an exemplary personal network <b>100</b> in which embodiments described herein may be implemented. As shown, personal network <b>100</b> may include a network <b>102</b> communicating with a group of devices <b>104</b>-<b>154</b>. These devices may include, among other things, a proxy server <b>104</b>, a home printer <b>106</b>, a wide-screen TV <b>108</b> (e.g., a display or monitor), a first pair of speakers <b>110</b> (first speakers <b>110</b>), a small-screen TV <b>112</b> (e.g., a display or monitor), a second pair of speakers <b>114</b> (second speakers <b>114</b>), a laptop <b>116</b>, a home server <b>118</b>, a car <b>120</b>, a mobile phone <b>152</b>, and a hotel television (hotel TV) <b>154</b>. In other embodiments, personal network <b>100</b> may include more, fewer, or different components. Moreover, one or more devices <b>104</b>-<b>154</b> associated with personal network <b>100</b> may perform one or more functions of any other device of personal network <b>100</b>. Furthermore, one or more of devices <b>104</b>-<b>154</b> may be remotely located from each other. Although <figref idref="DRAWINGS">FIG. 1</figref> shows devices <b>104</b>-<b>154</b> coupled to network <b>102</b>, devices <b>104</b>-<b>154</b> may also be coupled with each other and may be able to communicate directly with each other.</p>
<p id="p-0044" num="0043">Besides the devices shown in <figref idref="DRAWINGS">FIG. 1</figref> coupled to network <b>102</b>, coupled devices may include any computational device, including among other things: a camcorder, a personal computer; a telephone, such as a radio telephone; a personal communications system (PCS) terminal that may combine a cellular radiotelephone with data processing, facsimile, and/or data communications capabilities; an electronic notepad; a personal music player (PMP); a personal digital assistant (PDA) that may provide Internet/intranet access, web browser, organizer, calendar, and a global positioning system (GPS). In one embodiment, personal network <b>100</b> may include a DNLA (Digital Network Living Alliance) network.</p>
<p id="p-0045" num="0044">Network <b>102</b> may include the Internet, an ad hoc network, a local area network (LAN), a wide area network (WAN), a metropolitan area network (MAN), a cellular network, a public switched telephone network (PSTN), any other network, or combinations of networks. Network <b>102</b> may include wireless and/or wired networks or sub-networks.</p>
<p id="p-0046" num="0045">Home server <b>118</b> and proxy server <b>104</b> may include one or more computer systems for hosting server programs, databases, and/or applications. Home server <b>118</b> may receive a request for uploading or downloading data from other devices, such as devices coupled to personal network <b>100</b>, process the request, and transmit or receive data to and from other devices, such as devices coupled to personal network <b>100</b>. Proxy server <b>104</b> may authenticate devices connecting to personal network <b>100</b>, e.g., making sure devices and users connecting to personal network <b>100</b> are indeed supposed to be able to connect to personal network <b>100</b>. Authenticating a device may be considered creating a security association (SA) between the device and personal network <b>100</b>. In addition, proxy server <b>104</b> may also authorize those authenticated devices and users, e.g., making sure devices and users only do what they are supposed to be doing on personal network <b>100</b>. Proxy server <b>104</b> and home server <b>118</b> may be located in a home of a user, but proxy server <b>104</b> may be located elsewhere (e.g., remotely from home server <b>118</b>). In one embodiment, proxy server <b>104</b> and home server <b>118</b> may be the same device. In one embodiment, proxy server <b>104</b> may be a process, program, or application running in server <b>118</b>.</p>
<p id="p-0047" num="0046">Printer <b>106</b> may include any black and white or color printer, such as a laser printer, ink-jet printer, dot matrix printer, etc. Wide-screen display <b>108</b>, small-screen display <b>112</b>, and hotel TV <b>154</b> may include a liquid crystal display (LCD), a cathode ray tube (CRT), a plasma display, etc. Hotel TV <b>154</b> is shown behind bars because, as described below, hotel TV <b>154</b> may have limited or temporary access to personal network <b>100</b> through, for example, proxy server <b>104</b>. First speakers <b>110</b> and second speakers <b>114</b> may include one or more speakers that output audio signals, such as stereo or mono audio. Laptop <b>116</b> may include any portable computing device, PDA, PMP, etc. Mobile phone <b>152</b> may include any portable computing device, PDA, PMP, etc. Car <b>120</b> may include any mobile transportation device, automobile, truck, etc.</p>
<heading id="h-0008" level="1">Exemplary Environment</heading>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram of an exemplary environment <b>200</b> in which embodiments disclosed herein may be implemented. Environment <b>200</b> may include a home environment <b>210</b> and a foreign environment <b>250</b>. Environment <b>200</b> may include more, fewer, or different environments than shown in <figref idref="DRAWINGS">FIG. 2</figref>. As shown in <figref idref="DRAWINGS">FIG. 1</figref>, home environment <b>210</b> and foreign environment <b>250</b> may be coupled together through network <b>102</b>. In one embodiment, the Internet connects home environment <b>210</b> with foreign environment <b>250</b>. Home environment <b>210</b> and foreign environment <b>250</b> may include more, fewer, or different locations and/or device other than those shown in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0049" num="0048">Home environment <b>210</b> may include a kitchen <b>202</b>, a living room <b>204</b>, a home office <b>206</b>, and a driveway <b>208</b>. In exemplary environment <b>200</b>, kitchen <b>202</b> may include laptop <b>116</b>, small-screen TV <b>112</b>, and second speakers <b>114</b>; living room <b>204</b> may include home server <b>118</b>, wide-screen TV <b>108</b>, and first speakers <b>110</b>; home office <b>206</b> may include proxy server <b>104</b> and home printer <b>106</b>; driveway <b>208</b> may include car <b>120</b>.</p>
<p id="p-0050" num="0049">Foreign environment <b>250</b> may include a hotel room <b>252</b>. Hotel room <b>252</b> may include a hotel TV <b>154</b>. Foreign environment <b>250</b> may also include mobile phone <b>152</b>, which may be there by virtue of its user staying in hotel room <b>252</b> for a period of time.</p>
<p id="p-0051" num="0050">Home environment <b>210</b> may be considered a trusted environment while foreign environment <b>250</b> may be considered an untrusted environment. In addition, in one embodiment, hotel TV <b>154</b> in foreign environment <b>250</b> may be considered an untrusted device.</p>
<heading id="h-0009" level="1">Exemplary Device</heading>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of exemplary components of a device, such as any one of devices <b>104</b>-<b>154</b>. Device <b>300</b> may include a bus <b>310</b>, processing logic <b>320</b>, an input device <b>330</b>, an output device <b>340</b>, a communication interface <b>350</b>, and a memory <b>360</b>. Device <b>300</b> may include other components (not shown) that aid in receiving, transmitting, and/or processing data. Moreover, other configurations of components in device <b>300</b> are possible. Further, one or more components of device <b>300</b> may be remotely located.</p>
<p id="p-0053" num="0052">Bus <b>310</b> may include a path that permits communication among the components of device <b>300</b>. Processing logic <b>320</b> may include any type of processor or microprocessor (or groups of processors or microprocessors) that interprets and executes instructions. In other embodiments, processing logic <b>320</b> may include an application-specific integrated circuit (ASIC), a field-programmable gate array (FPGA), or the like.</p>
<p id="p-0054" num="0053">Input device <b>330</b> may include a device that permits a user to input information into device <b>300</b>, such as a keyboard, a keypad, a mouse, a pen, a microphone, a remote control, a touch-screen display, one or more biometric mechanisms, or the like.</p>
<p id="p-0055" num="0054">Output device <b>340</b> may include a device that outputs information to the user, such as a display, a printer, a speaker, etc. Output device <b>340</b> may include a vibrator to alert a user.</p>
<p id="p-0056" num="0055">Input device <b>330</b> and output device <b>340</b> may allow the user of device <b>300</b> to receive a menu of options. The menu may allow the user to select various functions or services associated with applications executed by device <b>300</b> or other devices coupled to network <b>102</b>. Input device <b>330</b> and output device <b>340</b> may allow the user to activate a particular service or application, such as a service defined by a device table described below.</p>
<p id="p-0057" num="0056">Communication interface <b>350</b> may include any transceiver-like mechanism that enables device <b>300</b> to communicate with other devices and/or systems. Communication interface <b>350</b> may include a transmitter that may convert baseband signals from processing logic <b>320</b> to radio frequency (RF) signals and/or a receiver that may convert RF signals to baseband signals. Alternatively, communication interface <b>350</b> may include a transceiver to perform functions of both a transmitter and a receiver. Communication interface <b>350</b> may be coupled to an antenna for transmission and reception of the RF signals. Communications interface <b>350</b> may include a network interface card, e.g., Ethernet card, for wired communications or a wireless network interface (WiFi) card for wireless communications.</p>
<p id="p-0058" num="0057">Communications interface <b>350</b> may include global satellite navigation and positioning system receiver for assisting in the determination of the location of the respective device. Communication interface <b>350</b> may also include, for example, a universal serial bus (USB) port for communications over a cable, a short-range communications device (e.g., a Bluetooth wireless interface or WiFi), a near-field communication (NFC) device, etc. Communication interface <b>350</b>, for example, may send signals, such as Bluetooth signals and/or electromagnetic signals, to other devices within a vicinity of the device <b>300</b>, such as within 1 centimeter, within 10 centimeters, within 1 meter, within 10 meters, within 15 meters, within 20 meters, within 25 meters, or within 30 meters, for example. Communications device <b>350</b> may receive, transmit and/or process digital or analog audio inputs/outputs and/or digital or analog video inputs/outputs.</p>
<p id="p-0059" num="0058">Memory <b>360</b> may include a random access memory (RAM) or another type of dynamic storage device that may store information and instructions, e.g., an application, for execution by processing logic <b>320</b>; a read-only memory (ROM) device or another type of static storage device that may store static information and instructions for use by processing logic <b>320</b>; and/or some other type of magnetic or optical recording medium and its corresponding drive, e.g., a hard disk drive (HDD), for storing information and/or instructions.</p>
<p id="p-0060" num="0059">Device <b>300</b> may perform certain operations, as described in detail below. Device <b>300</b> may perform these operations in response to processing logic <b>320</b> executing software instructions contained in a computer-readable medium, such as memory <b>360</b>. A computer-readable medium may be defined as a physical or logical memory device and/or carrier wave. The software instructions may be read into memory <b>360</b> from another computer-readable medium or from another device via communication interface <b>350</b>. The software instructions contained in memory <b>360</b> may cause processing logic <b>320</b> to perform processes that are described below.</p>
<heading id="h-0010" level="1">Exemplary Data Structures</heading>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram of an exemplary device table <b>400</b>. Device table <b>400</b>, e.g., a database, may define the devices associated with a personal network, such as personal network <b>100</b>, the privileges associated with the devices, and the services the devices may provide. Device table <b>400</b> may be stored, for example, in memory <b>360</b> of device <b>300</b>, or in a memory of any device coupled to personal network <b>100</b>. In one embodiment, device table <b>400</b> may be stored in memory <b>360</b> of proxy server <b>104</b> or home server <b>118</b>. In one embodiment, portions of device table <b>400</b> may be stored in various devices coupled to personal network <b>100</b>. Device table <b>400</b> may include a device field <b>402</b>, a privilege field <b>404</b>, and a services field <b>406</b>. Device table <b>400</b> may include additional, different, or fewer fields than illustrated in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0062" num="0061">Device field <b>402</b> may include the name of a device associated with personal network <b>100</b>. In exemplary device table <b>400</b>, the devices <b>104</b>-<b>154</b> associated with personal network <b>100</b> of <figref idref="DRAWINGS">FIG. 1</figref> are listed in eleven records (records <b>452</b> through <b>472</b>).</p>
<p id="p-0063" num="0062">Privilege field <b>404</b> may include the name of a set of privileges afforded the corresponding device in device field <b>402</b>. Exemplary device table <b>400</b> lists three different privilege types, including GUEST, TEMPORARY, and PERMANENT. The privileges (e.g., permissions) associated with these privilege types may be defined in a privilege table described below with respect to <figref idref="DRAWINGS">FIG. 6</figref>. In exemplary device table <b>400</b>, the privileges of devices <b>104</b>-<b>154</b> are listed in privilege field <b>404</b> of the eleven records (records <b>452</b> through <b>472</b>).</p>
<p id="p-0064" num="0063">Services field <b>406</b> may include the services that the device in the corresponding device field <b>402</b> may provide. In exemplary device table <b>400</b>, services of devices <b>104</b>-<b>154</b> are listed in services field <b>406</b> of the eleven records (records <b>452</b> through <b>472</b>). Exemplary services may include, among others, audio output (e.g., a speaker playing music), video output (e.g., a monitor displaying a video), printed paper (e.g., a printer outputting paper), audio input (e.g., a microphone), and a keypad input. Other services not shown in <figref idref="DRAWINGS">FIG. 4</figref>, device table <b>400</b>, are possible.</p>
<p id="p-0065" num="0064">As indicated in exemplary device table <b>400</b>: first speakers <b>110</b> may be have a privilege of PERMANENT and its services may include outputting audio (record <b>452</b>); wide-screen TV <b>108</b> may have a privilege of PERMANENT and its services may include outputting video (record <b>454</b>); second speakers <b>114</b> may have a privilege of PERMANENT and its services may include outputting audio (record <b>456</b>); small-screen TV <b>112</b> may have a privilege of PERMANENT and its services may include data input and output outputting video (record <b>458</b>); home server <b>118</b> may have a privilege of PERMANENT and its services may include inputting and outputting data (record <b>460</b>); laptop <b>116</b> may have a privilege of TEMPORARY and its services may include outputting video and audio and inputting audio (record <b>462</b>); home printer <b>106</b> may have a privilege of PERMANENT and its services may include printing paper (record <b>464</b>); proxy server <b>104</b> may have a privilege of PERMANENT and its services may include inputting (e.g., receiving, storing) and outputting (e.g., retrieving, displaying) data (record <b>466</b>); car <b>120</b> may have a privilege of TEMPORARY and its services may include outputting video and audio, inputting audio, and inputting user data from a keypad (record <b>468</b>); hotel TV may have privileges of GUEST and TEMPORARY and its services may include outputting video and audio (record <b>470</b>); and mobile phone <b>152</b> may have privileges of PERMANENT and its services may include outputting audio and video and inputting audio (record <b>472</b>).</p>
<p id="p-0066" num="0065">Devices and/or services may be added or removed from personal network <b>100</b>, for example, by adding, removing, or editing entries in device table <b>400</b>. Such editing of device table <b>400</b> may be done, for example, through laptop computer <b>116</b> or automatically by proxy server <b>104</b>.</p>
<p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of an exemplary privilege table <b>500</b>. Privilege table <b>500</b>, e.g., a database, may define the set of privileges (e.g., permissions) afforded each privilege type. Privilege table <b>500</b> may be stored in memory <b>360</b> of device <b>300</b>, e.g., a memory of any device coupled to network <b>102</b>, among other places. In one embodiment, privilege table <b>500</b> may be stored in memory <b>360</b> of proxy server <b>104</b> or home server <b>118</b>. Privilege table <b>500</b> may include a privilege type field <b>502</b> and a permissions field <b>504</b>. Privilege table <b>500</b> may include additional, different, or fewer fields than illustrated in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0068" num="0067">Privilege type field <b>502</b> may include the name of the privilege type. The name(s) listed in this field may correspond to the privileges afforded devices in device table <b>400</b>. Exemplary privilege table <b>500</b> may include three roles: GUEST, TEMPORARY, and PERMANENT. These roles are the same privileges listed in device table <b>400</b> described above with respect to <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0069" num="0068">Permissions field <b>504</b> may include the permissions afforded the privilege type in the corresponding privilege type field <b>502</b>. Permissions field <b>504</b> may include rules that devices having the corresponding privilege type may have to obey. For example, a permissions field <b>504</b> including NON-CONFIDENTIAL may indicate permission to access only files that are not tagged as confidential. A permissions field <b>504</b> including a time period (e.g., LESS THAN ONE HOUR) may indicate that a device must authenticate itself with personal network <b>100</b> at least once during that time period (e.g., an hour) or that credentials used for authenticating the device will be set to expire after that time period. In this latter example, the device may request new credentials before expiration of the time period. A permissions field <b>504</b> including FULL may indicate permissions to access all devices and all documents.</p>
<p id="p-0070" num="0069">Permissions field <b>504</b> may also provide other limitations to permissions, such as the time of day access may be allowed. For example, a permissions field <b>504</b> including 1500-1800 may indicate permission to access the services of wide-screen TV <b>108</b> between the hours of 1500 and 1800. Permissions may be indicated negatively, e.g., by indicating what permissions are not allowed. For example, a permission of NOT laptop <b>116</b> may indicate that a lack of permission to access the services of laptop <b>116</b> or data on laptop <b>116</b>. In one embodiment, permissions may also be limited to particular services provided by devices.</p>
<p id="p-0071" num="0070">In exemplary privilege table <b>500</b>, devices with the privilege type PERMANENT are provided the permission of FULL (record <b>554</b>). Devices with the privilege type GUEST may be provided the permission of NON-CONFIDENTIAL (record <b>556</b>). Devices with the privilege type TEMPORARY may be provided the permission of LESS THAN ONE HOUR (record <b>560</b>).</p>
<p id="p-0072" num="0071">The privileges afforded users with particular roles may be changed, for example, by adding, removing, or editing entries in privilege table <b>500</b>. Such editing of privilege table <b>500</b> may be done, for example, through laptop computer <b>116</b> or automatically by proxy server <b>104</b>.</p>
<heading id="h-0011" level="1">Exemplary Processeses</heading>
<p id="p-0073" num="0072"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart of an exemplary process <b>600</b> for one embodiment for authenticating and authorizing a guest device. In one embodiment, process <b>600</b> may be performed by mobile phone <b>152</b>, hotel TV <b>154</b>, proxy server <b>104</b>, and home server <b>118</b>. Process <b>600</b> is described with respect to <figref idref="DRAWINGS">FIG. 7</figref>, which shows the flow of information between devices.</p>
<p id="p-0074" num="0073">Process <b>600</b> may begin when the user of mobile phone <b>152</b> enters hotel room <b>252</b> and wants to use hotel TV <b>154</b> to view content from personal network <b>100</b>, e.g., video content from home server <b>118</b>. Hotel TV <b>154</b>, however, may not be part of personal network <b>100</b> and, as such, may not have access to content in home server <b>118</b>. The user of mobile phone <b>152</b> (as a master device) may wish to include hotel TV <b>154</b> in personal network <b>100</b> (as a guest device) so that hotel TV <b>154</b> may play content from personal network <b>100</b>, for example, during a guest session. A guest session may include a lasting connection between the guest device and personal network <b>100</b> for streaming music or video, for example.</p>
<p id="p-0075" num="0074">Information about a personal network may be sent to a guest device (block <b>602</b>). For example, mobile phone <b>152</b> may send information regarding personal network <b>100</b> to hotel TV <b>154</b>. Such information may include the Internet protocol (IP) address of proxy server <b>104</b>. Credentials may be generated (block <b>604</b>). Mobile phone <b>152</b> may generate credentials that may allow hotel TV <b>154</b> to be authenticated by proxy server <b>104</b>. In one embodiment, the credentials required by hotel TV <b>154</b> may already exist in mobile phone <b>152</b>. Credentials may include a certificate, such as an asymmetric encryption certificate. Credentials may be time varying, such as a numerical key generated by a time-varying algorithm in mobile phone <b>152</b>. The credentials may also include information regarding the privileges (e.g., GUEST, TEMPORARY, etc.) that should be afforded the guest device, e.g., hotel TV <b>154</b>.</p>
<p id="p-0076" num="0075">Credentials may be sent to the guest device (block <b>606</b>). In this example, mobile phone <b>152</b> may send the credentials generated at block <b>604</b> to hotel TV <b>154</b> via link <b>702</b> so that hotel TV <b>154</b> may access personal network <b>100</b>. Mobile phone <b>152</b> may use NFC, Bluetooth, WiFi, a cable, a WLAN, etc. As shown in <figref idref="DRAWINGS">FIG. 7</figref>, the credentials may be sent from mobile phone <b>152</b> to TV <b>154</b> via a link <b>702</b>.</p>
<p id="p-0077" num="0076">Using the credentials and information about personal network <b>100</b>, the guest device may be authenticated and authorized to access personal network <b>100</b> (block <b>608</b>). Having received the credentials from mobile phone <b>152</b> and having the connection information for proxy server <b>104</b>, hotel TV <b>154</b> may communicate with proxy server <b>104</b> via a link <b>704</b> to be authenticated. Having been authenticated, the guest device may be authorized to access personal network <b>100</b> and may provide services (block <b>610</b>) during a guest session <b>706</b>. Hotel TV <b>154</b> may access video content from home server <b>118</b> for the user of mobile phone <b>152</b> to watch, for example.</p>
<p id="p-0078" num="0077">Access by hotel TV <b>154</b> to personal network <b>100</b> may be limited, however. Hotel TV <b>154</b> may be granted GUEST privileges in accordance with device table <b>400</b> (record <b>470</b>). Device table <b>400</b>, e.g., record <b>470</b>, may be generated before the user of mobile phone <b>152</b> visits foreign environment <b>250</b> or may be generated using other information gathered by personal network <b>100</b> (e.g., location of mobile phone <b>152</b>, identification of hotel TV <b>154</b> during authentication, general rules, etc). Device table <b>400</b>, e.g., record <b>470</b> may also be generated based on information received from the user of mobile phone <b>152</b> when visiting foreign environment <b>250</b>. For example, when in foreign environment <b>250</b>, the user of mobile phone <b>152</b> may instruct mobile phone <b>152</b> to provide information to personal network <b>100</b> so that hotel TV <b>152</b> will be given GUEST privileges. With GUEST privileges, hotel TV <b>154</b> may only access non-confidential information (e.g., information that does not include personal financial information) from personal network <b>100</b> pursuant to privilege table <b>500</b>. In one embodiment, hotel TV <b>154</b> may also be limited to accessing only information that matches the services listed for hotel TV in device table <b>400</b>. That is, hotel TV may only provide audio out and video out related services, for example.</p>
<p id="p-0079" num="0078">Authentication and access by the guest device may be canceled (block <b>612</b>) and the guest session may be ended. At some point, the user of mobile phone <b>152</b> may end the guest session for hotel TV <b>154</b> by communicating with hotel TV <b>154</b> and requesting an end to guest session <b>706</b>, for example.</p>
<p id="p-0080" num="0079">The user of mobile phone <b>152</b> may want the access by hotel TV <b>154</b>, e.g., the guest session, to be temporary, however, because the user may not want the next occupant of hotel room <b>252</b> to have access to personal network <b>100</b> through hotel TV <b>154</b> and the user may forget to end guest session <b>706</b>. <figref idref="DRAWINGS">FIGS. 8 and 9</figref> address this scenario in which an absent-minded user forgets to end a session.</p>
<p id="p-0081" num="0080"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart of another exemplary process <b>800</b> for one embodiment for authenticating and authorizing a guest device. Like process <b>600</b>, process <b>800</b> may begin when the user of mobile phone <b>152</b> enters hotel room <b>252</b> and wants to use hotel TV <b>154</b> to view content from personal network <b>100</b>, e.g., video content from home server <b>118</b>. Hotel TV <b>154</b>, however, may not be part of personal network <b>100</b> and, as such, may not have access to content in home server <b>118</b>.</p>
<p id="p-0082" num="0081">Information about personal network <b>100</b> may be sent to the guest device (block <b>802</b>). Similar to process <b>600</b>, mobile phone <b>152</b> may send information regarding personal network <b>100</b> to hotel TV <b>154</b> via link <b>702</b>. Such information may include the IP address of proxy server <b>104</b>. Credentials may be generated (block <b>804</b>). Mobile phone <b>152</b> may generate credentials that may allow hotel TV <b>154</b> to be authenticated by proxy server <b>104</b>. The credentials may also include information regarding the privileges (e.g., GUEST, TEMPORARY, etc.) that should be afforded the guest device, e.g., hotel TV <b>154</b> for privilege table <b>500</b>. In this example, the information regarding the privileges may be encrypted or otherwise unalterable by hotel TV <b>154</b>. The generated credentials may be sent to the guest device (block <b>806</b>). In this example, mobile phone <b>152</b> may send the credentials generated at block <b>804</b> to hotel TV <b>154</b> via link <b>702</b> so that hotel TV <b>154</b> may access personal network <b>100</b>.</p>
<p id="p-0083" num="0082">Using the credentials and the information regarding personal network <b>100</b>, the guest device may be authenticated and authorized to access personal network <b>100</b> (block <b>808</b>). As described above with respect to process <b>600</b>, having received the credentials from mobile phone <b>152</b> and having the connection information for proxy server <b>104</b>, hotel TV <b>154</b> may be authenticated by proxy server <b>104</b> via link <b>704</b>. After authentication, the guest device may purge the credentials (block <b>810</b>). For example, hotel TV <b>154</b> may delete the authentication certificate received from mobile phone <b>152</b> at block <b>806</b>.</p>
<p id="p-0084" num="0083">Having been authenticated, the guest device may access personal network <b>100</b> and personal network <b>100</b> may provide services (block <b>812</b>) during the guest session. For example, hotel TV <b>154</b> may then access content from home server <b>118</b> for the user of mobile phone <b>152</b> to watch, for example, via guest session <b>706</b>.</p>
<p id="p-0085" num="0084">Access by hotel TV <b>154</b> to personal network <b>100</b> may be limited, however. Personal network <b>100</b> may, in one embodiment, grant only the privileges to hotel TV <b>154</b> indicated in the privilege information received with the credentials from hotel TV <b>154</b> (which hotel TV <b>154</b> received from mobile phone <b>152</b>). In addition to GUEST privileges, hotel TV <b>154</b> may also be granted TEMPORARY privileges in accordance with device table <b>400</b> (record <b>470</b>). With TEMPORARY privileges, hotel TV <b>154</b> may only access personal network <b>100</b> for a period of time (e.g., an hour) without re-authentication, for example.</p>
<p id="p-0086" num="0085">As defined by table <b>400</b>, therefore, proxy server <b>104</b> and/or hotel TV <b>154</b> may require re-authentication and re-authorization periodically to continue guest session <b>706</b>. Because the guest device purged the credentials, the credentials may be requested (or re-requested) by the guest device (block <b>814</b>). In this example, hotel TV <b>154</b> may request the credentials from mobile phone <b>152</b> via link <b>702</b>. If the master device (e.g., mobile phone <b>152</b> in this example) is not present (block <b>816</b>: NO), then the guest session may be ended (block <b>818</b>) because new credentials cannot be received. In this example, if mobile phone <b>152</b> is not present in hotel room <b>252</b> and/or hotel TV <b>154</b> does not receive credentials from mobile phone <b>152</b>, then hotel TV <b>154</b> and/or proxy server <b>104</b> may end guest session <b>706</b>.</p>
<p id="p-0087" num="0086">If the master device is present (block <b>816</b>: YES), then credentials may be resent to the guest device (block <b>806</b>). In this embodiment, if mobile phone <b>152</b> is present, then mobile phone <b>152</b> may send credentials to hotel TV <b>154</b>. In the embodiment where the credentials are time varying, the credentials may be generated again as well (block <b>804</b>). The guest device may be re-authenticated and re-authorized (block <b>808</b>). Process <b>800</b> may require re-authentication and re-authorization on a periodic basis, such as every minute or every hour, for example.</p>
<p id="p-0088" num="0087">In one embodiment of process <b>800</b>, hotel TV <b>154</b> may be a trusted device, or at least a partially trusted device, in that it may be trusted to purge credentials. In some situations, however, devices (such as hotel TV <b>154</b>) may not be trusted to purge credentials. <figref idref="DRAWINGS">FIG. 9</figref> addresses an untrusted (or a less trusted) device attaching to personal network <b>100</b>.</p>
<p id="p-0089" num="0088"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart of another exemplary process <b>900</b> for one embodiment for authenticating and authorizing a guest device. Like process <b>600</b> and <b>800</b>, process <b>900</b> may begin when the user of mobile phone <b>152</b> enters hotel room <b>252</b> and wants to use hotel TV <b>154</b> to view content from personal network <b>100</b>, e.g., video content from home server <b>118</b>. Hotel TV <b>154</b>, however, may not be part of personal network <b>100</b> and, as such, may not have access to content in home server <b>118</b>.</p>
<p id="p-0090" num="0089">Information about the personal network may be sent to a guest device (block <b>902</b>). For example, mobile phone <b>152</b> may send information regarding personal network <b>100</b> to hotel TV <b>154</b> via link <b>702</b>. Such information may include the IP address of proxy server <b>104</b>. Credentials may be generated (block <b>904</b>). Mobile phone <b>152</b> may generate credentials that may allow hotel TV <b>154</b> to be authenticated by proxy server <b>104</b>. In this example, the credentials may include an expiration date or may be such that an expiration date is understood by proxy server <b>104</b>. The credentials may also include information regarding the privileges (e.g., GUEST, TEMPORARY, etc.) that personal network <b>100</b> should grant to the guest device, e.g., hotel TV <b>154</b> for privilege table <b>500</b>. In this example, the information regarding the privileges may be encrypted or otherwise unalterable by hotel TV <b>154</b>. The generated credentials may be sent to the guest device (block <b>906</b>). In this embodiment, mobile phone <b>152</b> may send the credentials generated at block <b>904</b> to hotel TV <b>154</b> via link <b>702</b>.</p>
<p id="p-0091" num="0090">Using the credentials and the information about personal network <b>100</b>, the guest device may be authenticated and authorized to access personal network <b>100</b> (block <b>908</b>). In this example, having received the credentials from mobile phone <b>152</b> and having the connection information for proxy server <b>104</b>, hotel TV <b>154</b> may be authenticated by proxy server <b>104</b> via link <b>704</b>. The guest device may access personal network <b>100</b> and personal network <b>100</b> may provide services (block <b>910</b>) during the guest session. In this example, after authentication, hotel TV <b>154</b> may access content from home server <b>118</b> for the user of mobile phone <b>152</b> to watch, for example, via guest session <b>706</b>.</p>
<p id="p-0092" num="0091">Access by hotel TV <b>154</b> to personal network <b>100</b> may be limited, however. Personal network <b>100</b> may, in one embodiment, grant only the privileges to hotel TV <b>154</b> indicated in the privilege information received with the credentials from hotel TV <b>154</b> (which hotel TV <b>154</b> received from mobile phone <b>152</b>). In addition to GUEST privileges, hotel TV <b>154</b> may also be granted TEMPORARY privileges in accordance with device table <b>400</b> (record <b>470</b>). In one embodiment, TEMPORARY privileges may be defined in privilege table <b>500</b> in terms of an expiration time, such as when the credentials for hotel TV <b>154</b> expire. In this example, hotel TV <b>154</b> may only access personal network <b>100</b> until the expiration listed in permissions field <b>504</b> of privilege table <b>500</b>, for example.</p>
<p id="p-0093" num="0092">Proxy server <b>104</b> and/or hotel TV <b>154</b> may cancel authentication and access, e.g., end the guest session, when the credentials provided by the guest device expire. In one embodiment, if the credentials have not expired (block <b>912</b>: NO), the guest device may be re-authenticated and re-authorized to access personal network <b>100</b> (block <b>908</b>). For example, personal network <b>100</b> may re-authenticate and re-authorize the guest device for each received packet. If the credentials have not expired (block <b>912</b>: NO), the guest device may continue to provide services in the guest session (block <b>910</b>). If the credentials have expired (block <b>912</b>: YES), the credentials may be requested again by the guest device (block <b>914</b>). If the master device (e.g., mobile phone <b>152</b> in this example) is not present (block <b>916</b>: NO), then the guest session may be ended (block <b>918</b>) because new credentials cannot be received. In this example, if mobile phone <b>152</b> is not present in hotel room <b>252</b> and/or hotel TV <b>154</b> does not receive credentials from mobile phone <b>152</b>, then hotel TV <b>154</b> and/or proxy server <b>104</b> may end guest session <b>706</b>.</p>
<p id="p-0094" num="0093">If the master device is present (block <b>916</b>: YES), then credentials may be regenerated (block <b>904</b>) and sent to the guest device again (block <b>906</b>). In this embodiment, if mobile phone <b>152</b> is present, then mobile phone <b>152</b> may send credentials to hotel TV <b>14</b>. The guest device may be re-authenticated and re-authorized (block <b>908</b>).</p>
<p id="p-0095" num="0094">Process <b>900</b> may require re-authentication and re-authorization on a periodic basis (due to expiring credentials), such as every minute or every hour, for example. In this example, however, guest device may not purge any received credentials. Instead, the credentials provide access for only a period of time.</p>
<p id="p-0096" num="0095">In some cases, common firewalls and NAT (Network Address Translation) routers may impede a proxy server. For example, proxy server <b>104</b> (or a firewall associated with proxy server <b>104</b>) may perform address filtering (e.g., Media Access Card (MAC) or Internet Protocol (IP) address filtering). In this situation, proxy server <b>104</b> may require information regarding the guest device. <figref idref="DRAWINGS">FIG. 10</figref> is a flowchart of an exemplary process <b>1000</b> for one embodiment for authenticating and authorizing a guest device. Process <b>1000</b> is described below with respect to the signals in <figref idref="DRAWINGS">FIG. 11</figref>.</p>
<p id="p-0097" num="0096">Like process <b>600</b>, <b>800</b>, and <b>900</b>, process <b>1000</b> may begin when the user of mobile phone <b>152</b> enters hotel room <b>252</b> and wants to use hotel TV <b>154</b> to view content from personal network <b>100</b>, e.g., video content from home server <b>118</b>. Hotel TV <b>154</b>, however, may not be part of personal network <b>100</b> and, as such, may not have access to content in home server <b>118</b>.</p>
<p id="p-0098" num="0097">Connection information may be received from the guest device (block <b>1002</b>). This information may include the IP address of hotel TV <b>154</b>, for example, requested by mobile phone <b>152</b>. Connection information about the guest device may be sent to the proxy server (block <b>1004</b>). In this case, mobile phone <b>152</b> may connect with proxy server <b>104</b> via a link <b>1102</b> to send the connection information about the guest device. The connection information may also include information regarding the privileges (e.g., GUEST, TEMPORARY, etc.) that should be afforded the guest device, e.g., hotel TV <b>154</b>, for device table <b>500</b>. During this connection, mobile phone <b>152</b> may also receive credentials from proxy server <b>104</b> to establish a guest session between hotel TV <b>154</b> and personal network <b>100</b>. Link <b>1102</b> may also be used by proxy server <b>104</b> to verify, with mobile phone <b>152</b>, the adding of the guest device, e.g., hotel TV <b>154</b> to personal network <b>100</b>. In one embodiment, link <b>1102</b> may pass through hotel TV <b>154</b> and may act as an encrypted channel between mobile phone <b>152</b> and proxy server <b>104</b>.</p>
<p id="p-0099" num="0098">Information about personal network <b>100</b> may be sent to the guest device (block <b>1006</b>). As with process <b>600</b>, mobile phone <b>152</b> may send information regarding personal network <b>100</b> to hotel TV <b>154</b> via link <b>702</b>. Such information may include the IP address of proxy server <b>104</b>. Credentials may be generated (block <b>1008</b>). In one embodiment, mobile phone <b>152</b> may generate credentials that may allow hotel TV <b>154</b> to be authenticated by proxy server <b>104</b>. In another embodiment, the credentials required by hotel TV <b>154</b> may already exist in mobile phone <b>152</b>. In yet embodiment, the credentials may include the credentials received from home proxy <b>104</b> in block <b>1004</b>. In yet another embodiment, the credentials may include one or more of the above generated or received credentials. In one embodiment, the credentials may also include information regarding the privileges (e.g., GUEST) that should be afforded the guest device, e.g., hotel TV <b>154</b> for privilege table <b>500</b> if such privilege information was not sent to home proxy in block <b>1004</b>. Credentials may be sent to the guest device (block <b>1010</b>). So that hotel TV <b>154</b> may access personal network <b>100</b>, mobile phone <b>152</b> may send the credentials to hotel TV <b>154</b> via link <b>702</b>.</p>
<p id="p-0100" num="0099">Using the credentials and the connection information, the guest device may be authenticated and authorized to access the personal network (block <b>1012</b>). Having received the credentials from mobile phone <b>152</b> and having the connection information for proxy server <b>104</b>, hotel TV <b>154</b> may be authenticated by proxy server <b>104</b> via link <b>704</b>. The guest device may access personal network <b>100</b> and may provide services (block <b>1014</b>) during guest session <b>706</b>. Hotel TV <b>154</b> may then access content from home server <b>118</b> for the user of mobile phone <b>152</b> to watch, for example. Authentication and access by the guest device may be canceled (block <b>1016</b>) and the guest session may be ended. For example, at some point, the user of mobile phone <b>152</b> may end the guest session for hotel TV <b>154</b> by communicating with hotel TV <b>154</b> and requesting an end to the guest session. The guest session may end using the methods from any of the processes above.</p>
<p id="p-0101" num="0100">Process <b>1000</b> may be used in combination with processes <b>600</b>, <b>800</b>, and <b>900</b>, and vice versa. For example, the credentials in process <b>1000</b> may be purged by hotel TV <b>154</b> (as in process <b>800</b>) or may expire (as in process <b>900</b>). Communication between mobile device <b>152</b> (e.g., a master device) and hotel TV <b>154</b> (e.g., a guest device) may take place using a wired connection (such as a USB cable, Ethernet cable, or Internet) or a wireless connection (such as a NFC connection or a short-range communication connection). Mobile device <b>152</b> (e.g., a master device) and hotel TV <b>154</b> (e.g., a guest device) may be remotely located from each other, e.g., across town, across a continent, etc. Communications between mobile device <b>152</b> and hotel TV <b>154</b> may also take place over a secure or encrypted connection.</p>
<heading id="h-0012" level="1">Conclusion</heading>
<p id="p-0102" num="0101">Embodiments described herein allow the authentication of devices in a personal network and allow the control of access to information and/or content in the personal network. Embodiments described herein may allow devices associated with the personal network and the services that these devices provide to the users to be defined. In addition, embodiments described herein may define devices permitted to access the services and content. Further, embodiments described herein may limit the time duration of privileges of devices' access to the personal network.</p>
<p id="p-0103" num="0102">The foregoing description of embodiments provides illustration and description, but is not intended to be exhaustive or to limit the invention to the precise form disclosed. Modifications and variations are possible in light of the above teachings.</p>
<p id="p-0104" num="0103">For example, while series of blocks have been described with regard to some figures, the order of the blocks may be modified in other embodiments. Further, non-dependent acts may be performed in parallel.</p>
<p id="p-0105" num="0104">The term comprises/comprising when used in this specification is taken to specify the presence of stated features, integers, steps or components but does not preclude the presence or addition of one or more other features, integers, steps, components or groups thereof.</p>
<p id="p-0106" num="0105">It will be apparent that aspects of the invention, as described above, may be implemented in many different forms of software, firmware, and hardware in the embodiments illustrated in the figures. The actual software code or specialized control hardware used to implement aspects consistent with principles of the invention is not limiting of the invention. Thus, the operation and behavior of the aspects were described without reference to the specific software code&#x2014;it being understood that one would be able to design software and control hardware to implement the aspects based on the description herein.</p>
<p id="p-0107" num="0106">No element, act, or instruction used in the present application should be construed as critical or essential to the invention unless explicitly described as such. Also, as used herein, the article &#x201c;a&#x201d; is intended to include one or more items. Where only one item is intended, the term &#x201c;one&#x201d; or similar language is used. Further, the phrase &#x201c;based on&#x201d; is intended to mean &#x201c;based, at least in part, on&#x201d; unless explicitly stated otherwise.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A system comprising:
<claim-text>a proxy associated with a personal network; and</claim-text>
<claim-text>a mobile communications device associated with the personal network, where the mobile communications device is to:
<claim-text>send personal network connection information to a guest device, the personal network connection information including an internet protocol (IP) address for the proxy;</claim-text>
<claim-text>generate authentication credentials, where the authentication credentials include a type of access granted to the guest device, the type of access including a privilege afforded to the guest device, the afforded privilege comprising at least one of a first privilege to receive output data from the personal network using the guest device or a second privilege to input data to the personal network using the guest device; and</claim-text>
<claim-text>send the authentication credentials to the guest device, where the guest device does not communicate with the proxy until the guest device receives both the personal network connection information and the authentication credentials;</claim-text>
<claim-text>where the proxy is to:
<claim-text>receive the authentication credentials from the guest device, and</claim-text>
<claim-text>authenticate the guest device based on the authentication credentials received from the guest device and authorize the guest device to access content stored in the personal network based at least partially on the type of access granted to the guest device,</claim-text>
</claim-text>
</claim-text>
<claim-text>where the authentication credentials are first authentication credentials and include information indicative of a first expiration time,</claim-text>
<claim-text>where, prior to the first expiration time, the proxy re-authenticates the guest device based on the first authentication credentials,</claim-text>
<claim-text>where, after the first expiration time, the mobile communications device, in response to receiving a request for credentials from the guest device, generates second authentication credentials and transmits the second authentication credentials to the guest device, where the second authentication credentials include a second expiration time after which the second authentication credentials are not valid, and</claim-text>
<claim-text>where, prior to the second expiration time, the proxy re-authenticates the guest device based on the second authentication credentials.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>where the guest device purges the first authentication credentials after the proxy authenticates the guest device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, where the second authentication credentials are different from the first authentication credentials.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, where the proxy limits access, by the guest device, to content stored on the personal network, based on the privilege afforded to the guest device or privilege information stored in the proxy.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, where, prior to the guest device communicating with the proxy, the mobile communications device is to send connection information about the guest device to the proxy; and receive credentials from the proxy.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, where a transmitter of the mobile communications device includes one or more of a short-range communications transmitter or a near field communication transmitter.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The system of <claim-ref idref="CLM-00006">claim 6</claim-ref>, where the proxy requires information about the guest device in order for the guest device to initiate communication with the proxy.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, where the transmitter of the mobile communications device includes one or more of a short-range communications transmitter or a near field communication transmitter.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, where a first type of access granted to the guest device is guest access such that the guest device has access to files on the personal network that are not tagged as confidential, and where a second type of access granted to the guest device is temporary access such that the guest device is re-authenticated by the proxy at least once during a predetermined period.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, where a third type of access granted to the guest device is full access such that the guest device has access to confidential and non-confidential files on the personal network.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A method comprising:
<claim-text>in response to a proxy server in a personal network requiring information about a guest device:
<claim-text>requesting, by a mobile communications device associated with the personal network, connection information from the guest device;</claim-text>
<claim-text>receiving, at the mobile communications device, first connection information about the guest device;</claim-text>
<claim-text>sending, from the mobile communications device, to the proxy server in the personal network, the first connection information about the guest device, where the first connection information is sent via a link that includes the guest device and that acts as an encrypted channel;</claim-text>
<claim-text>sending, by the mobile communications device to the guest device, second connection information about the proxy server in the personal network, the second connection information including an internet protocol (IP) address for the proxy server;</claim-text>
<claim-text>generating, by the mobile communications device, authentication credentials for the guest device;</claim-text>
<claim-text>sending, by the mobile communications device to the guest device, the authentication credentials, where the authentication credentials are used by the proxy server to authenticate the guest device in the personal network and limit the guest device to access, based on a type of access included in the authentication credentials, content stored in the personal network for a guest session, where the guest device does not communicate with the proxy server until the guest device receives both the second connection information and the authentication credentials, the type of access including a privilege afforded to the guest device, the afforded privilege comprising at least one of a first privilege to receive output data from the personal network using the guest device or a second privilege to input data to the personal network using the guest device; and</claim-text>
<claim-text>verifying, by the mobile communications device and via the link, the guest device being added to the personal network,</claim-text>
</claim-text>
<claim-text>where the authentication credentials are first authentication credentials and include information indicative of a first expiration time,</claim-text>
<claim-text>where, prior to the first expiration time, the proxy server re-authenticates the guest device based on the first authentication credentials; and</claim-text>
<claim-text>after the first expiration time, in response to receiving a request for credentials from the guest device, generating, by the mobile communications device, second authentication credentials and transmitting the second authentication credentials to the guest device, where the second authentication credentials include a second expiration time after which the second authentication credentials are not valid,</claim-text>
<claim-text>where, prior to the second expiration time, the proxy server re-authenticates the guest device based on the second authentication credentials.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising:
<claim-text>in response to a second proxy server in the personal network not requiring information about the guest device:
<claim-text>sending, by the mobile communications device to the guest device, the second connection information about the second proxy server in the personal network;</claim-text>
<claim-text>generating, by the mobile communications device, second authentication credentials for the guest device; and</claim-text>
<claim-text>sending, by the mobile communications device to the guest device, the second authentication credentials, where the second authentication credentials are used by the second proxy server to authenticate the guest device in the personal network and limit the guest device to access content stored in the personal network based on a type of access included in the second authentication credentials.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, where a first type of access granted to the guest device is guest access such that the guest device has access to files on the personal network that are not tagged as confidential, and where a second type of access granted to the guest device is temporary access such that the guest device is re-authenticated by the proxy server at least once during a predetermined period.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, where a third type of access granted to the guest device is full access such that the guest device has access to confidential and non-confidential files on the personal network.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>,
<claim-text>where the guest device purges the first authentication credentials after the proxy server authenticates the guest device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, where the second authentication credentials are different from the first authentication credentials.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, where sending the authentication credentials includes transmitting the authentication credentials with a short-range communication transmitter or a near field communication transmitter.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, where generating the authentication credentials includes:
<claim-text>generating the first authentication credentials, and</claim-text>
<claim-text>receiving third authentication credentials from the proxy server in the personal network,</claim-text>
<claim-text>where sending the authentication credentials includes sending the first authentication credentials and the third authentication credentials.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A non-transitory computer-readable medium including instructions executable by at least one processor, the computer-readable medium comprising:
<claim-text>one or more instructions to determine that a proxy server in a personal network requires information about a guest device not associated with the personal network;</claim-text>
<claim-text>one or more instructions to request, by a mobile communications device associated with the personal network, connection information from the guest device;</claim-text>
<claim-text>one or more instructions to receive, at the mobile communications device, first connection information about the guest device;</claim-text>
<claim-text>one or more instructions to send, from the mobile communications device to the proxy server in the personal network and via a link that includes the guest device and that acts as an encrypted channel, the first connection information about the guest device;</claim-text>
<claim-text>one or more instructions to send, from the mobile communications device to the guest device, second connection information about the proxy server in the personal network, the second connection information including an internet protocol (IP) address for the proxy server;</claim-text>
<claim-text>one or more instructions to generate, by the mobile communications device authentication credentials for the guest device;</claim-text>
<claim-text>one or more instructions to send, from the mobile communications device to the guest device, the authentication credentials, where the authentication credentials are used to authenticate the guest device in the personal network and limit the guest device to access, based on a type of access included in the authentication credentials, content stored in the personal network during a guest session, where the guest device does not communicate with the proxy server until the guest device receives both the second connection information and the authentication credentials, the type of access including a privilege afforded to the guest device, the afforded privilege comprising at least one of a first privilege to receive output data from the personal network using the guest device or a second privilege to input data to the personal network using the guest device; and</claim-text>
<claim-text>one or more instructions to receive, from the proxy server in the personal network and via the link, verification regarding whether the guest device is added to the personal network,</claim-text>
<claim-text>where the authentication credentials are first authentication credentials and include information indicative of a first expiration time,</claim-text>
<claim-text>where, prior to the first expiration time, the proxy server re-authenticates the guest device based on the first authentication credentials; and</claim-text>
<claim-text>after the first expiration time, in response to receiving a request for credentials from the guest device, one or more instructions to generate, at the mobile communications device, second authentication credentials and transmit the second authentication credentials to the guest device, where the second authentication credentials include a second expiration time after which the second authentication credentials are not valid,</claim-text>
<claim-text>where, prior to the second expiration time, the proxy server re-authenticates the guest device based on the second authentication credentials.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The computer-readable medium of <claim-ref idref="CLM-00019">claim 19</claim-ref>, further comprising:
<claim-text>one or more instructions to determine that a second proxy server in the personal network does not require information about the guest device not associated with the personal network;</claim-text>
<claim-text>one or more instructions to send, by the mobile communications device to the guest device, the second connection information about the second proxy server in the personal network;</claim-text>
<claim-text>one or more instructions to generate, by the mobile communications device, second authentication credentials for the guest device;</claim-text>
<claim-text>one or more instructions to send, by the mobile communications device to the guest device, the second authentication credentials, where the second authentication credentials are used by the second proxy server to authenticate the guest device in the personal network and limit the guest device to access content stored in the personal network based on a type of access included in the second authentication credentials.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The computer-readable medium of <claim-ref idref="CLM-00019">claim 19</claim-ref>, where the personal network includes a DNLA (Digital Network Living Alliance) network.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The computer-readable medium of <claim-ref idref="CLM-00019">claim 19</claim-ref>, where the guest device includes a hotel television in a hotel room.</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353053-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353053</doc-number>
<kind>B1</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12102526</doc-number>
<date>20080414</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>630</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>7</main-group>
<subgroup>04</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>16</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>12</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>12</main-group>
<subgroup>14</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>13</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>7</main-group>
<subgroup>16</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>32</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 30</main-classification>
<further-classification>726 29</further-classification>
<further-classification>726  9</further-classification>
<further-classification>726 20</further-classification>
<further-classification>713159</further-classification>
<further-classification>713172</further-classification>
<further-classification>713185</further-classification>
<further-classification>707781</further-classification>
</classification-national>
<invention-title id="d2e53">Computer program product and method for permanently storing data based on whether a device is protected with an encryption mechanism and whether data in a data structure requires encryption</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6367019</doc-number>
<kind>B1</kind>
<name>Ansell et al.</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6658566</doc-number>
<kind>B1</kind>
<name>Hazard</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713172</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6820204</doc-number>
<kind>B1</kind>
<name>Desai et al.</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  6</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6957330</doc-number>
<kind>B1</kind>
<name>Hughes</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713163</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7194623</doc-number>
<kind>B1</kind>
<name>Proudler et al.</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713164</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7257707</doc-number>
<kind>B2</kind>
<name>England et al.</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713164</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7278016</doc-number>
<kind>B1</kind>
<name>Detrick et al.</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713  2</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7346778</doc-number>
<kind>B1</kind>
<name>Guiter et al.</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713182</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7350074</doc-number>
<kind>B2</kind>
<name>Gupta et al.</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713157</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7350084</doc-number>
<kind>B2</kind>
<name>Abiko et al.</name>
<date>20080300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713193</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7461249</doc-number>
<kind>B1</kind>
<name>Pearson et al.</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713156</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>7526654</doc-number>
<kind>B2</kind>
<name>Charbonneau</name>
<date>20090400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713188</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7653811</doc-number>
<kind>B2</kind>
<name>Yagiura</name>
<date>20100100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713166</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>7730040</doc-number>
<kind>B2</kind>
<name>Reasor et al.</name>
<date>20100600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707690</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>7877616</doc-number>
<kind>B2</kind>
<name>Abiko et al.</name>
<date>20110100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713193</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>8151363</doc-number>
<kind>B2</kind>
<name>Smithson</name>
<date>20120400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 30</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2004/0010686</doc-number>
<kind>A1</kind>
<name>Goh et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2004/0199566</doc-number>
<kind>A1</kind>
<name>Carlson et al.</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>2005/0289181</doc-number>
<kind>A1</kind>
<name>Deninger et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>7071041</main-classification></classification-national>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>2007/0074292</doc-number>
<kind>A1</kind>
<name>Mimatsu</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>2007/0094394</doc-number>
<kind>A1</kind>
<name>Singh et al.</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709226</main-classification></classification-national>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>2007/0101419</doc-number>
<kind>A1</kind>
<name>Dawson</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  9</main-classification></classification-national>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2007/0110089</doc-number>
<kind>A1</kind>
<name>Essafi et al.</name>
<date>20070500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370420</main-classification></classification-national>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2007/0136593</doc-number>
<kind>A1</kind>
<name>Plavcan et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713172</main-classification></classification-national>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2007/0245148</doc-number>
<kind>A1</kind>
<name>Buer</name>
<date>20071000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713182</main-classification></classification-national>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2008/0279381</doc-number>
<kind>A1</kind>
<name>Narendra et al.</name>
<date>20081100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380270</main-classification></classification-national>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2011/0167265</doc-number>
<kind>A1</kind>
<name>Ahuja et al.</name>
<date>20110700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</citation>
<citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2012/0011189</doc-number>
<kind>A1</kind>
<name>Werner et al.</name>
<date>20120100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709202</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00029">
<othercit>U.S. Appl. No. 11/840,831, filed Aug. 17, 2007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>17</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 30</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>7</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Chebiyyam</last-name>
<first-name>Gopi Krishna</first-name>
<address>
<city>Hyderabad</city>
<country>IN</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>IN</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Wong, Cabello, Lutsch, Rutherford, &#x26; Brucculeri, LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>McAfee, Inc.</orgname>
<role>02</role>
<address>
<city>Santa Clara</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kosowski</last-name>
<first-name>Carolyn B</first-name>
<department>2431</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A data loss prevention system, method, and computer program product are provided for determining whether a device is protected with an encryption mechanism before storing data thereon. In operation, data to be stored on a device is identified. Additionally, it is determined whether the device is protected with an encryption mechanism. Furthermore, there is conditional reaction, based on the determination.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="151.55mm" wi="125.14mm" file="US08353053-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="197.02mm" wi="157.65mm" file="US08353053-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="134.20mm" wi="162.14mm" file="US08353053-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="175.94mm" wi="125.05mm" file="US08353053-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="149.18mm" wi="194.65mm" file="US08353053-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="235.03mm" wi="191.26mm" file="US08353053-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="231.14mm" wi="186.77mm" file="US08353053-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="200.07mm" wi="189.74mm" file="US08353053-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates to data loss prevention systems, and more particularly to data loss prevention systems that employ encryption mechanisms to prevent data loss.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Mobile devices such as personal digital assistants (PDAs), laptops and Smartphones are now often being used as a replacement for personal computers (PCs) in many organizations. In many cases, sensitive information associated with the organization (e.g. files, folders, etc.) may be stored on these devices. Additionally, because mobile devices often have the ability to connect to network resources intermittently, monitoring the devices, corresponding software, and stored data is a daunting security management task.</p>
<p id="p-0004" num="0003">Mobile devices by nature are small, easily misplaced, and are attractive to criminal elements looking for sensitive information on unprotected machines. Thus, sensitive business information and documents are now at risk and the threats that need to be addressed with these converged devices are nearly equivalent to those of the PC. However, mobile devices often offer separate and additional functionality not found on PCs that should also be considered when addressing information security issues.</p>
<p id="p-0005" num="0004">Furthermore, organizations and security professional are continuously tasked with finding better solutions for data loss prevention (DLP). Though some solutions are currently available, these solutions do not address every problems associated with DLP. For example, if a non-encrypted device is lost or stolen, unauthorized users may have the ability to view confidential data on that device, leading to data loss.</p>
<p id="p-0006" num="0005">There is thus a need for overcoming these and/or other issues associated with the prior art.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0007" num="0006">A data loss prevention system, method, and computer program product are provided for determining whether a device is protected with an encryption mechanism before storing data (confidential or non-confidential) thereon. In operation, data to be stored on a device is identified. Additionally, it is determined whether the device is protected with an encryption mechanism. Furthermore, there is conditional reaction, based on the determination. Whenever data loss is prevented, event(s) corresponding to such an occurrence may be sent to a management platform/console. Reports/graphs may be generated using that information. Trends may be obtained using those reports. Optionally, organizational level policies may also be envisaged/conceived using such information.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a network architecture, in accordance with one embodiment.</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 2</figref> shows a representative hardware environment that may be associated with the servers and/or clients of <figref idref="DRAWINGS">FIG. 1</figref>, in accordance with one embodiment.</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 3</figref> shows a method for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with one embodiment.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 4</figref> shows a system for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with one embodiment.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 5</figref> shows a method for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with another embodiment.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 6</figref> shows a method for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with another embodiment.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 7</figref> shows a system for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with another embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a network architecture <b>100</b>, in accordance with one embodiment. As shown, a plurality of networks <b>102</b> is provided. In the context of the present network architecture <b>100</b>, the networks <b>102</b> may each take any form including, but not limited to a local area network (LAN), a wireless network, a wide area network (WAN) such as the Internet, peer-to-peer network, etc.</p>
<p id="p-0016" num="0015">Coupled to the networks <b>102</b> are servers <b>104</b> which are capable of communicating over the networks <b>102</b>. Also coupled to the networks <b>102</b> and the servers <b>104</b> is a plurality of clients <b>106</b>. Such servers <b>104</b> and/or clients <b>106</b> may each include a desktop computer, lap-top computer, hand-held computer, mobile phone, personal digital assistant (PDA), peripheral (e.g. printer, etc.), any component of a computer, and/or any other type of logic. In order to facilitate communication among the networks <b>102</b>, at least one gateway <b>108</b> is optionally coupled therebetween.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> shows a representative hardware environment that may be associated with the servers <b>104</b> and/or clients <b>106</b> of <figref idref="DRAWINGS">FIG. 1</figref>, in accordance with one embodiment. Such figure illustrates a typical hardware configuration of a workstation in accordance with one embodiment having a central processing unit <b>210</b>, such as a microprocessor, and a number of other units interconnected via a system bus <b>212</b>.</p>
<p id="p-0018" num="0017">The workstation shown in <figref idref="DRAWINGS">FIG. 2</figref> includes a Random Access Memory (RAM) <b>214</b>, Read Only Memory (ROM) <b>216</b>, an I/O adapter <b>218</b> for connecting peripheral devices such as disk storage units <b>220</b> to the bus <b>212</b>, a user interface adapter <b>222</b> for connecting a keyboard <b>224</b>, a mouse <b>226</b>, a speaker <b>228</b>, a microphone <b>232</b>, and/or other user interface devices such as a touch screen (not shown) to the bus <b>212</b>, communication adapter <b>234</b> for connecting the workstation to a communication network <b>235</b> (e.g., a data processing network) and a display adapter <b>236</b> for connecting the bus <b>212</b> to a display device <b>238</b>.</p>
<p id="p-0019" num="0018">The workstation may have resident thereon any desired operating system. It will be appreciated that an embodiment may also be implemented on platforms and operating systems other than those mentioned. One embodiment may be written using JAVA, C, and/or C++ language, or other programming languages, along with an object oriented programming methodology. Object oriented programming (OOP) has become increasingly used to develop complex applications.</p>
<p id="p-0020" num="0019">Of course, the various embodiments set forth herein may be implemented utilizing hardware, software, or any desired combination thereof. For that matter, any type of logic may be utilized which is capable of implementing the various functionality set forth herein.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 3</figref> shows a method <b>300</b> for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with one embodiment. As an option, the method <b>300</b> may be implemented in the context of the architecture and environment of <figref idref="DRAWINGS">FIGS. 1</figref> and/or <b>2</b>. Of course, however, the method <b>300</b> may be carried out in any desired environment.</p>
<p id="p-0022" num="0021">As shown, data to be stored on a device is identified. See operation <b>302</b>. In this case, a device refers to any device capable of storing data. For example, in various embodiments, the device may include, but is not limited to, a phone, a PDA, a handheld computer, a notebook computer, a desktop computer, removable memory, a printer, and/or any other device that meets the above definition. In one embodiment, the device may include a mobile device.</p>
<p id="p-0023" num="0022">Additionally, in the context of the present description, data refers to any data capable of being stored on a device. For example, in various embodiments, the data may include, but is not limited to, files, folders, documents, images, confidential information, and/or any other data capable of being stored on a device.</p>
<p id="p-0024" num="0023">As shown further, it is determined whether the device is protected with an encryption mechanism. See operation <b>304</b>. In the context of the present description, an encryption mechanism refers to any mechanism capable of encryption. For example, in one embodiment, the encryption mechanism may include computer code for encrypting files and/or folders and/or the hard disk.</p>
<p id="p-0025" num="0024">Furthermore, there is conditional reaction based on the determination. See operation <b>306</b>. In this case, the reaction may include any number of reactions. For example, in various embodiments, the reacting may include, but is not limited to, preventing storage of data on the device, displaying a message utilizing the device, sending a message to an administrator, logging the data, logging the incident/occurrence, and/or any other reaction. In one embodiment, the reaction may be conditionally performed, based on whether the data requires encryption.</p>
<p id="p-0026" num="0025">As an option, the reacting may also include asking the user to obtain a token from the authority concerned (e.g. an administrator) to allow such a storage of data temporarily. As another option, the reacting may include sending at least one event to a management platform/console. In this case, reports/graphs may be generated using that information. Additionally, trends may be obtained using those reports. Optionally, organizational level policies may also be envisaged/conceived using such information.</p>
<p id="p-0027" num="0026">More illustrative information will now be set forth regarding various optional architectures and features with which the foregoing technique may or may not be implemented, per the desires of the user. It should be strongly noted that the following information is set forth for illustrative purposes and should not be construed as limiting in any manner. Any of the following features may be optionally incorporated with or without the exclusion of other features described.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 4</figref> shows a system <b>400</b> for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with one embodiment. As an option, the system <b>400</b> may be implemented in the context of the architecture and environment of <figref idref="DRAWINGS">FIGS. 1-3</figref>. Of course, however, the system <b>400</b> may be implemented in any desired environment. It should also be noted that the aforementioned definitions may apply during the present description.</p>
<p id="p-0029" num="0028">As shown, a host device <b>402</b> is provided, the host device <b>402</b> including a data loss prevention (DLP) system <b>404</b>. Additionally, a remote device <b>406</b> is provided. As an option, the remote device may include a DLP agent <b>408</b>.</p>
<p id="p-0030" num="0029">In operation, data to be stored on the host device <b>402</b> and/or the remote device <b>406</b> is identified. In this case, the data may be located on the remote device <b>406</b> or the host device <b>402</b>. As an option, the data may be identified in response to a request to store data from a remote location by the remote device <b>406</b>.</p>
<p id="p-0031" num="0030">As another option, the data may be identified in response to a request to store data at a remote location. For example, the host device <b>402</b> or the remote device <b>406</b> may make a request to store data on the requesting device or on the device receiving the request. In this case, the request may be a user initiated request from the host device <b>402</b> or the remote device <b>406</b>.</p>
<p id="p-0032" num="0031">Once the data has been identified, it is then determined whether the device where the data is to be stored is protected with an encryption mechanism. In one embodiment, an agent or system located on the device to which the data is to be stored may be used to determine whether the device is protected with an encryption mechanism. In another embodiment, an operating system of the device may be used to determine whether the device is protected with an encryption mechanism. For example, the operating system may be used to determine what processes are running on the device to determine whether the device is protected with an encryption mechanism.</p>
<p id="p-0033" num="0032">In still another embodiment, a program registry on the device may be used to determine whether the device is protected with an encryption mechanism. As another option, a lookup table may be used to determine whether the device is protected with an encryption mechanism. Additionally, a managing device or database may be used to manage a configuration of a plurality of devices. In this case, the managing device may be used to determine whether the device is protected with an encryption mechanism.</p>
<p id="p-0034" num="0033">Still yet, computer code may be utilized for determining whether the data requires encryption. For example, it may be determined whether the data requires the encryption, based on a policy. In various embodiments, policies may be created locally and/or created using a management platform/server/console and then deployed (pushed/pulled) to the agents. In this case, the policy may be configurable. In one case, an administrator may access an interface on a server for configuring the policy.</p>
<p id="p-0035" num="0034">In another embodiment, it may be determined whether the data requires the encryption, based on a data structure associated with the data. For example, certain defined data structures may be configured to require encryption. On the other hand, some data structures may be configured such that they do not require encryption. In still another embodiment, determining whether the data requires the encryption may be performed by the DLP agent <b>408</b> running on the remote device <b>406</b> or the DLP system <b>404</b> running on the host device <b>402</b>.</p>
<p id="p-0036" num="0035">It should be noted that the encryption mechanism may encrypt the data on the host device <b>402</b> and/or the remote device <b>406</b>. Thus, the encryption mechanism may require a user to log-in, and decrypt the data in response to the log-in. In various embodiments, the login information may include a password, unique identifier, and/or any other login information.</p>
<p id="p-0037" num="0036">Once it is determined whether the device where the data is to be stored is protected with an encryption mechanism, the DLP system <b>404</b> may conditionally react based on the determination. For example, the reaction may be conditionally performed, based on whether the data requires encryption.</p>
<p id="p-0038" num="0037">In this case, the reaction may include any number of reactions. For example, the reacting may include preventing storage of data on the device. As another example, the reacting may include displaying a message utilizing the device.</p>
<p id="p-0039" num="0038">Still yet, the reacting may include sending a message to an administrator. As another option, the reacting may include logging the data. As another option, the reacting may include logging the incident/occurrence. In one case, the data may include confidential data, and the reacting may be performed for preventing a loss of the confidential data.</p>
<p id="p-0040" num="0039">As an example, the DLP system <b>404</b> or DLP agent <b>408</b> may execute on an encrypted device. In this case, the encrypted device may be the host device <b>402</b>. When data is requested to be copied and/or saved onto the remote device <b>406</b> from the host device <b>402</b>, the host based DLP system <b>404</b> running on the host device <b>402</b> may determine whether the destination device (i.e. the remote device <b>406</b>) is encrypted with a device encryption mechanism. If the remote device <b>406</b> encrypted, the DLP system <b>404</b> may allow the copy and/or save.</p>
<p id="p-0041" num="0040">If the remote device <b>406</b> is not encrypted, the DLP system <b>404</b> may not allow the copy and/or save. Furthermore, a message may be displayed indicating that copy and/or save would be allowed if the destination device is encrypted using an encryption mechanism. In this case, the message may be displayed to a user who initiated the copy and/or save.</p>
<p id="p-0042" num="0041">As another example, the DLP system <b>404</b> or DLP agent <b>408</b> may execute on a non-encrypted device (e.g. the host device <b>402</b>). In this case, the DLP system <b>404</b> running on the host device <b>402</b> may determine whether the host device <b>402</b> is encrypted with a device encryption mechanism. If the host device <b>402</b> is encrypted, the DLP solution system <b>404</b> may allow the copy and/or save of data (e.g. an e-mail attachment, etc.) to the host system.</p>
<p id="p-0043" num="0042">If the host device <b>402</b> is not encrypted, the DLP system <b>404</b> may not allow the copy and/or save. Furthermore, a message may be displayed indicating that copy and/or save would be allowed if the host device is encrypted using an encryption mechanism. In this case, the message may be displayed to a user who initiated the copy/save.</p>
<p id="p-0044" num="0043">As another example, the DLP system <b>404</b> or DLP agent <b>408</b> may execute on a non-encrypted device (e.g. the host device <b>402</b>). When data is requested to be copied and/or saved onto the remote device <b>406</b> from the host device <b>402</b>, the host based DLP system <b>404</b> running on the host device <b>402</b> may determine whether the destination device (i.e. the remote device <b>406</b>) is encrypted with a device encryption mechanism. If the remote device <b>406</b> is encrypted, the DLP system <b>404</b> may allow the copy and/or save.</p>
<p id="p-0045" num="0044">If the remote device <b>406</b> is not encrypted, the DLP system <b>404</b> may not allow the copy and/or save. Furthermore, a message may be displayed indicating that copy and/or save would be allowed if the destination device is encrypted using an encryption mechanism. In this case, the message may be displayed to a user who initiated the copy and/or save.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 5</figref> shows a method <b>500</b> for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with another embodiment. As an option, the method <b>500</b> may be implemented in the context of the architecture and environment of <figref idref="DRAWINGS">FIGS. 1-4</figref>. Of course, however, the method <b>500</b> may be carried out in any desired environment. Again, the aforementioned definitions may apply during the present description.</p>
<p id="p-0047" num="0046">As shown, it is determined whether there is request to copy data to a remote device. See operation <b>502</b>. If there is a request to copy data to a remote device, a host data loss prevention system receives the request. See operation <b>504</b>.</p>
<p id="p-0048" num="0047">It is then determined whether the remote device is encrypted. See operation <b>506</b>. If it is determined that the remote device is not encrypted, the copying of the data to the remote device is prevented. See operation <b>508</b>. If it is determined that the remote device is encrypted, the copying of the data to the remote device is allowed. See operation <b>510</b>.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 6</figref> shows a method <b>600</b> for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with another embodiment. As an option, the method <b>600</b> may be implemented in the context of the architecture and environment of <figref idref="DRAWINGS">FIGS. 1-5</figref>. Of course, however, the method <b>600</b> may be carried out in any desired environment. Further, the aforementioned definitions may apply during the present description.</p>
<p id="p-0050" num="0049">As shown, it is determined whether there is request to copy data to a host device. See operation <b>602</b>. If there is a request to copy data to a host device, a host data loss prevention system receives the request. See operation <b>604</b>.</p>
<p id="p-0051" num="0050">It is then determined whether the host device is encrypted. See operation <b>606</b>. If it is determined that the host device is not encrypted, the copying of the data to the host device is prevented. See operation <b>608</b>. If it is determined that the host device is encrypted, the copying of the data to the host device is allowed. See operation <b>610</b>.</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 7</figref> shows a system <b>700</b> for determining whether a device is protected with an encryption mechanism before storing data thereon, in accordance with another embodiment. As an option, the system <b>700</b> may be implemented in the context of the architecture and environment of <figref idref="DRAWINGS">FIGS. 1-6</figref>. Of course, however, the system <b>700</b> may be implemented in any desired environment. Again, the aforementioned definitions may apply during the present description.</p>
<p id="p-0053" num="0052">As shown, a mobile device <b>702</b> is in communication with a short message service (SMS) carrier <b>704</b> over a network <b>706</b>. As shown further, the mobile device <b>702</b> is also in communication with a server <b>708</b>. Furthermore, an administration system <b>710</b> capable of configuring the server <b>708</b> and/or the mobile device <b>702</b> is also provided. As an option, the administration system <b>710</b> may communicate with the server <b>708</b> over a network <b>712</b>.</p>
<p id="p-0054" num="0053">In operation, the mobile device <b>702</b> may include an encryption mechanism. In this case, when a user has been authenticated on the mobile device <b>702</b>, files may be in plain text and fully viewable by the authorized user(s) and applications(s). For encryption purposes, the files may be translated into sectors and the sectors are encrypted in memory. The sectors may then be stored in non-volatile RAM (random access memory) of the mobile device <b>702</b>.</p>
<p id="p-0055" num="0054">In various embodiments, the encryption may occur on power down of the device, a logout, a mode change, a time out, or any other event where encryption may be desired. Using this encryption, non-authorized users may be restricted from access to files. Thus, a user may be required to enter authentication information on an authentication screen to decrypt the files.</p>
<p id="p-0056" num="0055">Upon authentication, the sectors are read from the non-volatile RAM of the mobile device <b>702</b>. The encrypted sectors may then be decrypted in memory and assembled into files. Upon assembly, the files may once again be fully viewable by the authorized user(s) and applications(s).</p>
<p id="p-0057" num="0056">In one embodiment, the encryption may include a fully transparent Advanced Encryption Standard (AES) Federal Information Processing Standards (FIPS) 256 bit encryption. In various embodiments, the encryption may include encrypting specified files/folders, e-mails, encryption of standard application databases such as contacts, calendars, speed dials, appointments, tasks, etc.</p>
<p id="p-0058" num="0057">In this case, the mobile device <b>702</b>, the server <b>708</b>, and/or the administration system <b>710</b> may include a DLP system. Thus, before data is copied and/or transferred to or from any of these devices, these devices may identify the data to be stored on the device, determine whether the device is protected with an encryption mechanism, and conditionally reacting based on the determination. Thus, the encryption mechanisms and the DLP systems on the devices may be used as a tiered security system directed at preventing data loss.</p>
<p id="p-0059" num="0058">Additionally, various data loss prevention methods may be utilized in conjunction with the encryption mechanism and the DLP systems on the devices. For example, in the case that the data includes an image, predetermined data within the image may be used for data loss prevention. More information regarding preventing image-related data loss may be found in U.S. patent application Ser. No. 11/840,831 entitled &#x201c;System, Method, And Computer Program Product For Preventing Image-Related Data Loss,&#x201d; filed on Aug. 17, 2007, which is incorporated herein by reference in its entirety.</p>
<p id="p-0060" num="0059">While various embodiments have been described above, it should be understood that they have been presented by way of example only, and not limitation. Thus, the breadth and scope of a preferred embodiment should not be limited by any of the above-described exemplary embodiments, but should be defined only in accordance with the following claims and their equivalents.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer program product embodied on a non-transitory computer readable medium, comprising computer executable instructions stored thereon to cause one or more processors to:
<claim-text>identify data to be permanently stored on a device;</claim-text>
<claim-text>determine the device is to be protected with an encryption mechanism;</claim-text>
<claim-text>determine the data is not eligible for permanent storage on the device, based on whether a data structure associated with the data requires encryption of the data;</claim-text>
<claim-text>obtain a token, based on the data not being eligible for permanent storage on the device;</claim-text>
<claim-text>use the encryption mechanism to encrypt the data; and</claim-text>
<claim-text>temporarily store the encrypted data on the device based on the token.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the device includes a mobile device.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the encryption mechanism encrypts the data on the device.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer program product of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the encryption mechanism requires a user to log-in, and decrypts the data in response to the log-in.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the instructions to cause one or more processors to determine the data is not eligible for permanent storage on the device comprise instructions to cause one or more processors to use a policy.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The computer program product of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the policy is configurable.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the instructions to cause one or more processors to determine the data is not eligible for permanent storage on the device comprise instructions to cause one or more processors to use a data structure associated with the data.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the instructions to cause one or more processors to identify the data comprise instructions executed in response to a request to store data from a remote location.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the instructions to cause one or more processors to identify the data comprise instructions executed in response to a request to store data at a remote location.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the instructions to cause one or more processors to determine the device is protected with an encryption mechanism comprise instructions performed by an agent running on the device.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising instructions to cause one or more processors to display a message utilizing the device.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising instructions to cause one or more processors to send a message to an administrator.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising instructions to cause one or more processors to log the act of temporarily storing the encrypted data.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising instructions to cause one or more processors to log an incident.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The computer program product of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising instructions to cause one or more processors to send at least one event to a management platform.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A method, comprising:
<claim-text>identifying, by a first device, data to be permanently stored on a second device;</claim-text>
<claim-text>determining, by the first device, the second device is protected with an encryption mechanism;</claim-text>
<claim-text>determining, by the first device, the data is not eligible for permanent storage on the second device, based on whether a data structure associated with the data requires encryption of the data;</claim-text>
<claim-text>obtaining a token, by the first device, based on the data not being eligible for permanent storage on the second device;</claim-text>
<claim-text>using the encryption mechanism, by the first device, to encrypt the data; and</claim-text>
<claim-text>temporarily storing, by the first device, the encrypted data on the second device based on the token.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the second device includes a mobile device. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353054-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353054</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12681429</doc-number>
<date>20081020</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>DE</country>
<doc-number>10 2007 000 589</doc-number>
<date>20071029</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>377</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>7</main-group>
<subgroup>04</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>11</main-group>
<subgroup>30</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>12</main-group>
<subgroup>14</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 30</main-classification>
<further-classification>726  9</further-classification>
<further-classification>713185</further-classification>
<further-classification>713190</further-classification>
<further-classification>380278</further-classification>
</classification-national>
<invention-title id="d2e71">Method for protection of a chip card from unauthorized use, chip card and chip card terminal</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5241599</doc-number>
<kind>A</kind>
<name>Bellovin et al.</name>
<date>19930800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6792533</doc-number>
<kind>B2</kind>
<name>Jablon</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7139917</doc-number>
<kind>B2</kind>
<name>Jablon</name>
<date>20061100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7831051</doc-number>
<kind>B2</kind>
<name>Zunke</name>
<date>20101100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380278</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0172137</doc-number>
<kind>A1</kind>
<name>Hopkins</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713185</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2007/0028118</doc-number>
<kind>A1</kind>
<name>Brown et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713185</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2010/0186076</doc-number>
<kind>A1</kind>
<name>Ali et al.</name>
<date>20100700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726  9</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2010/0287384</doc-number>
<kind>A1</kind>
<name>Hubert</name>
<date>20101100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713190</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>DE</country>
<doc-number>3523237</doc-number>
<kind>A1</kind>
<date>19870100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>DE</country>
<doc-number>19507043</doc-number>
<kind>A1</kind>
<date>19960900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>DE</country>
<doc-number>19507044</doc-number>
<kind>C2</kind>
<date>19960900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>DE</country>
<doc-number>19850307</doc-number>
<kind>C2</kind>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>DE</country>
<doc-number>10338643</doc-number>
<kind>A1</kind>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>EP</country>
<doc-number>0730253</doc-number>
<kind>B1</kind>
<date>19960900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Bruce Schneier, &#x201c;Applied Cryptography&#x201d; John Wiley &#x26; Sons, pp. 28-29 (1996).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>International Search Report for corresponding PCT application No. PCT/EP08/064116, dated Jul. 27, 2009.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>David P. Jablon; Strong Password-Only Authenticated Key Exchange; www.integritySciences.com (Mar. 2, 1997) www.jablon.org/speke97.html.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>www.heise.de/security/news/meldung/85024, (Feb. 8, 2007).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>National Institute of Standards and Technology (NIST) standard, NIST Special Publication 800-56A, pp. 1-114, Mar. 2007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>Standards for Efficient Cryptography, SEC1: Elliptic Curve Cryptography, Certicom Research, pp. 1-90, Sep. 20, 2000, Version 1.0.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>International Preliminary Report on Patentability and Written Opinion for corresponding PCT application No: PCT/EP08/064116, dated Jun. 22, 2010.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>13</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100223479</doc-number>
<kind>A1</kind>
<date>20100902</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Nguyen</last-name>
<first-name>Kim</first-name>
<address>
<city>Berlin</city>
<country>DE</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>DE</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Byszio</last-name>
<first-name>Frank</first-name>
<address>
<city>Wandlitz</city>
<country>DE</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>DE</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Dernier, Esq.</last-name>
<first-name>Matthew B.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<orgname>Gibson &#x26; Dernier LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Bundesdruckerei GmbH</orgname>
<role>03</role>
<address>
<city>Berlin</city>
<country>DE</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Chen</last-name>
<first-name>Shin-Hon</first-name>
<department>2431</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/EP2008/064116</doc-number>
<kind>00</kind>
<date>20081020</date>
</document-id>
<us-371c124-date>
<date>20100514</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2009/056463</doc-number>
<kind>A </kind>
<date>20090507</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method for protection of a chip card from unauthorized use includes: inputting a first identification into a chip card terminal, producing a cipher of at least one first communication parameter using a first symmetric key derived from the first identification, a protected first communication channel being definable between the chip card terminal and the chip card, using the communication parameter, transmitting the cipher via a predefined communication channel from the chip card terminal to the chip card, attempting to decrypt the cipher using a second symmetric key by means of the chip card, the result of decryption only being the first communication parameter if the first symmetric key is identical to the second symmetric key so that the protected first communication channel can only be defined between the chip card terminal and the chip card if the first identification is correct.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="166.20mm" wi="150.96mm" file="US08353054-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="161.12mm" wi="159.17mm" file="US08353054-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="180.59mm" wi="135.72mm" file="US08353054-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="171.03mm" wi="155.19mm" file="US08353054-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="188.81mm" wi="128.19mm" file="US08353054-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims priority to International Patent Application No.: PCT/EP2008/064116, filed Oct. 20, 2008, the entire disclosure of which is hereby incorporated by reference.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">The invention relates to a method for protecting a chip card from unauthorized use, to a chip card and to a chip card terminal.</p>
<p id="p-0004" num="0003">To enable a chip card function, prior user identification to the chip card may be necessary, as is known per se from the prior art. The most frequent user identification is the input of a secret identifier, which is generally referred to as a PIN (Personal Identification Number) or as CHV (Card Holder Verification). Such identifiers generally comprise a numeric or alphanumeric character string. For the purpose of user identification, the identifier is input by the user on the keypad of a chip card terminal or a computer to which a chip card reader is connected, and is then sent to the chip card. The latter compares the input identifier with the stored identifier and notifies the terminal or the computer of the result by outputting an appropriate signal.</p>
<p id="p-0005" num="0004">For the PINs, a distinction can be drawn between static PINs and changeable PINs. A static PIN cannot be altered by the user and needs to be memorized by him. If it has been revealed, the card user needs to destroy his chip card in order to prevent misuse by unauthorized parties, and needs to obtain a new chip card with a different static PIN. Similarly, the user requires a new chip card if he or she has forgotten the static PIN.</p>
<p id="p-0006" num="0005">A changeable PIN can be changed by the user as desired. To change the PIN, for security reasons it is always necessary to provide the currently valid PIN at the same time, since otherwise any current PIN could be replaced by a hacker's own PIN.</p>
<p id="p-0007" num="0006">The situation is different with what are known as Super PINs or PUKs (Personal Unlocking Key). These usually have more places than the actual PIN and are used to reset a PIN's incorrect input counter (also called &#x201c;incorrect operation counter&#x201d;) that is at its maximum value. With the PUK, a new PIN is also transferred to the chip card at the same time because a reset incorrect operation counter is of little use if the PIN has been forgotten. Moreover, this is usually the case, of course, when the incorrect operation counter has reached its maximum value.</p>
<p id="p-0008" num="0007">There are also applications which use transport PINs. The chip card is personalized using a random PIN which the card user received in a PIN letter. When it is first input, however, the chip card asks the card user to replace the personalized PIN with his own. In a similar method, called the &#x201c;zero PIN method&#x201d;, the chip card is preassigned a trivial PIN, such as &#x201c;0000&#x201d;, and the chip card likewise forces a change when it is first used (in this regard, cf. also DE 35 23 237 A1, DE 195 07 043 A1, DE 195 07 044 C2, DE 198 50 307 C2, EP 0 730 253 B1). Such methods provide what is known as a first user function, which provides the authorized user with the certainty that no unauthorized use of the chip card by a third party has taken place before he uses it for the first time.</p>
<p id="p-0009" num="0008">DE 198 50 307 C2 discloses a method for protecting against misuse in chip cards. The chip card has a first user function which, when the data and/or functions of the chip card are used for the first time, demands that a personal secret number (PIN) which can be selected arbitrarily by the user be prescribed, wherein the input of the personal secret number sets data and/or functions of the chip card to a used status. A later change to the personal secret number is made possible by means of a superordinate unlock code.</p>
<p id="p-0010" num="0009">The prior art has already disclosed methods for checking an identifier in which it is not necessary to transmit the identifier itself, such as Strong Password Only Authentication Key Exchange (SPEKE), Diffie-Hellman Encrypted Key Exchange (DH-EKE), Bellovin-Merritt protocol or Password Authenticated Connection Establishment (PACE). The SPEKE protocol is known from www.jablon.org/speke97.html, U.S. Pat. No. 6,792,533 B2 and U.S. Pat. No. 7,139,917 B2, for example. The DH-EKE protocol is likewise known from www.jablon.org/speke97.html, inter alia. The Bellovin-Merritt protocol is known from U.S. Pat. No. 5,241,599, inter alia. The PACE protocol, which is particularly suitable for elliptic curve cryptography, is known from www.heise.de/security/news/meldung/85024.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0011" num="0010">By contrast, the invention is based on the object of providing an improved method for protecting a chip card from unauthorized use. The invention is also based on the object of providing an improved chip card and an improved chip card terminal.</p>
<p id="p-0012" num="0011">The invention provides a method for protecting a chip card from unauthorized use. The method involves not only the chip card itself but also a chip card terminal.</p>
<p id="p-0013" num="0012">In this context, &#x201c;chip card terminal&#x201d; is understood to mean any appliance which is designed for communication with a chip card in order to send chip card commands to the chip card, for example, and to receive corresponding responses from the chip card. The communication between the chip card and the chip card terminal can take place in contact-based fashion, wirelessly, for example using an RFID method, or either in contact-based fashion or wirelessly, particularly using what is known as a dual-mode interface. The chip card terminal may be what is known as a class 1, 2 or 3 chip card reader with or without its own keypad or a computer to which a chip card reader is connected. The chip card terminal may also be a terminal provided for a particular purpose, such as a bank terminal for handling bank transactions, a payment terminal, for example for purchasing electronic tickets, or an access terminal for enabling access to a protected area.</p>
<p id="p-0014" num="0013">In this context, the term &#x201c;protection of a chip card&#x201d; is understood to mean the protection of the chip card as a whole or the protection of one or more chip card functions of the chip card. By way of example, the invention involves the protection of a chip card function which is particularly worthy of protection on the chip card, such as a signature function for generating an electronic signature, a payment function, an authentication function or the like.</p>
<p id="p-0015" num="0014">In accordance with one embodiment of the method according to the invention, the authorized user receives a secret identifier, which is generally referred to as a PIN, from the office issuing the chip card. To use the chip card, it is first of all necessary to input an identifier into the chip card terminal, said identifier subsequently being referred to as the PIN&#x2032;. Only if the PIN&#x2032; is identical to the PIN will use of the chip card or of the protected chip card function be possible.</p>
<p id="p-0016" num="0015">To this end, the chip card terminal produces a cipher from at least one first communication parameter using a first symmetric key. The first symmetric key may be the PIN&#x2032; itself or may be a symmetric key derived from the PIN&#x2032;. By way of example, the PIN&#x2032; is used as what is known as a seed value for the generation of the first symmetric key by the chip card terminal.</p>
<p id="p-0017" num="0016">The at least one communication parameter is of a nature such that it can define a protected first communication channel between the chip card terminal and the chip card. To be able to set up said protected first communication channel between the chip card and the chip card terminal, the cipher of the first communication parameter, which cipher is obtained using the first symmetric key, is first of all transmitted via a predefined communication channel from the chip card terminal to the chip card. Said predefined communication channel is thus defined as standard for setting up an initial communication between the chip card terminal and the chip card.</p>
<p id="p-0018" num="0017">Following the transmission of the cipher via said predefined communication channel from the chip card terminal to the chip card, the chip card attempts to decrypt said cipher using a second symmetric key. This decryption is successful only if the second symmetric key is the same as the first key, i.e. if the prerequisite PIN&#x2032;=PIN is met.</p>
<p id="p-0019" num="0018">A communication link can thus be set up via the protected first communication channel only if the condition PIN&#x2032;=PIN is met, since only in this case is the chip card provided with knowledge of the first communication parameter which allows the protected first communication channel to be stipulated.</p>
<p id="p-0020" num="0019">By way of example, the first communication parameter may be the specification of a transmission frequency, of a frequency hopping scheme, of a coding method and/or of a modulation method.</p>
<p id="p-0021" num="0020">If the condition PIN&#x2032;=PIN is not met, on the other hand, the first key derived from the PIN&#x2032; does not match the second key of the chip card. The result of this is that the decryption of the cipher received from the chip card terminal by the chip card using the second key does not yield the first communication parameter, but rather a second communication parameter, for example, which is different than the first communication parameter.</p>
<p id="p-0022" num="0021">The second communication parameter may have defined a second communication channel which is different than the first communication channel. If the chip card receives a signal on the first communication channel, said signal is ignored, however, since the chip card expects a signal on the second communication channel. As a result, there is thus no communication between the chip card terminal and the chip card if the condition PIN&#x2032;=PIN is not met.</p>
<p id="p-0023" num="0022">According to one embodiment of the invention, the communication parameter may be a public key from an asymmetric key pair of the chip card terminal. To stipulate a symmetric key for the communication between the chip card terminal and the chip card, for example using the Diffie-Hellman method, the public key of the chip card terminal is encrypted using the first symmetric key obtained from the first identifier and is sent to the chip card via the predefined communication channel.</p>
<p id="p-0024" num="0023">Only if the condition PIN&#x2032;=PIN is met does the chip card obtain the correct public key for the chip card terminal. The chip card terminal takes the public key of the chip card, which is requested from a key server, for example, and uses the Diffie-Hellman method to generate the third key, whereas the chip card generates a fourth key, likewise using the Diffie-Hellman method, from its private key and the cipher decrypted using the second symmetric key, wherein the fourth key is the same as the third key only if the condition PIN&#x2032;=PIN is met.</p>
<p id="p-0025" num="0024">The third and the identical fourth symmetric key are used for encrypting signals, particularly chip card commands and responses to such chip card commands, which are interchanged between the chip card terminal and the chip card via the first communication channel. Said first communication channel is at least additionally defined by means of the third key, which is used to encrypt the communication via the first communication channel using a symmetric encryption method.</p>
<p id="p-0026" num="0025">In accordance with one embodiment of the invention, a method of discrete logarithmic cryptography (DLC) is used for the generation of a third key by the chip card terminal and of a fourth key by the chip card, the fourth key being the same as the third key only if the condition PIN&#x2032;=PIN is met.</p>
<p id="p-0027" num="0026">The third key is stipulated using any method of discrete logarithmic cryptography, in principle, as are described by way of example in the National Institute of Standards and Technology (NIST) standard, NIST Special Publication 800-56A, March 2007, and in Standards for Efficient Cryptography, SEC1: Elliptic Curve Cryptography, Certicom Research, Sep. 20, 2000, Version 1.0. Such methods require the production of what are known as domain parameters for the purpose of the generation of the identical third and fourth keys by the chip card terminal or the chip card.</p>
<p id="p-0028" num="0027">In accordance with one embodiment of the invention, the DLC used is a method for elliptic curve cryptography (ECC), particularly Elliptic Curve Diffie-Hellman (ECDH).</p>
<p id="p-0029" num="0028">In accordance with one embodiment of the invention, the first identifier, i.e. the PIN&#x2032;, which is input into the chip card terminal is used as what is known as a seed value for the derivation of the first symmetric key. This produces a key of greater length than would be the case if the first identifier were used directly as a key.</p>
<p id="p-0030" num="0029">In accordance with one embodiment of the invention, the chip card stores a second identifier, i.e. the PIN, from which it is possible to derive the second key for the decryption of the cipher initially received from the chip card terminal. The second key can be derived from the second identifier using the second identifier as a seed value.</p>
<p id="p-0031" num="0030">In accordance with one embodiment of the invention, it is not the PIN itself which is stored in the chip card but rather only the second key. The second key is preferably stored in a nonvolatile protected memory area of the chip card. In contrast to the prior art, it is thus not necessary to store the PIN as a reference value in the chip card.</p>
<p id="p-0032" num="0031">In accordance with one embodiment of the invention, the chip card has an incorrect operation counter. If incorrect input of the PIN&#x2032; means that the first and second communication channels do not match, the chip card increments or decrements the incorrect operation counter with every message which the chip card receives on a communication channel other than the second or the predefined communication channel. Such messages which the chip card receives on a communication channel other than the second or the predefined communication channel are otherwise ignored by the chip card. If the number of incorrect operations exceeds a prescribed threshold value, the chip card as a whole or a particular chip card function is reversibly or irreversibly locked.</p>
<p id="p-0033" num="0032">In accordance with one embodiment of the invention, the chip card has a first-user function. The unused chip card is in its first-use state, in which a particular communication parameter is stipulated for a first selection of the first communication channel. The chip card changes from its first-use state to a used state when it receives a chip card command on said first communication channel for the first time. For further use of the chip card, the chip card terminal then needs to select another communication parameter.</p>
<p id="p-0034" num="0033">In a further aspect, the invention relates to a chip card with a chip card having an interface for communication with a chip card terminal via a predefined communication channel and a plurality of further communication channels, means for the decryption of a cipher received on the predefined channel, which cipher has been encrypted using a first symmetric key, using a second symmetric key, wherein the decryption yields at least one communication parameter if a first identifier which has been input into the chip card terminal previously is correct, wherein the communication parameter explicitly stipulates one of the further communication channels for the protected communication between the chip card and the chip card terminal.</p>
<p id="p-0035" num="0034">In a further aspect, the invention relates to a chip card terminal having means for the input of a first identifier, means for the production of a cipher from at least one first communication parameter using a first symmetric key derived from the first identifier, wherein the communication parameter can be used to define a protected first communication channel between the chip card terminal and the chip card, and means for sending the cipher to the chip card via a predefined communication channel.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0036" num="0035">Embodiments of the invention are explained in more detail below with reference to the drawings, in which:</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 1</figref> shows a block diagram of a first embodiment of a chip card based on the invention and of a chip card terminal,</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 2</figref> shows a flowchart of an embodiment of a method based on the invention,</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 3</figref> shows a block diagram of a further embodiment of a chip card based on the invention and of a chip card terminal,</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 4</figref> shows a flowchart of a further embodiment of a method based on the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0041" num="0040">In the figures below, elements which correspond to one another in the various embodiments are denoted by the same reference symbols.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 1</figref> shows a block diagram of a chip card terminal <b>100</b>. The chip card terminal <b>100</b> has an interface <b>102</b> for communicating with a chip card <b>104</b> which has a corresponding interface <b>106</b>. Preferably, the interfaces <b>102</b> and <b>106</b> are designed for wireless communication, for example by radio, particularly on the basis of an RFID method.</p>
<p id="p-0043" num="0042">By way of example, the interfaces <b>102</b> and <b>106</b> are of a nature such that various communication channels can be set up between the interfaces <b>102</b>, <b>106</b>, said communication channels differing from one another on a physical and/or logical level. By way of example, communication channels at different transmission frequencies can be set up. It is also possible to set up communication channels on the basis of various frequency hopping schemes. In this context, &#x201c;frequency hopping&#x201d; is understood to mean frequency hopping methods which involve the frequencies used for the data transmission being continually changed on the basis of a defined scheme.</p>
<p id="p-0044" num="0043">The interfaces <b>102</b>, <b>106</b> may also be in a form such that different communication channels are set up using different coding methods and/or modulation methods, such as frequency modulation, amplitude modulation, phase modulation, pulse width modulation or other modulation methods.</p>
<p id="p-0045" num="0044">The various communication channels which can be set up between the interfaces <b>102</b> and <b>106</b> are subsequently referred to as the &#x201c;set of communication channels&#x201d;.</p>
<p id="p-0046" num="0045">One of the communication channels <b>108</b> from the set of communication channels is predefined for the initial communication between the chip card terminal <b>100</b> and the chip card <b>104</b>. By way of example, the communication channel is predefined in terms of its transmission frequency and the modulation and coding methods to be used.</p>
<p id="p-0047" num="0046">The predefined communication channel is used for the transmission of a cipher <b>110</b> for the at least one communication parameter K<b>1</b> from the chip card terminal <b>100</b> to the chip card <b>104</b> in order to notify the chip card <b>104</b> of which of the communication channels <b>112</b> in the set of communication channels is intended to be used for the subsequent communication with the chip card terminal <b>100</b>.</p>
<p id="p-0048" num="0047">The communication parameter K<b>1</b> thus contains a specification which explicitly specifies said communication channel <b>112</b>. This specification may be provided in the form of a codeword. The chip card <b>104</b> may store what is known as a lookup table in a nonvolatile memory, said lookup table containing a respective specification for one of the communication channels in the set of communication channels in association with the possible codewords.</p>
<p id="p-0049" num="0048">For the selection of a communication channel from the set of communication channels, all possible communication channels which can be set up between the interfaces <b>102</b>, <b>106</b> may be available or a selection thereof, in which case each of the communication channels in the set of communication channels that is actually able to be used for the communication between the interfaces <b>102</b>, <b>106</b> is associated with an explicit codeword which can be transmitted as a communication parameter <b>110</b> from the chip card terminal <b>100</b> to the chip card <b>104</b>.</p>
<p id="p-0050" num="0049">The chip card terminal <b>100</b> has a user interface <b>114</b>, such as a keypad or a graphical user interface, which can be used to input a first identifier <b>116</b>. Said first identifier is subsequently referred to as PIN&#x2032; without restricting the general nature.</p>
<p id="p-0051" num="0050">The chip card terminal <b>100</b> has at least one processor <b>118</b> for executing an application program <b>120</b>. The application program <b>120</b> can prompt the generation of a chip card command <b>122</b> in order to call a particular chip card function <b>124</b> of the chip card <b>104</b>. In one example, the application program <b>120</b> needs the chip card function <b>124</b> for an authorization check, for the generation of a digital signature, for checking an authorization, particularly an access authorization, performing a financial transaction or the like.</p>
<p id="p-0052" num="0051">In addition, the processor <b>118</b> is further used to execute the program instructions of a communication module <b>126</b> which is used for selecting the communication channel <b>112</b> from the set of communication channels and hence for selecting the communication parameter <b>110</b>. The communication parameter <b>110</b> can be selected on the basis of a prescribed scheme or randomly, particularly pseudo-randomly. By way of example, the communication module <b>126</b> stores a list of different communication parameters <b>110</b> which is processed cyclically.</p>
<p id="p-0053" num="0052">The processor <b>118</b> is also used to execute program instructions <b>128</b> for symmetric encryption of the communication parameters <b>110</b>. The encryption is performed using the PIN&#x2032;. To this end, the program instructions <b>128</b> may contain a key generator <b>130</b>.</p>
<p id="p-0054" num="0053">The key generator <b>130</b> may be in a form such that it takes the PIN&#x2032; as a seed value and generates a first symmetric key, which is subsequently referred to as S<b>1</b>. The key S<b>1</b> is used for the symmetric encryption of the communication parameter K<b>1</b> selected by the communication module <b>126</b>. The cipher obtained for the communication parameter K<b>1</b> from the symmetric encryption with the key S<b>1</b> is transmitted from the interface <b>102</b> to the interface <b>106</b> via the predefined communication channel <b>108</b>.</p>
<p id="p-0055" num="0054">The chip card <b>104</b> has a processor <b>132</b> which is used to execute the program instructions of a communication module <b>134</b>. The communication module <b>134</b> is designed to process the communication parameter K<b>1</b> possibly received from the chip card terminal <b>100</b>. By way of example, the communication module <b>134</b> can use the communication parameter K<b>1</b> as a key to access an association table, particularly a lookup table, in order to request the parameters for the communication channel <b>112</b> selected by the chip card terminal <b>100</b>, such as the transmission frequency of said communication channel and/or the coding and modulation methods to be used.</p>
<p id="p-0056" num="0055">The processor <b>132</b> is also used to execute program instructions <b>136</b> for the symmetric decryption of the cipher <b>110</b> which the chip card <b>104</b> has received from the chip card terminal <b>100</b>. By way of example, the chip card <b>104</b> has a protected memory area <b>138</b> which stores a second identifier <b>140</b>. The second identifier is subsequently referred to as the PIN without restricting the general nature. The PIN is communicated to the authorized user of the chip card separately when the chip card <b>104</b> is issued, for example in the form of what is known as the PIN letter.</p>
<p id="p-0057" num="0056">The program instructions <b>136</b> may contain a key generator <b>142</b> which uses the PIN as what is known as a seed value in order to derive a second key therefrom. This symmetric second key is subsequently referred to as S<b>2</b>.</p>
<p id="p-0058" num="0057">Alternatively, the key S<b>2</b> may be stored in the protected memory area <b>138</b> of the chip card <b>104</b> instead of the PIN <b>140</b>. The key generator <b>142</b> and storage of the PIN <b>140</b> in the chip card <b>104</b> are then superfluous. In contrast to the prior art, the chip card <b>104</b> therefore does not necessarily need to store the PIN <b>140</b> as a reference value for checking the correctness of the PIN&#x2032; <b>116</b>.</p>
<p id="p-0059" num="0058">The chip card <b>104</b> may also have an incorrect operation counter <b>144</b>. The incorrect operation counter <b>144</b> is designed such that every incorrect operation of the chip card <b>104</b> is counted. The number of incorrect operations is compared with a prescribed threshold value. If this threshold value is reached, at least the chip card function <b>124</b> with which the incorrect operation counter <b>144</b> is associated is reversibly or irreversibly locked.</p>
<p id="p-0060" num="0059">The chip card <b>104</b> may also have a first-use function. By way of example, the first-use status of the chip card <b>104</b> is defined by a particular communication parameter which specifies one of the communication channels in the set which needs to be used for the first use of the chip card.</p>
<p id="p-0061" num="0060">To use the chip card <b>104</b>, the procedure is as follows: a user inputs the PIN&#x2032; <b>116</b> into the chip card terminal <b>100</b> via the user interface <b>114</b>. This can be done upon an appropriate request via the application program <b>120</b>. The communication module <b>126</b> then selects a first of the possible communication parameters from the prescribed list of communication parameters, for example, that is to say the communication parameter K<b>1</b>.</p>
<p id="p-0062" num="0061">The key generator <b>130</b> takes the PIN&#x2032; and generates the key S<b>1</b>. The communication parameter K<b>1</b> is then encrypted using the symmetric key S<b>1</b> by executing the program instructions <b>128</b>. The resultant cipher <b>110</b> for the communication parameter K<b>1</b> is then sent from the interface <b>102</b> to the interface <b>106</b> of the chip card <b>104</b> via the predefined communication channel <b>108</b>.</p>
<p id="p-0063" num="0062">If required, the chip card <b>104</b> derives the key S<b>2</b> from the PIN or accesses the key S<b>2</b> directly in the protected memory area <b>138</b>. The key S<b>2</b> is used to make the attempt at decrypting the cipher <b>110</b> received for the communication parameter K<b>1</b> from the chip card terminal <b>100</b> by virtue of the execution of the program instructions <b>136</b> by the chip card <b>104</b>.</p>
<p id="p-0064" num="0063">The result of this decryption attempt is a second communication parameter, which is subsequently referred to as K<b>2</b> and which is transferred to the communication module <b>134</b>. Said communication parameter K<b>2</b> is identical to the communication parameter K<b>1</b> only if the condition PIN&#x2032;=PIN is met, since only then can the key S<b>1</b> which has been used for the symmetric encryption be the same as the key S<b>2</b>, which has been used for the symmetric decryption of the cipher for the communication parameter K<b>1</b>.</p>
<p id="p-0065" num="0064">The communication parameter K<b>2</b> may define a second communication channel <b>146</b>, namely by virtue of the communication module <b>134</b> using the communication parameter K<b>2</b> to access its association table. Said second communication channel <b>146</b> is in turn identical to the first communication channel <b>112</b> only if the condition PIN&#x2032;=PIN is met.</p>
<p id="p-0066" num="0065">Following the transmission of the cipher for the communication parameter K<b>1</b> via the predefined communication channel <b>108</b>, the chip card terminal <b>100</b> generates the chip card command <b>122</b>, which is sent via the first communication channel <b>112</b> from the interface <b>102</b> to the interface <b>106</b>. The chip card <b>104</b> and the communication module <b>134</b> thereof are set to the second communication channel <b>146</b> for reception on the basis of the communication parameter K<b>2</b>.</p>
<p id="p-0067" num="0066">If the second communication channel <b>146</b> matches the first communication channel <b>112</b>, the chip card command <b>122</b> is processed by the chip card <b>104</b> and the chip card function <b>124</b> is called. As a result, the chip card <b>104</b> generates a response to the chip card command <b>122</b> and transmits said response back to the chip card <b>100</b> via the first communication channel <b>112</b>.</p>
<p id="p-0068" num="0067">If, by contrast, the second communication channel <b>146</b> is not identical to the first communication channel <b>112</b>, the chip card <b>104</b> ignores the chip card command received on the first communication channel <b>112</b> and increments the incorrect operation counter <b>144</b>.</p>
<p id="p-0069" num="0068">By way of example, the communication channel <b>108</b> is defined by a transmission frequency of 9 GHz, the communication channel <b>112</b> is defined by a transmission frequency of 10 GHz and the communication channel <b>146</b> is defined by a transmission frequency of 11 GHz, the transmission frequencies of the communication channels <b>112</b> and <b>146</b> differing from one another, since the PIN&#x2032; which has been input into the chip card terminal <b>100</b> is not the same as the PIN. If the chip card <b>104</b> receives a signal on the frequency 10 GHz from the chip card terminal <b>100</b> in this case, even though it expected reception on the frequency 11 GHz, this signal is ignored and the incorrect operation counter is incremented. This provides an implicit check on the PIN&#x2032; without the need for the PIN&#x2032; to be compared directly with the PIN and without the PIN needing to be stored in the chip card.</p>
<p id="p-0070" num="0069"><figref idref="DRAWINGS">FIG. 2</figref> shows an appropriate flowchart. In step <b>200</b>, the PIN&#x2032; is input in the chip card terminal. Next, in step <b>202</b>, the chip card terminal <b>100</b> stipulates the communication parameter K<b>1</b> for selecting one of the communication channels from the set of communication channels. In step <b>204</b>, the communication parameter K<b>1</b> is symmetrically encrypted using the PIN&#x2032;. This can be done by virtue of a key generator being used to derive from the PIN&#x2032; the symmetric key S<b>1</b>, which is then used to encrypt the communication parameter K<b>1</b>.</p>
<p id="p-0071" num="0070">In step <b>206</b>, the cipher produced for the communication parameter K<b>1</b> using the key S<b>1</b> is transmitted from the chip card terminal to the chip card via a predefined communication channel.</p>
<p id="p-0072" num="0071">In step <b>208</b>, the chip card <b>104</b> makes the attempt at decrypting the communication parameter K<b>1</b> on the basis of the PIN. The correct PIN may be stored in a protected memory area of the chip card and is used to derive a symmetric key S<b>2</b>. Alternatively, the key S<b>2</b> may also be stored in the protected memory area of the chip card directly.</p>
<p id="p-0073" num="0072">The decryption of the cipher for the communication parameter K<b>1</b> with the key S<b>2</b> results in a communication parameter K<b>2</b>. Said communication parameter K<b>2</b> may define a second communication channel in the set. Only if the PIN&#x2032; is correct, i.e. if the condition PIN&#x2032;=PIN is met, are the communication channels specified by the communication parameters K<b>1</b> and K<b>2</b> identical.</p>
<p id="p-0074" num="0073">In step <b>210</b>, the chip card terminal generates a chip card command and sends it to the chip card via the first communication channel, specified by the communication parameter K<b>1</b> (step <b>212</b>). In step <b>214</b>, the chip card can receive the chip card command only if the second communication channel, for which the chip card is set up for reception, is identical to the first communication channel, i.e. if the condition PIN&#x2032;=PIN is met. Conversely, the chip card ignores the cipher received on the first communication channel and increments the incorrect operation counter therefor.</p>
<p id="p-0075" num="0074">In one embodiment of the invention, the communication parameter K<b>1</b> may be a public key of the chip card terminal. The cipher for said public key, which cipher has been generated using the key S<b>1</b> by means of symmetric encryption, is transmitted from the chip card terminal to the chip card. The chip card receives the correct public key of the chip card terminal only if in turn the condition PIN&#x2032;=PIN is met, since only then is the decryption of the cipher using the key S<b>2</b> successful (cf. the embodiment in <figref idref="DRAWINGS">FIG. 1</figref>). The public key of the chip card can be requested by the chip card terminal from an external keyserver, for example, via a network, particularly the Internet.</p>
<p id="p-0076" num="0075">The chip card terminal can use the Diffie-Hellman method to derive a symmetric key S<b>3</b> from the private key of the chip card terminal and the public key of the chip card. Accordingly, the chip card can likewise use the Diffie-Hellman method to derive a symmetric key S<b>4</b> from the public key of the chip card terminal and its private key. The keys S<b>3</b> and S<b>4</b> are identical if the condition PIN&#x2032;=PIN is met.</p>
<p id="p-0077" num="0076">The first communication channel (cf. communication channel <b>112</b> in <figref idref="DRAWINGS">FIG. 1</figref>) is at least additionally defined by means of the symmetric keys S<b>3</b>=S<b>4</b> in this embodiment. This is because the chip card command sent from the chip card terminal to the chip card is encrypted with the symmetric key S<b>3</b>, and can be decrypted, i.e. received, by the chip card only if the chip card command can be decrypted using the key S<b>4</b>. Otherwise, the chip card command is ignored and the incorrect operation counter is incremented.</p>
<p id="p-0078" num="0077"><figref idref="DRAWINGS">FIG. 3</figref> shows an embodiment of a chip card based on the invention and of a chip card terminal based on the invention, wherein a method for discrete logarithmic cryptography is used to generate the keys S<b>3</b> and S<b>4</b>. As an addition to the embodiment shown in <figref idref="DRAWINGS">FIG. 1</figref>, the processor <b>118</b> is used to execute program instructions <b>148</b>, which provide what is known as a Key Establishment Scheme for generating the symmetric key S<b>3</b>.</p>
<p id="p-0079" num="0078">The Key Establishment Scheme operates on the basis of a method for discrete logarithmic cryptography (DLC), particularly elliptic curve cryptography (EEC), preferably on the basis of an elliptic curve Diffie-Hellman method (ECDH). To generate the symmetric key S<b>3</b>, the program instructions <b>148</b> first of all produce first domain parameters, which are subsequently referred to as D<b>1</b>.</p>
<p id="p-0080" num="0079">In addition, the communication module <b>126</b> can produce a first channel parameter KA<b>1</b> or can read it from a prescribed list, such a first channel parameter specifying the physical properties of the first communication channel, for example. The first channel parameter KA<b>1</b> corresponds to the channel parameter K<b>1</b> in the embodiment in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0081" num="0080">The domain parameters D<b>1</b> and the channel parameter(s) KA<b>1</b> are encrypted by the program instructions <b>128</b> using the key S<b>1</b>. The cipher <b>110</b> obtained from KA<b>1</b>, D<b>1</b> using the key S<b>1</b> is transmitted from the interface <b>102</b> to the interface <b>106</b> via the predefined communication channel <b>108</b>.</p>
<p id="p-0082" num="0081">The chip card <b>104</b> decrypts the cipher <b>110</b> using the symmetric key S<b>2</b>. As a result of the decryption, the chip card <b>104</b> obtains the second channel parameter KA<b>2</b>, which corresponds to the communication parameter K<b>2</b> in the embodiment in <figref idref="DRAWINGS">FIG. 1</figref>. In addition, the chip card obtains the domain parameters D<b>2</b>. The channel parameter KA<b>2</b> is processed by the communication module <b>134</b> in order to establish the physical specification of the second communication channel <b>146</b>, for example.</p>
<p id="p-0083" num="0082">As an addition to the embodiment in <figref idref="DRAWINGS">FIG. 1</figref>, the chip card <b>104</b> has program instructions <b>150</b>, the functionality of which corresponds to that of the program instructions <b>148</b> and which implement the Key Establishment Scheme on the chip card.</p>
<p id="p-0084" num="0083">The chip card terminal executes the program instructions <b>148</b> in order to derive the symmetric key S<b>3</b>, which is stored in a memory <b>152</b> of the chip card terminal <b>100</b>, from the domain parameters D<b>1</b>. Accordingly, execution of the program instructions <b>150</b> by the chip card <b>104</b> derives a symmetric key S<b>4</b>, which is stored in a memory <b>154</b> of the chip card <b>104</b>, from the domain parameters D<b>2</b>.</p>
<p id="p-0085" num="0084">The chip card command <b>122</b> is encrypted by the chip card terminal with the symmetric key S<b>3</b> before being sent and is then transmitted via the first communication channel <b>112</b> specified by the channel parameters KA<b>1</b>. The chip card command <b>122</b> can be received by the chip card <b>104</b> only if both KA<b>2</b>=KA<b>1</b> and D<b>2</b>=D<b>1</b>, which in turn is possible only if the condition PIN&#x2032;=PIN is met.</p>
<p id="p-0086" num="0085">Of particular advantage in this embodiment is the fact that the transmission of the domain parameters D<b>1</b> via the predefined communication channel <b>108</b> cannot be spied out by third parties, since the domain parameters D<b>1</b> are transmitted in an encrypted form.</p>
<p id="p-0087" num="0086"><figref idref="DRAWINGS">FIG. 4</figref> shows an appropriate flowchart. In step <b>400</b>, a PIN&#x2032; is input into the chip card terminal by a user. The symmetric key Si is derived from the PIN&#x2032;.</p>
<p id="p-0088" num="0087">In step <b>402</b>, the Key Establishment Scheme is started. Next, in step <b>404</b>, a set of domain parameters D<b>1</b> is produced. The domain parameters D<b>1</b> are used for the generation of the symmetric key S<b>3</b> by the chip card terminal. In addition, in step <b>406</b>, the chip card terminal generates the channel parameter KA<b>1</b> or reads it from a prescribed list.</p>
<p id="p-0089" num="0088">In step <b>408</b>, the domain parameters D<b>1</b> and/or the channel parameters KA<b>1</b> are encrypted with the key S<b>1</b>. By way of example, the domain parameters D<b>1</b> and the channel parameters KA<b>1</b> are appended to one another, which results in a single communication parameter which is then encrypted with the key S<b>1</b>. Alternatively, only the domain parameters D<b>1</b> or only the channel parameters KA<b>1</b> or a respective subset of the domain and/or channel parameters are encrypted with the key S<b>1</b>. The cipher resulting from the encryption with the key S<b>1</b> and any remaining unencrypted domain and/or channel parameters are transmitted from the chip card terminal to the chip card via the predefined channel (cf. communication channel <b>108</b> in <figref idref="DRAWINGS">FIGS. 1 and 3</figref>) in step <b>410</b>.</p>
<p id="p-0090" num="0089">In step <b>412</b>, the chip card attempts to decrypt the cipher using the key S<b>2</b>. From this, the chip card <b>104</b> obtains the channel parameters KA<b>2</b> and the domain parameters D<b>2</b>. The chip card <b>104</b> derives the key S<b>4</b> from the domain parameters D<b>2</b>.</p>
<p id="p-0091" num="0090">In step <b>414</b>, the chip card terminal <b>100</b> generates a chip card command, which is encrypted with the key S<b>3</b> (step <b>416</b>) in order to transmit it via the first communication channel defined by the channel parameters KA<b>1</b> (cf. communication channel <b>112</b> in the embodiments in <figref idref="DRAWINGS">FIGS. 1 and 3</figref>). The chip card terminal <b>100</b> sends the chip card command in step <b>418</b>.</p>
<p id="p-0092" num="0091">Correct reception of the cipher by the chip card is possible in step <b>420</b> only if the second communication channel <b>146</b> matches the first communication channel <b>112</b>, i.e. if KA<b>2</b>=KA<b>1</b>, and if, furthermore, the chip card command can be decrypted with the key S<b>4</b>, i.e. if S<b>4</b>=S<b>3</b>. However, the conditions KA<b>2</b>=KA<b>1</b> and S<b>4</b>=S<b>3</b> can be met only if the correct PIN&#x2032; has been input into the chip card terminal by the user, i.e. if PIN&#x2032;=PIN.</p>
<p id="h-0006" num="0000">List of Reference Symbols</p>
<p id="p-0093" num="0000">
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0092"><b>100</b> Chip card terminal</li>
    <li id="ul0001-0002" num="0093"><b>102</b> Interface</li>
    <li id="ul0001-0003" num="0094"><b>104</b> Chip card</li>
    <li id="ul0001-0004" num="0095"><b>106</b> Interface</li>
    <li id="ul0001-0005" num="0096"><b>108</b> Predefined communication channel</li>
    <li id="ul0001-0006" num="0097"><b>110</b> Communication parameter</li>
    <li id="ul0001-0007" num="0098"><b>112</b> First communication channel</li>
    <li id="ul0001-0008" num="0099"><b>114</b> User interface</li>
    <li id="ul0001-0009" num="0100"><b>116</b> PIN&#x2032;</li>
    <li id="ul0001-0010" num="0101"><b>118</b> Processor</li>
    <li id="ul0001-0011" num="0102"><b>120</b> Application program</li>
    <li id="ul0001-0012" num="0103"><b>122</b> Chip card command</li>
    <li id="ul0001-0013" num="0104"><b>124</b> Chip card function</li>
    <li id="ul0001-0014" num="0105"><b>126</b> Communication module</li>
    <li id="ul0001-0015" num="0106"><b>128</b> Program instructions</li>
    <li id="ul0001-0016" num="0107"><b>130</b> Key generator</li>
    <li id="ul0001-0017" num="0108"><b>132</b> Processor</li>
    <li id="ul0001-0018" num="0109"><b>134</b> Communication module</li>
    <li id="ul0001-0019" num="0110"><b>136</b> Program instructions</li>
    <li id="ul0001-0020" num="0111"><b>138</b> Protected memory area</li>
    <li id="ul0001-0021" num="0112"><b>140</b> PIN</li>
    <li id="ul0001-0022" num="0113"><b>142</b> Key generator</li>
    <li id="ul0001-0023" num="0114"><b>144</b> Incorrect operation counter</li>
    <li id="ul0001-0024" num="0115"><b>146</b> Second communication channel</li>
    <li id="ul0001-0025" num="0116"><b>148</b> Program instructions</li>
    <li id="ul0001-0026" num="0117"><b>150</b> Program instructions</li>
    <li id="ul0001-0027" num="0118"><b>152</b> Memory</li>
    <li id="ul0001-0028" num="0119"><b>154</b> Memory</li>
</ul>
</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is: </us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for protecting a chip card from unauthorized use, comprising the following steps:
<claim-text>a first identifier is input into a chip card terminal,</claim-text>
<claim-text>a cipher is produced from at least one first communication parameter using a first symmetric key derived from the first identifier, wherein the communication parameter can be used to define a protected first communication channel between the chip card terminal and the chip card,</claim-text>
<claim-text>the cipher is transmitted via a predefined communication channel from the chip card terminal to the chip card,</claim-text>
<claim-text>an attempt is made to decrypt the cipher using a second symmetric key by the chip card, the result of the decryption being the first communication parameter only if the first symmetric key is the same as the second symmetric key, so that the protected first communication channel can be defined between the chip card terminal and the chip card only if the first identifier is correct,</claim-text>
<claim-text>wherein the first communication parameter is the specification of a transmission frequency, of a frequency hopping scheme, of a coding method and/or of a modulation method, and</claim-text>
<claim-text>wherein the first communication parameter is a first domain parameter for the performance of a discrete logarithmic cryptographic method for the production of a third symmetric key by the chip card terminal of a fourth symmetric key by the chip card and, wherein the third and fourth keys are identical if the first identifier is correct, wherein the third and fourth symmetric keys are provided for the purpose of encrypting the communication between the chip card terminal and the chip card via the protected first communication channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first communication parameter is a public key of the chip card terminal, wherein the chip card, if the decryption of the cipher is successful, takes the public key and uses the Diffie-Hellman (DH) method to derive a further symmetric key for encrypting the communication between the chip card terminal and the chip card, wherein the encryption with the further symmetric key defines the first communication channel.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the discrete logarithmic cryptographic method is an elliptic curve cryptographic method.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the discrete logarithmic cryptographic method is an elliptic curve Diffie-Hellman method.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first identifier is used as a seed value for the derivation of the first symmetric key by the chip card terminal.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the result of the decryption is an incorrect second communication parameter if the first identifier is incorrect, wherein the second communication parameter allows an incorrect second communication channel to be defined by the chip card, the method further comprising the following steps:
<claim-text>a chip card command is sent from the chip card terminal to the chip card on the protected first communication channel,</claim-text>
<claim-text>the chip card command is ignored by the chip card and the number of remaining incorrect operations is reduced, wherein the chip card or a chip card function of the chip card is locked if a prescribed number of incorrect operations is exceeded.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A chip card, comprising:
<claim-text>an interface for communication with a chip card terminal via a predefined communication channel and a plurality of further communication channels,</claim-text>
<claim-text>means for the decryption of a cipher received on the predefined channel, which cipher has been encrypted using a first symmetric key, using a second symmetric key, wherein the decryption yields at least one communication parameter if a first identifier which has been input into the chip card terminal previously is correct, wherein the communication parameter explicitly stipulates one of the further communication channels for the protected communication between the chip card and the chip card terminal,</claim-text>
<claim-text>wherein the first communication parameter is the specification of a transmission frequency, of a frequency hopping scheme, of a coding method and/or of a modulation method, and</claim-text>
<claim-text>wherein the first communication parameter is a first domain parameter for the performance of a discrete logarithmic cryptographic method for the production of a third symmetric key by the chip card terminal of a fourth symmetric key by the chip card and, wherein the third and fourth keys are identical if the first identifier is correct, wherein the third and fourth symmetric keys are provided for the purpose of encrypting the communication between the chip card terminal and the chip card via the protected one of the further communication channels.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The chip card as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the first communication parameter specifies a public key, and having means for performing a Diffie-Hellman method for the derivation of a further symmetric key using the public key.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The chip card as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising:
<claim-text>means for performing a discrete logarithmic encryption method for the production of the further symmetric key, wherein the further symmetric key is provided for the symmetric encryption of the communication between the chip card terminal and the chip card via the stipulated communication channel,</claim-text>
<claim-text>a nonvolatile protected memory area for storing a second identifier from which the second key can be derived, and</claim-text>
<claim-text>a protected nonvolatile memory area for storing the second key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The chip card as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising:
<claim-text>an incorrect operation count for locking the chip card if the number of incorrect operations has reached a prescribed threshold value, wherein:</claim-text>
<claim-text>a message received by the chip card which is sent to the chip card on one of the further communication channels which is not the stipulated communication channel is counted as an incorrect operation, and</claim-text>
<claim-text>the chip card is at least one of: a document, a value or security document, an ID card, a means of payment, and a signature card.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The chip card as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising:
<claim-text>a first-user function, wherein:</claim-text>
<claim-text>in a first-use state, a particular communication parameter is stipulated for a first selection of the first communication channel, and</claim-text>
<claim-text>the chip card changes from its first-use state to a used state when it receives a chip card command on said first communication channel for the first time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A chip card terminal, comprising:
<claim-text>means for the input of a first identifier,</claim-text>
<claim-text>means for the production of a cipher from at least one first communication parameter using a first symmetric key derived from the first identifier, wherein the communication parameter can be used to define a protected first communication channel between the chip card terminal and the chip card,</claim-text>
<claim-text>means for sending the cipher to the chip card via a predefined communication channel,</claim-text>
<claim-text>wherein the first communication parameter is the specification of a transmission frequency, of a frequency hopping scheme, of a coding method and/or of a modulation method, and</claim-text>
<claim-text>wherein the first communication parameter is a first domain parameter for the performance of a discrete logarithmic cryptographic method for the production of a second symmetric key by the chip card terminal of a third symmetric key by the chip card and, wherein the second and third keys are identical if the first identifier is correct, wherein the second and third symmetric keys are provided for the purpose of encrypting the communication between the chip card terminal and the chip card via the protected first communication channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The chip card terminal as claimed in <claim-ref idref="CLM-00012">claim 12</claim-ref>, further comprises means for producing domain parameters for the performance of a discrete logarithm cryptographic method for the derivation of a further symmetric key for encrypting the communication between the chip card terminal and the chip card, wherein the first communication parameter specifies the domain parameter. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353055-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353055</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13540212</doc-number>
<date>20120702</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>CN</country>
<doc-number>2008 1 0130556</doc-number>
<date>20080707</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<disclaimer>
<text>This patent is subject to a terminal disclaimer.</text>
</disclaimer>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>7</main-group>
<subgroup>04</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 30</main-classification>
<further-classification>726 26</further-classification>
<further-classification>726 27</further-classification>
<further-classification>726 28</further-classification>
<further-classification>726 29</further-classification>
<further-classification>713161</further-classification>
<further-classification>713162</further-classification>
<further-classification>713163</further-classification>
<further-classification>713164</further-classification>
<further-classification>713165</further-classification>
</classification-national>
<invention-title id="d2e69">Method and apparatus for processing rights object</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>2002/0019814</doc-number>
<kind>A1</kind>
<name>Ganesan</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2006/0031164</doc-number>
<kind>A1</kind>
<name>Kim</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2006/0156413</doc-number>
<kind>A1</kind>
<name>Oh et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2008/0183831</doc-number>
<kind>A1</kind>
<name>Shi et al.</name>
<date>20080700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2009/0037493</doc-number>
<kind>A1</kind>
<name>Dang et al.</name>
<date>20090200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2009/0151001</doc-number>
<kind>A1</kind>
<name>Li et al.</name>
<date>20090600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2011/0091041</doc-number>
<kind>A1</kind>
<name>Zhang et al.</name>
<date>20110400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>CN</country>
<doc-number>1728039</doc-number>
<kind>A</kind>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>CN</country>
<doc-number>1851608</doc-number>
<kind>A</kind>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>CN</country>
<doc-number>101038610</doc-number>
<kind>A</kind>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>CN</country>
<doc-number>101089865</doc-number>
<kind>A</kind>
<date>20071200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>WO</country>
<doc-number>WO 2004/077911</doc-number>
<kind>A2</kind>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>WO</country>
<doc-number>WO 2007-108619</doc-number>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>WO</country>
<doc-number>WO 2007/108619</doc-number>
<kind>A1</kind>
<date>20070900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>WO</country>
<doc-number>WO 2010/003328</doc-number>
<kind>A1</kind>
<date>20100100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>Written Opinion of the International Searching Authority (translation) dated (mailed) Jul. 23, 2009, issued in related Application No. PCT/CN2009/071174, filed Apr. 7, 2009, Huawei Technologies Co., Ltd. (7 pgs.).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>International Search Report dated (mailed) Jul. 23, 2009, issued in related Application No. PCT/CN2009/071174, filed Apr. 7, 2009, Huawei Technologies Co., Ltd. (5 pgs.).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>Extended European Search Report dated (mailed) Feb. 1, 2012, issued in related Application No. 09793803.9-2212, PCT/CN2009071174, filed Apr. 7, 2009, Huawei Tech Co., Ltd.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>Open Mobile Alliance (OMA), &#x201c;OMA Secure Removable Media Specification&#x201d;, Candidate Version 1.0, OMA-TS-SRM-V1<sub>&#x2014;</sub>0-20080128-C; Jan. 28, 2008 (138 pgs.).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>First Chinese Office Action mailed Jul. 16, 2012, issued in related Chinese Application No. 200810130556.7 (35 pages).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>Notice of Allowance dated Oct. 11, 2012, U.S. Appl. No. 12/980,050, filed Dec. 28, 2010, 18 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>18</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 30</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>12</number-of-drawing-sheets>
<number-of-figures>24</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>12980050</doc-number>
<date>20101228</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13540212</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>PCT/CN2009/071174</doc-number>
<date>20090407</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>12980050</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120272334</doc-number>
<kind>A1</kind>
<date>20121025</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Zhang</last-name>
<first-name>Renzhou</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CN</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Huang</last-name>
<first-name>Chen</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CN</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yuan</last-name>
<first-name>Weizhong</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CN</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Zhou</last-name>
<first-name>Zhipeng</first-name>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>CN</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Conley Rose, P.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Rodolph</last-name>
<first-name>Grant</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Huawei Technologies Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Shenzhen</city>
<country>CN</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Chai</last-name>
<first-name>Longbit</first-name>
<department>2431</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method for upgrading a Rights Object (RO) includes: acquiring, by a Digital Rights Management (DRM) Agent, RO related information of the RO that requires updating from a Secure Removable Media (SRM) Agent; providing, by the DRM Agent, the RO related information to a Rights Issuer (RI), and obtaining a new RO from the RI; and interacting, by the DRM Agent, with the SRM Agent to upgrade the RO that requires updating on the SRM by means of the new RO. According to the embodiments of the present invention, the DRM Agent acquires RO related information which is stored on the SRM and does not have Move rights, and interacts with the RI to move the RO out from the SRM, so as to move the RO without the Move rights out from the SRM.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="95.67mm" wi="174.24mm" file="US08353055-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="194.73mm" wi="168.66mm" file="US08353055-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="205.57mm" wi="174.92mm" file="US08353055-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="193.80mm" wi="183.39mm" file="US08353055-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="208.87mm" wi="176.61mm" file="US08353055-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="147.57mm" wi="178.22mm" file="US08353055-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="202.95mm" wi="172.97mm" file="US08353055-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="189.15mm" wi="171.62mm" file="US08353055-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="151.55mm" wi="167.05mm" file="US08353055-20130108-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="172.30mm" wi="130.47mm" file="US08353055-20130108-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="172.64mm" wi="130.13mm" file="US08353055-20130108-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="165.44mm" wi="136.74mm" file="US08353055-20130108-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="137.41mm" wi="140.38mm" file="US08353055-20130108-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation of U.S. patent application Ser. No. 12/980,050, filed on Dec. 28, 2010, which is a continuation of International Application No. PCT/CN2009/071174, filed on Apr. 7, 2009. The International Application claims priority to Chinese Patent Application No. 200810130556.7, filed on Jul. 7, 2008. The afore-mentioned patent applications are hereby incorporated by reference in their entireties.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE TECHNOLOGY</heading>
<p id="p-0003" num="0002">The present invention relates to the field of Digital Rights Management (DRM), and more particularly to a method and apparatus for processing a Rights Object (RO).</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">Digital Rights Management (DRM) controls use of digital content, and protects lawful rights and interests of a content owner mainly through a solution of rights limitation and content protection. After a Content Issuer (CI) encrypts the digital content, a user downloads a data packet of the encrypted digital content to a terminal device. A Rights Issuer (RI) is responsible for distributing a Rights Object (RO) corresponding to the digital content, and the RO includes a content decryption key and corresponding rights. Only owning the data packet of the digital content (which includes information necessary for decrypting the digital content) and the RO at the same time, a device is able to normally use the purchased digital content. A DRM Agent gets an RO key by means of decryption with a private key of the device, then gets the digital content decrypted with a content key in the RO, and controls detailed use for the digital content by the user according to rights information in the RO. The RO includes such information as the rights, the limitation, the key, and the digital signature. For the same content, multiple different ROs including different rights can be produced. For example, for a certain document file, browsing rights, printing rights and Move rights of the RO are set in some RO, and only the browsing rights are set in some other RO.</p>
<p id="p-0005" num="0004">A device owning an RO can independently consume the RO and use the corresponding digital content, and a device without an RO can also consume an RO in a Secure Removable Media (SRM) by interacting with the SRM. The SRM can be a security storage card or a smart card. An RO can be stored on the SRM, so that the RO can be consumed conveniently on multiple devices through the SRM. As with the RO stored on the device, the RO stored on the SRM still needs to be moved out. For example, the user can assign the RO of some old content on the SRM to his/her friends, and purchase an RO of new content for the empty space.</p>
<p id="p-0006" num="0005">The device moves its own stored RO to the SRM, and also, the device moves the RO from the SRM. In the moving process, the device must check whether &#x201c;the RO is movable&#x201d; is noted for the RO itself, that is, checking whether the RO has move rights, and whether the RI allows to move the RO in advance. If the RO stored in the SRM does not have the move rights, or the move rights have been used up, a terminal is incapable of moving the RO out from the SRM. If the user does not fully consider the problems about whether it is needed to move the RO in future, and the times by which it is needed to move the RO during purchasing the RO, it is possible that the RO cannot be moved, which limits the application of the RO.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">The present invention is directed to a method and device for processing a Rights Object (RO), so as to move the RO without Move rights stored on a Secure Removable Media (SRM) out from the SRM, thus extending an application of the RO without the Move rights.</p>
<p id="p-0008" num="0007">The present invention provides a method for upgrading an RO, which includes the following steps.</p>
<p id="p-0009" num="0008">A Digital Rights Management (DRM) Agent acquires RO related information of the RO that requires updating from an SRM Agent.</p>
<p id="p-0010" num="0009">The DRM Agent provides the RO related information to a Rights Issuer (RI), and obtains a new RO from the RI.</p>
<p id="p-0011" num="0010">The DRM Agent interacts with the SRM Agent to upgrade the RO that requires updating on the SRM by means of the new RO.</p>
<p id="p-0012" num="0011">The present invention provides another method for upgrading an RO, which includes the following steps.</p>
<p id="p-0013" num="0012">An RI acquires RO related information of the RO that requires updating on an SRM through a DRM Agent and an SRM Agent.</p>
<p id="p-0014" num="0013">The RI upgrades the RO that requires updating on the SRM with a newly generated RO.</p>
<p id="p-0015" num="0014">The present invention provides a method for removing an RO, which includes the following steps.</p>
<p id="p-0016" num="0015">A DRM Agent receives a trigger message sent by an RI. The trigger message includes an identifier of an RO to be removed on an SRM.</p>
<p id="p-0017" num="0016">The DRM Agent interacts with an SRM Agent on the SRM to remove the RO to be removed.</p>
<p id="p-0018" num="0017">The present invention provides a method for moving an RO, which includes the following steps.</p>
<p id="p-0019" num="0018">An RI acquires RO related information of the RO that requires moving on an SRM through a DRM Agent and an SRM Agent.</p>
<p id="p-0020" num="0019">The RI triggers the DRM Agent to remove the RO that requires moving on the SRM, and provides to the DRM Agent a Rights Encryption Key (REK) of the RO that requires moving.</p>
<p id="p-0021" num="0020">The present invention provides another method for moving an RO, which includes the following steps.</p>
<p id="p-0022" num="0021">A DRM Agent interacts with an SRM Agent to acquire RO related information of the RO that requires moving on an SRM.</p>
<p id="p-0023" num="0022">The DRM Agent interacts with an RI to provide the RO related information to the RI, and obtain Move rights of the RO that requires moving from the RI.</p>
<p id="p-0024" num="0023">The DRM Agent moves the RO that requires moving to a device at which the DRM Agent locates according to the Move rights.</p>
<p id="p-0025" num="0024">The present invention provides an RI, which includes a new RO generating module and a new RO providing module.</p>
<p id="p-0026" num="0025">The new RO generating module is configured to generate a new RO according to RO related information of an RO that requires updating on an SRM obtained through a DRM Agent and an SRM Agent.</p>
<p id="p-0027" num="0026">The new RO providing module is configured to provide the new RO to the DRM Agent.</p>
<p id="p-0028" num="0027">The present invention provides a DRM Agent, which includes an RO related information acquiring module and a first RO upgrading module.</p>
<p id="p-0029" num="0028">The RO related information acquiring module is configured to obtain RO related information of an RO that requires updating on an SRM from an SRM Agent, and provide the RO related information to an RI.</p>
<p id="p-0030" num="0029">The first RO upgrading module is configured to upgrade the RO that requires updating on the SRM through the SRM Agent with a new RO generated according to the RO related information by the RI.</p>
<p id="p-0031" num="0030">The present invention provides another RI, which includes a new RO generating module and a second RO upgrading module.</p>
<p id="p-0032" num="0031">The new RO generating module is configured to generate a new RO according to RO related information of an RO that requires updating on an SRM obtained through a DRM Agent and an SRM Agent.</p>
<p id="p-0033" num="0032">The second RO upgrading module is configured to upgrade the RO that requires updating on the SRM with the new RO through the DRM Agent and the SRM Agent.</p>
<p id="p-0034" num="0033">The present invention provides another DRM Agent, which includes an RO related information acquiring module and a new RO acquiring module.</p>
<p id="p-0035" num="0034">The RO related information acquiring module is configured to obtain RO related information of an RO that requires updating on an SRM from an SRM Agent, and provide the RO related information to an RI.</p>
<p id="p-0036" num="0035">The new RO acquiring module is configured to obtain from the RI a new RO generated according to the RO related information.</p>
<p id="p-0037" num="0036">The present invention provides another DRM Agent, which includes a receiving module and a removing module.</p>
<p id="p-0038" num="0037">The receiving module is configured to receive a trigger message sent by an RI. The trigger message includes an identifier of an RO to be removed on an SRM.</p>
<p id="p-0039" num="0038">The removing module is configured to notify an SRM Agent to remove the RO to be removed.</p>
<p id="p-0040" num="0039">The present invention provides another RI, which includes a triggering module and an REK providing module.</p>
<p id="p-0041" num="0040">The triggering module is configured to trigger a DRM Agent to remove an RO that requires moving on an SRM through an SRM Agent after acquiring RO related information of the RO that requires moving on the SRM through the DRM Agent and the SRM Agent.</p>
<p id="p-0042" num="0041">The REK providing module is configured to provide to the DRM Agent an REK of the RO that requires moving.</p>
<p id="p-0043" num="0042">The present invention provides another DRM Agent, which includes an RO related information acquiring module and an REK acquiring module.</p>
<p id="p-0044" num="0043">The RO related information acquiring module is configured to obtain RO related information of an RO that requires updating on an SRM from an SRM Agent, and provide the RO related information to an RI.</p>
<p id="p-0045" num="0044">The REK acquiring module is configured to receive an REK of the RO that requires moving that is provided by the RI.</p>
<p id="p-0046" num="0045">The present invention provides another RI, which includes a Move rights generating module and a Move rights providing module.</p>
<p id="p-0047" num="0046">The Move rights generating module is configured to generate Move rights of an RO that requires moving according to RO related information of the RO that requires moving on an SRM acquired through a DRM Agent and an SRM Agent.</p>
<p id="p-0048" num="0047">The Move rights providing module is configured to provide to the DRM Agent the Move rights of the RO that requires moving.</p>
<p id="p-0049" num="0048">The present invention provides another DRM Agent, which includes an RO related information acquiring module and an RO moving module.</p>
<p id="p-0050" num="0049">The RO related information acquiring module is configured to obtain RO related information of an RO that requires updating on an SRM from an SRM Agent, and provide the RO related information to an RI.</p>
<p id="p-0051" num="0050">The RO moving module is configured to receive Move rights, provided by the RI, of an RO that requires moving, and move the RO that requires moving to a device at which the DRM Agent locates through the SRM Agent according to the Move rights.</p>
<p id="p-0052" num="0051">It can be known from the technical solution that, according to the embodiments of the present invention, the DRM Agent acquires related information of the RO which is stored on the SRM and does not have the Move rights, and interacts with the RI to move the RO out from the SRM, so as to realize that the RO without the Move rights can be moved out from the SRM, thus extending an application of the RO without the Move rights.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0053" num="0052">To make the technical solution under the present invention clearer, the accompanying drawings for illustrating the embodiments of the present invention or the prior art are outlined below. Apparently, the accompanying drawings are for the exemplary purpose only, and person having ordinary skill in the art can derive other drawings from such accompanying drawings without any creative effort.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic flow chart of a first embodiment of a method for upgrading a Rights Object (RO) according to the present invention;</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic flow chart of a second embodiment of a method for upgrading an RO according to the present invention;</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 3</figref> is a schematic flow chart following interaction protocol reification in the second embodiment of a method for upgrading an RO according to the present invention;</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic flow chart of a first embodiment of another method for upgrading an RO according to the present invention;</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 5</figref> is a schematic flow chart of a second embodiment of another method for upgrading an RO according to the present invention;</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 6</figref> is a schematic flow chart following interaction protocol reification in the second embodiment of another method for upgrading an RO according to the present invention;</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 7</figref> is a schematic flow chart of an embodiment of a method for removing an RO according to the present invention;</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 8</figref> is a schematic flow chart of a first embodiment of a method for moving an RO according to the present invention;</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 9</figref> is a schematic flow chart of a second embodiment of a method for moving an RO according to the present invention;</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 10</figref> is a schematic flow chart following interaction protocol reification in the second embodiment of a method for moving an RO according to the present invention;</p>
<p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. 11</figref> is a schematic flow chart of a first embodiment of another method for moving an RO according to the present invention;</p>
<p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. 12</figref> is a schematic flow chart of a second embodiment of another method for moving an RO according to the present invention;</p>
<p id="p-0066" num="0065"><figref idref="DRAWINGS">FIG. 13</figref> is a schematic flow chart following interaction protocol reification in the second embodiment of another method for moving an RO according to the present invention;</p>
<p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. 14</figref> is a schematic structural view of an embodiment of a Rights Issuer (RI) according to the present invention;</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. 15</figref> is a schematic structural view of an embodiment of a Digital Rights Management (DRM) Agent according to the present invention;</p>
<p id="p-0069" num="0068"><figref idref="DRAWINGS">FIG. 16</figref> is a schematic structural view of an embodiment of another RI according to the present invention;</p>
<p id="p-0070" num="0069"><figref idref="DRAWINGS">FIG. 17</figref> is a schematic structural view of an embodiment of another DRM Agent according to the present invention;</p>
<p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. 18</figref> is a schematic structural view of an embodiment of still another DRM Agent according to the present invention;</p>
<p id="p-0072" num="0071"><figref idref="DRAWINGS">FIG. 19</figref> is a schematic structural view of an embodiment of still another RI according to the present invention;</p>
<p id="p-0073" num="0072"><figref idref="DRAWINGS">FIG. 20</figref> is a schematic structural view of an embodiment of still another DRM Agent according to the present invention;</p>
<p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. 21</figref> is a schematic structural view of an embodiment of still another RI according to the present invention;</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 22</figref> is a schematic structural view of an embodiment of still another DRM Agent according to the present invention;</p>
<p id="p-0076" num="0075"><figref idref="DRAWINGS">FIG. 23</figref> is a schematic structural view of an embodiment of a Secure Removable Media (SRM) Agent according to the present invention; and</p>
<p id="p-0077" num="0076"><figref idref="DRAWINGS">FIG. 24</figref> is a schematic structural view of an embodiment of another SRM Agent according to the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0078" num="0077">The technical solution of the present invention will be clearly and completely described in the following with reference to the accompanying drawings. It is obvious that the embodiments to be described are only a part rather than all of the embodiments of the present invention. All other embodiments obtained by persons skilled in the art based on the embodiments of the present invention without creative efforts shall fall within the protection scope of the present invention.</p>
<p id="p-0079" num="0078">According to the embodiments of the present invention, through a Digital Rights Management (DRM) Agent on a terminal device and a Secure Removable Media (SRM) Agent on an SRM, a Rights Issuer (RI) acquires Rights Object (RO) related information of an RO that requires updating on the SRM, and replaces the RO that requires updating on the SRM with a newly generated RO.</p>
<p id="p-0080" num="0079">The RO that requires updating may be an RO without Move rights, and accordingly, the new RO can be an RO with the Move rights. Further, according to the embodiments of the present invention, the SRM Agent interacts with the DRM Agent or another DRM Agent, so as to move the new RO with the Move rights to a device at which the DRM Agent locates or a device at which the another DRM Agent locates.</p>
<p id="p-0081" num="0080"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic flow chart of a first embodiment of a method for upgrading an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 1</figref>, the embodiment includes the following steps.</p>
<p id="p-0082" num="0081">In Step <b>101</b>, the DRM Agent of the terminal device interacts with the SRM Agent of the SRM, so as to acquire the related information of the RO that requires updating on the SRM.</p>
<p id="p-0083" num="0082">In Step <b>102</b>, the DRM Agent interacts with the RI and sends the related information of the RO that requires updating to the RI, and obtains from the RI a new RO generated according to the related information.</p>
<p id="p-0084" num="0083">In Step <b>103</b>, the DRM Agent interacts with the SRM Agent to upgrade the RO that requires updating on the SRM by means of the new RO.</p>
<p id="p-0085" num="0084">In the embodiment, by replacing the RO on the SRM, the SRM is enabled to have a certain type of new operation rights, so as to realize upgrading of the RO, thus extending the application of the RO.</p>
<p id="p-0086" num="0085"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic flow chart of a second embodiment of a method for upgrading an RO according to the present invention. A user of a device intends to move the RO issued by the RI and without the Move rights out from the SRM. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the embodiment includes the following steps.</p>
<p id="p-0087" num="0086">In Step <b>201</b>, the RI sends an ROUpgradeTrigger message to the DRM Agent, so as to trigger the DRM Agent to upgrade the RO in the SRM.</p>
<p id="p-0088" num="0087">Preferably, the ROUpgradeTrigger message may include an identifier of the RO that requires updating, so that when receiving the ROUpgradeTrigger message, the DRM Agent knows which RO is to be upgraded. Before the RI sends the ROUpgradeTrigger message, a terminal user needs to access a web site of the RI in virtue of the device at which the DRM Agent locates or other devices, and submit its own request about upgrading the RO in the SRM and related information of the new RO needed to be supplemented. After performing such operations as an accounting related operation, the RI sends the ROUpgradeTrigger trigger message to the DRM Agent.</p>
<p id="p-0089" num="0088">The step is an optional step, and the embodiment can also begin directly from Step <b>202</b>.</p>
<p id="p-0090" num="0089">Further, the ROUpgradeTrigger message can also include indication information for indicating whether the RI will preserve a Rights Encryption Key (REK) corresponding to the ever issued RO. The REK is used for encrypting a Content Encryption Key (CEK), so as to form the encrypted CEK in the RO.</p>
<p id="p-0091" num="0090">In Step <b>202</b>, the DRM Agent interacts with the SRM Agent to prepare to upgrade an RO on the SRM. The preparation work at least includes that the DRM Agent instructs the SRM Agent to set the RO that requires updating to an unavailable status, such that the RO that requires updating is unable to be used for consuming corresponding content by any device.</p>
<p id="p-0092" num="0091">Preferably, the DRM Agent may obtain an ExistProof indicating that &#x201c;the RO that requires updating actually exists in the SRM&#x201d; from the SRM Agent. The Existproof includes partial or all information of the RO that requires updating and a digital signature for the partial or all information of the RO by the SRM Agent. The partial information of the RO mentioned here may be the REK corresponding to the RO or the identifier of the RO. In the following steps, the DRM Agent may send the Existproof to the RI, and the RI verifies the digital signature for the partial or all information of the RO by the SRM included in the ExistProof. If the digital signature is verified to be correct, it is judged that the RO that requires updating exists in the SRM.</p>
<p id="p-0093" num="0092">Preferably, data of the digital signature performed by SRM in the Existproof can further include a time stamp, so as to prevent the DRM Agent from repetitively using the same ExistProof to get RO from the RI.</p>
<p id="p-0094" num="0093">Further, if the ROUpgradeTrigger message in the Step <b>201</b> includes the indication information which indicates that the RI does not preserve the REK corresponding to the ever issued RO, the SRM Agent should also encrypt the REK with a public key of the RI, and send it to the DRM Agent together with the ExistProof.</p>
<p id="p-0095" num="0094">In Step <b>203</b>, the DRM Agent interacts with the RI to acquire the new RO for replacing the RO that requires updating on the SRM. The new RO includes the Move rights. The DRM Agent may send the RO that requires updating, the previous digital signature for the original RO by the RI, and State Information of the RO that requires updating to the RI.</p>
<p id="p-0096" num="0095">Preferably, the DRM Agent can also send the ExistProof provided by the SRM Agent to the RI, in order to prove to the RI that the RO that requires updating actually exists on the SRM. After the RI verifies that the ExistProof is passed and judges that the RO that requires updating actually exists on the SRM, the new RO is generated to be sent to the DRM Agent. The REK of the new RO is encrypted with a manner in which the DRM Agent is incapable of finally decrypting to obtain, for example, the REK is encrypted firstly with a public key of the SRM, and further encrypted with a public key of the DRM Agent.</p>
<p id="p-0097" num="0096">Further, if the ROUpgradeTrigger message in the Step <b>201</b> includes the indication information which indicates that the RI does not preserve the REK corresponding to the ever issued RO, the DRM Agent should also send to the RI the REK encrypted by the SRM Agent with the public key of the RI, so that the RI verifies the ExistProof provided by the SRM Agent, without exposing the REK to the DRM Agent.</p>
<p id="p-0098" num="0097">Preferably, the DRM Agent can also send requirements of the terminal user about the new RO to the RI, for example, information of what types of Move rights are needed, such that the RI generates the new RO which satisfies the requirements of the terminal user.</p>
<p id="p-0099" num="0098">In Step <b>204</b>, the DRM Agent interacts with the SRM Agent to replace the RO that requires updating on the SRM with the new RO.</p>
<p id="p-0100" num="0099">The DRM Agent may firstly preprocess the new RO sent by the RI, for example, verifies the digital signature for the new RO by the RI, and requests the SRM Agent to replace the RO that requires updating on the SRM with the new RO acquired from the RI. During the replacement, the SRM needs to decrypt the encrypted REK with its own private key and preserve the decrypted REK.</p>
<p id="p-0101" num="0100">In Step <b>205</b>, the DRM Agent interacts with the RI to confirm that replacing the RO has been completed for the RI.</p>
<p id="p-0102" num="0101">The step is an optional step, and the embodiment can also be executed by directly skipping to Step <b>206</b>.</p>
<p id="p-0103" num="0102">In Step <b>206</b>, the DRM Agent interacts with the SRM Agent to move the new RO on the SRM to the device at which the DRM Agent locates or other devices.</p>
<p id="p-0104" num="0103">In the embodiment, by firstly upgrading the RO without the Move rights in the SRM, the RO is enabled to have sufficient Move rights, and then the RO is moved, so as to realize separation of upgrading from moving. After the RO is upgraded to have the Move rights, the user can decide which device the RO is to be moved to, such that the RO without the Move rights can be moved out from the SRM, thus extending the application of the RO without the Move rights. If the user intends to move the RO to one connectionless device, that is, a device which is unable to directly communicate with the RI, the embodiment is particularly suitable.</p>
<p id="p-0105" num="0104"><figref idref="DRAWINGS">FIG. 3</figref> is a schematic flow chart following interaction protocol reification in a second embodiment of a method for upgrading an RO according to the present invention. Assuming that the RI does not buffer the ever issued REK, as shown in <figref idref="DRAWINGS">FIG. 3</figref>, the detailed process includes the following steps.</p>
<p id="p-0106" num="0105">In Step <b>301</b>, the DRM Agent sends a RightsInfoQueryRequest message to the SRM Agent.</p>
<p id="p-0107" num="0106">In Step <b>302</b>, after receiving the RightsInfoQueryRequest message, the SRM Agent returns a RightsInfoQueryResponse message to the DRM Agent.</p>
<p id="p-0108" num="0107">Through the Step <b>301</b> and Step <b>302</b>, the DRM Agent obtains from the SRM all information about the RO that requires updating except for the REK, which includes: a &#x3c;rights&#x3e; element, a digital signature for the &#x3c;rights&#x3e; element by the RI, Meta Data of RO, and corresponding State Information (if a status RO exists).</p>
<p id="p-0109" num="0108">The RightsInfoQueryRequest message sent by the DRM Agent in the Step <b>301</b> includes fields as shown in Table 1:</p>
<p id="p-0110" num="0109">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 1</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of RightsInfoQueryRequest Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Handle</entry>
<entry>The unique identifier of the RO on the SRM</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0111" num="0110">The RightsInfoQueryResponse message returned by the SRM Agent in the Step <b>302</b> includes fields as shown in Table 2:</p>
<p id="p-0112" num="0111">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of RightsInfoQueryResponse Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Status</entry>
<entry>A result of processing the RightsInfoQueryRequest</entry>
</row>
<row>
<entry/>
<entry>message by the SRM Agent. If an error occurs, only</entry>
</row>
<row>
<entry/>
<entry>this field exists in the RightsInfoQueryResponse</entry>
</row>
<row>
<entry/>
<entry>message.</entry>
</row>
<row>
<entry>Rights</entry>
<entry>The Rights Meta Data, which includes information as</entry>
</row>
<row>
<entry>Meta Data</entry>
<entry>follows:</entry>
</row>
<row>
<entry/>
<entry>Rights Object Version</entry>
</row>
<row>
<entry/>
<entry>RO Alias</entry>
</row>
<row>
<entry/>
<entry>RI Identifier</entry>
</row>
<row>
<entry/>
<entry>RI URL</entry>
</row>
<row>
<entry/>
<entry>RI Alias</entry>
</row>
<row>
<entry/>
<entry>RI Time Stamp</entry>
</row>
<row>
<entry>Rights Object</entry>
<entry>Container including the &#x3c;rights&#x3e; element and a</entry>
</row>
<row>
<entry>Container</entry>
<entry>&#x3c;signature&#x3e; element</entry>
</row>
<row>
<entry>State</entry>
<entry>Remaining State Information of the RO, such as the left</entry>
</row>
<row>
<entry>Information</entry>
<entry>times of playing rights. If the RO has no status, the</entry>
</row>
<row>
<entry/>
<entry>field does not exist.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0113" num="0112">In Step <b>303</b>, after receiving the RightsInfoQueryResponse message, the DRM Agent knows that the RO does not have the Move rights according to the &#x3c;rights&#x3e; element and the State Information of the RO.</p>
<p id="p-0114" num="0113">After receiving the RightsInfoQueryResponse message, the DRM Agent finds that the RO does not have the Move rights by analyzing the &#x3c;rights&#x3e; element and the State Information of the RO. The device prompts the user to upgrade the RO in a manner of popping up a dialogue box.</p>
<p id="p-0115" num="0114">In Step <b>304</b>, the user logs in the web site provided by the RI through the device at which the DRM Agent locates or other devices, and submits a request for upgrading the RO on the SRM through a page provided by the web site. Preferably, the user can specify through a web page the identifier of the RO that requires updating and the rights that needs to be supplemented.</p>
<p id="p-0116" num="0115">In Step <b>305</b>, after such operations as accounting, the RI launches a SRMROUpgradeTrigger message to the DRM Agent. The SRMROUpgradeTrigger message may be used for triggering the DRM Agent to upgrade the RO on the SRM. Fields included in the SRMROUpgradeTrigger message are shown in Table 3:</p>
<p id="p-0117" num="0116">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 3</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of SRMROUpgradeTrigger Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>ROID</entry>
<entry>RO Identifier</entry>
</row>
<row>
<entry>upgradeInfo</entry>
<entry>Detailed upgrading requirements that the user specifies in</entry>
</row>
<row>
<entry/>
<entry>a browser, such as, the type of the Move rights that needs</entry>
</row>
<row>
<entry/>
<entry>to be supplemented, and the times by which the moving</entry>
</row>
<row>
<entry/>
<entry>is performed</entry>
</row>
<row>
<entry>REKNeeded</entry>
<entry>The RI does not buffer the REK corresponding to the</entry>
</row>
<row>
<entry/>
<entry>ever issued RO, and the DRM Agent is needed to transfer</entry>
</row>
<row>
<entry/>
<entry>the original text of the REK to the RI, so as to verify the</entry>
</row>
<row>
<entry/>
<entry>RI.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0118" num="0117">In Step <b>306</b>, after receiving the SRMROUpgradeTrigger message, the DRM Agent sends a RightsUpgradeSetupRequest message to the SRM Agent. The DRM Agent sends the RightsUpgradeSetupRequest message to the SRM Agent in two manners.</p>
<p id="p-0119" num="0118">In the first manner, according to the upgradeInfo field in the SRMROUpgradeTrigger message, display rights information ever specified to be in need of supplementation by the user to the user, and send the rights information after getting confirmation of the user.</p>
<p id="p-0120" num="0119">In the second manner, automatically send without the confirmation of the user.</p>
<p id="p-0121" num="0120">Fields included in the RightsUpgradeSetupRequest message are shown in Table 4:</p>
<p id="p-0122" num="0121">
<tables id="TABLE-US-00004" num="00004">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 4</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of RightsUpgradeSetupRequest Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Handle</entry>
<entry>The unique identifier (original identifier) of the RO on</entry>
</row>
<row>
<entry/>
<entry>the SRM</entry>
</row>
<row>
<entry>New Handle</entry>
<entry>The identifier newly allocated for the RO in this</entry>
</row>
<row>
<entry/>
<entry>upgrading transaction by the DRM Agent, other devices</entry>
</row>
<row>
<entry/>
<entry>are unable to know the value of the New Handle.</entry>
</row>
<row>
<entry>REKNeeded</entry>
<entry>The RI does not buffer the REK corresponding to the</entry>
</row>
<row>
<entry/>
<entry>ever issued RO, and the SRM Agent is needed to transfer</entry>
</row>
<row>
<entry/>
<entry>the original text of the REK to the RI, so as to verify the</entry>
</row>
<row>
<entry/>
<entry>RI.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0123" num="0122">In Step <b>307</b>, after receiving the RightsUpgradeSetupRequest message, the SRM Agent uses the New Handle field to overwrite the existing Handle field.</p>
<p id="p-0124" num="0123">Before the step <b>307</b>, the uniqueness of the New Handle field needs to be verified, that is, it should be ensure that other Handle fields do not exist on the SRM. In this way, the unique identifier of the RO on the SRM is only known by the DRM Agent, while other DRM Agents are unable to access the RO because they do not know the corresponding Handle field.</p>
<p id="p-0125" num="0124">Preferably, the SRM Agent may further set the RO at an unavailable status. Because such fields as Handle of the RO at the unavailable status are not allowed to be queried, it is further ensured that the RO is not accessed by other devices.</p>
<p id="p-0126" num="0125">The SRMROUpgradeTrigger message sent by the RI includes the REKNeeded field, and thus the DRM Agent also includes the REKNeeded field in the RightsUpgradeSetupRequest message, so as to demonstrate to the SRM Agent that the RI does not buffer the ever issued REK. Therefore, the SRM Agent needs to send the REK in the subsequent steps. If the RI is able to buffer all issued REK, it is unnecessary to transfer the REKNeeded field.</p>
<p id="p-0127" num="0126">In Step <b>308</b>, the SRM Agent sends a Rights Upgrade Setup Response message to the DRM Agent.</p>
<p id="p-0128" num="0127">Fields included in the Rights Upgrade Setup Response message are shown in Table 5:</p>
<p id="p-0129" num="0128">
<tables id="TABLE-US-00005" num="00005">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 5</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of Rights Upgrade Setup Response Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Status</entry>
<entry>Indicate whether the SRM Agent successfully processes</entry>
</row>
<row>
<entry/>
<entry>the RightsUpgradeSetupRequest message. If an error</entry>
</row>
<row>
<entry/>
<entry>occurs, the response message will only include the field,</entry>
</row>
<row>
<entry/>
<entry>and the subsequent fields will not be included.</entry>
</row>
<row>
<entry>ExistProof</entry>
<entry>Demonstrate that the RO exists on the SRM</entry>
</row>
<row>
<entry>EncryptedREK</entry>
<entry>REK encrypted with the public key of the RI, that is,</entry>
</row>
<row>
<entry/>
<entry>REK bound to the RI</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0130" num="0129">The ExistProof field is used for proving that the RO that requires updating exists on the SRM, and is an optional field. The ExistProof field includes all information of the RO that requires updating and the digital signature for the all information of the RO that requires updating by the SRM, or includes partial information of the RO that requires updating and the digital signature for the partial information of the RO that requires updating by the SRM. The partial information may be the REK of the RO that requires updating, the identifier of the RO that requires updating, or a combination of the REK of the RO that requires updating and the identifier of the RO that requires updating.</p>
<p id="p-0131" num="0130">If the REKNeeded field does not exist in the RightsUpgradeSetupRequest message, the EncryptedREK field in the RightsUpgradeSetupResponse message may also be omitted.</p>
<p id="p-0132" num="0131">In Step <b>309</b>, after receiving the RightsUpgradeSetupResponse message, the DRM Agent sends a SRM RO Upgrade Request message to the RI.</p>
<p id="p-0133" num="0132">Fields included in the SRMROUpgradeRequest message are shown in Table 6:</p>
<p id="p-0134" num="0133">
<tables id="TABLE-US-00006" num="00006">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 6</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of SRMROUpgradeRequest Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>ROID</entry>
<entry>Identifier of the RO that requires updating on the SRM</entry>
</row>
<row>
<entry>&#x3c;rights&#x3e;</entry>
<entry>&#x3c;rights&#x3e; element in the RO that requires updating</entry>
</row>
<row>
<entry>&#x3c;signature&#x3e;</entry>
<entry>Digital signature for the &#x3c;rights&#x3e; element by the RI</entry>
</row>
<row>
<entry>State</entry>
<entry>State Information corresponding to the RO that requires</entry>
</row>
<row>
<entry>Information</entry>
<entry>updating on the SRM</entry>
</row>
<row>
<entry>ExistProof</entry>
<entry>Indicate that the RO exists on the SRM</entry>
</row>
<row>
<entry>EncryptedREK</entry>
<entry>REK of the RO that requires updating encrypted with the</entry>
</row>
<row>
<entry/>
<entry>public key of the RI</entry>
</row>
<row>
<entry>upgradeInfo</entry>
<entry>Detailed upgrading requirements on the RO for the user</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0135" num="0134">The ExistProof is used for proving that the RO that requires updating exists on the SRM. The form of the proof is seen in the Step <b>308</b>.</p>
<p id="p-0136" num="0135">The EncryptedREK field can be used by the RI to verify whether the device of the terminal user (the device at which the DRM Agent locates or the SRM, but does not know which on earth is it) really owns the RO that requires updating, so that the RI decrypts the encryptedCEK in the &#x3c;rights&#x3e; element only by using the REK. If the decryption is successful, it indicates that the device of the terminal user owns the RO that requires updating, and otherwise, the device does not own the RO that requires updating. The EncryptedREK field can also be used by the RI to verify the ExistProof field. When the RI does not preserve its own ever issued REK of the RO that requires updating, the RI needs to decrypt the EncryptedREK to get the original text of the REK, so as to verify the ExistProof.</p>
<p id="p-0137" num="0136">There can be two cases of the value of the upgradeInfo field in the SRMROUpgradeRequest message: when the DRM Agent performs an RO upgrading operation with the triggering of the SRMROUpgradeTrigger message, the value of the upgradeInfo field is obtained from the value of the field with the same name in the SRMROUpgradeTrigger message; and when the DRM Agent performs the RO upgrading operation without the triggering of the SRMROUpgradeTrigger message, the device needs to display a friendly user interface, for the user to specify the upgrading requirements for the RO, and the value of the upgradeInfo field will be obtained from the user interface.</p>
<p id="p-0138" num="0137">In Step <b>310</b>, after receiving the SRMROUpgradeRequest message, the RI verifies the digital signature for the &#x3c;rights&#x3e; element by the RI and the ExistProof.</p>
<p id="p-0139" num="0138">In Step <b>311</b>, after passing the verification, the RI constructs a new RO according to the upgradeInfo field, and sends the new RO to the DRM Agent through a SRMROUpgradeResponse message.</p>
<p id="p-0140" num="0139">Preferably, for the purpose of security, the REK in the new RO is different from the REK in the original RO that requires updating.</p>
<p id="p-0141" num="0140">Fields included in the SRMROUpgradeResponse message are shown in Table 7:</p>
<p id="p-0142" num="0141">
<tables id="TABLE-US-00007" num="00007">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 7</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of SRMROUpgradeResponse Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="175pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Status</entry>
<entry>Indicate whether the RI has successfully processed the</entry>
</row>
<row>
<entry/>
<entry>SRMROUpgradeRequest message. If an error occurs,</entry>
</row>
<row>
<entry/>
<entry>subsequent fields of the message will not exist.</entry>
</row>
<row>
<entry>New RO</entry>
<entry>New RO under protection and satisfying the user</entry>
</row>
<row>
<entry/>
<entry>requirements. The New RO includes the digital</entry>
</row>
<row>
<entry/>
<entry>signature for the &#x3c;rights&#x3e; element by the RI, and its REK</entry>
</row>
<row>
<entry/>
<entry>is firstly encrypted with the public key of the SRM Agent</entry>
</row>
<row>
<entry/>
<entry>and then encrypted with the public key of the DRM</entry>
</row>
<row>
<entry/>
<entry>Agent.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0143" num="0142">The REK in the new RO should be different from the REK of the RO that requires updating, and its encrypting algorithm is described as follows.</p>
<p id="p-0144" num="0143">After the RI randomly generates the REK, it is needed to execute the following steps for delivering the REK to the SRM in a case that the DRM Agent is unable to know.</p>
<p id="p-0145" num="0144">A random number Z<sub>x </sub>is generated, so as to get:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>KEK<sub>x</sub>=KDF(<i>I</i>2OSP(<i>Z</i><sub>x</sub><i>,m</i>Len<sub>SRM</sub>),NULL,kekLen)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where mLen<sub>the SRM </sub>is a modulus length of an SRM certificate, and the kekLen and the KDF( ) function can refer to the OMA DRM standard manuscript OMA-TS-DRM_DRM-V2<sub>&#x2014;</sub>1-20070919-C.doc;
</p>
<p id="p-0146" num="0145">so as to get:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>x2</sub>=AES&#x2212;WRAP(KEK<sub>x</sub>,REK); and<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>x1</sub><i>=I</i>2OSP(RSA.ENCRYPT(PubKey<sub>SRM</sub><i>,Z</i><sub>x</sub>),<i>m</i>Len<sub>SRM</sub>);<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0147" num="0146">in which, the I2OSP( ) function and the RSA.ENCRYPT( ) function can refer to the DRM standard manuscript;</p>
<p id="p-0148" num="0147">and so as to get:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>EncREK=<i>C</i><sub>x1</sub><i>|C</i><sub>x2</sub>.<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0149" num="0148">A random number Z and a K<sub>MAC </sub>are then generated (according to the DRM standard, which is used for the DRM Agent to verify the message integrity), so as to get:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>KEK=KDF(<i>I</i>2OSP(<i>Z,m</i>Len<sub>DRMAgent</sub>),NULL,kekLen);<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0150" num="0149">in which, mLen<sub>DRMAgent </sub>is a modulus length of a DRM certificate, and the kekLen and the KDF( ) function can refer to the DRM standard manuscript;</p>
<p id="p-0151" num="0150">and so as to get by the previously got EncREK and K<sub>MAC</sub>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>K=K</i><sub>MAC</sub>|EncREK;<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>2</sub>=AES&#x2212;WRAP(KEK,<i>K</i>);<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>1</sub><i>=I</i>2OSP(RSA.ENCRYPT(PubKey<sub>DRMAgent</sub><i>,Z</i>),<i>m</i>Len<sub>DRMAgent</sub>); and<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C=C</i><sub>1</sub><i>|C</i><sub>2</sub>.<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0152" num="0151">The RI carries the C in the new RO and sends the new RO to the DRM Agent. After receiving the C, the DRM Agent can finally get the EncREK by means of its own private key, and transfer the EncREK to the SRM Agent. The SRM Agent can finally get the REK by means of its own private key.</p>
<p id="p-0153" num="0152">In Step <b>312</b>, after receiving the new RO satisfying the user requirements, the DRM Agent preprocesses the new RO. The preprocessing includes the following steps.</p>
<p id="p-0154" num="0153">Verify the digital signature for the SRMROUpgradeResponse message by the RI.</p>
<p id="p-0155" num="0154">Verify the digital signature for the &#x3c;rights&#x3e; element by the RI.</p>
<p id="p-0156" num="0155">Extract from the SRMROUpgradeResponse message the Rights Meta Data, the &#x3c;rights&#x3e; element, the &#x3c;signature&#x3e; element, that is, the digital signature for the &#x3c;rights&#x3e; element by the RI defined by the OMA SRM 1.0 standard.</p>
<p id="p-0157" num="0156">Extract the EncryptedREK field, that is, a result of encrypting the REK by the RI with the public key of the SRM Agent from the SRMROUpgradeResponse message.</p>
<p id="p-0158" num="0157">If appropriately reducing the security requirements, the REK of the new RO can also not be further encrypted with the public key of the SRM Agent.</p>
<p id="p-0159" num="0158">In Step <b>313</b>, after completing the preprocessing, the DRM Agent sends a RightsReplaceRequest message to the SRM Agent.</p>
<p id="p-0160" num="0159">Fields included in the RightsReplaceRequest message are shown in Table 8:</p>
<p id="p-0161" num="0160">
<tables id="TABLE-US-00008" num="00008">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 8</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of RightsReplaceRequest Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Handle</entry>
<entry>Current identifier of the RO in the SRM, its value is the</entry>
</row>
<row>
<entry/>
<entry>New Handle in the RightsUpgradeSetupRequest</entry>
</row>
<row>
<entry/>
<entry>message.</entry>
</row>
<row>
<entry>Size</entry>
<entry>Size of the new RO</entry>
</row>
<row>
<entry>Rights</entry>
<entry>Extracted from the SRMROUpgradeResponse message,</entry>
</row>
<row>
<entry>Information</entry>
<entry>and including the Rights Meta Data and the RO</entry>
</row>
<row>
<entry/>
<entry>Container</entry>
</row>
<row>
<entry>EncryptedREK</entry>
<entry>REK encrypted with the public key of the SRM</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0162" num="0161">In Step <b>314</b>, after receiving the RightsReplaceRequest message, the SRM Agent replaces the RO that requires updating with the new RO.</p>
<p id="p-0163" num="0162">Replacing with the new RO by the SRM Agent can adopt two following manners.</p>
<p id="p-0164" num="0163">In the first manner, a new storage slot for storing the new RO is newly created according to the size field, which has a corresponding handle field being a temporary handle, the new RO is stored into the new storage slot, the existing original storage slot (that is, the storage slot corresponding to the value of the handle field in the RightsReplaceRequest message) is removed, and the temporary handle is overwritten with the value corresponding to the handle field in the RightsReplaceRequest message.</p>
<p id="p-0165" num="0164">In the second manner, firstly, the existing original storage slot (that is, the storage slot corresponding to the value of the handle field in the RightsReplaceRequest message) is removed, a new storage slot is created according to the size field, which has a value of the corresponding handle being the value of the handle field in the RightsReplaceRequest message, and the new RO is stored into the new storage slot.</p>
<p id="p-0166" num="0165">In the process of storing the new RO into the new storage slot in the two manners, if the REK in the SRMROUpgradeResponse is further encrypted with the public key of the SRM Agent, it is different from the OMA SRM 1.0 standard in that, before storing the REK, the SRM Agent needs to decrypt the EncryptedREK field with its own private key, and then store the result after decrypting into the storage slot. Otherwise, the SRM Agent directly stores the REK without a decryption process.</p>
<p id="p-0167" num="0166">In Step <b>315</b>, the SRM Agent returns a RightsReplaceResponse message to the DRM Agent.</p>
<p id="p-0168" num="0167">Fields included in the RightsReplaceResponse message are shown in Table 9:</p>
<p id="p-0169" num="0168">
<tables id="TABLE-US-00009" num="00009">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 9</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of RightsReplaceResponse Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Status</entry>
<entry>Indicate whether the SRM Agent has successfully</entry>
</row>
<row>
<entry/>
<entry>processed the RightsReplaceRequest message. If an</entry>
</row>
<row>
<entry/>
<entry>error occurs, subsequent fields of the message will not</entry>
</row>
<row>
<entry/>
<entry>exist.</entry>
</row>
<row>
<entry>ReplaceProof</entry>
<entry>Proof for demonstrating that the new RO has replaced the</entry>
</row>
<row>
<entry/>
<entry>existing RO that requires updating in the SRM</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0170" num="0169">The ReplaceProof field is used for proving that the new RO has replaced the existing RO that requires updating on the SRM, and is an optional field. The proof includes the following information and the digital signature for it by the SRM:</p>
<p id="p-0171" num="0170">
<tables id="TABLE-US-00010" num="00010">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>&#x2003;&#x2003;{</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier of the DRM Agent which urges the SRM Agent to</entry>
</row>
<row>
<entry>perform the upgrading operation;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;upgrading time;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier representing the replacing operation;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the REK of the new RO and/or the identifier of the new RO; and</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the REK of the old RO (that is, the REK of the RO that requires</entry>
</row>
<row>
<entry>updating) and/or the identifier of the old RO (that is, the identifier of the</entry>
</row>
<row>
<entry>RO that requires updating)</entry>
</row>
<row>
<entry>&#x2003;&#x2003;}</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0172" num="0171">In Step <b>316</b>, after receiving the RightsReplaceResponse message, the DRM Agent sends a SRM RO Upgrade Confirm Request message to the RI, so as to confirm for the RI that the new RO has successfully replaced the original RO on the SRM.</p>
<p id="p-0173" num="0172">Fields included in the SRMROUpgradeConfirmRequest message are shown in Table 10:</p>
<p id="p-0174" num="0173">
<tables id="TABLE-US-00011" num="00011">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 10</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of SRMROUpgradeConfirmRequest Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Status</entry>
<entry>Indicate whether the RO has been successfully upgraded</entry>
</row>
<row>
<entry>ReplaceProof</entry>
<entry>Proof for demonstrating that the new RO has replaced the</entry>
</row>
<row>
<entry/>
<entry>existing RO that requires updating in the SRM</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0175" num="0174">The ReplaceProof field is used for proving that the new RO has replaced the existing RO that requires updating on the SRM, and is an optional field. The form of the proof is seen in the Step <b>315</b>.</p>
<p id="p-0176" num="0175">In the Steps <b>314</b> to <b>316</b>, replacing of the old RO with the new RO is realized through a pair of messages. The inventor considers that it can also be realized through two pairs of messages. That is to say, the DRM Agent sends the messages to the SRM Agent and requires the SRM Agent to remove the RO that requires updating; and after confirming that the RO that requires updating has been removed, the DRM Agent sends the messages to the SRM Agent to transfer the new RO to the SRM Agent, and the SRM Agent installs the new RO into the SRM. However, in this way, the DRM Agent obtains a RemovalProof of the RO that requires updating and an InstallationProof of the new RO successively from the SRM Agent. The RemovalProof includes the following information and the digital signature for it by the SRM:</p>
<p id="p-0177" num="0176">
<tables id="TABLE-US-00012" num="00012">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>&#x2003;&#x2003;{</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier of the DRM Agent which urges the SRM Agent to</entry>
</row>
<row>
<entry>perform a removing operation;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;removing time;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier representing the removing operation;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the REK of the removed RO; (that is, the REK of the RO that</entry>
</row>
<row>
<entry>&#x2003;&#x2003;requires updating) and the identifier of the removed RO; (that is, the</entry>
</row>
<row>
<entry>identifier of the RO that requires updating)</entry>
</row>
<row>
<entry>&#x2003;&#x2003;}</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0178" num="0177">Moreover, the InstallationProof includes the following information and the digital signature for it by the SRM:</p>
<p id="p-0179" num="0178">
<tables id="TABLE-US-00013" num="00013">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>&#x2003;&#x2003;{</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the&#x2002;identifier&#x2002;of&#x2002;the&#x2002;DRM&#x2002;Agent&#x2002;which&#x2002;urges&#x2002;the&#x2002;SRM&#x2002;Agent&#x2002;to</entry>
</row>
<row>
<entry>perform an installation operation;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;installation time;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier representing the installation operation;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the REK of the installed RO; (that is, the REK of the new RO) and</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier of the installed RO; (that is, the identifier of the new</entry>
</row>
<row>
<entry>&#x2003;&#x2003;RO)</entry>
</row>
<row>
<entry>&#x2003;&#x2003;}</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0180" num="0179">In Step <b>317</b>, after receiving the SRMROUpgradeConfirmRequest message, the RI verifies the ReplaceProof or the RemovalProof and the InstallationProof provided by the SRM Agent.</p>
<p id="p-0181" num="0180">In Step <b>318</b>, after passing the verification, the RI returns a SRMROUpgradeConfirmResponse message to the DRM Agent.</p>
<p id="p-0182" num="0181">Fields included in the SRMROUpgradeConfirmResponse message are shown in Table 11:</p>
<p id="p-0183" num="0182">
<tables id="TABLE-US-00014" num="00014">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 11</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of SRMROUpgradeConfirmResponse Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Status</entry>
<entry>Indicate whether the RI has successfully processed the</entry>
</row>
<row>
<entry/>
<entry/>
<entry>SRMROUpgradeConfirmRequest message</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0184" num="0183">After executing the step, the RO not having the Move rights on the SRM currently has been replaced by the RO having the Move rights.</p>
<p id="p-0185" num="0184">In Step <b>319</b>, after receiving the SRMROUpgradeConfirmResponse message, the DRM Agent can move the upgraded new RO to the device at which the DRM Agent locates with a Push Move protocol of the OMA SRM 1.0 immediately or at a certain moment in future.</p>
<p id="p-0186" num="0185">If the user is unwilling to move the RO to the device which the DRM agent locates at, while intends to move the RO to another device, the user can insert the SRM to the another device, and then perform a Pull Move operation.</p>
<p id="p-0187" num="0186">Alternatively, besides the disclosed realization methods, some alternative methods for the steps in the embodiment also exist, which are described in the following for example.</p>
<p id="p-0188" num="0187">The obtaining, by the DRM Agent, the new RO from the RI can also be realized without using the method of adding new messages, that is, the SRMROUpgradeRequest message and the SRMROUpgradeResponse message on the existing OMA SRM 1.0 standard as in the Step <b>309</b> and the Step <b>310</b>, instead, the same effect can be achieved by modifying a message in an existing ROAP-ROUpgrade Protocol, and delivering a field or data needed to be delivered by means of an Extension field in the message.</p>
<p id="p-0189" num="0188">The replacing the original RO on the SRM with the new RO by the DRM Agent can also be realized without using the method of adding new messages, that is, the RightsReplaceRequest message and the RightsReplaceResponse message on the existing OMA SRM 1.0 standard as in the Step <b>313</b> and the Step <b>315</b>, instead, it is realized with two pairs of messages. Particularly, firstly the new RO is installed, that is, the RightslnstallRequest message and the RightslnstallResponse message are used, and then the existing original RO is removed, that is, the RightsRemovalRequest message and the RightsRemovalResponse message are used. However, the installing the new RO is somewhat different from the installation method in the existing OMA SRM 1.0 standard, that is, the SRM Agent needs to preserve the EncryptedREK field after decrypting it with the private key of the SRM Agent, while in the OMA SRM 1.0 standard, the DRM Agent transfers to the SRM Agent the REK which can be directly stored, rather than the REK encrypted with the public key of the SRM Agent.</p>
<p id="p-0190" num="0189"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic flow chart of a first embodiment of another method for upgrading an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, the embodiment includes the following steps.</p>
<p id="p-0191" num="0190">In Step <b>401</b>, the DRM Agent interacts with the SRM Agent to acquire the RO related information of the RO that requires updating on the SRM.</p>
<p id="p-0192" num="0191">In Step <b>402</b>, the RI triggers the DRM Agent to interact with the SRM Agent to remove the RO that requires updating on the SRM.</p>
<p id="p-0193" num="0192">In Step <b>403</b>, the RI triggers the DRM Agent to obtain the new RO generated according to the related information from the RI, and install the new RO to the SRM.</p>
<p id="p-0194" num="0193">In this embodiment, by removing the RO on the SRM and replacing the RO with the new RO, the SRM is enabled to have a certain type of the new operation rights, so as to realize the upgrading of the RO, thus extending the application of the RO.</p>
<p id="p-0195" num="0194"><figref idref="DRAWINGS">FIG. 5</figref> is a schematic flow chart of a second embodiment of another method for upgrading an RO according to the present invention. An RO issued by the RI and not having the Move rights exists on the SRM, and a user of a device intends to move the RO to the device. As shown in <figref idref="DRAWINGS">FIG. 5</figref>, the embodiment includes the following steps.</p>
<p id="p-0196" num="0195">In Step <b>501</b>, the RI sends a RORemovalTrigger message to the DRM Agent, so as to trigger the DRM Agent to remove the RO on the SRM.</p>
<p id="p-0197" num="0196">Preferably, the RORemovalTrigger message can include the identifier of the original RO to be removed, so that when receiving the RORemovalTrigger message, the DRM Agent knows which RO is to be removed. Before the RI sends the RORemovalTrigger message, the terminal user needs to access the web site of the RI in virtue of the device at which the DRM Agent locates or the other devices, and submit a request about intending to move the RO in the SRM to the device and the related information of the new RO needed to be supplemented. After performing such operations as the accounting related operation, the RI can send the RORemovalTrigger message to the DRM Agent.</p>
<p id="p-0198" num="0197">The step is an optional step, and the embodiment can also begin directly from Step <b>502</b>.</p>
<p id="p-0199" num="0198">In Step <b>502</b>, the DRM Agent interacts with the SRM Agent to remove the RO on the SRM.</p>
<p id="p-0200" num="0199">Preferably, the DRM Agent can obtain the RemovalProof indicating that &#x201c;the RO has been removed by the SRM Agent&#x201d; from the SRM Agent. The form of the proof is seen in the illustration of the Step <b>316</b>.</p>
<p id="p-0201" num="0200">In Step <b>503</b>, the DRM Agent interacts with the RI to report to the RI that removal of the RO that requires updating is completed.</p>
<p id="p-0202" num="0201">Preferably, for the purpose of security, the DRM Agent should provide the RemovalProof in the Step <b>502</b> to the RI. After verifying that the ExistProof is passed, the RI can judge that the RO that requires updating has been removed from the SRM, and send the new RO to the DRM Agent.</p>
<p id="p-0203" num="0202">In Step <b>504</b>, the RI installs a new RO including the existing rights in the RO that requires updating together with the Move rights needed by the user to the SRM through the DRM Agent.</p>
<p id="p-0204" num="0203">In Step <b>505</b>, the DRM Agent interacts with the SRM Agent to move the new RO on the SRM to the device at which the DRM Agent locates. Alternatively, another DRM Agent interacts with the SRM Agent to move the new RO on the SRM to the device at which the another DRM Agent locates.</p>
<p id="p-0205" num="0204">This embodiment is similar to an embodiment of a method for upgrading RO rights of the present invention. By firstly upgrading the RO without the Move rights in the SRM, the RO is enabled to have sufficient Move rights, and then the RO is moved, so as to realize the separation of the upgrading from the moving. After the RO is upgraded to have the Move rights, the RO is moved to the device at which the DRM Agent locates, so as to move the RO without the Move rights out from the SRM, thus extending the application of the RO without the Move rights. However, the upgrading method in the embodiment is different, that is, the RI triggers the DRM Agent to remove the RO on the SRM, and then installs the new RO to the SRM through the DRM Agent.</p>
<p id="p-0206" num="0205"><figref idref="DRAWINGS">FIG. 6</figref> is a schematic flow chart following interaction protocol reification in a second embodiment of another method for upgrading an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 6</figref>, the detailed process includes the following steps.</p>
<p id="p-0207" num="0206">In Step <b>601</b>, the DRM Agent sends the RightsInfoQueryRequest message to the SRM Agent. The RightsInfoQueryRequest message includes the Handle field.</p>
<p id="p-0208" num="0207">In Step <b>602</b>, after receiving the RightsInfoQueryRequest message, the SRM Agent returns the RightsInfoQueryResponse message to the DRM Agent. The RightsInfoQueryResponse message includes the Rights Meta Data field, the Rights Object Container field, and the State Information field.</p>
<p id="p-0209" num="0208">Through the Step <b>601</b> and Step <b>602</b>, from the SRM, the DRM Agent obtains all information about the RO to be removed except for the REK, which includes: the &#x3c;rights&#x3e; element, the signature for the &#x3c;rights&#x3e; element by the RI, the Rights Meta Data, and the corresponding State Information (If the RO has the status RO).</p>
<p id="p-0210" num="0209">In Step <b>603</b>, after receiving the RightsInfoQueryResponse message, the DRM Agent can know that the RO does not have the Move rights according to the &#x3c;rights&#x3e; element and the State Information of the RO.</p>
<p id="p-0211" num="0210">After receiving the RightsInfoQueryResponse message, the DRM Agent can find that the RO does not have the Move rights by analyzing the &#x3c;rights&#x3e; element and the State Information of the RO. The device can prompt the user to upgrade the RO in the manner of popping up a dialogue box.</p>
<p id="p-0212" num="0211">In Step <b>604</b>, the user logs in the web site provided by the RI through the device at which the DRM Agent locates or the other devices, and submits the request about upgrading the RO on the SRM through the page provided by the web site. Preferably, the user can specify the identifier of the RO that requires updating and the rights that needs to be supplemented through the web page.</p>
<p id="p-0213" num="0212">In Step <b>605</b>, after such operations as the accounting, the RI sends a SRMRORemovalTrigger message to the DRM Agent. The SRMRORemovalTrigger message can be used for triggering the DRM Agent to remove the RO on the SRM. The SRMRORemovalTrigger message includes the ROD field and the REKNeeded field.</p>
<p id="p-0214" num="0213">Preferably, the SRMRORemovalTrigger message may also include the reason of the RO removal or a hyperlink for designating the reason of the removal. In this way, after the DRM Agent receives the SRMRORemovalTrigger message, the device at which the DRM Agent locates can display to the terminal user the reason of the removal, such as, the user has submitted the requirements for upgrading the RO through a web page before.</p>
<p id="p-0215" num="0214">In Step <b>606</b>, after receiving the SRMRORemovalTrigger message, the DRM Agent sends a RightsRemovalRequest message to the SRM Agent. The RightsRemovalRequest message includes the Handle field and the ProofNeeded field.</p>
<p id="p-0216" num="0215">In Step <b>607</b>, the SRM Agent sends a RightsRemovalResponse message to the DRM Agent. The RightsRemovalResponse message includes the Status field and the Proof of Removal field.</p>
<p id="p-0217" num="0216">In Step <b>608</b>, after receiving the RightsRemovalResponse message, the DRM Agent sends a SRMRORemovalReportRequest message to the RI. The SRMRORemovalReportRequest message includes the ROID field, the &#x3c;rights&#x3e; element, the &#x3c;signature&#x3e; element, and the Proof of Removal field.</p>
<p id="p-0218" num="0217">In Step <b>609</b>, after receiving the SRMRORemovalReportRequest message, the RI returns a SRMRORemovalReportResponse message to the DRM Agent.</p>
<p id="p-0219" num="0218">In Step <b>610</b>, the RI sends a ROAquisitionTrigger message to the DRM Agent. The ROAquisitionTrigger message includes the ROID field.</p>
<p id="p-0220" num="0219">In Step <b>611</b>, the DRM Agent sends a RORequest message to the RI, so as to acquire the new RO having the Move rights. The RORequest message includes the ROID field.</p>
<p id="p-0221" num="0220">In Step <b>612</b>, after receiving the RORequest message, the RI provides a new RO bound to the SRM Agent to the SRM through the DRM Agent by returning a ROResponse message to the DRM Agent.</p>
<p id="p-0222" num="0221">In Step <b>613</b>, after receiving the new RO, the DRM Agent performs preprocessing on the new RO. The preprocessing includes such steps as verifying the integrity of the RO.</p>
<p id="p-0223" num="0222">In Step <b>614</b>, after completing the preprocessing, the DRM Agent sends an InstallationSetupRequest message to the SRM Agent. The InstallationSetupRequest message includes the Handle field and the Size field.</p>
<p id="p-0224" num="0223">In Step <b>615</b>, after receiving the InstallationSetupRequest message, the SRM Agent returns an InstallationSetupResponse message to the DRM Agent. The InstallationSetupResponse message includes the Status field.</p>
<p id="p-0225" num="0224">In Step <b>616</b>, after receiving the InstallationSetupResponse message, the DRM Agent sends a RightslnstallationSetupRequest message to the SRM Agent. The RightslnstallationSetupRequest message includes the Handle field, the Rights Information field, and an REK bound to SRM Agent field.</p>
<p id="p-0226" num="0225">In Step <b>617</b>, after receiving the RightslnstallRequest message, the SRM Agent returns a RightslnstallationSetupResponse message to the DRM Agent. The RightslnstallationSetupResponse message includes the Status field.</p>
<p id="p-0227" num="0226">So far, the RO originally not having the Move rights on the SRM becomes the RO having the Move rights.</p>
<p id="p-0228" num="0227">In Step <b>618</b>, the DRM Agent interacts with the SRM Agent to move the new RO out from the SRM. After receiving the RightslnstallationSetupResponse message, the DRM Agent can move the upgraded new RO to the device at which the DRM Agent locates immediately or at a certain moment in future.</p>
<p id="p-0229" num="0228"><figref idref="DRAWINGS">FIG. 7</figref> is a schematic flow chart of an embodiment of a method for removing an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 7</figref>, the embodiment includes the following steps.</p>
<p id="p-0230" num="0229">In Step <b>701</b>, the DRM Agent on the terminal device receives a RORemovalTrigger message sent by the RI. The RORemovalTrigger message includes the identifier of the RO to be removed on the SRM.</p>
<p id="p-0231" num="0230">In Step <b>702</b>, the DRM Agent interacts with the SRM Agent on the SRM to remove the RO to be removed.</p>
<p id="p-0232" num="0231">In this embodiment, according to the identifier of the RO to be removed on the SRM included in the received RORemovalTrigger message, the DRM Agent interacts with the SRM Agent on the SRM to remove the RO to be removed, so that the RO on the SRM can be removed, and the new RO is installed after acquiring the REK of the RO provided by the RI, thus extending the application of the RO.</p>
<p id="p-0233" num="0232"><figref idref="DRAWINGS">FIG. 8</figref> is a schematic flow chart of a first embodiment of a method for moving an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 8</figref>, the embodiment includes the following steps.</p>
<p id="p-0234" num="0233">In Step <b>801</b>, the RI acquires the RO related information of the RO that requires moving on the SRM through the DRM Agent on the terminal device and the SRM Agent on the SRM.</p>
<p id="p-0235" num="0234">In Step <b>802</b>, the RI triggers the DRM Agent to remove the RO that requires moving on the SRM, and provides to the DRM Agent the REK of the RO that requires moving.</p>
<p id="p-0236" num="0235">In this embodiment, after acquiring the RO related information of the RO that requires moving on the SRM, the RI triggers the DRM Agent to remove the RO that requires moving, and provides to the DRM Agent the REK of the RO that requires moving, for the DRM Agent to install the new RO to the SRM according to the related information and the REK, so as to move the RO without the Move rights out from the SRM, thus extending the application of the RO.</p>
<p id="p-0237" num="0236"><figref idref="DRAWINGS">FIG. 9</figref> is a schematic flow chart of a second embodiment of a method for moving an RO according to the present invention. Assuming that the RI buffers the ever issued REK, an RO issued by the RI and not having the Move rights exists on the SRM, and the user of the device intends to move the RO to the device. As shown in <figref idref="DRAWINGS">FIG. 9</figref>, the embodiment includes the following steps.</p>
<p id="p-0238" num="0237">In Step <b>901</b>, the RI sends a REKtrigger message to the DRM Agent, so as to trigger the DRM Agent to acquire the REK corresponding to an RO from the RI.</p>
<p id="p-0239" num="0238">Preferably, the REKtrigger message can include the identifier of the RO, so that when receiving the REKtrigger message, the DRM Agent knows that the corresponding REK of which RO is to be acquired. Before the RI sends the REKtrigger message, the terminal user needs to access the web site of the RI in virtue of the device at which the DRM Agent locates or the other devices, and submit the request about intending to move the RO in the SRM to its own. After performing such operations as the accounting related operation, the RI can send the REKtrigger message to the DRM Agent.</p>
<p id="p-0240" num="0239">The step is an optional step, and the embodiment can also begin directly from Step <b>902</b>.</p>
<p id="p-0241" num="0240">In Step <b>902</b>, the DRM Agent interacts with the SRM Agent to remove the RO on the SRM.</p>
<p id="p-0242" num="0241">Preferably, the DRM Agent may obtain an Existproof indicating that &#x201c;the RO exists on the SRM and the RO has been removed by the SRM Agent&#x201d; from the SRM Agent. The form of the proof can be a signature for the REK corresponding to the RO by the SRM Agent and a signature for a request message of RO removal sent by the DRM Agent.</p>
<p id="p-0243" num="0242">Preferably, the proof may also include a time stamp, so as to prevent the DRM Agent from repetitively using this ExistProof to get RO from the RI. That is to say, the signature range of the SRM Agent can include a time stamp.</p>
<p id="p-0244" num="0243">In Step <b>903</b>, the DRM Agent interacts with the RI to acquire the REK corresponding to the RO.</p>
<p id="p-0245" num="0244">Preferably, for the purpose of security, the DRM Agent should provide a proof indicating that &#x201c;the corresponding RO actually exists on the SRM and the RO has been removed by the SRM Agent&#x201d; to the RI. After verifying the proof, the RI sends the REK bound to the DRM Agent (that is, the REK encrypted with the public key of the DRM Agent) to the DRM Agent. This REK should be the same as the REK previously stored in the SRM.</p>
<p id="p-0246" num="0245">In Step <b>904</b>, the DRM Agent installs the RO according to the related information of the RO and the REK of the RO.</p>
<p id="p-0247" num="0246">In this embodiment, after acquiring from the SRM Agent the related information of the RO, that is, the information except for the REK, the DRM Agent removes the RO on the SRM, then acquires the REK from the RI, and installs the RO according to the acquired RO related information and REK, so that the RO without the Move rights can be moved from the SRM to the device at which the DRM Agent locates, thus extending the application of the RO without the Move rights.</p>
<p id="p-0248" num="0247"><figref idref="DRAWINGS">FIG. 10</figref> is a schematic flow chart following interaction protocol reification in the second embodiment of a method for moving an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 10</figref>, the detailed process includes the following steps.</p>
<p id="p-0249" num="0248">In Step <b>1001</b>, the DRM Agent sends the RightsInfoQueryRequest message to the SRM Agent.</p>
<p id="p-0250" num="0249">In Step <b>1002</b>, after receiving the RightsInfoQueryRequest message, the SRM Agent returns the RightsInfoQueryResponse message to the DRM Agent.</p>
<p id="p-0251" num="0250">Through the Step <b>1001</b> and Step <b>1002</b>, the DRM Agent obtains from the SRM all information about the RO to be removed except for the REK, which includes: the &#x3c;rights&#x3e; element, the signature for the &#x3c;rights&#x3e; element by the RI, the Rights Meta Data, and the corresponding State Information (If the RO has the status RO).</p>
<p id="p-0252" num="0251">The RightsInfoQueryRequest message sent by the DRM Agent in the Step <b>1001</b> includes fields as shown in Table 12:</p>
<p id="p-0253" num="0252">
<tables id="TABLE-US-00015" num="00015">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 12</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of RightsInfoQueryRequest Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Handle</entry>
<entry>The unique identifier of the RO on the SRM</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0254" num="0253">The RightsInfoQueryResponse message returned by the SRM Agent in the Step <b>1002</b> includes fields as shown in Table 13:</p>
<p id="p-0255" num="0254">
<tables id="TABLE-US-00016" num="00016">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 13</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields ofs RightsInfoQueryResponse Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Status</entry>
<entry>A result of processing the RightsInfoQueryRequest</entry>
</row>
<row>
<entry/>
<entry>message by the SRM Agent. If an error occurs, only</entry>
</row>
<row>
<entry/>
<entry>this field will be present in the RightsInfoQueryResponse</entry>
</row>
<row>
<entry/>
<entry>message.</entry>
</row>
<row>
<entry>Rights</entry>
<entry>The Rights Meta Data, which includes information as</entry>
</row>
<row>
<entry>Meta Data</entry>
<entry>follows:</entry>
</row>
<row>
<entry/>
<entry>Rights Object Version</entry>
</row>
<row>
<entry/>
<entry>RO Alias</entry>
</row>
<row>
<entry/>
<entry>RI Identifier</entry>
</row>
<row>
<entry/>
<entry>RI URL</entry>
</row>
<row>
<entry/>
<entry>RI Alias</entry>
</row>
<row>
<entry/>
<entry>RI Time Stamp</entry>
</row>
<row>
<entry>RO</entry>
<entry>Container including the &#x3c;rights&#x3e; element and the</entry>
</row>
<row>
<entry>Container</entry>
<entry>&#x3c;signature&#x3e; element</entry>
</row>
<row>
<entry>State</entry>
<entry>Remaining State Information of the RO, such as the left</entry>
</row>
<row>
<entry>Information</entry>
<entry>times of playing rights. If the RO has no status, the</entry>
</row>
<row>
<entry/>
<entry>field is not present.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0256" num="0255">In Step <b>1003</b>, after receiving the RightsInfoQueryResponse message, the DRM Agent can know that the RO does not have the Move rights according to the &#x3c;rights&#x3e; element and the State Information of the RO.</p>
<p id="p-0257" num="0256">After receiving the RightsInfoQueryResponse message, the DRM Agent may find that the RO does not have the Move rights by analyzing the &#x3c;rights&#x3e; element and the State Information of the RO. The device can prompt the user to remove the RO in the manner of popping up a dialogue box.</p>
<p id="p-0258" num="0257">In Step <b>1004</b>, the user logs in the web site provided by the RI through the device at which the DRM Agent locates or the other devices, and submits a request about moving the RO on the SRM through the page provided by the web site. Preferably, the user can specify the identifier of the RO needed to be moved through the web page.</p>
<p id="p-0259" num="0258">In Step <b>1005</b>, after such operations as accounting, the RI sends a REKTrigger message to the DRM Agent. The REKTrigger message may be used for triggering the DRM Agent to acquire the REK corresponding to the RO from the RI. Fields included in the REKTrigger message are shown in Table 14:</p>
<p id="p-0260" num="0259">
<tables id="TABLE-US-00017" num="00017">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 14</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of REKTrigger Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="49pt" align="left"/>
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="91pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>ROID</entry>
<entry>RO Identifier</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0261" num="0260">In Step <b>1006</b>, after receiving the REKTrigger message, the DRM Agent sends a RightsRemovalRequest message to the SRM Agent.</p>
<p id="p-0262" num="0261">Fields included in the RightsRemovalRequest message are shown in Table 15:</p>
<p id="p-0263" num="0262">
<tables id="TABLE-US-00018" num="00018">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 15</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of RightsRemovalRequest Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="140pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Handle</entry>
<entry>RO whose identifier needs to be removed</entry>
</row>
<row>
<entry>RemovalProofNeeded</entry>
<entry>Demonstrate whether the DRM Agent needs</entry>
</row>
<row>
<entry/>
<entry>the SRM Agent to return a proof indicating</entry>
</row>
<row>
<entry/>
<entry>that the RO has been removed</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0264" num="0263">In Step <b>1007</b>, after receiving the RightsRemovalRequest message, the SRM Agent returns a RightsRemovalResponse message to the DRM Agent.</p>
<p id="p-0265" num="0264">Fields included in the RightsRemovalResponse message are shown in Table 16:</p>
<p id="p-0266" num="0265">
<tables id="TABLE-US-00019" num="00019">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 16</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of RightsRemovalResponse Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Status</entry>
<entry>Indicate whether the SRM Agent successfully processes</entry>
</row>
<row>
<entry/>
<entry>the RightsRemovalRequest message</entry>
</row>
<row>
<entry>RemovalProof</entry>
<entry>Proof indicating that the RO has been removed on the</entry>
</row>
<row>
<entry/>
<entry>SRM</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0267" num="0266">The RemovalProof field is used for proving that RO has been removed from the SRM. The proof includes a signature for the following information combination by the SRM:</p>
<p id="p-0268" num="0267">
<tables id="TABLE-US-00020" num="00020">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>&#x2003;&#x2003;{</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier of the DRM Agent which urges the SRM Agent to</entry>
</row>
<row>
<entry>perform the removing operation;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the removing time;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier representing the removing operation;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the REK of the removed RO; and</entry>
</row>
<row>
<entry>&#x2003;&#x2003;the identifier of the removed RO;</entry>
</row>
<row>
<entry>&#x2003;&#x2003;}.</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0269" num="0268">In Step <b>1008</b>, after receiving the RightsRemovalResponse message, the DRM Agent sends a REKRequest message to the RI.</p>
<p id="p-0270" num="0269">Fields included in the REKRequest message are shown in Table 17:</p>
<p id="p-0271" num="0270">
<tables id="TABLE-US-00021" num="00021">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 17</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of REKRequest Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>ROID</entry>
<entry>RO Identifier</entry>
</row>
<row>
<entry>&#x3c;rights&#x3e;</entry>
<entry>Corresponding &#x3c;rights&#x3e; element in the RO</entry>
</row>
<row>
<entry>&#x3c;signature&#x3e;</entry>
<entry>The signature for the &#x3c;rights&#x3e; element by the RI</entry>
</row>
<row>
<entry>RemovalProof</entry>
<entry>Proof of the SRM Agent indicating that the RO has been</entry>
</row>
<row>
<entry/>
<entry>removed</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0272" num="0271">In Step <b>1009</b>, after receiving the REKRequest message, the RI returns a REKResponse message to the DRM Agent.</p>
<p id="p-0273" num="0272">Fields included in the REKResponse message are shown in Table 18:</p>
<p id="p-0274" num="0273">
<tables id="TABLE-US-00022" num="00022">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 18</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Fields of REKResponse Message</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="56pt" align="left"/>
<colspec colname="2" colwidth="161pt" align="left"/>
<tbody valign="top">
<row>
<entry>Fields</entry>
<entry>Description</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Status</entry>
<entry>Indicate whether the RI successfully processes the</entry>
</row>
<row>
<entry/>
<entry>RightsRemovalRequest message</entry>
</row>
<row>
<entry>EncryptedREK</entry>
<entry>REK encrypted with the public key of the DRM Agent</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0275" num="0274">The EncryptedREK field is the REK encrypted with the public key of the DRM Agent. The REK is used for decrypting the EncryptedCEK within the &#x3c;rights&#x3e; element in the REKRequest message.</p>
<p id="p-0276" num="0275">In Step <b>1010</b>, the DRM Agent installs the RO according to the related information of the RO and the REK of the RO.</p>
<p id="p-0277" num="0276"><figref idref="DRAWINGS">FIG. 11</figref> is a schematic flow chart of a first embodiment of another method for moving an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 11</figref>, the embodiment includes the following steps.</p>
<p id="p-0278" num="0277">In Step <b>1101</b>, the DRM Agent on the terminal device interacts with the SRM Agent on the SRM to obtain the RO related information of the RO that requires moving on the SRM.</p>
<p id="p-0279" num="0278">In Step <b>1102</b>, the DRM Agent interacts with the RI to provide the RO related information to the RI, and obtain from the RI the Move rights that allows the DRM Agent to move the RO that requires moving.</p>
<p id="p-0280" num="0279">In Step <b>1103</b>, the DRM Agent moves the RO that requires moving to the device at which the DRM Agent locates according to the Move rights.</p>
<p id="p-0281" num="0280">In this embodiment, the DRM Agent applies to the RI for moving the RO according to the acquired RO related information of the RO that requires moving, and after getting the permission of the RI, compulsively moves the RO from the SRM to the device at which the DRM Agent locates, so as to move the RO without the Move rights out from the SRM, thus extending the application of the RO.</p>
<p id="p-0282" num="0281"><figref idref="DRAWINGS">FIG. 12</figref> is a schematic flow chart of a second embodiment of another method for moving an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 12</figref>, the embodiment includes the following steps.</p>
<p id="p-0283" num="0282">In Step <b>1201</b>, the RI sends a Move permission trigger message to the DRM Agent, so as to trigger the DRM Agent to acquire from the RI the permission of allowing the RO without the Move rights on the SRM to be moved out.</p>
<p id="p-0284" num="0283">Preferably, the Move permission trigger message can include the identifier of the RO that requires moving, so that when receiving the Move permission trigger message, the DRM Agent knows which RO acquires the permission. Before the RI sends the Move permission trigger message, the terminal user needs to access the web site of the RI in virtue of the device at which the DRM Agent locates or the other devices, and submit the request about intending to move the RO in the SRM to its own. After performing such operations as the accounting related operation, the RI may send the Move permission trigger message to the DRM Agent.</p>
<p id="p-0285" num="0284">The step is an optional step, and the embodiment can also begin directly from Step <b>1202</b>.</p>
<p id="p-0286" num="0285">In Step <b>1202</b>, the DRM Agent interacts with the SRM Agent to prepare to move the RO on the SRM. The preparation work at least includes that the DRM Agent instructs the SRM Agent to set the RO that requires moving to the unavailable status.</p>
<p id="p-0287" num="0286">Preferably, the DRM Agent can obtain a Existproof indicating that &#x201c;the RO that requires moving actually exists on the SRM&#x201d; from the SRM Agent. The form of the proof can be the signature for the REK corresponding to the RO by the SRM Agent.</p>
<p id="p-0288" num="0287">Preferably, the proof can also include a time stamp, so as to prevent the DRM Agent from repetitively using this proof to get the RO from the RI by defrauding. That is to say, the signature range of the SRM Agent can include a time stamp.</p>
<p id="p-0289" num="0288">The step is an optional step, and the embodiment can also begin directly from Step <b>1203</b>.</p>
<p id="p-0290" num="0289">In Step <b>1203</b>, the DRM Agent interacts with the RI to acquire the permission about moving out the RO that requires moving on the SRM.</p>
<p id="p-0291" num="0290">Preferably, the DRM Agent can present a proof indicating that &#x201c;the RO that requires moving exists on the SRM&#x201d; to the RI (that is, the signature for the REK by the SRM Agent). After verifying that the RO that requires moving exists on the SRM, the RI sends permission information to the DRM Agent through a message. After receiving the permission information, the DRM Agent can preserve the permission.</p>
<p id="p-0292" num="0291">Preferably, for the purpose of security, the RI can perform a signature on the permission information.</p>
<p id="p-0293" num="0292">In Step <b>1204</b>, the DRM Agent interacts with the SRM Agent to move the RO that requires moving from the SRM to the device.</p>
<p id="p-0294" num="0293">In the embodiment, after finding that the RO that requires moving does not have the Move rights, the DRM Agent applies to the RI for moving the RO, and compulsively moves the RO that requires moving from the SRM to the device at which the DRM Agent locates after getting the permission of the RI. Although the RO that requires moving itself demonstrates that it does not have the Move rights, with an indication of the permission obtained by the DRM Agent, the DRM Agent still can move the RO that requires moving from the SRM to the device. It may modify appropriately on the basis of the Rights Removal protocol disclosed by the OMA SRM 1.0.</p>
<p id="p-0295" num="0294"><figref idref="DRAWINGS">FIG. 13</figref> is a schematic flow chart following interaction protocol reification in a second embodiment of another method for moving an RO according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 13</figref>, the detailed process includes the following steps.</p>
<p id="p-0296" num="0295">In Step <b>1301</b>, the DRM Agent sends the RightsInfoQueryRequest message to the SRM Agent. The RightsInfoQueryRequest message includes the Handle field.</p>
<p id="p-0297" num="0296">In Step <b>1302</b>, after receiving the RightsInfoQueryRequest message, the SRM Agent returns the RightsInfoQueryResponse message to the DRM Agent. The RightsInfoQueryResponse message includes the Rights field, the MetaData field, the RO Container field, and the State Information field.</p>
<p id="p-0298" num="0297">Through the Step <b>1301</b> and Step <b>1302</b>, the DRM Agent obtains from the SRM all information about the RO that requires moving except for the REK, which includes: the &#x3c;rights&#x3e; element, the signature for the &#x3c;rights&#x3e; element by the RI, the Rights Meta Data, and the corresponding State Information (If the RO has the status RO).</p>
<p id="p-0299" num="0298">In Step <b>1303</b>, after receiving the RightsInfoQueryResponse message, the DRM Agent may know that the RO does not have the Move rights according to the &#x3c;rights&#x3e; element and the State Information of the RO.</p>
<p id="p-0300" num="0299">After receiving the RightsInfoQueryResponse message, the DRM Agent may know that the RO does not have the Move rights by analyzing the &#x3c;rights&#x3e; element and the State Information of the RO. The device can prompt the user to remove the RO in the manner of popping up a dialogue box.</p>
<p id="p-0301" num="0300">In Step <b>1304</b>, the user logs in the web site provided by the RI through the device at which the DRM Agent locates or the other devices, and submits a request about acquiring the Move rights of the RO on the SRM through the page provided by the web site. Preferably, the user may specify the identifier of the RO needed to be moved through the web page.</p>
<p id="p-0302" num="0301">In Step <b>1305</b>, after such operations as accounting, the RI sends a MovePermissionTrigger message to the DRM Agent. The MovePermissionTrigger message may be used for triggering the DRM Agent to acquire the Move rights of the RO from the RI. The message includes the ROD field, a MoveRequirementInfo field, and the REKNeeded field. The MoveRequirementInfo is used for representing the detailed move requirements specified by the user, such as the type of the RO that requires moving and the times by which the moving can be performed. The user can specify these requirements through the web page provided by the RI.</p>
<p id="p-0303" num="0302">In Step <b>1306</b>, after receiving the MovePermissionTrigger message, the DRM Agent sends a MoveSetupRequest message to the SRM Agent. The MoveSetupRequest message includes the Handle field, the New Handle field, and the REKNeeded field.</p>
<p id="p-0304" num="0303">In Step <b>1307</b>, after receiving the Move Setup Request message, the SRM Agent returns a Move Setup Response message to the DRM Agent. The Move Setup Response message includes the ExistProof field and the EncryptedREK field.</p>
<p id="p-0305" num="0304">In Step <b>1308</b>, after receiving the MoveSetupResponse message, the DRM Agent sends a MovePermissionRequest message to the RI. The MovePermissionRequest message includes the ROD field, the &#x3c;rights&#x3e; field, the &#x3c;signature&#x3e; field, the State Information field, a SRMSignOverREK field, the EncryptedREK field, and the MoveRequirementInfo field. These fields can refer to the aforementioned embodiments.</p>
<p id="p-0306" num="0305">In Step <b>1309</b>, after receiving the MovePermissionRequest message, the RI returns a MovePermissionResponse message to the DRM Agent. The MovePermissionResponse message includes a MovePermission field. The MovePermission field includes a signature of the following information:</p>
<p id="p-0307" num="0306">an identifier representing a moving action; and</p>
<p id="p-0308" num="0307">an identifier of the RO that requires moving.</p>
<p id="p-0309" num="0308">For the purpose of security, the RI may perform a signature on the MovePermission field, and send it to the DRM Agent together with the MovePermission field.</p>
<p id="p-0310" num="0309">In Step <b>1310</b>, the DRM Agent moves the RO that requires moving from the SRM to the device according to the MovePermission field of the RI. The DRM Agent can execute a move operation according to its MovePermission field immediately after receiving the MovePermissionResponse, and may also preserve the MovePermission field, and perform the Move operation in the subsequent time. It depends on the need of the user.</p>
<p id="p-0311" num="0310"><figref idref="DRAWINGS">FIG. 14</figref> is a schematic structural view of an embodiment of an RI according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 14</figref>, in the embodiment, the RI includes a new RO generating module <b>1401</b> and a new RO providing module <b>1402</b>.</p>
<p id="p-0312" num="0311">The new RO generating module <b>1401</b> is configured to generate the new RO according to the RO related information of the RO that requires updating on the SRM obtained through the DRM Agent and the SRM Agent.</p>
<p id="p-0313" num="0312">The new RO providing module <b>1402</b> is configured to provide the new RO to the DRM Agent.</p>
<p id="p-0314" num="0313"><figref idref="DRAWINGS">FIG. 15</figref> is a schematic structural view of an embodiment of a DRM Agent according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 15</figref>, in the embodiment, the DRM Agent includes an RO related information acquiring module <b>1501</b> and a first RO upgrading module <b>1502</b>.</p>
<p id="p-0315" num="0314">The RO related information acquiring module <b>1501</b> is configured to obtain the RO related information of the RO that requires updating on the SRM from the SRM Agent, and provide the RO related information to the RI.</p>
<p id="p-0316" num="0315">The first RO upgrading module <b>1502</b> is configured to upgrade the RO that requires updating on the SRM with the new RO generated according to the RO related information by the RI through the SRM Agent.</p>
<p id="p-0317" num="0316">According to the embodiments of the present invention, the embodiment of the RI and the embodiment of the DRM Agent can be used for the processes in the first embodiment and the second embodiment of the method for upgrading the RO according to the present invention.</p>
<p id="p-0318" num="0317"><figref idref="DRAWINGS">FIG. 16</figref> is a schematic structural view of an embodiment of another RI according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 16</figref>, in the embodiment, the RI includes a new RO generating module <b>1601</b> and a second RO upgrading module <b>1602</b>.</p>
<p id="p-0319" num="0318">The new RO generating module <b>1601</b> is configured to generate the new RO according to the RO related information of the RO that requires updating on the SRM obtained through the DRM Agent and the SRM Agent.</p>
<p id="p-0320" num="0319">The second RO upgrading module <b>1602</b> is configured to upgrade the RO that requires updating on the SRM with the new RO through the DRM Agent and the SRM Agent.</p>
<p id="p-0321" num="0320"><figref idref="DRAWINGS">FIG. 17</figref> is a schematic structural view of an embodiment of another DRM Agent according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 17</figref>, in the embodiment, the DRM Agent includes an RO related information acquiring module <b>1701</b> and a new RO acquiring module <b>1702</b>.</p>
<p id="p-0322" num="0321">The RO related information acquiring module <b>1701</b> is configured to obtain the RO related information of the RO that requires updating on the SRM from the SRM Agent, and provide the RO related information to the RI.</p>
<p id="p-0323" num="0322">The new RO acquiring module <b>1702</b> is configured to obtain the new RO generated according to the RO related information from the RI.</p>
<p id="p-0324" num="0323">According to the embodiments of the present invention, the embodiment of the another RI and the embodiment of the another DRM Agent can be used for the processes in the first embodiment and the second embodiment of the another method for upgrading the RO according to the present invention.</p>
<p id="p-0325" num="0324"><figref idref="DRAWINGS">FIG. 18</figref> is a schematic structural view of an embodiment of still another DRM Agent according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 18</figref>, in the embodiment, the DRM Agent includes a receiving module <b>1801</b> and a removing module <b>1802</b>.</p>
<p id="p-0326" num="0325">The receiving module <b>1801</b> is configured to receive a trigger message sent by the RI. The trigger message includes the identifier of the RO to be removed on the SRM.</p>
<p id="p-0327" num="0326">The removing module <b>1802</b> is configured to notify the SRM Agent to remove the RO to be removed.</p>
<p id="p-0328" num="0327">According to the embodiments of the present invention, the embodiment of the still another DRM Agent can be used for the process in the embodiment of the method for removing the RO according to the embodiments of the present invention.</p>
<p id="p-0329" num="0328"><figref idref="DRAWINGS">FIG. 19</figref> is a schematic structural view of still another RI according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 19</figref>, in the embodiment, the RI includes a triggering module <b>1901</b> and an REK providing module <b>1902</b>.</p>
<p id="p-0330" num="0329">The triggering module <b>1901</b> is configured to trigger the DRM Agent to remove the RO that requires moving on the SRM through the SRM Agent after acquiring the RO related information of the RO that requires moving on the SRM through the DRM Agent and the SRM Agent.</p>
<p id="p-0331" num="0330">The REK providing module <b>1902</b> is configured to provide to the DRM Agent the REK of the RO that requires moving.</p>
<p id="p-0332" num="0331"><figref idref="DRAWINGS">FIG. 20</figref> is a schematic structural view of an embodiment of still another DRM Agent according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 20</figref>, in the embodiment, the DRM Agent includes an RO related information acquiring module <b>2001</b> and an REK acquiring module <b>2002</b>.</p>
<p id="p-0333" num="0332">The RO related information acquiring module <b>2001</b> is configured to obtain the RO related information of the RO that requires updating on the SRM from the SRM Agent, and provide the RO related information to the RI.</p>
<p id="p-0334" num="0333">The REK acquiring module <b>2002</b> is configured to receive the REK of the RO that requires moving that are provided by the RI.</p>
<p id="p-0335" num="0334">According to the embodiments of the present invention, the embodiment of the still another RI and the embodiment of the still another DRM Agent can be used for the processes in the first embodiment and the second embodiment of the method for moving the RO according to the present invention.</p>
<p id="p-0336" num="0335"><figref idref="DRAWINGS">FIG. 21</figref> is a schematic structural view of an embodiment of still another RI according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 21</figref>, in the embodiment, the RI includes a Move rights generating module <b>2101</b> and a Move rights providing module <b>2102</b>.</p>
<p id="p-0337" num="0336">The Move rights generating module <b>2101</b> is configured to generate the Move rights of the RO that requires moving according to the RO related information of the RO that requires moving on the SRM acquired through the DRM Agent and the SRM Agent.</p>
<p id="p-0338" num="0337">The Move rights providing module <b>2102</b> is configured to provide to the DRM Agent the Move rights of the RO that requires moving.</p>
<p id="p-0339" num="0338"><figref idref="DRAWINGS">FIG. 22</figref> is a schematic structural view of an embodiment of still another DRM Agent according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 22</figref>, in the embodiment, the DRM Agent includes an RO related information acquiring module <b>2201</b> and an RO moving module <b>2202</b>.</p>
<p id="p-0340" num="0339">The RO related information acquiring module <b>2201</b> is configured to obtain the RO related information of the RO that requires updating on the SRM from the SRM Agent, and provide the RO related information to the RI.</p>
<p id="p-0341" num="0340">The RO moving module <b>2202</b> is configured to receive the Move rights, provided by the RI, of the RO that requires moving and move the RO that requires moving to the device at which the DRM Agent locates through the SRM Agent according to the Move rights.</p>
<p id="p-0342" num="0341">According to the embodiments of the present invention, the embodiment of the still another RI and the embodiment of the still another DRM Agent can be used for the processes in the first embodiment and the second embodiment of the another method for moving the RO according to the present invention.</p>
<p id="p-0343" num="0342"><figref idref="DRAWINGS">FIG. 23</figref> is a schematic structural view of an embodiment of an SRM Agent according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 23</figref>, in the embodiment, the SRM Agent includes an RO related information providing module <b>2301</b> and an RO upgrading module <b>2302</b>.</p>
<p id="p-0344" num="0343">The RO related information providing module <b>2301</b> is configured to provide the RO related information of the RO that requires updating to the DRM Agent.</p>
<p id="p-0345" num="0344">The RO upgrading module <b>2302</b> is configured to receive the new RO generated according to the RO related information of the RO that requires updating and sent by the DRM Agent, and upgrade the RO that requires updating.</p>
<p id="p-0346" num="0345"><figref idref="DRAWINGS">FIG. 24</figref> is a schematic structural view of an embodiment of another SRM Agent according to the present invention. As shown in <figref idref="DRAWINGS">FIG. 24</figref>, in the embodiment, the SRM Agent includes a message receiving module <b>2401</b> and a removing module <b>2402</b>.</p>
<p id="p-0347" num="0346">The message receiving module <b>2401</b> is configured to receive the RightsRemovalRequest message sent by the DRM Agent.</p>
<p id="p-0348" num="0347">The removing module <b>2402</b> is configured to remove the RO to be removed according to the received RightsRemovalRequest message, and return the RemovalProof to the DRM Agent.</p>
<p id="p-0349" num="0348">According to the embodiments of the present invention, the DRM Agent interacts with the RI with the acquired RO related information which is stored on the SRM and does not have the Move rights, so as to acquire the new RO or the Move rights from the RI, and move the RO out from the SRM, so that the RO without the Move rights can be moved out from the SRM, thus extending the application of the RO without the Move rights.</p>
<p id="p-0350" num="0349">Persons of ordinary skill in the art should understand that all or a part of the steps of the method according to the embodiments of the present invention may be implemented by a program instructing relevant hardware. The program may be stored in a computer readable storage medium. When the program is run, the steps of the method according to the embodiments of the present invention are performed. The storage medium may be any medium that is capable of storing program codes, such as a ROM, a RAM, a magnetic disk, and an optical disk.</p>
<p id="p-0351" num="0350">It should be noted that the above embodiments are merely provided for describing the technical solutions of the present invention, but not intended to limit the present invention. It should be understood by persons of ordinary skill in the art that although the present invention has been described in detail with reference to the embodiments, modifications can be made to the technical solutions described in the embodiments, or equivalent replacements can be made to some technical features in the technical solutions, as long as such modifications or replacements do not depart from the spirit and scope of the present invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for upgrading a Rights Object (RO), comprising:
<claim-text>receiving, by a Digital Rights Management (DRM) Agent of a terminal device, a RO Upgrade message, comprising and identifier of the RO that requires updating;</claim-text>
<claim-text>instructing, by the DRM Agent, a Secure Removable Media (SRM) Agent of a SRM to set the RO that requires updating to an unavailable status;</claim-text>
<claim-text>acquiring, by the DRM Agent of the terminal device and from the SRM agent, an indication that the RO that requires updating actually exists in the SRM through an existence of the identifier of the RO and a digital signature therein;</claim-text>
<claim-text>providing, by the DRM Agent of the terminal device, the RO related information to a Rights Issuer (RI);</claim-text>
<claim-text>obtaining, by the DRM Agent, a new RO from the RI; and</claim-text>
<claim-text>interacting, by the DRM Agent of the terminal device, with the SRM Agent to upgrade the RO that requires updating on the SRM by means of the new RO to install the new RO to the SRM through the SRM Agent.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein before obtaining, by the DRM Agent, the new RO from the RI, the method further comprises:
<claim-text>receiving, by the DRM Agent of the terminal device, a Rights Upgrade Setup Response message carrying a field for demonstrating existence of the RO that requires updating on the SRM transferred by the SRM Agent of the SRM;</claim-text>
<claim-text>sending, by the DRM Agent of the terminal device, a SRM RO Upgrade Request message carrying a field for demonstrating existence of the RO that requires updating on the SRM to the RI; and</claim-text>
<claim-text>sending the new RO to the DRM Agent after passing a verification for the SRM RO Upgrade Request message carrying the field for demonstrating existence of the RO that requires updating on the SRM by the RI.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein before obtaining the new RO from the RI, the method further comprises setting, by the SRM Agent of the SRM, the RO that requires updating to the unavailable status.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein before obtaining the new RO from the RI, the method further comprises transferring a RO upgrading requirement information to the RI.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein, interacting, by the DRM Agent of the terminal device, with the SRM Agent of the SRM to upgrade the RO that requires updating on the SRM by the new RO comprises:
<claim-text>obtaining, by the DRM Agent of the terminal device, RO related information of the new RO and a Rights Encryption Key (REK) of the new RO from the new RO, wherein the REK of the new RO is encrypted in a manner that the RI is capable of decrypting with the SRM Agent;</claim-text>
<claim-text>sending, by the DRM Agent of the terminal device, the RO related information of the new RO and the REK of the new RO to the SRM Agent;</claim-text>
<claim-text>decrypting, by the SRM Agent of the SRM, the REK of the new RO to get a decrypted REK; and</claim-text>
<claim-text>storing the RO related information of the new RO and the REK plain text in the SRM.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein upgrading the RO that requires updating on the SRM by means of the new RO comprises:
<claim-text>transferring, by the DRM Agent of the terminal device, the new RO to the SRM Agent of the SRM, and replacing, by the SRM Agent of the SRM, the RO that requires updating with the new RO; or</claim-text>
<claim-text>transferring, by the DRM Agent of the terminal device, the new RO to the SRM Agent of the SRM after removing the RO that requires updating through the SRM Agent of the SRM, and installing, by the SRM Agent of the SR, the new RO to the SRM.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein after removing the RO that required updating through the SRM Agent, the DRM Agent acquires from the SRM Agent a RemovalProof for demonstrating that the RO that required updating has been removed from the SRM, wherein after the SRM Agent installs the new RO, the DRM Agent of the terminal device receives a SRM RO Upgrade Confirm Request message and a message for demonstrating that the new RO has been installed to the SRM, wherein the SRM RO Upgrade Confirm Request message carries a field for demonstrating that the RO to be removed has been removed from the SRM, and wherein the DRM Agent transfers the RemovalProof and the message for demonstrating that the new RO has been installed to the SRM to the RI to demonstrate that the replacement of the RO that required updating with the new RO has been completed.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the RemovalProof comprises a signature for third information by the SRM wherein the third information comprises at least one of the following information: a REK of the RO that requires updating, an identifier of the RO that requires updating, an identifier of the DRM Agent, an identifier representing a removing action, and a time that the RO that required updating was removed, wherein the InstallationProof comprises a signature for fourth information by the SRM, and wherein the fourth information comprises at least one of the following information: a REK of the new RO, an identifier of the new RO, the identifier of the DRM Agent, an identifier representing an installation action, and a time that the new RO was installed.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein after or during the upgrading the RO that requires updating on the SRM by means of the new RO, the method further comprises notifying, by the DRM Agent of the terminal device, the RI that replacement of the RO that required updating with the new RO has been completed.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein after the upgrading the RO that required updating on the SRM by means of the new RO, the method further comprises:
<claim-text>receiving, by the DRM Agent of the terminal device and from the SRM Agent of the SRM a RightsReplaceResponse message carrying a field for demonstrating that the RO that required updating has been replaced with the new RO; and</claim-text>
<claim-text>sending, by the DRM Agent of the terminal device, an SRM RO Upgrade Confirm Request message to the RI, wherein the SRM RO Upgrade Confirm Request message carries a field for demonstrating that the RO to be removed has been removed from the SRM.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A method for upgrading a Rights Object (RO), comprising:
<claim-text>acquiring, by a Rights Issuer (RI) device, RO related information of the RO from a Digital Rights Management (DRM) Agent that requires updating on a Secure Removable Media (SRM) through the (DRM) Agent of a terminal device and an SRM Agent of the SRM, wherein the acquired RO related information comprises an identifier of the RO and a digital signature; and</claim-text>
<claim-text>triggering, by the RI device, the DRM Agent of the terminal device to obtain a new RO from the RI device after the RI device confirms, via the SRM agent, that the RO that required updating has been removed from the SRM, and installing the RO to the SRM through the DRM Agent of the terminal device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein removing the RO that requires updating from the SRM comprises triggering, by the RI device, the DRM Agent of the terminal device to interact with the SRM Agent of the SRM to remove the RO that requires updating on the SRM.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein before obtaining, by the DRM Agent of the terminal device, the new RO from the RI device, the method further comprises:
<claim-text>obtaining, by the DRM Agent of the terminal device, a Rights Encryption Key (REK) of the RO that requires updating encrypted by the SRM Agent of the SRM in a manner that the RI is capable of decrypting;</claim-text>
<claim-text>transferring, by the DRM Agent of the terminal device, the encrypted REK to the RI; and</claim-text>
<claim-text>decrypting, by the RI, the encrypted REK to get an REK plain text to verify the RO that requires updating.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein confirming, by the RI device, that the RO that required updating has been removed from the SRM comprises confirming, by the RI device, that the RO that required updating has been removed from the SRM by verifying a RemovalProof, and wherein the RemovalProof is provided by the SRM Agent and transferred to the RI via the DRM Agent of the terminal device.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A method for removing a Rights Object (RO), comprising:
<claim-text>receiving, by a Digital Rights Management (DRM) Agent of a terminal device, a trigger message sent by a Rights Issuer (RI) device, wherein the trigger message comprises an identifier of an RO to be removed on a Secure Removable Media (SRM) and a digital signature; and</claim-text>
<claim-text>interacting, by the DRM Agent of the terminal device, with an SRM Agent of the SRM to remove the RO to be removed;</claim-text>
<claim-text>acquiring, by the RI and via the DRM Agent, at least a confirmation from a SRM Agent indicating the RO has been removed from the SRM;</claim-text>
<claim-text>triggering, by the DRN Agent to obtain a new RO from the RI after the RI receives the RO removal confirmation; and</claim-text>
<claim-text>installing the new RO to the SRM through the DRM Agent.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method according to <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein after removing the RO to be removed, the method further comprises notifying the RI device that removal of the RO to be removed has been completed.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein notifying the RI device that the removal of the RO to be removed has been completed comprises:
<claim-text>receiving, by the DRM Agent of the terminal device, a Rights Replace Response message carrying a field for demonstrating that the RO to be removed has been removed from the SRM returned by the SRM Agent; and</claim-text>
<claim-text>sending, by the DRM of the terminal device, an SRM RO Upgrade Confirm Request message to the RI, wherein the SRM RO Upgrade Confirm Request message carries a field for demonstrating that the RO to be removed has been removed from the SRM.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A terminal device, comprising:
<claim-text>at least one processor or circuit;</claim-text>
<claim-text>a Rights Object (RO) related information acquiring module, configured by the processor or circuit to receive an ROUpgrade Trigger message comprising an identifier of a RO that requires updating, to instruct a Secure Removable Media (SRM) of a SRM to set the RO to an unavailable status, to acquire from the SRM Agent an ExistProof indicating that the RO that requires updating actually exists in the SRM, wherein the Existproof includes the identifier of the RO and a digital signature, to provide the RO related information to a Rights Issuer (RI), and to obtain a new RO from the RI; and</claim-text>
<claim-text>a first RO upgrading module, configured to interact with the SRM Agent to upgrade the RO that requires updating on the SRM with the new RO generated according to the RO related information by the RI through the SRM Agent to install the new RO to the SRM through the SRM Agent.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353056-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353056</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12067665</doc-number>
<date>20071030</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>KR</country>
<doc-number>10-2007-0005827</doc-number>
<date>20070118</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>814</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>9</main-group>
<subgroup>44</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>40</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>7</main-group>
<subgroup>04</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 32</main-classification>
<further-classification>717127</further-classification>
<further-classification>702187</further-classification>
</classification-national>
<invention-title id="d2e71">Apparatus and method for detecting program plagiarism through memory access log analysis</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6748584</doc-number>
<kind>B1</kind>
<name>Witchel et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717136</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>7503035</doc-number>
<kind>B2</kind>
<name>Zeidman</name>
<date>20090300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717123</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7802236</doc-number>
<kind>B2</kind>
<name>Calder et al.</name>
<date>20100900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717130</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2004/0111708</doc-number>
<kind>A1</kind>
<name>Calder et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717131</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0114840</doc-number>
<kind>A1</kind>
<name>Zeidman</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717126</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2006/0005166</doc-number>
<kind>A1</kind>
<name>Atkin et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2006/0145896</doc-number>
<kind>A1</kind>
<name>Venkatesan et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>KR</country>
<doc-number>1020040064681</doc-number>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>Clough, Paul. &#x201c;Plagiarism in natural and programming languages: an overview of current tools and technologies.&#x201d; Research Memoranda: CS-00-05, Department of Computer Science, University of Sheffield, UK. Jun. 2000. pp. 1-31.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Wise, &#x201c;YAP3: Improved Detection of Similarities in Computer Program and Other Texts,&#x201d; ACM, 1996.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Moussiades et al., &#x201c;PDetect: A Clustering Approach for Detecting Plagiarism in Source Code Datasets,&#x201d; Advance Access published on Jun. 24, 2005.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Liu et al., &#x201c;GPLAG: Detection of Software Plagiarism by Program Dependence Graph Analysis,&#x201d; ACM, 2006.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Prechelt et al., &#x201c;JPlag: Finding plagiarisms among a set of programs,&#x201d; Mar. 28, 2000.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>Son et al., &#x201c;Program Plagiarism Detection Using Parse Tree Kernels,&#x201d; Springer-Verlag Berlin Heidelberg 2006.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Ellis et al., &#x201c;Plagiarism Detection in Computer Code,&#x201d; Mar. 23, 2005.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>Wise, &#x201c;Running Karp-Raabin Matching and Greedy String Tiling,&#x201d; CiteSeer, 1993.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
</references-cited>
<number-of-claims>13</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>12</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100242023</doc-number>
<kind>A1</kind>
<date>20100923</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Han</last-name>
<first-name>Sang Yong</first-name>
<address>
<city>Gyeonggi-do</city>
<country>KR</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>KR</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Park</last-name>
<first-name>Sung Yun</first-name>
<address>
<city>Seoul</city>
<country>KR</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>KR</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Occhiuti Rohlicek &#x26; Tsao LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Chung-Ang University Industry-Academy Cooperation Foundation</orgname>
<role>03</role>
<address>
<city>Seoul</city>
<country>KR</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kang</last-name>
<first-name>Insun</first-name>
<department>2198</department>
</primary-examiner>
<assistant-examiner>
<last-name>Kretzmer</last-name>
<first-name>Erika</first-name>
</assistant-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/KR2007/005379</doc-number>
<kind>00</kind>
<date>20071030</date>
</document-id>
<us-371c124-date>
<date>20080321</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2008/088121</doc-number>
<kind>A </kind>
<date>20080724</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An apparatus and method for detecting program plagiarism through memory access log analysis is provided. A data extractor extracts an access log of an original program and an access log of a target program to be compared with the original program from a memory accessed by the programs. A common string detector enumerates values, which are obtained from the access logs extracted from the original program and the target program, into strings and detects a common string that commonly exists in the strings. A discontinuity calculator calculates a discontinuity value that indicates a distance between the strings by using an array of the detected common strings. A plagiarism determining unit determines that the target program is plagiarized if the calculated discontinuity value is less than a predetermined reference value.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="58.42mm" wi="130.81mm" file="US08353056-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="206.16mm" wi="113.79mm" file="US08353056-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="186.69mm" wi="75.78mm" file="US08353056-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="185.08mm" wi="72.90mm" file="US08353056-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="191.69mm" wi="77.98mm" file="US08353056-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="130.89mm" wi="98.72mm" file="US08353056-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is the National Stage of International Application No. PCT/KR2007/005379, filed on Oct. 30, 2007, which claims the priority of Korean Application No. 10-2007-0005827, filed on Jan. 18, 2007. The contents of both applications are hereby incorporated by reference in their entirety.</p>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">The present invention relates to an apparatus and method for detecting program plagiarism, and more particularly, to an apparatus and method for detecting program plagiarism through a memory access log analysis.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">In regards to protection of intellectual property rights, there are various software copyright problems. Examples of the problems include illegal use and distribution of software products and copyright infringement caused by program plagiarism in software production. Among the problems, the use of illegal software can be easily detected. However, regarding the program plagiarism problem, it is difficult to determine whether plagiarism is made or not.</p>
<p id="p-0005" num="0004">To address such problems, several methods of detecting program plagiarism have been studied. In the conventional methods which have been proposed so far to measure a program similarity, source codes of programs are analyzed and numericalized in various manners so as to determine a similarity between two programs to be compared with each other. Specifically, comparison is performed by using software metrics, or by comparing a token array of source codes or comparing function call relationships, or by analyzing a tree structure. In particular, researches on a method of detecting plagiarized programs from students assignments are widely being conducted, and a variety of results are being released by many universities worldwide. In this regards, systems (e.g., Plague, YAP3, MOSS, Clonechecker, etc.) have been introduced, in which source programs are input so that plagiarism is detected by measuring a similarity between two source programs. Disadvantageously, however, these conventional methods can be used only when source programs are obtained.</p>
<heading id="h-0004" level="1">DISCLOSURE</heading>
<heading id="h-0005" level="1">Summary</heading>
<p id="p-0006" num="0005">The present invention provides an apparatus and method capable of detecting program plagiarism by determining a similarity of programs without having to use source programs.</p>
<p id="p-0007" num="0006">The present invention also provides a computer-readable medium having embodied thereon a computer program for executing a method capable of detecting program plagiarism by determining a similarity of programs without having to use source programs.</p>
<p id="p-0008" num="0007">According to an aspect of the present invention, an apparatus for detecting program plagiarism is provided. The apparatus includes: a data extractor for extracting an access log of an original program and an access log of a target program to be compared with the original program from a memory accessed by the programs; a common string detector for enumerating values, which are obtained from the access logs extracted from the original program and the target program, into strings and for detecting a common string that commonly exists in the strings; a discontinuity calculator for calculating a discontinuity value that indicates a distance between strings by using an array of the detected common strings; and a plagiarism determining unit for determining that the target program is plagiarized if the calculated discontinuity value is less than a predetermined reference value.</p>
<p id="p-0009" num="0008">According to another aspect of the present invention, an apparatus for detecting program plagiarism is provided. The apparatus includes: a data extractor for extracting an access log of an original program and an access log of a target program to be compared with the original program from a memory accessed by the programs; a common string detector for enumerating values, which are obtained from the access logs extracted from the original program and the target program, into strings and for detecting a common string that commonly exists in the strings; a similarity calculator for calculating a similarity value that indicates a level of coincidence of strings by using an array of the detected common strings; and a plagiarism determining unit for determining that the target program is plagiarized if the calculated similarity value is greater than a predetermined reference value.</p>
<p id="p-0010" num="0009">According to another aspect of the present invention, a method of detecting program plagiarism is provided. The method includes: extracting an access log of an original program and an access log of a target program to be compared with the original program from a memory accessed by the programs; enumerating values, which are obtained from the access logs extracted from the original program and the target program, into strings and detecting a common string that commonly exists in the strings; calculating a discontinuity value that indicates a distance between strings by using an array of the detected common strings; and determining that the target program is plagiarized if the calculated discontinuity value is less than a predetermined reference value.</p>
<p id="p-0011" num="0010">According to another aspect of the present invention, a method of detecting program plagiarism is provided. The method includes: extracting an access log of an original program and an access log of a target program to be compared with the original program from a memory accessed by the programs; enumerating values, which are obtained from the access logs extracted from the original program and the target program, into strings and detecting a common string that commonly exists in the strings; calculating a similarity value that indicates a level of coincidence of strings by using an array of the detected common strings; and determining that the target program is plagiarized if the calculated similarity value is greater than a predetermined reference value.</p>
<p id="p-0012" num="0011">Accordingly, even when a source code is not obtained, program plagiarism can be accurately and rapidly detected by analyzing a memory access log of a program.</p>
<p id="p-0013" num="0012">As described above, in apparatus and method for detecting program plagiarism according to the Present invention, even when a source code is not obtained, program plagiarism can be accurately and rapidly detected by analyzing a memory access log of a program.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0006" level="1">DESCRIPTION OF DRAWINGS</heading>
<p id="p-0014" num="0013">The above and other features and advantages of the present invention will become more apparent by describing in detail exemplary embodiments thereof with reference to the attached drawings in which:</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating a structure of an apparatus for detecting program plagiarism according to an embodiment of the present invention;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIGS. 2 and 3</figref> respectively illustrate an area image and a line image composed of detected common strings;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIGS. 4 to 11</figref> illustrate line images and area images obtained by performing a string comparison algorithm (i.e., a Greedy-String-Tiling (GST) algorithm) on a plurality of target programs; and</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 12</figref> is a flowchart illustrating a method of detecting program plagiarism according to an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0007" level="1">DESCRIPTION</heading>
<p id="p-0019" num="0018">Hereinafter, exemplary embodiments of the present invention will be described in detail with reference to the accompanying drawings.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating a structure of an apparatus for detecting program plagiarism according to an embodiment of the present invention.</p>
<p id="p-0021" num="0020">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, the apparatus of the present invention includes a data extractor <b>110</b>, a common string detector <b>120</b>, a similarity calculator <b>130</b>, a discontinuity calculator <b>140</b>, and a plagiarism determining unit <b>150</b>.</p>
<p id="p-0022" num="0021">The data extractor <b>110</b> extracts an access log of a target program to be compared with an original program from a memory used by the programs. In order to extract memory access information on a program, memory allocation has to be managed when the program is loaded on the memory, and all memory areas used by the program have to be monitored. The data extractor <b>110</b> uses a memory protection scheme (e.g., read, write, etc.) to extract information by checking memory addresses and values whenever the memory is accessed.</p>
<p id="p-0023" num="0022">Instructions supported by latest processors have various formats. According to a method of processing an operation result, most instructions may be classified as described in Table 1 below.</p>
<p id="p-0024" num="0023">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="140pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="2" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Method Of Processing</entry>
<entry/>
</row>
<row>
<entry>Operation Result</entry>
<entry>Function</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>Write To Memory</entry>
<entry>Write Operation Result To Memory</entry>
</row>
<row>
<entry>Write To Register</entry>
<entry>Store Operation Result In Register</entry>
</row>
<row>
<entry>Control Operation</entry>
<entry>Change Flow Of Code Execution (Without</entry>
</row>
<row>
<entry/>
<entry>Storing The Result)</entry>
</row>
<row>
<entry>Port I/O (Input/Output)</entry>
<entry>Read Value From Port Or Write Value To Port</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0025" num="0024">Referring to Table 1, the control operation represents changes in a procedure for performing a memory operation or a register operation. When results are generated after performing the operation, the results are written to a register (or memory) of a processor or to a specific hardware port. Before data is stored in the memory, the data may be stored in the register. Further, the register may serve as a storage element for recording temporary values of the operation. That is, the register functions as a temporary storage element. A port I/O itself is generally provided to facilitate an operation of a corresponding hardware device, and does not perform a specific function. Similar to memory access, the port I/O is a process in which one value is read or written. Thus, a process of writing a value corresponding to the port I/O may be regarded as a process of writing an operation result to the memory. Results obtained by performing programs are recorded in a log according to the aforementioned methods of processing the operation result, and as a result, information on &#x201c;Read/Write&#x201d;, &#x201c;Address&#x201d;, and &#x201c;Value&#x201d; may be recognized.</p>
<p id="p-0026" num="0025">The data extractor 110 extracts information on memory access while operating the original program and the target program. Examples of the extracted information are described in Table 2 below.</p>
<p id="p-0027" num="0026">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="98pt" align="center"/>
<colspec colname="2" colwidth="119pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="2" rowsep="1">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Original Program</entry>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="70pt" align="center"/>
<colspec colname="3" colwidth="119pt" align="center"/>
<tbody valign="top">
<row>
<entry>Read/</entry>
<entry/>
<entry>Target Program</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="35pt" align="center"/>
<colspec colname="3" colwidth="35pt" align="center"/>
<colspec colname="4" colwidth="42pt" align="center"/>
<colspec colname="5" colwidth="35pt" align="center"/>
<colspec colname="6" colwidth="42pt" align="center"/>
<tbody valign="top">
<row>
<entry>Write</entry>
<entry>Address</entry>
<entry>Value</entry>
<entry>Read/Write</entry>
<entry>Address</entry>
<entry>Value</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
<row>
<entry>R</entry>
<entry>00980040</entry>
<entry>000000a</entry>
<entry>R</entry>
<entry>00980050</entry>
<entry>0000008</entry>
</row>
<row>
<entry>R</entry>
<entry>00980050</entry>
<entry>0000007</entry>
<entry>R</entry>
<entry>00980030</entry>
<entry>0000004</entry>
</row>
<row>
<entry>R</entry>
<entry>00980050</entry>
<entry>0000007</entry>
<entry>W</entry>
<entry>00980070</entry>
<entry>0000004</entry>
</row>
<row>
<entry>W</entry>
<entry>00980060</entry>
<entry>0000007</entry>
<entry>R</entry>
<entry>00980060</entry>
<entry>0000008</entry>
</row>
<row>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
</row>
<row>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
</row>
<row>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
<entry>.</entry>
</row>
<row>
<entry>R</entry>
<entry>00980020</entry>
<entry>0000008</entry>
<entry>R</entry>
<entry>00980018</entry>
<entry>0000001</entry>
</row>
<row>
<entry>R</entry>
<entry>00980060</entry>
<entry>0000004</entry>
<entry>R</entry>
<entry>00980080</entry>
<entry>0000002</entry>
</row>
<row>
<entry>W</entry>
<entry>00980070</entry>
<entry>0000004</entry>
<entry>W</entry>
<entry>00980080</entry>
<entry>0000003</entry>
</row>
<row>
<entry namest="1" nameend="6" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0028" num="0027">In the plagiarism detection apparatus according to an embodiment of the present invention, only values are used as comparison data. However, in another embodiment, &#x201c;Read/Write&#x201d;, &#x201c;Address&#x201d;, and &#x201c;Value&#x201d; described in Table 2 may all used in the determination of plagiarism.</p>
<p id="p-0029" num="0028">The common string detector <b>120</b> enumerates values v, which are obtained from the access logs extracted from the original program and the target program, into strings S<sub>1 </sub>and S<sub>2</sub>. Each of the strings S<sub>1 </sub>and S<sub>2 </sub>is subject to a tiling process according to a string comparison algorithm (i.e., a Greedy-String-Tiling (GST) algorithm), thereby detecting a common string c. <figref idref="DRAWINGS">FIG. 2</figref> illustrates an area image composed of only common strings detected by the common string detector <b>120</b>, where the horizontal axis corresponds to S<sub>1 </sub>and the vertical axis corresponds to S<sub>2</sub>. <figref idref="DRAWINGS">FIG. 3</figref> illustrates a line image composed of only common strings detected by the common string detector <b>120</b>, with the same horizontal and vertical axes as the corresponding area image of <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0030" num="0029">In this case, the respective strings S<sub>1 </sub>and S<sub>1 </sub>can be expressed by Math <figref idref="DRAWINGS">FIG. 1</figref> below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>S<sub>1</sub>=(v<sub>1,1</sub>, V<sub>1,2</sub>, . . . , v<sub>1,a</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>S<sub>2</sub>=(v<sub>2,1</sub>, v<sub>2,2</sub>, . . . , v<sub>2,b</sub>)&#x2003;&#x2003;[Math FIG. 1]<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0031" num="0030">In addition, an array of the common strings c detected by the common string detector <b>120</b> is expressed by Math <figref idref="DRAWINGS">FIG. 2</figref> below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>CS(S<sub>1</sub>,S<sub>2</sub>)={C<sub>1</sub>, c<sub>2</sub>,c<sub>3</sub>, . . . c<sub>n</sub>}&#x2003;&#x2003;[Math FIG. 2]<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0032" num="0031">Herein, CS(S<sub>1</sub>, S<sub>2</sub>) denotes an array of a plurality of c<sub>i </sub>sorted with respect to x<sub>i </sub>or y<sub>i</sub>, where c<sub>i </sub>denotes (x<sub>i</sub>, y<sub>i</sub>, l<sub>i</sub>), x<sub>i </sub>denotes a starting point of c<sub>i </sub>in S<sub>1</sub>, y<sub>i </sub>denotes a starting point of c<sub>i </sub>in S<sub>2</sub>, and l<sub>i </sub>denotes the length of c<sub>i</sub>.</p>
<p id="p-0033" num="0032">By using the array CS of the common strings detected by the common string detector <b>120</b>, the similarity calculator <b>130</b> calculates a similarity value m<sub>p </sub>that indicates a level of coincidence between S<sub>i </sub>and S<sub>2 </sub>according to Math <figref idref="DRAWINGS">FIG. 3</figref> below.</p>
<p id="p-0034" num="0033">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>m</mi>
          <mi>p</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>&#x2211;</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>n</mi>
          </munderover>
          <mo>&#x2062;</mo>
          <msup>
            <mrow>
              <mo>(</mo>
              <msub>
                <mi>l</mi>
                <mi>i</mi>
              </msub>
              <mo>)</mo>
            </mrow>
            <mi>p</mi>
          </msup>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>[</mo>
        <mrow>
          <mi>Math</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mrow>
            <mi>FIG</mi>
            <mo>.</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mn>3</mn>
          </mrow>
        </mrow>
        <mo>]</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0035" num="0034">Herein, if p=0, m<sub>p </sub>denotes the number n of common strings. If p=1, m<sub>p </sub>denotes the total length of common strings. If p=2, m<sub>p </sub>denotes the sum of squares for common string lengths.</p>
<p id="p-0036" num="0035">The discontinuity calculator <b>140</b> calculates a discontinuity value M that indicates a distance between strings by using the array CS of the common strings detected by the common string detector <b>120</b>, according to Math <figref idref="DRAWINGS">FIG. 4</figref> below. The CS is an array of a plurality of common strings c sorted with respect to x or y. The discontinuity calculator <b>140</b> calculates an area distance that indicates a distance from an upper left end of a common string c<sub>b </sub>to a reference point, that is, a lower right end of a common string c<sub>a</sub>, wherein the two common strings c<sub>a </sub>and c<sub>b </sub>are adjacent to each other. This operation is performed by the discontinuity calculator <b>140</b> for the entire common strings in the array CS, thereby calculating each area distance. Thereafter, the discontinuity calculator <b>140</b> sums all area distances calculated for the entire common strings in the array CS, and then normalizes the summation result to a total area. Such process can be expressed by Math <figref idref="DRAWINGS">FIG. 4</figref>.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>c<sub>xmax</sub>=(x<sub>xmax</sub>, y<sub>xmax</sub>, l<sub>xmax</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>c<sub>ymax</sub>=(x<sub>ymax</sub>, y<sub>ymax</sub>, l<sub>ymax</sub>) &#x2003;&#x2003;[Math FIG. 4]<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0037" num="0036">Herein, c<sub>xmax </sub>denotes c having maximum x in CS, and c<sub>ymax </sub>denotes c having a maximum y in CS.</p>
<p id="p-0038" num="0037">Meanwhile, if CS&#x2032; (S<sub>1</sub>, S<sub>2</sub>) is defined as Math <figref idref="DRAWINGS">FIG. 5</figref>, a discontinuity that indicates a level of discontinuity of CS&#x2032; (S<sub>1</sub>, S<sub>2</sub>) can be calculated as follows.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>CS&#x2032;(S<sub>1</sub>,S<sub>2</sub>)=CS(S<sub>1</sub>,S<sub>2</sub>)&#x222a;{c<sub>0</sub>,c<sub>n+1</sub>}&#x2003;&#x2003;[Math FIG. 5]<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0039" num="0038">Herein, c<sub>0 </sub>is (1, 1, 0), and c<sub>n+1 </sub>is (x<sub>xmax</sub>+1<sub>xmax</sub>&#x2212;1, y<sub>ymax</sub>+1<sub>ymax</sub>&#x2212;1, 0).</p>
<p id="p-0040" num="0039">Finally, the discontinuity calculator <b>140</b> calculates a discontinuity value M that indicates a level of discontinuity of CS&#x2032; (S<sub>1</sub>, S<sub>2</sub>) according to Math <figref idref="DRAWINGS">FIG. 6</figref> below.</p>
<p id="p-0041" num="0040">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>M</mi>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <munderover>
              <mo>&#x2211;</mo>
              <mrow>
                <mi>i</mi>
                <mo>=</mo>
                <mn>0</mn>
              </mrow>
              <mi>n</mi>
            </munderover>
            <mo>&#x2062;</mo>
            <mrow>
              <mo>{</mo>
              <mrow>
                <mrow>
                  <mo>&#xf603;</mo>
                  <mrow>
                    <msub>
                      <mi>x</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>-</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>x</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <msub>
                          <mi>l</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>&#xf604;</mo>
                </mrow>
                <mo>&#xd7;</mo>
                <mrow>
                  <mo>&#xf603;</mo>
                  <mrow>
                    <msub>
                      <mi>y</mi>
                      <mrow>
                        <mi>i</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>&#x2061;</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>y</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>+</mo>
                        <msub>
                          <mi>l</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>&#xf604;</mo>
                </mrow>
              </mrow>
              <mo>}</mo>
            </mrow>
          </mrow>
          <mrow>
            <msub>
              <mi>x</mi>
              <mrow>
                <mi>n</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>&#xd7;</mo>
            <msub>
              <mi>y</mi>
              <mrow>
                <mi>n</mi>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
            </msub>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>[</mo>
        <mrow>
          <mi>Math</mi>
          <mo>&#x2062;</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>&#x2062;</mo>
          <mrow>
            <mi>FIG</mi>
            <mo>.</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>&#x2062;</mo>
            <mn>6</mn>
          </mrow>
        </mrow>
        <mo>]</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0042" num="0041">According to the similarity value m<sub>p </sub>calculated by the similarity calculator <b>130</b> or the discontinuity value M calculated by the discontinuity calculator <b>140</b>, the plagiarism determining unit <b>150</b> determines whether the target program is plagiarized. If the similarity value m<sub>p </sub>is greater than a predetermined first reference value, the plagiarism determining unit <b>150</b> determines that the target program is plagiarized. If the discontinuity value M is less than a predetermined second reference value, the plagiarism determining unit <b>150</b> determines that the target program is plagiarized. The first and second reference values are determined through experimentations.</p>
<p id="p-0043" num="0042">For example, if p&#x3e;1, although common strings have the same length in total, a common string having a longer length has a greater similarity value m<sub>p </sub>calculated according to Math <figref idref="DRAWINGS">FIG. 3</figref>. If the similarity value m<sub>p </sub>is normalized to the sum of string lengths (i.e., length(S<sub>1</sub>)+length(S<sub>2</sub>)), the greater the similarity, the more similar the memory access log is. Thus, it can be concluded that operations of the two programs to be compared with each other are further similar to each other. Meanwhile, the discontinuity value M is a value that indicates discontinuity of the two programs. This means that the two programs have a higher continuity when the value becomes close to zero. Therefore, when two strings exactly coincide with each other, the discontinuity value M is 0, and when there is no common string, the discontinuity value M is 1.</p>
<p id="p-0044" num="0043">In Table 3 below, the similarity value m<sub>p </sub>and the discontinuity value M are described according to a comparison result between one original program and four target programs. In addition, <figref idref="DRAWINGS">FIG. 4</figref> to <figref idref="DRAWINGS">FIG. 11</figref> illustrate line images and area images obtained by performing a string comparison algorithm (i.e., the GST algorithm) on a plurality of target programs.</p>
<p id="p-0045" num="0044">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="56pt" align="center"/>
<colspec colname="3" colwidth="98pt" align="center"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="3" rowsep="1">TABLE 3</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry>Similarity</entry>
<entry/>
</row>
<row>
<entry/>
<entry>Program</entry>
<entry>(m<sub>p</sub>/(len(S<sub>1 </sub>+ S<sub>2</sub>))</entry>
<entry>Discontinuity (M)</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>Program 1</entry>
<entry>0.514463</entry>
<entry>0.000344</entry>
</row>
<row>
<entry/>
<entry>Program 2</entry>
<entry>0.008190</entry>
<entry>0.005818</entry>
</row>
<row>
<entry/>
<entry>Program 3</entry>
<entry>0.138358</entry>
<entry>0.033524</entry>
</row>
<row>
<entry/>
<entry>Program 4</entry>
<entry>0.014254</entry>
<entry>0.261336</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0046" num="0045">Referring to Table 3 and <figref idref="DRAWINGS">FIGS. 4 to 11</figref> (which are line and area images having the same axes as those shown in <figref idref="DRAWINGS">FIGS. 2 and 3</figref>), Program <b>1</b> is a plagiarized source code having completely the same operation as the original program, and is a test program which is modified to make it hard for a user to visually recognize that the two programs have the same code. In the GST common string images shown in <figref idref="DRAWINGS">FIGS. 4 and 5</figref>, memory access logs entirely coincide with each other except for one part, and a discontinuity has a value very close to 0. <figref idref="DRAWINGS">FIG. 4</figref> shows a line image for Program <b>1</b>, and <figref idref="DRAWINGS">FIG. 5</figref> shows a corresponding area image for Program <b>1</b>. Program <b>2</b> is a test program in which an unnecessary memory access code that interferes with continuous memory access is inserted into a plagiarized source code performing the same operation as the original program. In this case, a continuity of memory access is not ensured, and thus plagiarism cannot be detected by using the GST common string images illustrated in <figref idref="DRAWINGS">FIGS. 6 and 7</figref>. <figref idref="DRAWINGS">FIG. 6</figref> shows a line image for Program <b>2</b>, and <figref idref="DRAWINGS">FIG. 7</figref> shows a corresponding area image for Program <b>2</b>. However, since a discontinuity is very close to 0, it can be determined that the program is plagiarized. Program <b>3</b> is a source code performing the similar function as the original program. In GST common string images illustrated in <figref idref="DRAWINGS">FIGS. 8 and 9</figref>, the length and area of the common string are significantly small, which shows that the program is not plagiarized. <figref idref="DRAWINGS">FIG. 8</figref> shows a line image for Program <b>3</b>, and <figref idref="DRAWINGS">FIG. 9</figref> shows a corresponding area image for Program <b>3</b>. Further, a large discontinuity shows that the program is not plagiarized. Program <b>4</b> is a source code totally different from the original program. In the GST common string images illustrated in <figref idref="DRAWINGS">FIGS. 10 and 11</figref>, short common strings are irregularly scattered, which shows that the program is not plagiarized. <figref idref="DRAWINGS">FIG. 10</figref> shows a line image for Program <b>4</b>, and <figref idref="DRAWINGS">FIG. 11</figref> shows a corresponding area image for Program <b>4</b>. Further, since a discontinuity is large, it can be determined that the program is not plagiarized.</p>
<p id="p-0047" num="0046">Regarding a similarity value, although the common strings are almost similar except for one part as shown in <figref idref="DRAWINGS">FIGS. 4 and 5</figref>, if p=2, the similarity value is halved, and if p&#x3e;2, the similarity value changes further. As shown in <figref idref="DRAWINGS">FIGS. 6 and 7</figref>, in a case where a continuity of an access log is intentionally eliminated by sporadically inserting unnecessary memory access codes into almost similar programs, a significantly low value (i.e., indicating low similarity) is obtained. As shown in <figref idref="DRAWINGS">FIGS. 10 and 11</figref>, even if locations of common strings (i.e., program execution sequence) are not orderly positioned, it cannot be concluded that a similarity is lower than the case where common strings are sequentially located. Accordingly, it can be concluded that plagiarism can be further accurately detected when using a discontinuity obtained by calculating a discontinuity level of common strings rather than using a similarity obtained by calculating a continuity level of the common strings.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 12</figref> is a flowchart illustrating a method of detecting program plagiarism according to an embodiment of the present invention.</p>
<p id="p-0049" num="0048">Referring to <figref idref="DRAWINGS">FIG. 12</figref>, the data extractor <b>110</b> extracts an access log of an original program and an access log of a target program from a memory accessed by the programs (step S<b>800</b>). In this case, the data extractor <b>110</b> uses a memory protection scheme (e.g., read, write, etc.) to extract information by checking memory addresses and values whenever the memory is accessed. The common string detector <b>120</b> enumerates values v, which are obtained from the access logs extracted from the original program and the target program, into strings S<sub>1 </sub>and S<sub>2</sub>, and then each of the strings S<sub>1 </sub>and S<sub>2 </sub>is subject to a tiling process according to a string comparison algorithm (i.e., a GST algorithm), thereby detecting a common string c (step S<b>810</b>). By using an array CS of the common strings detected by the common string detector <b>120</b>, the similarity calculator <b>130</b> calculates a similarity value m<sub>p </sub>that indicates a level of coincidence between S<sub>1 </sub>and S<sub>2 </sub>(step S<b>820</b>). The discontinuity calculator <b>140</b> calculates a discontinuity value M that indicates a distance between strings by using the array CS of the common strings detected by the common string detector <b>120</b> (step S<b>830</b>). According to the similarity value m<sub>p </sub>calculated by the similarity calculator <b>130</b> or the discontinuity value M calculated by the discontinuity calculator <b>140</b>, the plagiarism determining unit <b>150</b> determines whether the target program is plagiarized (step S<b>840</b>). If the similarity value m<sub>p </sub>is greater than a predetermined first reference value, the plagiarism determining unit <b>150</b> determines that the target program is plagiarized. If the discontinuity value M is less than a predetermined second reference value, the plagiarism determining unit <b>150</b> determines that the target program is plagiarized.</p>
<p id="p-0050" num="0049">According to an apparatus and method for detecting program plagiarism of the present invention, program plagiarism can be detected when two programs are compared with each other without having to provide source programs. In particular, plagiarism can be accurately detected when a memory access sequence is not modified after changing a program source, for example, insertion of comments, changes in variables or function names, changes in locations of function declarations, integration and disintegration of functions, insertion of unnecessary non-executed codes, and so on. In addition, when plagiarism is detected by using a discontinuity value, plagiarism can be accurately detected even if a plagiarist intentionally inserts a code to generate unnecessary memory access.</p>
<p id="p-0051" num="0050">The invention can also be embodied as computer readable codes on a computer readable recording medium. The computer readable recording medium is any data storage device that can store data which can be thereafter read by a computer system. Examples of the computer readable recording medium include read-only memory (ROM), random-access memory (RAM), CD-ROMs, magnetic tapes, floppy disks, optical data storage devices, and carrier waves (such as data transmission through the Internet). The computer readable recording medium can also be distributed over network coupled computer systems so that the computer readable code is stored and executed in a distributed fashion.</p>
<p id="p-0052" num="0051">While the present invention has been particularly shown and described with reference to exemplary embodiments thereof, it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the invention as defined by the appended claims. The exemplary embodiments should be considered in descriptive sense only and not for purposes of limitation. Therefore, the scope of the invention is defined not by the detailed description of the invention but by the appended claims, and all differences within the scope will be construed as being included in the present invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US08353056-20130108-M00001.NB">
<img id="EMI-M00001" he="8.47mm" wi="76.20mm" file="US08353056-20130108-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US08353056-20130108-M00002.NB">
<img id="EMI-M00002" he="12.02mm" wi="76.20mm" file="US08353056-20130108-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US08353056-20130108-M00003.NB">
<img id="EMI-M00003" he="11.68mm" wi="76.20mm" file="US08353056-20130108-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US08353056-20130108-M00004.NB">
<img id="EMI-M00004" he="8.47mm" wi="76.20mm" file="US08353056-20130108-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US08353056-20130108-M00005.NB">
<img id="EMI-M00005" he="11.68mm" wi="76.20mm" file="US08353056-20130108-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US08353056-20130108-M00006.NB">
<img id="EMI-M00006" he="8.47mm" wi="76.20mm" file="US08353056-20130108-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An apparatus, comprising at least one processor, for detecting program plagiarism, the apparatus comprising:
<claim-text>a data extractor for extracting an access log of an original program and an access log of a target program to be compared with the original program, the access logs being extracted from at least one memory accessed by the programs;</claim-text>
<claim-text>a common string detector for enumerating values into a first string including values from the access log of the original program and a second string including values from the access log of the target program, and for detecting one or more common strings that exist in both the first and second strings;</claim-text>
<claim-text>a discontinuity calculator for calculating a discontinuity value that indicates a distance between the first and second strings by using an array of the detected common strings; and</claim-text>
<claim-text>a plagiarism determining unit for determining that the target program is plagiarized if the calculated discontinuity value is less than a predetermined reference value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the discontinuity calculator calculates the discontinuity value according to Equation:</claim-text>
<claim-text>
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mi>M</mi>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>0</mn>
        </mrow>
        <mi>n</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>{</mo>
        <mrow>
          <mrow>
            <mo>&#xf603;</mo>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo>-</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>x</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>l</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>&#xf604;</mo>
          </mrow>
          <mo>&#xd7;</mo>
          <mrow>
            <mo>&#xf603;</mo>
            <mrow>
              <msub>
                <mi>y</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo>-</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>y</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>l</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>&#xf604;</mo>
          </mrow>
        </mrow>
        <mo>}</mo>
      </mrow>
    </mrow>
    <mrow>
      <msub>
        <mi>x</mi>
        <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
        </mrow>
      </msub>
      <mo>&#xd7;</mo>
      <msub>
        <mi>y</mi>
        <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
        </mrow>
      </msub>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<claim-text>where x<sub>i </sub>denotes a starting point of c<sub>i </sub>in the first string composed of values obtained from the access log extracted from the original program, y<sub>i </sub>denotes a starting point of c<sub>i </sub>in the second string composed of values obtained from the access log extracted from the target program, and l<sub>i </sub>denotes the length of c<sub>i </sub>, where {c<sub>1</sub>,c<sub>2</sub>,c<sub>3</sub>, . . . ,c<sub>n</sub>} is the array of the detected common strings.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. An apparatus, comprising at least one processor, for detecting program plagiarism, the apparatus comprising:
<claim-text>a data extractor for extracting an access log of an original program and an access log of a target program to be compared with the original program, the access logs being extracted from at least one memory accessed by the programs;</claim-text>
<claim-text>a common string detector for enumerating values into a first string including values from the access log of the original program and a second string including values from the access log of the target program, and for detecting one or more common strings that exist in both the first and second strings;</claim-text>
<claim-text>a similarity calculator for calculating a similarity value that indicates a level of coincidence of the first and second strings by using an array of the detected common strings; and</claim-text>
<claim-text>a plagiarism determining unit for determining that the target program is plagiarized if the calculated similarity value is greater than a predetermined reference value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the similarity determining unit calculates the similarity value according to Equation:</claim-text>
<claim-text>
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>m</mi>
    <mi>p</mi>
  </msub>
  <mo>=</mo>
  <mrow>
    <munderover>
      <mo>&#x2211;</mo>
      <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
      </mrow>
      <mi>n</mi>
    </munderover>
    <mo>&#x2062;</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <msub>
          <mi>l</mi>
          <mi>i</mi>
        </msub>
        <mo>)</mo>
      </mrow>
      <mi>p</mi>
    </msup>
  </mrow>
</mrow>
</math>
</maths>
<claim-text>where l<sub>i </sub>, denotes the length of c<sub>i </sub>where {c<sub>1</sub>, c<sub>2 </sub>,c<sub>3</sub>, . . . , c<sub>n </sub>} is the array of the detected common strings.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method of detecting program plagiarism, comprising the steps of:
<claim-text>extracting an access log of an original program and an access log of a target program to be compared with the original program, the access logs being extracted from at least one memory accessed by the programs;</claim-text>
<claim-text>enumerating values into a first string including values from the access log of the original program and a second string including values from the access log of the target program, and detecting one or more common strings that exist in both the first and second strings;</claim-text>
<claim-text>calculating a discontinuity value that indicates a distance between the first and second strings by using an array of the detected common strings; and</claim-text>
<claim-text>determining that the target program is plagiarized if the calculated discontinuity value is less than a predetermined reference value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein, in the step of calculating a discontinuity value, the discontinuity value is calculated according to Equation:</claim-text>
<claim-text>
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mrow>
  <mi>M</mi>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <munderover>
        <mo>&#x2211;</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <mn>0</mn>
        </mrow>
        <mi>n</mi>
      </munderover>
      <mo>&#x2062;</mo>
      <mrow>
        <mo>{</mo>
        <mrow>
          <mrow>
            <mo>&#xf603;</mo>
            <mrow>
              <msub>
                <mi>x</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo>-</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>x</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>l</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>&#xf604;</mo>
          </mrow>
          <mo>&#x2062;</mo>
          <mi>S</mi>
          <mo>&#x2062;</mo>
          <mrow>
            <mo>&#xf603;</mo>
            <mrow>
              <msub>
                <mi>y</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mn>1</mn>
                </mrow>
              </msub>
              <mo>-</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>y</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>l</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>&#xf604;</mo>
          </mrow>
        </mrow>
        <mo>}</mo>
      </mrow>
    </mrow>
    <mrow>
      <msub>
        <mi>x</mi>
        <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
        </mrow>
      </msub>
      <mo>&#xd7;</mo>
      <msub>
        <mi>y</mi>
        <mrow>
          <mi>n</mi>
          <mo>+</mo>
          <mn>1</mn>
        </mrow>
      </msub>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<claim-text>where x<sub>i </sub>denotes a starting point of c<sub>i </sub>in the first string composed of values obtained from the access log extracted from the original program, y<sub>i </sub>denotes a staring point of c<sub>i </sub>in the second string composed of values obtained from the access log extracted from the target program, and 1<sub>i </sub>denotes the length of c<sub>i</sub>, where {c<sub>1 </sub>,c<sub>2 </sub>,c<sub>3</sub>, . . . , c<sub>n </sub>} is the array of the detected common strings.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A method of detecting program plagiarism, comprising the steps of:
<claim-text>extracting an access log of an original program and an access log of a target program to be compared with the original program, the access logs being extracted from at least one memory accessed by the programs;</claim-text>
<claim-text>enumerating values into a first string including values from the access log of the original program and a second string including values from the access log of the target program, and detecting one or more common strings that exist in both the first and second strings;</claim-text>
<claim-text>calculating a similarity value that indicates a level of coincidence of the first and second strings by using an array of the detected common strings; and</claim-text>
<claim-text>determining that the target program is plagiarized if the calculated similarity value is greater than a predetermined reference value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein, in the step of the calculating a similarity value, the similarity value is calculated according to Equation:</claim-text>
<claim-text>
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>m</mi>
    <mi>p</mi>
  </msub>
  <mo>=</mo>
  <mrow>
    <munderover>
      <mo>&#x2211;</mo>
      <mrow>
        <mi>i</mi>
        <mo>=</mo>
        <mn>1</mn>
      </mrow>
      <mi>n</mi>
    </munderover>
    <mo>&#x2062;</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <msub>
          <mi>l</mi>
          <mi>i</mi>
        </msub>
        <mo>)</mo>
      </mrow>
      <mi>p</mi>
    </msup>
  </mrow>
</mrow>
</math>
</maths>
<claim-text>Where l<sub>i </sub>denotes the length of c<sub>i </sub>where {c<sub>1</sub>,c<sub>2 </sub>,c<sub>3</sub>, . . . , c<sub>n </sub>} is the array of the detected common strings.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A non-transitory computer-readable medium having embodied thereon a computer program for executing the method of <claim-ref idref="CLM-00005">claim 5</claim-ref>.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the values from the access log of the original program include values that are results of operations performed by the original program, and the values from the access log of the target program include values that are results of operations performed by the target program.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the values from the access log of the original program include values that are results of operations performed by the original program, and the values from the access log of the target program include values that are results of operations performed by the target program.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the values from the access log of the original program include values that are results of operations performed by the original program, and the values from the access log of the target program include values that are results of operations performed by the target program.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the values from the access log of the original program include values that are results of operations performed by the original program, and the values from the access log of the target program include values that are results of operations performed by the target program.</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353057-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353057</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12816049</doc-number>
<date>20100615</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2009-153317</doc-number>
<date>20090629</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>303</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>21</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 32</main-classification>
<further-classification>726 27</further-classification>
<further-classification>726 30</further-classification>
<further-classification>726 33</further-classification>
</classification-national>
<invention-title id="d2e71">Information processing apparatus, control method, and control program</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>2004/0019800</doc-number>
<kind>A1</kind>
<name>Tatebayashi et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713200</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2005/0220296</doc-number>
<kind>A1</kind>
<name>Kawell et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2006/0106727</doc-number>
<kind>A1</kind>
<name>Yellai et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 59</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2009/0228982</doc-number>
<kind>A1</kind>
<name>Kobayashi</name>
<date>20090900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>JP</country>
<doc-number>2006-107468</doc-number>
<kind>A</kind>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00006">
<othercit>Ma&#xf1;a et al. &#x201c;A framework for secure execution of software,&#x201d; International Journal of Information Security vol. 3, No. 2 (2004), pp. 99-112.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
</references-cited>
<number-of-claims>9</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 26- 33</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20100333214</doc-number>
<kind>A1</kind>
<date>20101230</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Tsuboi</last-name>
<first-name>Masanori</first-name>
<address>
<city>Kawasaki</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Canon USA, Inc., IP Division</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Canon Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Zand</last-name>
<first-name>Kambiz</first-name>
<department>2434</department>
</primary-examiner>
<assistant-examiner>
<last-name>Guirguis</last-name>
<first-name>Michael</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An information processing apparatus in which an application managed by a license based on license data operates. The information processing apparatus includes a recording unit to record transfer information indicating that the license data is transferred from the information processing apparatus to a second information processing apparatus, and a prohibition unit to prohibit use in the information processing apparatus of the license data corresponding to the transfer information when the transfer information indicates that the license data has been transferred from the information processing apparatus to the second information processing apparatus.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="164.93mm" wi="187.03mm" file="US08353057-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="123.53mm" wi="103.89mm" file="US08353057-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="241.72mm" wi="154.69mm" file="US08353057-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="209.21mm" wi="138.43mm" orientation="landscape" file="US08353057-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="223.18mm" wi="157.48mm" orientation="landscape" file="US08353057-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="216.41mm" wi="164.17mm" orientation="landscape" file="US08353057-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="250.70mm" wi="119.97mm" orientation="landscape" file="US08353057-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="212.68mm" wi="153.16mm" orientation="landscape" file="US08353057-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="191.60mm" wi="150.28mm" file="US08353057-20130108-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to an information processing method in a license management system.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">An application license management system allows businesses and others to manage product licenses by enforcing, monitoring, and maintaining licenses to keep track of which customers have licensed what application and how those applications and licenses are being used. There is an apparatus that can be connected to a network to install an application with a license. There is a process by which a license issuing server transfers an application and a related license to another apparatus (for example, see Japanese Patent Application Laid-Open No. 2006-107468).</p>
<p id="p-0006" num="0005">The license handled by Japanese Patent Application Laid-Open No. 2006-107468 activates an application that is preinstalled in a device. When the license is installed and when the license is transferred, since a license condition is stored in a non-volatile area, it is possible to prevent use of the license without proper authorization when the license is transferred.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">According to an aspect of the present invention, an information processing apparatus in which an application managed by a license based on license data operates includes a recording unit to record transfer information indicating that the license data is transferred from the information processing apparatus to a second information processing apparatus. The information processing apparatus also includes a prohibition unit to prohibit use in the information processing apparatus of the license data corresponding to the transfer information when the transfer information indicates that the license data has been transferred from the information processing apparatus to the second information processing apparatus.</p>
<p id="p-0008" num="0007">Further features and aspects of the present invention will become apparent from the following detailed description of exemplary embodiments with reference to the attached drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0009" num="0008">The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate exemplary embodiments, features, and aspects of the invention and, together with the description, serve to explain the principles of the invention.</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a system configuration diagram according to an exemplary embodiment of the present invention.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a functional block diagram of a multifunction peripheral according to the exemplary embodiment of the present invention.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a functional block diagram of a contents distribution server according to the exemplary embodiment of the present invention.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a processing flow for installation of an indefinite-period license according to the exemplary embodiment of the present invention.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart illustrating installation according to the exemplary embodiment of the present invention.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a recovery flow during a hard disk (HDD) crash according to the exemplary embodiment of the present invention.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a processing flow for installation of an indefinite-period license according to the exemplary embodiment of the present invention.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a modified example of a part of the exemplary embodiment illustrated in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0018" num="0017">Various exemplary embodiments, features, and aspects of the invention will be described in detail below with reference to the drawings.</p>
<p id="p-0019" num="0018">The constitutive elements described in an exemplary embodiment of the present invention are merely exemplary. The scope of the present invention is not limited merely to such exemplary description within a scope that does not depart from the spirit of the present invention. A licensor may grant license to a licensee to authorize certain use of an application and use of that license. One aspect of the present exemplary embodiment enables prevention of use of a license without proper authorization when an application and the license are installed at the same time, and for example, reduces a recovery processing load when a hard disk drive (HDD) is exchanged.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a network system configuration that includes an information processing apparatus according to an exemplary embodiment of the present invention.</p>
<p id="p-0021" num="0020">In <figref idref="DRAWINGS">FIG. 1</figref>, a contents distribution server <b>101</b> is configured to distribute an application, a license, or firmware. A computer system provided in the contents distribution server <b>101</b> may constitute an example of a server access unit, a number request unit, an apparatus body number recognition unit, a contents distribution confirmation demand unit, an apparatus body number check unit, a contents distribution unit, an option information registration unit, an identifier generation unit, an identifier transmission unit, and the like. The contents distribution server <b>101</b> may be integrated with a license server apparatus <b>107</b>.</p>
<p id="p-0022" num="0021">A multifunction peripheral (MFP) <b>102</b> includes functions such as a printer, a scanner, a copier, a FAX, and the like in a single unit. A plurality of applications and licenses can be installed in the MFP <b>102</b> and each application and each license has a unique device identification (ID). The MFP <b>102</b> can install the firmware, applications, and licenses according to the present invention.</p>
<p id="p-0023" num="0022">An information processing apparatus <b>103</b> is used to remotely operate the MFP <b>102</b>. A network <b>104</b> includes the Internet or the like, and the MFP <b>102</b> can be connected with the contents distribution server <b>101</b> via the network <b>104</b>. A network <b>105</b> also includes the Internet or the like, and the information processing apparatus <b>103</b> can be connected with the MFP <b>102</b> via the network <b>105</b>. An example of a communication circuit <b>106</b> is illustrated in <figref idref="DRAWINGS">FIG. 1</figref>. Each apparatus in the network system configuration of <figref idref="DRAWINGS">FIG. 1</figref> can communicate with one another directly or via another apparatus. When a license access number and an MFP identification ID to be installed are input from an input screen of the information processing apparatus <b>103</b> to the license server apparatus <b>107</b>, a license file is generated and issued. An encryption key that corresponds to a decryption key in the MFP or the like encrypts the license file.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a functional block diagram of an MFP according to the present exemplary embodiment.</p>
<p id="p-0025" num="0024">An MFP <b>201</b> includes the same functions and configurations as those of the MFP <b>102</b> illustrated in <figref idref="DRAWINGS">FIG. 1</figref>. A scanner functional unit <b>202</b> is configured to read a paper document and convert a read result into binary image data. A print functional unit <b>203</b> is configured to add a command for a printer to the image that is read and converted into the binary image data by the scanner functional unit <b>202</b> and output the image to a printer device. A facsimile functional unit <b>204</b> is configured to encode the image that is read and converted into the binary image data by the scanner functional unit <b>202</b> according to a facsimile standard such as G3, G4, or the like. The facsimile functional unit <b>204</b> also is configured to perform image communication with an external facsimile apparatus using a protocol according to the facsimile standard. The facsimile functional unit <b>204</b> further is configured to transmit and receive a facsimile image to and from an external facsimile apparatus according to the facsimile standard.</p>
<p id="p-0026" num="0025">A job control functional unit <b>205</b> queues pieces of the binary image data received from the scanner functional unit <b>202</b> and the facsimile image data received by the facsimile functional unit <b>205</b> from an external apparatus as print jobs. The job control functional unit <b>205</b> includes a job control function of executing suitable output in sequence to the print functional unit <b>203</b>, the facsimile functional unit <b>204</b>, and a network functional unit <b>206</b> described below. The network functional unit <b>206</b> includes various network protocol functions including a transmission control protocol/internet protocol (TCP/IP), a hypertext transfer protocol (HTTP), a file transfer protocol (FTP), a lightweight directory access protocol (LDAP), a simple network access protocol (SNMP), a simple mail transfer protocol (SMTP), a secure sockets layer (SSL), or the like. The MFP <b>201</b> can receive licenses and applications or execute transmission to an external personal computer (PC) by using the various network protocols.</p>
<p id="p-0027" num="0026">A user interface (UI) functional unit <b>207</b> manages input and output by a user on an operation panel on the MFP <b>201</b>, and displays an input field, an output message field, and the like on the operation panel. The UI functional unit <b>207</b> has functions of receiving a value input to the input field by the user, notifying other functional units of the input value, and displaying a message to the user from other functional units on a pre-designed screen. A user authentication functional unit <b>208</b> responds to a user authentication request for various applications in an application functional unit <b>209</b> with using the UI functional unit <b>207</b> or an information terminal (not illustrated) on the network. In other words, various user authentication functions are set for each application using a user authentication setting file. Further, the user authentication functional unit <b>208</b> has a function of authenticate the user who operates each function of the MFP <b>201</b> using user authentication information in the MFP <b>201</b> or a user authentication server on the network.</p>
<p id="p-0028" num="0027">The application functional unit <b>209</b> includes functions of installing various applications operated on the MFP <b>201</b>, authenticating a user, executing the applications, and uninstalling the applications. The application functional unit <b>209</b> further sets an expiration date for the application when the application is installed. When the application is executed, a time management functional unit <b>215</b> described below is used to determine the expiration date, which is pre-set when the application was installed, so that execution of the application with the expiration date can be realized.</p>
<p id="p-0029" num="0028">For the setting for the application expiration date, expiration date information may be stored in an application object, or a separate object may be set as additional information to the application when the application is installed. The expiry date shows a number of days from installation of the application until the application will cease to operate. The expiry date may be a number of days indicating a validity period or may be an expiry day in a day/month/year format. When the expiry day indicates the expiry date, a system built-in clock in the MFP <b>201</b> may calculate the number of days indicating the validity period. More precise units than a number of days, for example of a number of seconds may be used. If such units fall within the scope of units used by the system built-in clock, they may be used for calculation of the expiry date. The expiry date is transferred as an argument to an installation time setting function described below when the application is installed, and is stored in a non-volatile storage region in the MFP <b>201</b>. The expiry date may be set to an indefinite-period.</p>
<p id="p-0030" num="0029">When a decoded valid license is installed, an application can be started up. When a valid license is not installed, the application cannot be started up. When a license file is decoded, an application ID and an expiry date are generated. An application license management unit <b>214</b> allows startup and operation of the application only after checking that the application ID corresponds to the ID of the application and confirming that the data in the license file is valid.</p>
<p id="p-0031" num="0030">The application license management unit <b>214</b> in <figref idref="DRAWINGS">FIG. 2</figref> manages a state of the installed license or the license for the application. The state of the license includes the expiry date, validity, invalidity, or the like. The application license management unit <b>214</b> also manages an ignored license ID, a transfer flag, and the like, and details thereof will be described below with reference to <figref idref="DRAWINGS">FIG. 4</figref> and <figref idref="DRAWINGS">FIG. 7</figref>. The application license management unit <b>214</b> executes determination processing <b>402</b> and installation processing unit <b>406</b> in <figref idref="DRAWINGS">FIG. 4</figref> and determination processing <b>702</b> and installation processing <b>706</b> in <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0032" num="0031">Among the applications of the MFP <b>102</b>, functions of the application whose main body is already installed in the MFP <b>102</b> can be validated by installation of only a license key.</p>
<p id="p-0033" num="0032">A validation sequence is required after installing the application to use the application on the MFP <b>102</b>. Using the license key, which generally is input from the UI functional unit <b>207</b>, validates the application. The license key is encrypted information including an identification ID for identifying a functional type of the license and a device in which the license is validated. Use of the network functional unit <b>206</b> may perform input of the license key via the network.</p>
<p id="p-0034" num="0033">Inputting the license key into the MFP <b>102</b> executes the validation of the application. In practice, a license bit existing in the non-volatile storage region in the MFP <b>102</b> corresponding to each of the applications is turned ON. In the same manner, turning the license bit OFF invalidates the application. When the license bit of the system in the MFP <b>102</b> or the application itself is OFF, startup of the application is prevented. When the license bit is ON, startup of the application is permitted.</p>
<p id="p-0035" num="0034">A mail sending and receiving application <b>210</b> is one of the applications of the MFP <b>201</b> operated on the application functional unit <b>209</b>. The mail sending and receiving application <b>210</b> receives an email having an electronic document attached thereto sent from an information terminal (not illustrated) on the network by use of the network functional unit <b>206</b>. The mail sending and receiving application <b>210</b> has a function of performing printing by use of the print functional unit <b>203</b>. The mail sending and receiving application <b>210</b> further attaches an electronic document read using the scanner functional unit <b>202</b> to an email and transmits the email with the electronic document attached thereto to a preset transfer destination.</p>
<p id="p-0036" num="0035">A remote control application <b>211</b> is one of the applications on the MFP <b>201</b> operated by the application functional unit <b>209</b>. The remote control application <b>211</b> has a function of displaying the same interface as a main body's touch panel, which is displayed on the MFP main body using the UI functional unit <b>207</b> on an information terminal (not illustrated) on the network to thereby enable remote control.</p>
<p id="p-0037" num="0036">A document format conversion application <b>212</b> is one of the applications on the MFP <b>201</b> operated by the application functional unit <b>209</b>. The document format conversion application <b>212</b> has a function of converting electronic data into a preset electronic data format. Electronic data read by the user using the scanner functional unit <b>202</b> or electronic data sent from an information terminal on the network using the network functional unit <b>206</b> are subjected to the conversion.</p>
<p id="p-0038" num="0037">A document management system application <b>213</b> is one of the applications on the MFP <b>201</b> operated by the application functional unit <b>209</b>. The document management system application <b>213</b> has a function of storing data in a preset document storage location in the MFP main body or on the network. The stored data includes electronic data read by the user operating the scanner functional unit <b>202</b> or electronic data sent from an information terminal on the network using the network functional unit <b>206</b>.</p>
<p id="p-0039" num="0038">The mail sending and receiving application <b>210</b>, the remote control application <b>211</b>, the document format conversion application <b>212</b>, and the document management system application <b>213</b> can execute user authentication. When using the application, the user utilizes the user authentication functional unit <b>208</b> via the application functional unit <b>209</b>.</p>
<p id="p-0040" num="0039">The time management functional unit <b>215</b> includes the system built-in clock and provides a system built-in clock interface that can be used for time setting and referred to for all functional modules of the MFP <b>201</b>. The time management functional unit <b>215</b> has a function of storing cumulative setting differential time from the system startup time as described below in a non-volatile storage region of a flash read only memory (ROM) or the like. The time management functional unit <b>215</b> further has a function of adjusting the time according to a time synchronization service on the network to which the MFP <b>201</b> is connected. The time synchronization service is a service for synchronizing the time using a protocol specified by a TIME protocol (RFC868), a network time protocol (NTP) (RFC1305), a simple network time protocol (SNTP) (RFC 1769), or the like. The time management functional unit <b>215</b> further has a function of setting installation time, at the time of application installation as described below, to determine an expiry date of an application having an expiry date.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a functional block diagram of a contents distribution server <b>3000</b>. A central processing unit (CPU) <b>301</b> controls each processing in the apparatus. A read-only memory (ROM) <b>302</b> stores data or programs related to each processing of the apparatus and cannot be rewritten. A random access memory (RAM) <b>303</b> electrically stores temporary data related to each processing of the apparatus and can be rewritten. Temporary data or programs and data related to each processing of the apparatus are stored in a hard disk (HDD) <b>304</b>. An input apparatus <b>305</b> includes a keyboard or a pointing device that receives an instruction input to the apparatus. A display unit <b>306</b> displays various pieces of information such as an operational state of the apparatus and outputs from each program operated by the apparatus. A network interface (I/F) <b>307</b> is connected to the Internet or a local area network (LAN) via the network to execute information exchange with external apparatuses. An external apparatus I/F <b>308</b> is connected to an external storage device or the like. The above units are connected by a system bus <b>309</b> and exchange data with each other.</p>
<p id="p-0042" num="0041">The MFP <b>102</b> includes approximately the same hardware as the contents distribution server <b>3000</b> in <figref idref="DRAWINGS">FIG. 3</figref>. However, the MFP <b>102</b> is different from the contents distribution server <b>3000</b> in that the MFP <b>102</b> is further provided with hardware and software for printing functions and image processing functions, and has limited CPU and memory resources. Software as illustrated in <figref idref="DRAWINGS">FIG. 4</figref> and <figref idref="DRAWINGS">FIG. 7</figref> is stored in the HDD <b>304</b> and executed by the CPU <b>301</b>. Further, the CPU <b>301</b> executes the processing illustrated in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0043" num="0042">The processing for installing a license according to the present exemplary embodiment will be in detail described below.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 4</figref> illustrates an example of a software block in the MFP <b>102</b>. Installation of the license is realized by executing the determination processing <b>402</b> and the installation processing unit <b>406</b> in <figref idref="DRAWINGS">FIG. 4</figref> and the application license management unit <b>214</b> in <figref idref="DRAWINGS">FIG. 2</figref>. Program codes that configure respective processing procedures implement each processing illustrated in <figref idref="DRAWINGS">FIG. 4</figref>. Application license <b>401</b> in <figref idref="DRAWINGS">FIG. 4</figref> is data configuring an application and a license to be installed. The determination processing <b>402</b> determines whether installation can be executed in the MFP <b>102</b>. MFP <b>102</b> executes the installation processing unit <b>406</b>.</p>
<p id="p-0045" num="0044">When installation of the application license <b>401</b> is requested in the MFP <b>102</b>, a decoding processing unit <b>403</b> executes decoding thereof. Then, an indefinite-period license check unit <b>404</b> checks whether the application license <b>401</b> is an indefinite-period license. For example, a determination unit may determine whether an expiry date of license data has an indefinite period When the application license <b>401</b> is an indefinite-period license, a transfer flag check unit <b>405</b> executes a transfer flag check. When a transfer flag is ON, an error management unit <b>409</b> displays an error in an operation unit of the MFP <b>102</b>. Alternatively, an error notification is executed via the network to a PC that is an installation destination. In this case, the application is not installed. When the transfer flag is OFF, an installation unit <b>407</b> executes installation.</p>
<p id="p-0046" num="0045">Transfer flag information <b>411</b> used for checking in the transfer flag check unit <b>405</b> is written into when the license is transferred. In other words, the transfer flag information <b>411</b> stores whether the license has been transferred to an external apparatus. After installation, a license ID registration unit <b>408</b> executes registration of the license ID. Then, installation is completed in procedure <b>410</b>.</p>
<p id="p-0047" num="0046">The transfer flag is associated with the license ID for identifying the license file and recorded. For example, when the transfer flag has a value of 1, the value of 1 conveys that the license file corresponding to the license ID has been transferred to an external apparatus. When the transfer flag has a value of 0, the value of 0 conveys that the license file has not been transferred to an external apparatus.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart illustrating an example of normal installation of a license.</p>
<p id="p-0049" num="0048">The application license management unit <b>214</b> illustrated in <figref idref="DRAWINGS">FIG. 2</figref> executes the processing illustrated in <figref idref="DRAWINGS">FIG. 5</figref>. In step S<b>501</b>, decoding of the license is executed, and in step S<b>502</b>, an indefinite-period license check is executed. If it is determined in step S<b>502</b> that the license has an indefinite period, then a transfer flag check is executed in step S<b>503</b>. When the application license management unit <b>214</b> determines at step S<b>503</b> that a transfer flag <b>405</b> is ON, then it is determined in step S<b>505</b> as an installation error and installation is not executed. When the application license management unit <b>214</b> determines at step S<b>503</b> that a transfer flag <b>405</b> is OFF, then installation is executed in step S<b>504</b>. Then, in step S<b>506</b>, registration of the license ID is executed and, in step S<b>507</b>, installation processing is completed.</p>
<p id="p-0050" num="0049">If it is determined in step S<b>502</b> that the license is a normal license, the application license management unit <b>214</b> executes in step <b>508</b> a license duplication check. When duplication is detected (duplication present), then in step S<b>509</b>, it is determined as an installation error. When no duplication of the license ID is detected (duplication absent), then in step S<b>510</b>, installation of the license is executed. Then, in step S<b>511</b>, registration of the license ID is executed and in step S<b>512</b>, the installation processing for the license is completed. Installation of the license may be executed together with installation of the application. When the license is not installed, installation of the application also may be suppressed.</p>
<p id="p-0051" num="0050">In other words, when the transfer flag is ON in the transfer flag <b>405</b>, installation of the license is not permitted and when the transfer flag is OFF, installation of the license is permitted.</p>
<p id="p-0052" num="0051">The information processing apparatus <b>103</b> executes transfer processing of the license file from the MFP <b>102</b> to other MFPs. More specifically, such processing is executed as described below.</p>
<p id="p-0053" num="0052">The information processing apparatus <b>103</b> accesses the MFP <b>102</b> via a browser. An application or license ID in the MFP <b>102</b> to be invalidated is designated via the browser. In this manner, license ID corresponding to the designated application or a license linked to the license ID corresponding to the designated license in the MFP <b>102</b> are invalidated and an invalidation license key is generated.</p>
<p id="p-0054" num="0053">The invalidation license key is transferred from the MFP <b>102</b> to the information processing apparatus <b>103</b>. A user uses the browser in the information processing apparatus <b>103</b> to store the invalidation license key in the information processing apparatus <b>103</b>. Then, the user accesses the license server <b>107</b> using the browser in the information processing apparatus <b>103</b>. The user then inputs the invalidation license key and an MFP identification ID for the license to be used via the browser. The browser transmits input information to the license server <b>107</b>.</p>
<p id="p-0055" num="0054">The license server <b>107</b> generates a license file that can only be used with the relevant MFP based on the invalidation license key and the MFP identification ID. The license file is transmitted from the license server <b>107</b> to the information processing apparatus <b>103</b>. The license server <b>107</b> issues a new license file ID, which is stored in the license file.</p>
<p id="p-0056" num="0055">Since a new license ID is generated each time an invalidated license is validated, installation is executed based on the new license file ID. Thus, installation prohibition by the transfer flag does not occur.</p>
<p id="p-0057" num="0056">However, rather than issuing a new license file ID, there is a case where the license and the license ID invalidated in the MFP <b>102</b> may be issued again. In this case, a license file, which was extracted from the MFP <b>102</b> and used in another MFP, is invalidated, and the following procedure is executed when the license file is extracted again. When installation processing is attempted even if there is a valid license file, the transfer flag that has already been written will prohibit the installation process. In this case, the processing illustrated in <figref idref="DRAWINGS">FIG. 5</figref> is modified by adding the following processing.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a modified example of an exemplary embodiment of the present invention. Similar to the processing in <figref idref="DRAWINGS">FIG. 5</figref>, the application license management unit <b>214</b> illustrated in <figref idref="DRAWINGS">FIG. 2</figref> executes the processing illustrated in <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0059" num="0058">In step S<b>502</b>, if it is determined that the license has an indefinite period, the processing in <figref idref="DRAWINGS">FIG. 8</figref> is started prior to checking the transfer flag at step S<b>503</b>. In step S<b>5001</b>, it is determined whether the license file includes a license invalidated by an external apparatus of the MFP. When it is determined that the license file includes the license invalidated by the external apparatus (YES in step S<b>5001</b>), then in step S<b>5002</b>, it is determined whether the transfer flag corresponding to the license ID of the license file is ON. When the license flag is ON (YES in step S<b>5002</b>), the processing proceeds to step S<b>5003</b> and the transfer flag is cleared. By way of comparison, the license flag being ON at step S<b>503</b> in the process of <figref idref="DRAWINGS">FIG. 5</figref> resulted in an installation error at step S<b>505</b> with installation not being executed. When the license flag is OFF (NO in step S<b>5002</b>), the processing returns to step S<b>504</b> in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0060" num="0059">In step S<b>5001</b>, if it is determined that the license file does not include the license invalidated by the external apparatus (NO in step S<b>5001</b>), the processing returns to step S<b>503</b> in <figref idref="DRAWINGS">FIG. 5</figref>. The processing illustrated in <figref idref="DRAWINGS">FIG. 8</figref> is executed in the following case. More specifically, the license file is once transferred from the MFP <b>102</b> to another external MFP or the like and validated by the external MFP. Then, the license is invalidated again in the external apparatus MFP. When the license is attempted to re-install in the MFP <b>102</b>, the processing in <figref idref="DRAWINGS">FIG. 8</figref> is executed.</p>
<p id="p-0061" num="0060">According to the present exemplary embodiment, even when a license is output to an external apparatus on one occasion and used, the license can be installed again. It is assumed that a use amount for the license can be defined and a right of use for printing 100 pages is transferred to the external MFP. Then, when the right of use for 30 pages remains in the external apparatus MFP, the license file can be acquired by invalidating the 30 pages. At this time, when the external MFP recognizes that the license file is invalidated its license in the MFP <b>102</b> and transferred based on data stored in the license file, the external MFP records data indicating that invalidation has been executed in the external MFP in the license file. Using this data in step S<b>5001</b>, it is determined whether the right of use remaining in the external MFP, which is an apparatus other than the MFP, is a license file that is invalidated and generated.</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a method for recovering firmware, an application, and a license when the HDD is exchanged. An MFP <b>601</b> is equivalent to the MFP <b>102</b>. A contents distribution server <b>602</b> is equivalent to the contents distribution server <b>101</b>.</p>
<p id="p-0063" num="0062">Firstly, in procedure <b>603</b>, firmware version information, an application, and license information are transmitted in advance from the MFP <b>601</b> to the contents distribution server <b>602</b>.</p>
<p id="p-0064" num="0063">When the HDD is exchanged in procedure <b>604</b>, for example, after the HDD crash has occurred, a request for firmware, an application, and a license is made in procedure <b>605</b>. In procedure <b>606</b>, a search for registered information about the MFP <b>601</b> is conducted of information registered in the contents distribution server <b>602</b>, and the firmware version, application, and license are identified. In procedure <b>607</b>, the firmware, application, and license are transmitted to the MFP <b>601</b>.</p>
<p id="p-0065" num="0064">Application license <b>701</b> in <figref idref="DRAWINGS">FIG. 7</figref> is an application and a license to be installed. Determination processing <b>702</b> determines whether installation can be executed in the MFP <b>102</b>. The MFP <b>102</b> executes installation processing <b>706</b>.</p>
<p id="p-0066" num="0065">When the application license <b>701</b> is installed in the MFP <b>102</b>, a decoding processing unit <b>703</b> executes decoding thereof. Then, an ignored license ID check unit <b>704</b> executes an ignored license ID check. The ignored license ID is registered in an ignored license ID storage unit <b>713</b> when an indefinite-period license is installed. A license ID duplication check is not performed in relation to license file IDs, which are registered in the ignored license ID storage unit <b>713</b>. The license file ID is information for discriminating a license file storing a license key. When an indefinite-period license is transferred from the MFP <b>102</b> to an external PC, the ignored license ID registered in the ignored license ID storage unit <b>713</b> is deleted.</p>
<p id="p-0067" num="0066">When the ignored license check unit <b>704</b> determines that the ignored license ID is present in the ignored license ID storage unit <b>713</b>, a check of an installation history of the relevant license ID is skipped and the processing proceeds to installation processing by an installation processing unit <b>707</b>. When the ignored license check unit <b>704</b> determines that the ignored license ID is not present in the ignored license ID storage unit <b>713</b>, a license ID duplication check unit <b>705</b> executes a license ID duplication check. When it is determined that duplication of the license ID is present, an error is displayed in procedure <b>711</b>. When the license ID duplication check unit <b>705</b> determines that there is no duplication of the license ID, the processing proceeds to the installation processing by the installation processing unit <b>707</b>. The installation processing unit <b>707</b> writes an install log into an install log storage unit <b>714</b>.</p>
<p id="p-0068" num="0067">Then, the processing proceeds to a license ID registration unit <b>708</b>. Then, an indefinite-period license check unit <b>709</b> executes an indefinite-period license check. When the license is the indefinite-period license, the ignored license ID is registered in the ignored license ID storage unit <b>713</b>. Then, an ignored license ID registration unit <b>710</b> executes registration of the ignored license ID registration and thereby completes the installation in procedure <b>712</b>. When the indefinite-period license check unit <b>709</b> determines that the license is not the indefinite-period license, the installation is completed at that point in procedure <b>712</b>.</p>
<p id="p-0069" num="0068">As described above, the MFP <b>102</b> has been described as an example of an information processing apparatus operating by an application whose license is managed based on a license file that is an example of license data.</p>
<p id="p-0070" num="0069">The application license management unit <b>214</b> is an example of a recording unit that records under control of the CPU. A transfer flag is an example of transfer information indicating that license data has been transferred from the MFP <b>102</b> to the contents distribution server <b>101</b> or the information processing apparatus <b>103</b>. When the transfer flag indicates that the license data has been transferred from the MFP <b>102</b> to the contents distribution server <b>101</b> or the information processing apparatus <b>103</b>, that is to say, when the transfer flag is ON, the following processing is executed. More specifically, an error is transmitted to a license installation source and the installation of the license is stopped. In this manner, use of the license data corresponding to the transfer flag can be prohibited in the MFP <b>102</b>.</p>
<p id="p-0071" num="0070">According to the transfer of the license from the MFP <b>102</b> to the contents distribution server <b>101</b> or the information processing apparatus <b>103</b>, transfer information indicating that the license has been transferred from the MFP <b>102</b> to another apparatus may be stored in the application license management unit <b>214</b>.</p>
<p id="p-0072" num="0071">The application license management unit <b>214</b> determines whether the expiry date of the license file has an indefinite period. The application license management unit <b>214</b> may include a prohibition unit to execute prohibition processing or deterrence processing when it is determined that the expiry date of the license data has the indefinite period.</p>
<p id="p-0073" num="0072">When the license is invalidated in another information processing apparatus and license data is generated, the application license management unit <b>214</b> may include a changing unit to change a state of the recorded transfer flag to indicate that license data has not been transferred to another information processing apparatus. More specifically, the transfer flag may be cleared. The present exemplary embodiment can be implemented by designing the values 0 and 1 of the transfer flag to be reversed. In addition, the present exemplary embodiment can be implemented when an equivalent design is performed using another technical concept.</p>
<p id="p-0074" num="0073">The software blocks and the control program that realize the processing according to the present exemplary embodiment may be distributed and stored in a computer-readable medium such as a digital versatile disk (DVD), a compact disk ROM (CD-ROM), and other medium capable of storing data in a machine-readable format that can be accessed by an automated sensing device. Further, the control program may be transmitted using a network and may cause an information processing apparatus to perform a method to control the information processing apparatus in which an application managed by a license based on license data operates.</p>
<p id="p-0075" num="0074">While the present invention has been described with reference to exemplary embodiments, it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all modifications, equivalent structures, and functions.</p>
<p id="p-0076" num="0075">This application claims priority from Japanese Patent Application No. 2009-153317 filed Jun. 29, 2009, which is hereby incorporated by reference herein in its entirety.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An information processing apparatus in which an application managed by a license based on license data is configured to operate, the information processing apparatus comprising:
<claim-text>a recording unit configured to record transfer information indicating that the license data is transferred from the information processing apparatus to a second information processing apparatus; and</claim-text>
<claim-text>a prohibition unit configured to prohibit, in response to the transfer information indicating that the license data has been transferred from the information processing apparatus to the second information processing apparatus, use in the information processing apparatus of the license data corresponding to the transfer information,</claim-text>
<claim-text>wherein, in response to the transfer information indicating that the license data has not been transferred from the information processing apparatus, the license data is used in the information processing apparatus, and</claim-text>
<claim-text>wherein the recording unit and the prohibition unit are implemented by a central processing unit in the information processing apparatus.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The information processing apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the recording unit is configured to record transfer information indicating that the license is transferred from the information processing apparatus to the second information processing apparatus in response to the transfer of the license from the information processing apparatus to the second information processing apparatus.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The information processing apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a determination unit configured to determine whether an expiry date of the license data has an indefinite period,
<claim-text>wherein the prohibition unit is configured to execute prohibition processing in response to the determination unit determining that the expiry date of the license data has the indefinite period.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The information processing apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a changing unit configured to change the transfer information recorded by the recording unit to a state that does not indicate that the license data is transferred from the information processing apparatus to the second information processing apparatus, in response to generating the license data by invalidating the license in the second information processing apparatus.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method for controlling an information processing apparatus in which an application managed by a license based on license data is configured to operate, the method comprising:
<claim-text>recording transfer information indicating that the license data is transferred from the information processing apparatus to a second information processing apparatus; and</claim-text>
<claim-text>prohibiting, in response to the transfer information indicating that the license data has been transferred from the information processing apparatus to the second information processing apparatus, use in the information processing apparatus of the license data corresponding to the transfer information,</claim-text>
<claim-text>wherein, in response to the transfer information indicating that the license data has not been transferred from the information processing apparatus, the license data is used in the information processing apparatus.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein recording includes recording transfer information indicating that the license is transferred from the information processing apparatus to the second information processing apparatus in response to the transfer of the license from the information processing apparatus to the second information processing apparatus.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, further comprising determining whether an expiry date of the license data has an indefinite period
<claim-text>wherein prohibiting includes executing prohibition processing in response to determining that the expiry date of the license data has the indefinite period.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, further comprising changing the recorded transfer information to a state that does not indicate that the license data is transferred from the information processing apparatus to the second information processing apparatus, in response to generating the license data by invalidating the license in the second information processing apparatus.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A non-transitory computer-readable medium storing a control program causing an information processing apparatus to perform the method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>. </claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353058-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353058</doc-number>
<kind>B1</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>12410166</doc-number>
<date>20090324</date>
</document-id>
</application-reference>
<us-application-series-code>12</us-application-series-code>
<us-term-of-grant>
<us-term-extension>738</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>08</class>
<subclass>B</subclass>
<main-group>29</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>08</class>
<subclass>B</subclass>
<main-group>23</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>12</main-group>
<subgroup>14</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>173</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 34</main-classification>
<further-classification>726 22</further-classification>
<further-classification>713192</further-classification>
<further-classification>713193</further-classification>
<further-classification>713194</further-classification>
<further-classification>380  2</further-classification>
<further-classification>704224</further-classification>
</classification-national>
<invention-title id="d2e53">Methods and systems for detecting rootkits</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5922075</doc-number>
<kind>A</kind>
<name>Bowker</name>
<date>19990700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6357003</doc-number>
<kind>B1</kind>
<name>Zarrin et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713  2</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2005/0114660</doc-number>
<kind>A1</kind>
<name>Lee et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713166</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2005/0251864</doc-number>
<kind>A1</kind>
<name>Kelley et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2007/0005957</doc-number>
<kind>A1</kind>
<name>Sahita et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713156</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2007/0176756</doc-number>
<kind>A1</kind>
<name>Friedrich</name>
<date>20070800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>340 1051</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2008/0235791</doc-number>
<kind>A1</kind>
<name>Ivanov et al.</name>
<date>20080900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 21</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2009/0192780</doc-number>
<kind>A1</kind>
<name>Carbone et al.</name>
<date>20090700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>703 23</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2009/0204811</doc-number>
<kind>A1</kind>
<name>Fries et al.</name>
<date>20090800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713160</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00010">
<othercit>Eagle, Chris et al.; &#x201c;Next Generation Collaborative Reversing with Ida Pro and CollabREate&#x201d;; (accessed on May 14, 2009).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>http://www.blackhat.com/presentations/bh-usa-08/Eagle<sub>&#x2014;</sub>Vidas/BH<sub>&#x2014;</sub>US<sub>&#x2014;</sub>08<sub>&#x2014;</sub>Eagle<sub>&#x2014;</sub>Vidas<sub>&#x2014;</sub>Collabreate<sub>&#x2014;</sub>pres.pdf.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Embleton, Shawn et al.; &#x201c;SMM Rootkits:White Paper&#x201d;; Aug. 2008; Clear Hat Consulting, Inc.; www.clearhatconsulting.com.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Suiche, Matthew; &#x201c;SMM Rootkit limitations. (and how to defeat it :-))&#x201d;; (accessed May 15, 2009); Matthew Suiches blog!.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>http://www.msuiche.net/2008/08/06/smm-rootkit-limitations-and-how-to-defeat-it/.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Collins, Robert R.; &#x201c;Intel's System Management Mode&#x201d;; (accessed May 19, 2009); http://www.rcollins.org/ddj/Jan97/Jan97.html.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 22</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>726 34</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713192-194</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380  2</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709224</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>McCorkendale</last-name>
<first-name>Bruce</first-name>
<address>
<city>Manhattan Beach</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Satish</last-name>
<first-name>Sourabh</first-name>
<address>
<city>Fremont</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Sobel</last-name>
<first-name>William E.</first-name>
<address>
<city>Jamul</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Advantedge Law Group</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Symantec Corporation</orgname>
<role>02</role>
<address>
<city>Mountain View</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Moorthy</last-name>
<first-name>Aravind</first-name>
<department>2492</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A computer-implemented method for detecting rootkits is disclosed. The computer-implemented method may include sending periodic security communications from a privileged-processor-mode region of a computing device. The computer-implemented method may also include identifying at least one of the periodic security communications. The computer-implemented method may further include determining, based on the periodic security communications, whether the privileged-processor-mode region of the computing device has been compromised. Various other methods, systems, and computer-readable media are also disclosed.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="124.46mm" wi="174.41mm" file="US08353058-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="217.17mm" wi="173.31mm" file="US08353058-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="158.75mm" wi="132.67mm" file="US08353058-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="231.65mm" wi="140.38mm" file="US08353058-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="244.18mm" wi="156.46mm" file="US08353058-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="230.63mm" wi="180.26mm" orientation="landscape" file="US08353058-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="219.46mm" wi="181.86mm" orientation="landscape" file="US08353058-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">Rootkits are programs that use system hooking or modification to hide files, processes, registry keys, and other objects in order to hide malicious behaviors. Malicious programmers seek to develop rootkits that are difficult to detect and remove. One particularly difficult rootkit to detect is a rootkit hidden in a System Management Mode (&#x201c;SMM&#x201d;) region of a computing device. Such rootkits are referred to as SMM rootkits.</p>
<p id="p-0003" num="0002">An SMM rootkit may access SMM memory space, which may be referred to as System Management Random Access Memory (&#x201c;SMRAM&#x201d;), to install a malicious System Management Interrupt (&#x201c;SMI&#x201d;) handler. The SMM rootkit may make SMRAM visible for reading and writing and may then write the SMI handler to the SMRAM. An SMI handler may operate as a chipset-level keylogger and a network backdoor. As such, an SMI handler may be able to steal sensitive information from an infected computer. SMM rootkits may also be programmed to perform various other malicious behaviors.</p>
<p id="p-0004" num="0003">After installing the SMM handler, the rootkit may lock the SMRAM, which may make the SMRAM invisible from non-SMM processor modes. Thus, the malicious SMI handler may be difficult to detect and remove. What is needed, therefore, is an effective mechanism for defending against and detecting SMM rootkits.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0005" num="0004">Embodiments of the instant disclosure provide methods and systems for sending a heartbeat from a privileged-processor-mode region of a computing device to enable detection of corruption of the privileged-processor-mode region. For example, a communication module may send periodic security communications from a privileged-processor-mode region of a computing device. A security module may identify at least one of the periodic security communications and may determine, based on the periodic security communications, whether the privileged-processor-mode region of the computing device has been compromised.</p>
<p id="p-0006" num="0005">In some embodiments, the security module may identify a first security communication and determine whether the privileged-processor-mode region of the computing device has been compromised by determining that a second security communication was not received at an expected time. In other embodiments, the security module may determine whether the privileged-processor-mode region of the computing device has been compromised by determining that a security communication from the communication module does not include an expected security code.</p>
<p id="p-0007" num="0006">In certain embodiments, the security module may be located on the same computing system that includes the communication module sending communications from the privileged-processor-mode region. In other embodiments, the security module may be located on a remote computing device. The communication module may send a periodic communication by storing a security communication in a first storage location on a computing device. In other embodiments, the communication module may send the security communication to a remote computing device through a network interface. In such embodiments, the periodic security communications may include Universal-Datagram-Protocol (&#x201c;UDP&#x201d;) packets.</p>
<p id="p-0008" num="0007">In various embodiments, the security module, the communication module, or other security code may lock the privileged-processor-mode region of the computing device such that the privileged-processor-mode region is read-only. For example, security code may set a D_LCK bit in a system-management-control register of a computing device.</p>
<p id="p-0009" num="0008">In various embodiments, the computing device may include an x86 processor, and the privileged-processor-mode region of the computing device may include System Management Random Access Memory (&#x201c;SMRAM&#x201d;) space. Similarly, the security code may include a System Management Interrupt (&#x201c;SMI&#x201d;) handler. If the security module detects that the privileged-processor-mode region of the computing device has been compromised, the security module may perform a security action (e.g., notifying a user or a security software vendor of a potential risk).</p>
<p id="p-0010" num="0009">Features from any of the above-mentioned embodiments may be used in combination with one another in accordance with the general principles described herein. These and other embodiments, features, and advantages will be more fully understood upon reading the following detailed description in conjunction with the accompanying drawings and claims.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0011" num="0010">The accompanying drawings illustrate a number of exemplary embodiments and are a part of the specification. Together with the following description, these drawings demonstrate and explain various principles of the instant disclosure.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an exemplary system for detecting rootkits according to certain embodiments.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 2</figref> is another block diagram of another exemplary system for detecting rootkits according to certain embodiments.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 3</figref> is another block diagram of another exemplary system for detecting rootkits according to certain embodiments.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 4</figref> is a flow diagram of an exemplary method for detecting rootkits according to certain embodiments.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of an exemplary computing system capable of implementing one or more of the embodiments described and/or illustrated herein.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram of an exemplary computing network capable of implementing one or more of the embodiments described and/or illustrated herein.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0018" num="0017">Throughout the drawings, identical reference characters and descriptions indicate similar, but not necessarily identical, elements. While the exemplary embodiments described herein are susceptible to various modifications and alternative forms, specific embodiments have been shown by way of example in the drawings and will be described in detail herein. However, the exemplary embodiments described herein are not intended to be limited to the particular forms disclosed. Rather, the instant disclosure covers all modifications, equivalents, and alternatives falling within the scope of the appended claims.</p>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF EXEMPLARY EMBODIMENTS</heading>
<p id="p-0019" num="0018">Embodiments of the instant disclosure provide various methods and systems for detecting rootkits. In some embodiments, security software may be provided for sending periodic security communications from a privileged-processor-mode region of a computing device. The periodic security communications may be used to determine whether the privileged-processor-mode region of the computing device has been compromised by a rootkit. <figref idref="DRAWINGS">FIGS. 1-3</figref> show exemplary systems for detecting rootkits, and <figref idref="DRAWINGS">FIG. 4</figref> shows an exemplary method for accomplishing the same. <figref idref="DRAWINGS">FIGS. 5 and 6</figref> illustrate an exemplary network and computing system for implementing embodiments of the instant disclosure.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an exemplary rootkit-detection system <b>100</b>. System <b>100</b> may include a privileged-processor-mode region <b>110</b>, a security module <b>120</b>, a processor <b>130</b>, and a network interface <b>140</b>. Privileged-processor-mode region <b>110</b> may include any memory space or other data storage associated with a privileged-processor-mode of a computing device. Privileged-processor-mode region <b>110</b> may be isolated from other memory and may be locked against write access from other processor modes. Privileged-processor-mode region <b>110</b> may also be hidden from other processor modes.</p>
<p id="p-0021" num="0020">A privileged-processor-mode may include an operating mode used for advanced power-management features, system events (e.g., memory or chipset errors), system safety functions (e.g., shutdown on high CPU temperature), emulation of motherboard hardware that is unimplemented or buggy, emulation of a PS-2 mouse or keyboard from a USB mouse or keyboard, system configuration, and/or to emulate or forward calls to a Trusted Platform Module (&#x201c;TPM&#x201d;). In some embodiments, a privileged-processor-mode may provide operating-system-independent functions. An example of a privileged-processor mode is INTEL's System Management Mode (&#x201c;SMM&#x201d;). In SMM, privileged-processor-mode region <b>110</b> may be referred to as System Management Random Access Memory (&#x201c;SMRAM&#x201d;).</p>
<p id="p-0022" num="0021">Code and data stored in privileged-processor-mode region <b>110</b> may be referred to as a privileged-processor-mode handler or a privileged-processor-mode interrupt handler. A processor may enter a privileged-processor mode in response to an interrupt. The interrupt may cause control to be transferred to a privileged-processor-mode interrupt handler. An example of a privileged-processor-mode interrupt handler is a System Management Interrupt (&#x201c;SMI&#x201d;) handler.</p>
<p id="p-0023" num="0022">Privileged-processor-mode region <b>110</b> may include a communication module <b>112</b>, which may be programmed to send periodic security communications, which are also referred to herein as heartbeats. In some embodiments, communication module <b>112</b> may be incorporated into other software programs that run in privileged-processor-mode region <b>110</b>. For example, communication module <b>112</b> may be included in legitimate privileged-processor-mode code, which may include debugging code, power management code, and/or any other suitable privileged-processor-mode program. In other embodiments, communication module <b>112</b> may be installed in privileged-processor-mode region <b>110</b> as a standalone module. For example, communication module <b>112</b> may be a privileged-processor-mode interrupt handler.</p>
<p id="p-0024" num="0023">Privileged-processor-mode region <b>110</b> may include a system-management-control register <b>114</b>. System-management-control register <b>114</b> may provide various control values for privileged-processor-mode region <b>110</b>. In particular, system-management-control register <b>114</b> may include a bit (or any data) that indicates whether privileged-processor-mode region <b>110</b> is locked against write access from other processor modes. System-management-control register <b>114</b> may also include a bit (or any data) that indicates whether privileged-processor-mode region <b>110</b> is hidden from other processor modes. In SMM, SMRAM may be locked by setting a D_LCK bit in a SMRAM control register. SMRAM may be hidden from view by clearing a D_OPEN bit in the SMRAM control register.</p>
<p id="p-0025" num="0024">As previously mentioned, system <b>100</b> may also include a security module <b>120</b>. Security module <b>120</b> may be programmed to identify periodic security communications from communication module <b>112</b>. Security module <b>120</b> may also be programmed to determine, based on the periodic security communications, whether privileged-processor-mode region <b>110</b> has been compromised. For example, security module <b>120</b> may be programmed to determine whether privileged-processor-mode region <b>110</b> has been compromised by determining that a security communication was not received at an expected time. Additionally or alternatively, security module <b>120</b> may determine whether privileged-processor-mode region <b>110</b> has been compromised by determining that a security communication does not include an expected security code.</p>
<p id="p-0026" num="0025">System <b>100</b> may also include a processor <b>130</b>. Processor <b>130</b> may include any suitable microprocessor or Central Processing Unit (&#x201c;CPU&#x201d;). In some embodiments, processor <b>130</b> may include a processor with an x86 instruction-set architecture. In addition to processor <b>130</b>, system <b>100</b> may include network interface <b>140</b>, which may include any network hardware and/or software configured to allow system <b>100</b> to communicate over a network. In some embodiments, communication module <b>112</b> may directly access network interface <b>140</b> to send periodic security communications to a remote computing device.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a computing device <b>200</b> that provides an exemplary configuration of components of system <b>100</b>. <figref idref="DRAWINGS">FIG. 2</figref> shows security module <b>120</b> on the same computing device as privileged-processor-mode region <b>110</b> and communication module <b>112</b>. Computing device <b>200</b> generally represents any type or form of computing device capable of reading computer-executable instructions. Examples of computing device <b>200</b> include, without limitation, laptops, desktops, servers, cellular phones, personal digital assistants (&#x201c;PDAs&#x201d;), multimedia players, embedded systems, combinations of one or more of the same, exemplary computing system <b>510</b> in <figref idref="DRAWINGS">FIG. 5</figref>, or any other suitable computing device.</p>
<p id="p-0028" num="0027">Computing device <b>200</b> may include processor <b>130</b>, network interface <b>140</b>, a chipset <b>210</b>, memory <b>220</b>, and a storage device <b>230</b>. Chipset <b>210</b> may include one or more circuits and/or chips that link processor <b>130</b> to memory <b>220</b> and network interface <b>140</b>. For example, chipset <b>210</b> may include a northbridge that links processor <b>130</b> to memory <b>220</b> and a southbridge that links processor <b>130</b> to network interface <b>140</b>. Memory <b>220</b> may include any suitable computer storage. For example, memory <b>220</b> may include random access memory (&#x201c;RAM&#x201d;), such as SMRAM.</p>
<p id="p-0029" num="0028">As noted, computing device <b>200</b> may also include a storage device <b>230</b>, which may store security module <b>120</b>. In the configuration shown in <figref idref="DRAWINGS">FIG. 2</figref>, communication module <b>112</b> may send periodic security communications to security module <b>120</b> by storing messages in storage device <b>230</b> and/or any other storage device of computing device <b>200</b>. Communication module <b>112</b> may also send periodic security communications to security module <b>120</b> using any other suitable communication mechanism.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a system <b>300</b> that provides an exemplary configuration of components of system <b>100</b> with communication module <b>112</b> and security module <b>120</b> on different computing devices. For example, a computing device <b>310</b> may include privileged-processor-mode region <b>110</b>, communication module <b>112</b>, processor <b>130</b>, and network interface <b>140</b>. A computing device <b>320</b> may include security module <b>120</b>, and communication module <b>112</b> may send periodic security communications to security module <b>120</b> over network <b>330</b>.</p>
<p id="p-0031" num="0030">Computing devices <b>310</b> and/or <b>320</b> generally represent any type or form of computing devices capable of reading computer-executable instructions. Examples of computing devices <b>310</b> and/or <b>320</b> include, without limitation, laptops, desktops, servers, cellular phones, personal digital assistants (&#x201c;PDAs&#x201d;), multimedia players, embedded systems, combinations of one or more of the same, exemplary computing system <b>510</b> in <figref idref="DRAWINGS">FIG. 5</figref>, or any other suitable computing device.</p>
<p id="p-0032" num="0031">Computing device <b>310</b> may communicate with computing device <b>320</b> over a network <b>330</b>. Network <b>330</b> generally represents any medium or architecture capable of facilitating communication or data transfer. Network <b>330</b> may include, without limitation, an intranet, a Wide Area Network (&#x201c;WAN&#x201d;), a Local Area Network (&#x201c;LAN&#x201d;), a Personal Area Network (&#x201c;PAN&#x201d;), the Internet, Power Line Communications (&#x201c;PLC&#x201d;), a cellular network (e.g., a GSM network), or the like. Network <b>330</b> may facilitate communication or data transfer using wireless and/or wired communications.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 4</figref> illustrates an exemplary method for detecting rootkits. The steps in <figref idref="DRAWINGS">FIG. 4</figref> may be performed by one or more components of systems <b>100</b>, <b>200</b>, and/or <b>300</b>. For example, at step <b>410</b> communication module <b>112</b> may send periodic security communications from a privileged-processor-mode region of a computing device. A periodic security communication may be sent in regular intervals (e.g., seconds, hours, days, etc.). In other embodiments, periodic security communications may be sent at irregular intervals.</p>
<p id="p-0034" num="0033">Periodic security communications may include any security communication that indicates communication module <b>112</b> has not been compromised. For example, a periodic security communication may include a heartbeat (e.g., a notification) that indicates communication module <b>112</b> is functioning and has not been overwritten. In some embodiments, one or more periodic security communications may include one or more security codes. A security code may include any data that indicates a security communication is sent from communication module <b>112</b> and has not been spoofed by malicious code.</p>
<p id="p-0035" num="0034">At step <b>420</b>, security module <b>120</b> may identify at least one of the periodic security communications. In some embodiments, security module <b>120</b> may continually identify the periodic security communications as they are sent from communication module <b>112</b>. Security module <b>120</b> may identify periodic security communications by checking a storage location where communication module <b>112</b> stores the security communications. In other embodiments, security module <b>120</b> may identify periodic security communications when security module <b>120</b> receives the security communications from communication module <b>112</b>. In such embodiments, the periodic security communications may include any suitable network communications, such as UDP packets.</p>
<p id="p-0036" num="0035">At step <b>430</b>, security module <b>120</b> may determine whether privileged-processor-mode region <b>110</b> has been compromised based on the periodic security communications. A privileged-processor-mode region may be compromised when malicious code is installed in the privileged-processor mode region. In some embodiments, security module <b>120</b> may determine that privileged-processor-mode region <b>110</b> has been compromised if security module <b>120</b> determines that communication module <b>112</b> had stopped sending security communications. For example, security module <b>120</b> may determine that privileged-processor-mode region <b>110</b> has been compromised when a security communication is not received at an expected time. Communication module <b>112</b> would no longer send communications if it has been overwritten by malicious code. Thus, the failure of communication module <b>112</b> to send communications may indicate that privileged-processor-mode region <b>110</b> has been infected.</p>
<p id="p-0037" num="0036">In some embodiments, security module <b>120</b> may determine that privileged-processor-mode region <b>110</b> has been compromised when a predetermined number of security codes are not received. For example, if security module <b>120</b> determines that communication module <b>112</b> has not sent the last five expected security codes, security module <b>120</b> may determine that privileged-processor-mode region <b>110</b> has been compromised (e.g., possibly infected with malware).</p>
<p id="p-0038" num="0037">Additionally or alternatively, security module <b>120</b> may determine that privileged-processor-mode region <b>110</b> has been compromised if security module <b>120</b> does not identify a security communication for a predefined amount of time. For example, if security module <b>120</b> waits more than 10 minutes and has not received a security communication from communication module <b>112</b>, security module <b>120</b> may determine that privileged-processor-mode region <b>110</b> has been compromised.</p>
<p id="p-0039" num="0038">According to various embodiments, security module <b>120</b> may check the contents of one or more security communications to determine whether the security communications were sent from communication module <b>112</b>. For example, communication module <b>112</b> may include a security code in one or more security communications to protect against malicious code that might attempt to spoof a security communication.</p>
<p id="p-0040" num="0039">A security communication may include an encrypted message (e.g. a security code) that shows that the security communication is from communication module <b>112</b>. For example, communication module <b>112</b> may communicate with a Trusted Platform Module (&#x201c;TMP&#x201d;) to obtain one or more security keys to use for encryption. Since malicious code would not be able to communicate with the TPM, malicious code would not be able to spoof encrypted communications expected by security module <b>120</b>. Any suitable encryption techniques and/or technology may be implemented to provide encrypted security communications. In some embodiments, communication module <b>112</b> may send encrypted information in every security communication. In other embodiments, communication module <b>112</b> may only send encrypted information in some security communications. For example, every Nth security communication may include encrypted information.</p>
<p id="p-0041" num="0040">In various embodiments, communication module <b>112</b>, security module <b>120</b>, and/or any other security code may lock privileged-processor-mode region <b>110</b> after communication module <b>112</b> is installed in privileged-processor-mode region <b>110</b>. For example, security module <b>120</b> may set a lock bit (e.g., a D_LCK bit) in system-management-control register <b>114</b>. Locking privileged-processor-mode region <b>110</b> may protect privileged-processor-mode region <b>110</b> against rootkits being installed in privileged-processor-mode region <b>110</b>. However, malicious programmers may develop rootkits that are able to unlock and/or subvert the locking technology of privileged-processor-mode region <b>110</b>. In such situations, the security technologies discussed herein may detect that a rootkit has compromised privileged-processor-mode region <b>110</b>.</p>
<p id="p-0042" num="0041">After determining that privileged-processor-mode region <b>110</b> has been compromised, security module <b>120</b> may perform a security action. For example, security module <b>120</b> may send a security notification if privileged-processor-mode region <b>110</b> has been compromised. In some embodiments, privileged-processor-mode region <b>110</b> may send the security notification to a user and/or a security software vendor. In addition to and/or instead of providing a security notification, security module <b>120</b> may perform a remediation action. For example, security module <b>120</b> may attempt to remove any malicious code installed in the privileged-processor-mode region and/or may provide instructions for removing the malicious code.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of an exemplary computing system <b>510</b> capable of implementing one or more of the embodiments described and/or illustrated herein. Computing system <b>510</b> broadly represents any single or multi-processor computing device or system capable of executing computer-readable instructions. Examples of computing system <b>510</b> include, without limitation, workstations, laptops, client-side terminals, servers, distributed computing systems, handheld devices, or any other computing system or device. In its most basic configuration, computing system <b>510</b> may comprise at least one processor <b>514</b> and a system memory <b>516</b>.</p>
<p id="p-0044" num="0043">Processor <b>514</b> generally represents any type or form of processing unit capable of processing data or interpreting and executing instructions. In certain embodiments, processor <b>514</b> may receive instructions from a software application or module. These instructions may cause processor <b>514</b> to perform the functions of one or more of the exemplary embodiments described and/or illustrated herein. For example, processor <b>514</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the sending, identifying, determining, storing, reading, accessing, locking, setting, installing, including, and performing steps described herein. Processor <b>514</b> may also perform and/or be a means for performing any other steps, methods, or processes described and/or illustrated herein.</p>
<p id="p-0045" num="0044">System memory <b>516</b> generally represents any type or form of volatile or non-volatile storage device or medium capable of storing data and/or other computer-readable instructions. Examples of system memory <b>516</b> include, without limitation, random access memory (&#x201c;RAM&#x201d;), read only memory (&#x201c;ROM&#x201d;), flash memory, or any other suitable memory device. Although not required, in certain embodiments computing system <b>510</b> may comprise both a volatile memory unit (such as, for example, system memory <b>516</b>) and a non-volatile storage device (such as, for example, primary storage device <b>532</b>, as described in detail below).</p>
<p id="p-0046" num="0045">In certain embodiments, exemplary computing system <b>510</b> may also comprise one or more components or elements in addition to processor <b>514</b> and system memory <b>516</b>. For example, as illustrated in <figref idref="DRAWINGS">FIG. 5</figref>, computing system <b>510</b> may comprise a memory controller <b>518</b>, an Input/Output (&#x201c;I/O&#x201d;) controller <b>520</b>, and a communication interface <b>522</b>, each of which may be interconnected via a communication infrastructure <b>512</b>. Communication infrastructure <b>512</b> generally represents any type or form of infrastructure capable of facilitating communication between one or more components of a computing device. Examples of communication infrastructure <b>512</b> include, without limitation, a communication bus (such as an ISA, PCI, PCIe, or similar bus) and a network.</p>
<p id="p-0047" num="0046">Memory controller <b>518</b> generally represents any type or form of device capable of handling memory or data or controlling communication between one or more components of computing system <b>510</b>. For example, in certain embodiments memory controller <b>518</b> may control communication between processor <b>514</b>, system memory <b>516</b>, and I/O controller <b>520</b> via communication infrastructure <b>512</b>. In certain embodiments, memory controller may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the steps or features described and/or illustrated herein, such as sending, identifying, determining, storing, reading, accessing, locking, setting, installing, including, and performing.</p>
<p id="p-0048" num="0047">I/O controller <b>520</b> generally represents any type or form of module capable of coordinating and/or controlling the input and output functions of a computing device. For example, in certain embodiments I/O controller <b>520</b> may control or facilitate transfer of data between one or more elements of computing system <b>510</b>, such as processor <b>514</b>, system memory <b>516</b>, communication interface <b>522</b>, display adapter <b>526</b>, input interface <b>530</b>, and storage interface <b>534</b>. I/O controller <b>520</b> may be used, for example, to perform and/or be a means for performing, either alone or in combination with other elements, one or more of the sending, identifying, determining, storing, reading, accessing, locking, setting, installing, including, and performing steps described herein. I/O controller <b>520</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0049" num="0048">Communication interface <b>522</b> broadly represents any type or form of communication device or adapter capable of facilitating communication between exemplary computing system <b>510</b> and one or more additional devices. For example, in certain embodiments communication interface <b>522</b> may facilitate communication between computing system <b>510</b> and a private or public network comprising additional computing systems. Examples of communication interface <b>522</b> include, without limitation, a wired network interface (such as a network interface card), a wireless network interface (such as a wireless network interface card), a modem, and any other suitable interface. In at least one embodiment, communication interface <b>522</b> may provide a direct connection to a remote server via a direct link to a network, such as the Internet. Communication interface <b>522</b> may also indirectly provide such a connection through, for example, a local area network (such as an Ethernet network), a personal area network, a telephone or cable network, a cellular telephone connection, a satellite data connection, or any other suitable connection.</p>
<p id="p-0050" num="0049">In certain embodiments, communication interface <b>522</b> may also represent a host adapter configured to facilitate communication between computing system <b>510</b> and one or more additional network or storage devices via an external bus or communications channel. Examples of host adapters include, without limitation, SCSI host adapters, USB host adapters, IEEE 594 host adapters, SATA and eSATA host adapters, ATA and PATA host adapters, Fibre Channel interface adapters, Ethernet adapters, or the like. Communication interface <b>522</b> may also allow computing system <b>510</b> to engage in distributed or remote computing. For example, communication interface <b>522</b> may receive instructions from a remote device or send instructions to a remote device for execution. In certain embodiments, communication interface <b>522</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the sending, identifying, determining, storing, reading, accessing, locking, setting, installing, including, and performing steps disclosed herein. Communication interface <b>522</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0051" num="0050">As illustrated in <figref idref="DRAWINGS">FIG. 5</figref>, computing system <b>510</b> may also comprise at least one display device <b>524</b> coupled to communication infrastructure <b>512</b> via a display adapter <b>526</b>. Display device <b>524</b> generally represents any type or form of device capable of visually displaying information forwarded by display adapter <b>526</b>. Similarly, display adapter <b>526</b> generally represents any type or form of device configured to forward graphics, text, and other data from communication infrastructure <b>512</b> (or from a frame buffer, as known in the art) for display on display device <b>524</b>.</p>
<p id="p-0052" num="0051">As illustrated in <figref idref="DRAWINGS">FIG. 5</figref>, exemplary computing system <b>510</b> may also comprise at least one input device <b>528</b> coupled to communication infrastructure <b>512</b> via an input interface <b>530</b>. Input device <b>528</b> generally represents any type or form of input device capable of providing input, either computer or human generated, to exemplary computing system <b>510</b>. Examples of input device <b>528</b> include, without limitation, a keyboard, a pointing device, a speech recognition device, or any other input device. In at least one embodiment, input device <b>528</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the sending, identifying, determining, storing, reading, accessing, locking, setting, installing, including, and performing steps disclosed herein. Input device <b>528</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0053" num="0052">As illustrated in <figref idref="DRAWINGS">FIG. 5</figref>, exemplary computing system <b>510</b> may also comprise a primary storage device <b>532</b> and a backup storage device <b>533</b> coupled to communication infrastructure <b>512</b> via a storage interface <b>534</b>. Storage devices <b>532</b> and <b>533</b> generally represent any type or form of storage device or medium capable of storing data and/or other computer-readable instructions. For example, storage devices <b>532</b> and <b>533</b> may be a magnetic disk drive (e.g., a so-called hard drive), a floppy disk drive, a magnetic tape drive, an optical disk drive, a flash drive, or the like. Storage interface <b>534</b> generally represents any type or form of interface or device for transferring data between storage devices <b>532</b> and <b>533</b> and other components of computing system <b>510</b>.</p>
<p id="p-0054" num="0053">In certain embodiments, storage devices <b>532</b> and <b>533</b> may be configured to read from and/or write to a removable storage unit configured to store computer software, data, or other computer-readable information. Examples of suitable removable storage units include, without limitation, a floppy disk, a magnetic tape, an optical disk, a flash memory device, or the like. Storage devices <b>532</b> and <b>533</b> may also comprise other similar structures or devices for allowing computer software, data, or other computer-readable instructions to be loaded into computing system <b>510</b>. For example, storage devices <b>532</b> and <b>533</b> may be configured to read and write software, data, or other computer-readable information. Storage devices <b>532</b> and <b>533</b> may also be a part of computing system <b>510</b> or may be a separate device accessed through other interface systems.</p>
<p id="p-0055" num="0054">In certain embodiments, storage devices <b>532</b> and <b>533</b> may be used, for example, to perform and/or be a means for performing, either alone or in combination with other elements, one or more of the sending, identifying, determining, storing, reading, accessing, locking, setting, installing, including, and performing steps disclosed herein. Storage devices <b>532</b> and <b>533</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0056" num="0055">Many other devices or subsystems may be connected to computing system <b>510</b>. Conversely, all of the components and devices illustrated in <figref idref="DRAWINGS">FIG. 5</figref> need not be present to practice the embodiments described and/or illustrated herein. The devices and subsystems referenced above may also be interconnected in different ways from that shown in <figref idref="DRAWINGS">FIG. 5</figref>. Computing system <b>510</b> may also employ any number of software, firmware, and/or hardware configurations. For example, one or more of the exemplary embodiments disclosed herein may be encoded as a computer program (also referred to as computer software, software applications, computer-readable instructions, or computer control logic) on a computer-readable medium. The phrase &#x201c;computer-readable medium&#x201d; generally refers to any form of device, carrier, or medium capable of storing or carrying computer-readable instructions. Examples of computer-readable media include, without limitation, transmission-type media, such as carrier waves, and physical media, such as magnetic-storage media (e.g., hard disk drives and floppy disks), optical-storage media (e.g., CD- or DVD-ROMs), electronic-storage media (e.g., solid-state drives and flash media), and other distribution systems.</p>
<p id="p-0057" num="0056">The computer-readable medium containing the computer program may be loaded into computing system <b>510</b>. All or a portion of the computer program stored on the computer-readable medium may then be stored in system memory <b>516</b> and/or various portions of storage devices <b>532</b> and <b>533</b>. When executed by processor <b>514</b>, a computer program loaded into computing system <b>510</b> may cause processor <b>514</b> to perform and/or be a means for performing the functions of one or more of the exemplary embodiments described and/or illustrated herein. Additionally or alternatively, one or more of the exemplary embodiments described and/or illustrated herein may be implemented in firmware and/or hardware. For example, computing system <b>510</b> may be configured as an application specific integrated circuit (&#x201c;ASIC&#x201d;) adapted to implement one or more of the exemplary embodiments disclosed herein.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram of an exemplary network architecture <b>600</b> in which client systems <b>610</b>, <b>620</b>, and <b>630</b> and servers <b>640</b> and <b>645</b> may be coupled to a network <b>650</b>. Client systems <b>610</b>, <b>620</b>, and <b>630</b> generally represent any type or form of computing device or system, such as exemplary computing system <b>510</b> in <figref idref="DRAWINGS">FIG. 5</figref>. Similarly, servers <b>640</b> and <b>645</b> generally represent computing devices or systems, such as application servers or database servers, configured to provide various database services and/or run certain software applications. Network <b>650</b> generally represents any telecommunication or computer network including, for example, an intranet, a wide area network (&#x201c;WAN&#x201d;), a local area network (&#x201c;LAN&#x201d;), a personal area network (&#x201c;PAN&#x201d;), or the Internet.</p>
<p id="p-0059" num="0058">As illustrated in <figref idref="DRAWINGS">FIG. 6</figref>, one or more storage devices <b>660</b>(<b>1</b>)-(N) may be directly attached to server <b>640</b>. Similarly, one or more storage devices <b>670</b>(<b>1</b>)-(N) may be directly attached to server <b>645</b>. Storage devices <b>660</b>(<b>1</b>)-(N) and storage devices <b>670</b>(<b>1</b>)-(N) generally represent any type or form of storage device or medium capable of storing data and/or other computer-readable instructions. In certain embodiments, storage devices <b>660</b>(<b>1</b>)-(N) and storage devices <b>670</b>(<b>1</b>)-(N) may represent network-attached storage (&#x201c;NAS&#x201d;) devices configured to communicate with servers <b>640</b> and <b>645</b> using various protocols, such as NFS, SMB, or CIFS.</p>
<p id="p-0060" num="0059">Servers <b>640</b> and <b>645</b> may also be connected to a storage area network (&#x201c;SAN&#x201d;) fabric <b>680</b>. SAN fabric <b>680</b> generally represents any type or form of computer network or architecture capable of facilitating communication between a plurality of storage devices. SAN fabric <b>680</b> may facilitate communication between servers <b>640</b> and <b>645</b> and a plurality of storage devices <b>690</b>(<b>1</b>)-(N) and/or an intelligent storage array <b>695</b>. SAN fabric <b>680</b> may also facilitate, via network <b>650</b> and servers <b>640</b> and <b>645</b>, communication between client systems <b>610</b>, <b>620</b>, and <b>630</b> and storage devices <b>690</b>(<b>1</b>)-(N) and/or intelligent storage array <b>695</b> in such a manner that devices <b>690</b>(<b>1</b>)-(N) and array <b>695</b> appear as locally attached devices to client systems <b>610</b>, <b>620</b>, and <b>630</b>. As with storage devices <b>660</b>(<b>1</b>)-(N) and storage devices <b>670</b>(<b>1</b>)-(N), storage devices <b>690</b>(<b>1</b>)-(N) and intelligent storage array <b>695</b> generally represent any type or form of storage device or medium capable of storing data and/or other computer-readable instructions.</p>
<p id="p-0061" num="0060">In certain embodiments, and with reference to exemplary computing system <b>510</b> of <figref idref="DRAWINGS">FIG. 5</figref>, a communication interface, such as communication interface <b>522</b> in <figref idref="DRAWINGS">FIG. 5</figref>, may be used to provide connectivity between each client system <b>610</b>, <b>620</b>, and <b>630</b> and network <b>650</b>. Client systems <b>610</b>, <b>620</b>, and <b>630</b> may be able to access information on server <b>640</b> or <b>645</b> using, for example, a web browser or other client software. Such software may allow client systems <b>610</b>, <b>620</b>, and <b>630</b> to access data hosted by server <b>640</b>, server <b>645</b>, storage devices <b>660</b>(<b>1</b>)-(N), storage devices <b>670</b>(<b>1</b>)-(N), storage devices <b>690</b>(<b>1</b>)-(N), or intelligent storage array <b>695</b>. Although <figref idref="DRAWINGS">FIG. 6</figref> depicts the use of a network (such as the Internet) for exchanging data, the embodiments described and/or illustrated herein are not limited to the Internet or any particular network-based environment.</p>
<p id="p-0062" num="0061">In at least one embodiment, all or a portion of one or more of the exemplary embodiments disclosed herein may be encoded as a computer program and loaded onto and executed by server <b>640</b>, server <b>645</b>, storage devices <b>660</b>(<b>1</b>)-(N), storage devices <b>670</b>(<b>1</b>)-(N), storage devices <b>690</b>(<b>1</b>)-(N), intelligent storage array <b>695</b>, or any combination thereof. All or a portion of one or more of the exemplary embodiments disclosed herein may also be encoded as a computer program, stored in server <b>640</b>, run by server <b>645</b>, and distributed to client systems <b>610</b>, <b>620</b>, and <b>630</b> over network <b>650</b>. Accordingly, network architecture <b>600</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more of the sending, identifying, determining, storing, reading, accessing, locking, setting, installing, including, and performing steps disclosed herein. Network architecture <b>600</b> may also be used to perform and/or be a means for performing other steps and features set forth in the instant disclosure.</p>
<p id="p-0063" num="0062">As detailed above, computing system <b>510</b> and/or one or more components of network architecture <b>600</b> may perform and/or be a means for performing, either alone or in combination with other elements, one or more steps of the exemplary methods described and/or illustrated herein. For example, a computing system (e.g., computing system <b>510</b> and/or one or more of the components of network architecture <b>600</b>) may perform a computer-implemented method for detecting rootkits. In certain embodiments, the computing system may send periodic security communications from a privileged-processor-mode region of a computing device. The computing system may also identify at least one of the periodic security communications. The computing system may further determine, based on the periodic security communications, whether the privileged-processor-mode region of the computing device has been compromised.</p>
<p id="p-0064" num="0063">In some embodiments, the computing system may identify at least one of the periodic security communications by identifying a first security communication. The computing system may also determine whether the privileged-processor-mode region of the computing device has been compromised by determining that a second security communication was not received at an expected time. In other embodiments, the computing system may identify at least one of the periodic security communications by identifying a first security communication. The computing system may determine whether the privileged-processor-mode region of the computing device has been compromised by determining that a second security communication does not include an expected security code. In at least one embodiment, the expected security code may be an encrypted security code. In some embodiments, the computing system may comprise a security computing subsystem.</p>
<p id="p-0065" num="0064">In various embodiments, the computing system may send the periodic security communications by storing a security message in a first storage location on the computing device. The computing system may identify at least one of the periodic security communications by reading the security message from the first storage location. In some embodiments, the computing system may send the periodic security communications by accessing a network interface card, and by sending at least one security communication to a remote computing device. The remote computing device may comprise the security computing subsystem. In certain embodiments, the periodic security communications may comprise universal-datagram-protocol packets.</p>
<p id="p-0066" num="0065">In at least one embodiment, the computing system may lock the privileged-processor-mode region of the computing device such that the privileged-processor-mode region is read-only. In some embodiments, the computing system may lock the privileged-processor-mode region of the computing device by setting a D_LCK bit in a system-management-control register of the computing device. In some embodiments, the computing system may install security code in the privileged-processor-mode region of the computing device. The security code may be programmed to send the periodic security communications. In other embodiments, the security code may include a system-management-mode handler.</p>
<p id="p-0067" num="0066">In certain embodiments, the computing system may include security code in software programmed to execute from the privileged-processor-mode region of the computing device. The security code may be programmed to send the periodic security communications. In some embodiments, the computing device may include an x86 processor, and the privileged-processor-mode region of the computing device may include system-management-mode random-access-memory space. In at least one embodiment, the computing system may perform a security action after determining that the privileged-processor-mode region of the computing device is infected with a rootkit.</p>
<p id="p-0068" num="0067">In some embodiments, the computing system may include privileged-processor-mode memory space. The privileged-processor-mode memory space may comprise a communication module. The communication module may send periodic security communications. The computing system may also contain a security module. The security module may identify at least one of the periodic security communications. The security module may also determine, based on the periodic security communications, whether the privileged-processor-mode memory space has been compromised. In at least one embodiment, the computing system may contain an x86 processor. The privileged-processor-mode memory space may include system-management-mode random-access-memory space, and the communication module may include a system-management-mode handler.</p>
<p id="p-0069" num="0068">In various embodiments, the computing system may include a system-management-control register that may comprise a D_LCK bit. At least one of the communication module and the security module may set the D_LCK bit to lock the system-management-mode random-access-memory space. In some embodiments, the security module may identify a first security communication. The security module may determine whether the privileged-processor-mode memory space has been compromised by determining that a second communication was not received at an expected time, and/or by determining that the second communication does not include an expected security code.</p>
<p id="p-0070" num="0069">While the foregoing disclosure sets forth various embodiments using specific block diagrams, flowcharts, and examples, each block diagram component, flowchart step, operation, and/or component described and/or illustrated herein may be implemented, individually and/or collectively, using a wide range of hardware, software, or firmware (or any combination thereof) configurations. In addition, any disclosure of components contained within other components should be considered exemplary in nature since many other architectures can be implemented to achieve the same functionality.</p>
<p id="p-0071" num="0070">The process parameters and sequence of steps described and/or illustrated herein are given by way of example only and can be varied as desired. For example, while the steps illustrated and/or described herein may be shown or discussed in a particular order, these steps do not necessarily need to be performed in the order illustrated or discussed. The various exemplary methods described and/or illustrated herein may also omit one or more of the steps described or illustrated herein or include additional steps in addition to those disclosed.</p>
<p id="p-0072" num="0071">While various embodiments have been described and/or illustrated herein in the context of fully functional computing systems, one or more of these exemplary embodiments may be distributed as a program product in a variety of forms, regardless of the particular type of computer-readable media used to actually carry out the distribution. The embodiments disclosed herein may also be implemented using software modules that perform certain tasks. These software modules may include script, batch, or other executable files that may be stored on a computer-readable storage medium or in a computing system. In some embodiments, these software modules may configure a computing system to perform one or more of the exemplary embodiments disclosed herein.</p>
<p id="p-0073" num="0072">The preceding description has been provided to enable others skilled in the art to best utilize various aspects of the exemplary embodiments disclosed herein. This exemplary description is not intended to be exhaustive or to be limited to any precise form disclosed. Many modifications and variations are possible without departing from the spirit and scope of the instant disclosure. The embodiments disclosed herein should be considered in all respects illustrative and not restrictive. Reference should be made to the appended claims and their equivalents in determining the scope of the instant disclosure.</p>
<p id="p-0074" num="0073">Unless otherwise noted, the terms &#x201c;a&#x201d; or &#x201c;an,&#x201d; as used in the specification and claims, are to be construed as meaning &#x201c;at least one of.&#x201d; In addition, for ease of use, the words &#x201c;including&#x201d; and &#x201c;having,&#x201d; as used in the specification and claims, are interchangeable with and have the same meaning as the word &#x201c;comprising.&#x201d;</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer-implemented method comprising:
<claim-text>installing security code in a privileged-processor-mode region of a computing device;</claim-text>
<claim-text>sending, from the security code, periodic security communications from the privileged-processor-mode region of the computing device by:
<claim-text>accessing, via the security code, a network interface card, the accessing the network interface card being performed from within the privileged-processor-mode region of the computing device, and</claim-text>
<claim-text>sending, via the network interface card, at least one security communication from the privileged-processor-mode region to a remote computing device, the remote computing device comprising a security computing subsystem;</claim-text>
</claim-text>
<claim-text>identifying at least one of the periodic security communications;</claim-text>
<claim-text>determining, based on the periodic security communications, whether the privileged-processor-mode region of the computing device has been compromised, wherein the security computing subsystem performs the identifying and the determining.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>identifying at least one of the periodic security communications comprises identifying a first security communication;</claim-text>
<claim-text>determining whether the privileged-processor-mode region of the computing device has been compromised comprises determining that a second security communication was not received at an expected time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>identifying at least one of the periodic security communications comprises identifying a first security communication;</claim-text>
<claim-text>determining whether the privileged-processor-mode region of the computing device has been compromised comprises determining that a second security communication does not include an expected security code.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer-implemented method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the expected security code comprises an encrypted security code.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the computing device comprises the security computing subsystem and the security subsystem is not located in the privileged-processor-mode region of the computing device.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The computer-implemented method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein:
<claim-text>sending the periodic security communications comprises storing a security message in a first storage location on the computing device;</claim-text>
<claim-text>identifying at least one of the periodic security communications comprises reading the security message from the first storage location.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein
<claim-text>the security code directly accesses the network interface card.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the periodic security communications comprise universal-datagram-protocol packets.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>locking the privileged-processor-mode region of the computing device such that the privileged-processor-mode region is read-only.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The computer-implemented method of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein locking the privileged-processor-mode region of the computing device comprises setting a D_LCK bit in a system-management-control register of the computing device.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the security code comprises a system-management-mode interrupt handler to which control is transferred when an interrupt causes a processor of the computing device to enter a privileged-processor mode.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the privileged-processor-mode region of the computing device comprises memory and/or storage associated with a privileged-processor mode of a processor of the computing device.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein:
<claim-text>the computing device comprises an x86 processor;</claim-text>
<claim-text>the privileged-processor-mode region of the computing device comprises system-management-mode random-access-memory space.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer-implemented method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising performing a security action after determining that the privileged-processor-mode region of the computing device has been compromised.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A system comprising:
<claim-text>a network interface card;</claim-text>
<claim-text>an installation module programmed to install a communication module to privileged-processor-mode memory space, the communication module being programmed to send periodic security communications by:
<claim-text>accessing, via the communication module, the network interface card, the accessing the network interface card being performed from within the privileged-processor-mode memory space, and</claim-text>
</claim-text>
<claim-text>sending, via the network interface card, at least one security communication from the privileged-processor-mode memory space to a remote computing device, the remote computing device comprising a security subsystem;</claim-text>
<claim-text>a security module within the security subsystem, the security module being programmed to:
<claim-text>identify at least one of the periodic security communications;</claim-text>
<claim-text>determine, based on the periodic security communications, whether the privileged-processor-mode memory space has been compromised.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<claim-text>an x86 processor, wherein:
<claim-text>the privileged-processor-mode memory space comprises system-management-mode random-access-memory space;</claim-text>
<claim-text>the communication module comprises a system-management-mode handler.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The system of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the privileged-processor-mode memory space of a computing device comprises memory and/or storage associated with an advanced processor operating mode used for at least one of:
<claim-text>advanced power-management features;</claim-text>
<claim-text>system events;</claim-text>
<claim-text>system safety functions;</claim-text>
<claim-text>hardware emulation;</claim-text>
<claim-text>emulating and/or forwarding calls to a Trusted Platform Module.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The system of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein:
<claim-text>the privileged-processor-mode memory space of a computing device is isolated from other memory and locked against write access from processor modes other than a privileged-processor-mode of a processor of the computing device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A physical computer-readable-storage medium comprising one or more computer-executable instructions that, when executed by a computing device, cause the computing device to:
<claim-text>install security code in a privileged-processor-mode region of the computing device;</claim-text>
<claim-text>send, from the security code, periodic security communications from the privileged-processor-mode region of the computing device by:
<claim-text>accessing, via the security code, a network interface card, the accessing the network interface card being performed from within the privileged-processor-mode region of the computing device, and</claim-text>
<claim-text>sending, via the network interface card, at least one security communication from the privileged-processor-mode region to a remote computing device, the remote computing device comprising a security computing subsystem;</claim-text>
</claim-text>
<claim-text>identify at least one of the periodic security communications;</claim-text>
<claim-text>determine, based on the periodic security communications, whether the privileged-processor-mode region of the computing device has been compromised, wherein the security computing subsystem performs the identifying and the determining. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US08353059-20130108.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20121221" date-publ="20130108">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>08353059</doc-number>
<kind>B2</kind>
<date>20130108</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>13177227</doc-number>
<date>20110706</date>
</document-id>
</application-reference>
<us-application-series-code>13</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="regional">
<country>EP</country>
<doc-number>06252270</doc-number>
<date>20060427</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>8</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>12</class>
<subclass>B</subclass>
<main-group>21</main-group>
<subgroup>02</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20130108</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>850  9</main-classification>
</classification-national>
<invention-title id="d2e71">Optical scanning probe</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>3994798</doc-number>
<kind>A</kind>
<name>Westerlund</name>
<date>19761100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>4739394</doc-number>
<kind>A</kind>
<name>Oda et al.</name>
<date>19880400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5193120</doc-number>
<kind>A</kind>
<name>Gamache et al.</name>
<date>19930300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5402582</doc-number>
<kind>A</kind>
<name>Raab</name>
<date>19950400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5829148</doc-number>
<kind>A</kind>
<name>Eaton</name>
<date>19981100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6366831</doc-number>
<kind>B1</kind>
<name>Raab</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>7463138</doc-number>
<kind>B2</kind>
<name>Pawlicki et al.</name>
<date>20081200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>8238012</doc-number>
<kind>B2</kind>
<name>Kobayashi</name>
<date>20120800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3592011</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2002/0140949</doc-number>
<kind>A1</kind>
<name>Sasaki et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2005/0237423</doc-number>
<kind>A1</kind>
<name>Nilson et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>DE</country>
<doc-number>19639999</doc-number>
<kind>A1</kind>
<date>19980300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>DE</country>
<doc-number>10333493</doc-number>
<kind>A1</kind>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>FR</country>
<doc-number>2693003</doc-number>
<kind>A1</kind>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>JP</country>
<doc-number>56100306</doc-number>
<kind>A</kind>
<date>19810800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>JP</country>
<doc-number>62088906</doc-number>
<kind>A</kind>
<date>19870400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>JP</country>
<doc-number>6-300539</doc-number>
<kind>A</kind>
<date>19941000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>JP</country>
<doc-number>2000-097629</doc-number>
<kind>A</kind>
<date>20000400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>JP</country>
<doc-number>2002-296017</doc-number>
<kind>A</kind>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>JP</country>
<doc-number>2003-107389</doc-number>
<kind>A</kind>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>JP</country>
<doc-number>2003-194526</doc-number>
<kind>A</kind>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>JP</country>
<doc-number>2003189163</doc-number>
<kind>A</kind>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>JP</country>
<doc-number>2005-351851</doc-number>
<kind>A</kind>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>WO</country>
<doc-number>WO-97/05449</doc-number>
<date>19970200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>WO</country>
<doc-number>WO-2004/096502</doc-number>
<kind>A1</kind>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00025">
<othercit>International search report from PCT/EP2007/054116, Dec. 9, 2007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>6</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>850  9</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3592011</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3592012</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>9</number-of-drawing-sheets>
<number-of-figures>23</number-of-figures>
</figures>
<us-related-documents>
<division>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>12298688</doc-number>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>8117668</doc-number>
</document-id>
</parent-grant-document>
<parent-pct-document>
<document-id>
<country>WO</country>
<doc-number>PCT/EP2007/054116</doc-number>
<date>20070426</date>
</document-id>
</parent-pct-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>13177227</doc-number>
</document-id>
</child-doc>
</relation>
</division>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60795459</doc-number>
<date>20060427</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20120026510</doc-number>
<kind>A1</kind>
<date>20120202</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Crampton</last-name>
<first-name>Stephen James</first-name>
<address>
<city>Greater London</city>
<country>GB</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>GB</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Champ</last-name>
<first-name>Peter</first-name>
<address>
<city>Pinner Middlesex</city>
<country>GB</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>GB</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Marshall, Gerstein &#x26; Borun LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Metris N.V.</orgname>
<role>03</role>
<address>
<city>Leuven</city>
<country>BE</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Nguyen</last-name>
<first-name>Kiet T</first-name>
<department>2881</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention relates to a scanning probe (<b>2</b>) for capturing data from a plurality of points on the surface of an object by irradiating the object with a light stripe and detecting light reflected from the object surface, the scanning probe comprising (a) stripe generating means (<b>14</b>) for generating and emitting a light stripe (<b>55</b>); (b) a camera (<b>16</b>) comprising an imaging sensor having an array of pixels to detect the light stripe reflected from the object surface; (c) means for adjusting the intensity of the light stripe (<b>55</b>) during acquisition of the frame, in dependence upon the intensities detected by the camera (<b>16</b>). It also relates to a means to modify the stripe length, a scanner with separate compartment for the processing means, and an attachable dust cover for a scanner.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="91.86mm" wi="104.31mm" file="US08353059-20130108-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="208.28mm" wi="144.86mm" file="US08353059-20130108-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="201.25mm" wi="101.85mm" file="US08353059-20130108-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="161.46mm" wi="142.92mm" file="US08353059-20130108-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="218.69mm" wi="145.37mm" orientation="landscape" file="US08353059-20130108-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="114.72mm" wi="113.45mm" file="US08353059-20130108-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="214.71mm" wi="139.02mm" file="US08353059-20130108-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="195.41mm" wi="146.73mm" file="US08353059-20130108-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="208.87mm" wi="151.89mm" file="US08353059-20130108-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="196.09mm" wi="134.54mm" file="US08353059-20130108-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention concerns non-contact optical scanning.</p>
<heading id="h-0002" level="1">BACKGROUND TO THE INVENTION</heading>
<p id="p-0003" num="0002">Scanning Probes</p>
<p id="p-0004" num="0003">Scanning probes are non-contact optical probes for measuring thousands of points a second on the 3D surface shape of an object. There are three broad types of scanning probe: point, stripe and area. This invention concerns stripe scanning probes. Most stripe scanning probes use the principal of optical triangulation. Stripe scanning probes are provided or are being developed by Metris (Belgium), 3D Scanners (UK), Romer (France), Faro Technologies (USA), Perceptron (USA), Steinbichler (Germany), Pulstec (Japan), Micro Epsilon (Germany), SICK IVP (Germany), Vitana (Canada), Laser Design (USA), Datapixel (Spain), Optimet (Israel) and Kreon (France) amongst others.</p>
<p id="p-0005" num="0004">Movement of Stripe Scanning Probes</p>
<p id="p-0006" num="0005">In order to scan the surface of an object a stripe scanning probe needs to move over the object's surface in a similar way to how a paintbrush is used for painting a surface. The movement of the stripe scanning probe may be accomplished manually or by automated equipment.</p>
<p id="p-0007" num="0006">Localisers for Stripe Scanning Probes</p>
<p id="p-0008" num="0007">In order to get accurate data of the surface of an object, a localiser is required to register the position and orientation of the stripe scanning probe when surface data is captured by the stripe scanning probe. Localisers are generally mechanical or remote. Localisers may also have the dual functionality of supporting/moving the probe as well as supplying its position and orientation. Mechanical localisers include: 3-axis Cartesian coordinate measurement machines (CMMs), Manual CMM arms, Robot CMM arms and essentially all types of combinations of continuous mechanical linkages that might accurately register the position and orientation of a probe end relative to a base end, the stripe scanning probe being rigidly attached to the probe end. Remote localisers include: optical trackers, optical CMMs, magnetic trackers and GPS systems. Remote localisers often require one or more lines of sight between the stripe scanning probe and the remote localiser equipment.</p>
<p id="p-0009" num="0008">Since the 1970's, companies have been building manually operable CMM arms that have recently achieved a measuring accuracy using a contact probe of between 0.025 mm (+/&#x2212;2 Sigma) and 0.005 mm (+/&#x2212;2 Sigma) depending, mainly, on the reach of the Manual CMM Arm, Manual CMM Arms are expected to become more accurate with further development. These Manual CMM Arms are now accurate enough for many measurement requirements and area growing sector in the measurement marketplace. They have the flexibility of being able to get into areas with difficult access. Manual CMM Arms are acceptably accurate for many applications, but are not automated; they are expensive to operate, particularly since a semi-skilled operator is required; human operators are also subject to human error. Manual CMM Arms are provided by companies including: Hexagon Cimcore (USA), Faro Technologies (USA), Hexagon Romer (France), Zett Mess Technik (Germany) and Tokyo Boeki (Japan). As examples, U.S. Pat. No. 3,994,798 Eaton, U.S. Pat. No. 5,402,582 Raab assigned to Faro Technologies, U.S. Pat. No. 5,829,148 Eaton and U.S. Pat. No. 6,366,831 Raab assigned to Faro Technologies disclose background information on Manual CMM Arms.</p>
<p id="p-0010" num="0009">Stripe Scanning Probes on Manual CMM Arms</p>
<p id="p-0011" num="0010">Stripe scanning probes on Manual CMM Arms were disclosed by Crampton, an inventor of the present invention, in several patent applications including PCT/GB96/01868. Stripe scanning probes for Manual CMM Arms are provided or are being developed by Metris, 3D Scanners, Romer, Faro Technologies, Perceptron, Steinbichler, Pulstec and Kreon amongst others. As yet, a measurement accuracy standard does not exist that defines the way accuracy should be measured for Stripe scanning probes. The marketplace is in the situation of not being able to perform standard tests to verify accuracy and enable comparison between stripe scanning probe types in a practical way. Stripe scanning probes have become accurate, largely because their measuring range is short. In general, stripe scanning probes gather measurement data over a measuring range of the order of 20-400 mm. This is often at a standoff to the end of the Manual CMM Arm. The accuracy of the best Manual CMM Arms combined with the best Stripe scanning probes is already better than 0.050 mm (+/&#x2212;2 Sigma) and can be better than 0.010 mm (+/&#x2212;2 Sigma) for short measuring ranges. Stripe scanning probes are generally mounted offset on the side of the Manual CMM Arm or mounted on the probe end of it. Stripe scanning probes are usually quickly dismountable from a Manual CMM Arm using a mounting system that is mechanically repeatable to an acceptable degree of accuracy.</p>
<p id="p-0012" num="0011">Robot CMM Arms and their use with stripe scanning probes were disclosed by Crampton, an inventor of the present invention, in several patent applications including PCT/GB2004/001827, Robot CMM Arms have the advantage over Manual CMM Arms of supporting and moving the stripe scanning probe automatically. Both Manual CMM Arms and Robot CMM Arms have the advantage over Cartesian CMMs of articulation.</p>
<p id="p-0013" num="0012">Market Needs</p>
<p id="p-0014" num="0013">Accuracy: Users demand ever higher accuracy and data quality from their stripe scanning probes.</p>
<p id="p-0015" num="0014">Speed: When surfaces are scanned, they are sampled. The quality and automation of the surface reconstruction or measurement is related to the number and density of raw points scanned. Scanning rates of current sensors on the market are typically 3,000 to 20,000 points per second. Rates exceeding 200,000 points per second will increase the productivity of the stripe scanning probes by reducing both data capture time and manual intervention in the post-processing activity.</p>
<p id="p-0016" num="0015">Cabling: a stripe scanning probe with fewer cables has higher utility than a stripe scanning probe with lots of cables. Cables are an ever increasing proportion of the cost of CMMs.</p>
<p id="p-0017" num="0016">Compactness: it is desirable to provide a stripe scanning probe with built in processing and without an extra box of electronics and associated cables.</p>
<p id="p-0018" num="0017">Cost: the market place is becoming more competitive and reductions in cabling, components are desirable to reduce the manufacturing cost of stripe scanning probes.</p>
<p id="p-0019" num="0018">Current Situation</p>
<p id="p-0020" num="0019">The vast majority of stripe scanning probes on the market are analogue and use video CCD imaging sensors. This state of the art imaging technology has limited the accuracies, data quality, speeds, cost and compactness of the solutions.</p>
<heading id="h-0003" level="1">SUMMARY OF SOME EMBODIMENTS OF THE INVENTION</heading>
<p id="p-0021" num="0020">One embodiment of the invention relates to a scanning probe (<b>2</b>) for capturing data from a plurality of points on the surface of an object by irradiating the object with a light stripe and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0021">(a) stripe generating means (<b>14</b>) for generating and emitting a light stripe (<b>55</b>);</li>
    <li id="ul0001-0002" num="0022">(b) a camera (<b>16</b>) comprising an imaging sensor having an array of pixels to detect the light stripe reflected from the object surface;</li>
    <li id="ul0001-0003" num="0023">(c) means for adjusting the intensity of the light stripe (<b>55</b>) during acquisition of a single frame, in dependence upon the intensities detected by the camera (<b>16</b>).</li>
</ul>
</p>
<p id="p-0022" num="0024">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein:
<ul id="ul0002" list-style="none">
    <li id="ul0002-0001" num="0000">
    <ul id="ul0003" list-style="none">
        <li id="ul0003-0001" num="0025">the camera (<b>16</b>) and/or stripe generating means (<b>14</b>) are configured such that different subsets of the imaging sensor pixels at different times detect light reflected from the stripe during the acquisition of the frame, the different subsets corresponding to different positions on the detected light stripe,</li>
        <li id="ul0003-0002" num="0026">the means for adjusting the intensity of the light is configured to adjust the intensity during acquisition of the frame, in dependence upon the intensities detected by the subset of pixels.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0023" num="0027">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, whereby the imaging sensor is a CMOS equipped with a rolling shutter, wherein:
<ul id="ul0004" list-style="none">
    <li id="ul0004-0001" num="0000">
    <ul id="ul0005" list-style="none">
        <li id="ul0005-0001" num="0028">the rolling shutter is configured such that different subsets of the sensor pixels at different times detect light reflected from the stripe during the acquisition of the frame, the different subsets corresponding to different positions on the detected light stripe, and</li>
        <li id="ul0005-0002" num="0029">the stripe generating means (<b>14</b>) is configured to generate a stripe of unvariable intensity across the length of the stripe which overall intensity is adjustable during acquisition of the frame, in dependence upon the intensities detected by the subset of pixels.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0024" num="0030">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein the stripe generating means (<b>14</b>) comprises static optics.</p>
<p id="p-0025" num="0031">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein the stripe generating means (<b>14</b>) comprises a laser and solid cylindrical optics.</p>
<p id="p-0026" num="0032">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein the stripe generating means (<b>14</b>) comprises a laser and a micro-mirror array.</p>
<p id="p-0027" num="0033">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein the means for adjusting the intensity of the light is arranged to set the intensity for each subset of pixels in dependence upon:
<ul id="ul0006" list-style="none">
    <li id="ul0006-0001" num="0000">
    <ul id="ul0007" list-style="none">
        <li id="ul0007-0001" num="0034">the light detected by the pixel(s) in that subset for at least one previously projected light stripe, and</li>
        <li id="ul0007-0002" num="0035">the intensity of the light emitted for that subset in at least one previously projected light stripe.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0028" num="0036">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein:
<ul id="ul0008" list-style="none">
    <li id="ul0008-0001" num="0000">
    <ul id="ul0009" list-style="none">
        <li id="ul0009-0001" num="0037">the stripe generating means (<b>14</b>) is configured to generate a stripe (<b>55</b>) comprising a plurality of spots whose individual intensities are adjustable during acquisition of a single frame, and</li>
        <li id="ul0009-0002" num="0038">the spots are separately projected so that different subsets of the sensor pixels at different times detect light reflected from the stripe during the acquisition of the frame, the different subsets corresponding to different positions on the detected light stripe,</li>
        <li id="ul0009-0003" num="0039">the individual spot intensities are adjusted in dependence upon the intensities detected by the subset of pixels.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0029" num="0040">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein the stripe generating means (<b>14</b>) comprises a laser and a micro-mirror array.</p>
<p id="p-0030" num="0041">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein the stripe generating means (<b>14</b>) comprises moving optics.</p>
<p id="p-0031" num="0042">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein the stripe generating means (<b>14</b>) comprises a laser and a moving mirror.</p>
<p id="p-0032" num="0043">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, whereby the imaging sensor is a CMOS equipped with a rolling shutter, or a CCD.</p>
<p id="p-0033" num="0044">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, wherein the means for adjusting the intensity of the light is arranged to set the intensity of spots within a projected stripe for each subset of pixels in dependence upon:
<ul id="ul0010" list-style="none">
    <li id="ul0010-0001" num="0000">
    <ul id="ul0011" list-style="none">
        <li id="ul0011-0001" num="0045">the light detected by the pixel(s) in that subset for at least one previously projected spot in the stripe, and</li>
        <li id="ul0011-0002" num="0046">the intensity of the light emitted for that subset in at least one previously projected spot in the stripe.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0034" num="0047">Another embodiment of the invention relates to a scanning probe (<b>2</b>) as described above, further comprising means for adjusting the exposure time for a subset of the pixels in dependence upon the light intensity set for the subset.</p>
<p id="p-0035" num="0048">Another embodiment of the invention relates to a method of capturing data from a plurality of points on the surface of an object by irradiating the object with a light stripe and detecting light reflected from the object surface, the method comprising:
<ul id="ul0012" list-style="none">
    <li id="ul0012-0001" num="0049">(a) generating and emitting a light stripe;</li>
    <li id="ul0012-0002" num="0050">(b) detecting the light stripe reflected from the object surface using an imaging sensor comprising an array of pixels,</li>
    <li id="ul0012-0003" num="0051">(c) adjusting the intensity of the light during acquisition of a single frame in dependence upon the intensity of light detected by the pixels.</li>
</ul>
</p>
<p id="p-0036" num="0052">Another embodiment of the invention relates to a method as described above, wherein:
<ul id="ul0013" list-style="none">
    <li id="ul0013-0001" num="0000">
    <ul id="ul0014" list-style="none">
        <li id="ul0014-0001" num="0053">different subsets of the imaging sensor pixels at different times detect light reflected from the stripe during the acquisition of the frame, the different subsets corresponding to different positions on the detected light stripe, to determine the light detected by the pixel(s) in each subset; and</li>
        <li id="ul0014-0002" num="0054">the intensity of the light during acquisition of the frame is adjusted in dependence upon the intensity of light detected by the subset of pixels.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0037" num="0055">Another embodiment of the invention relates to a method as described above, whereby the stripe is detected using a CMOS imaging sensor equipped with a rolling shutter allowing different subsets of the sensor pixels at different times to detect light reflected from the stripe during the acquisition of the frame, the different subsets corresponding to different positions on the detected light stripe, and
<ul id="ul0015" list-style="none">
    <li id="ul0015-0001" num="0000">
    <ul id="ul0016" list-style="none">
        <li id="ul0016-0001" num="0056">the stripe generating means generates a stripe of unvariable intensity across the length of the stripe which overall intensity is adjusted during acquisition of a single frame.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0038" num="0057">Another embodiment of the invention relates to a method as described above, whereby wherein the stripe generating means comprises static optics.</p>
<p id="p-0039" num="0058">Another embodiment of the invention relates to a method as described above, wherein the stripe generating means comprises a laser and solid cylindrical optics.</p>
<p id="p-0040" num="0059">Another embodiment of the invention relates to a method as described above, wherein the stripe generating means comprises a laser and a micro-mirror array.</p>
<p id="p-0041" num="0060">Another embodiment of the invention relates to a method as described above, wherein the intensity of the light is further adjusted by setting the intensity for each subset of pixels in dependence upon:
<ul id="ul0017" list-style="none">
    <li id="ul0017-0001" num="0000">
    <ul id="ul0018" list-style="none">
        <li id="ul0018-0001" num="0061">the light detected by the pixel(s) in that subset for at least one previously projected light stripe, and</li>
        <li id="ul0018-0002" num="0062">the intensity o he light emitted for that subset in at least one previously projected light stripe.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0042" num="0063">Another embodiment of the invention relates to a method as described above, wherein:
<ul id="ul0019" list-style="none">
    <li id="ul0019-0001" num="0000">
    <ul id="ul0020" list-style="none">
        <li id="ul0020-0001" num="0064">the stripe generating means generates a stripe comprising a plurality of spots whose individual intensities are adjustable during acquisition of a single frame, and</li>
        <li id="ul0020-0002" num="0065">the spots are separately projected no that different subsets of the sensor pixels at different times detect light reflected from the stripe during the acquisition of the frame, the different subsets corresponding to different positions on the detected light stripe,</li>
        <li id="ul0020-0003" num="0066">the individual spot intensities are adjusted in dependence upon the intensities detected by the subset of pixels.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0043" num="0067">Another embodiment of the invention relates to a method as described above, wherein the stripe generating means comprises a laser and a micro-mirror array.</p>
<p id="p-0044" num="0068">Another embodiment of the invention relates to a method as described above, wherein the stripe generating means (<b>14</b>) comprises moving optics.</p>
<p id="p-0045" num="0069">Another embodiment of the invention relates to a method as described above, wherein the stripe generating means comprises a laser and a moving mirror.</p>
<p id="p-0046" num="0070">Another embodiment of the invention relates to a method as described above, wherein the imaging sensor is a CMOS camera equipped with a rolling shutter, or a CCD.</p>
<p id="p-0047" num="0071">Another embodiment of the invention relates to a method as described above, wherein the intensity of the light is further adjusted by setting the intensity within a projected stripe for each subset of pixels in dependence upon:
<ul id="ul0021" list-style="none">
    <li id="ul0021-0001" num="0000">
    <ul id="ul0022" list-style="none">
        <li id="ul0022-0001" num="0072">the light detected by the pixel(s) in that subset for at least one previously projected spot in the stripe, and</li>
        <li id="ul0022-0002" num="0073">the power of the light emitted for that subset in at least one previously projected spot in the stripe.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0048" num="0074">Another embodiment of the invention relates to a method as described above, further comprising adjusting the exposure time for a subset of the pixels in dependence upon the light power set for the subset.</p>
<p id="p-0049" num="0075">Another embodiment of the invention relates to a scanning probe for capturing data from a plurality of points on the surface of the object by irradiating the object with a light stripe and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0023" list-style="none">
    <li id="ul0023-0001" num="0076">(a) stripe generating means for generating a light stripe;</li>
    <li id="ul0023-0002" num="0077">(b) an imaging sensor to detect the light stripe reflected from the object surface; and</li>
    <li id="ul0023-0003" num="0078">(c) an aperture through which the light stripe generated by the stripe generating means is emitted, the aperture being variable to provide an aperture of a first width and an aperture of a second width through which the light stripe must pass such that light stripes of different lengths are generated when the aperture is arranged at its different widths.</li>
</ul>
</p>
<p id="p-0050" num="0079">Another embodiment of the invention relates to the scanning probe as described above, wherein the aperture is of non-circular shape and is variable by rotation relative to the light stripe to provide the aperture of first and second widths.</p>
<p id="p-0051" num="0080">Another embodiment of the invention relates to the scanning probe as described above, wherein the aperture is manually variable.</p>
<p id="p-0052" num="0081">Another embodiment of the invention relates to the scanning probe as described above, further comprising:
<ul id="ul0024" list-style="none">
    <li id="ul0024-0001" num="0000">
    <ul id="ul0025" list-style="none">
        <li id="ul0025-0001" num="0082">means for detecting whether the aperture is set to the first width or the second width; and</li>
        <li id="ul0025-0002" num="0083">means for setting the detection frame rate of the imaging sensor in dependence upon the determined width.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0053" num="0084">Another embodiment of the invention relates to the scanning probe as described above, further comprising means for varying the aperture in response to user input instructions.</p>
<p id="p-0054" num="0085">Another embodiment of the invention relates to the scanning probe as described above, further comprising means for setting the detection frame rate of the imaging sensor in dependence upon the user input instructions.</p>
<p id="p-0055" num="0086">Another embodiment of the invention relates to a scanning probe for capturing data from a plurality of points on the surface of an object by irradiating the object with light and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0026" list-style="none">
    <li id="ul0026-0001" num="0087">(a) light generating means for generating and emitting light;</li>
    <li id="ul0026-0002" num="0088">(b) an imaging sensor to detect light reflected from the object surface; and</li>
    <li id="ul0026-0003" num="0089">(c) data processing means operable to process signals from the imaging sensor;
    <ul id="ul0027" list-style="none">
        <li id="ul0027-0001" num="0090">wherein the data processing means is provided in a compartment separated from the light generating means and the imaging sensor.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0056" num="0091">Another embodiment of the invention relates to a scanning probe as described above, wherein the imaging sensor and the data processing means are provided in a first enclosure and the light generating means is provided in a separate second enclosure, the first and second enclosures being rigidly connected together.</p>
<p id="p-0057" num="0092">Another embodiment of the invention relates to a scanning probe as described above, wherein the compartment of the data processing means is separated from the imaging sensor by a barrier with high thermal resistance to thermally insulate the data processing means from the imaging sensor.</p>
<p id="p-0058" num="0093">Another embodiment of the invention relates to a scanning probe as described above, wherein the light generating means, the imaging sensor, and the data processing means are provided in a single enclosure, and wherein the compartment of the data processing means is separated from the light generating means and the imaging sensor by a barrier with high thermal resistance to thermally insulate the data processing means from the light generating means and the imaging sensor.</p>
<p id="p-0059" num="0094">Another embodiment of the invention relates to a scanning probe as described above, wherein the compartment containing the data processing means has an air inlet, an air outlet, and a fan arranged to draw air into the compartment through the air inlet and to expel air from the compartment through the air outlet.</p>
<p id="p-0060" num="0095">Another embodiment of the invention relates to a scanning probe for capturing data from a plurality of points on the surface of the object by irradiating the object with light and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0028" list-style="none">
    <li id="ul0028-0001" num="0096">(a) light generating means for generating and emitting light;</li>
    <li id="ul0028-0002" num="0097">(b) an imaging sensor having a plurality of pixels to detect light reflected from the object surface through an imaging window; and</li>
    <li id="ul0028-0003" num="0098">(c) a visor moveable between a closed position in which the visor covers the imaging window and an open position in which the visor does not cover the imaging window.</li>
</ul>
</p>
<p id="p-0061" num="0099">Another embodiment of the invention relates to a scanning probe as described above, further comprising means for detecting when the visor is in the closed position and means for inhibiting operation of the probe when it is detected that the visor is in the closed position.</p>
<p id="p-0062" num="0100">Another embodiment of the invention relates to a scanning probe as described above, further comprising means for detecting when the visor is in the closed position and means for warning the user when it is detected that the visor is in the closed position.</p>
<p id="p-0063" num="0101">Another embodiment of the invention relates to a scanning probe as described above, further comprising means for locking the visor in the open position and the closed position, respectively.</p>
<p id="p-0064" num="0102">Another embodiment provides a digital stripe scanning probe for operation with a localiser to accurately record thousands of 3D points per second on the surface of an object.</p>
<p id="p-0065" num="0103">In a first embodiment of the present invention, the digital stripe scanning probe comprises:
<ul id="ul0029" list-style="none">
    <li id="ul0029-0001" num="0000">
    <ul id="ul0030" list-style="none">
        <li id="ul0030-0001" num="0104">an imaging sensor which may optionally be digitally addressable;</li>
        <li id="ul0030-0002" num="0105">two separate enclosures for stripe projection and stripe imaging, that are rigidly connected together;</li>
        <li id="ul0030-0003" num="0106">connection to a computer without the need for an intermediate box for specialist processing.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0066" num="0107">In an alternative embodiment of the present invention, the digital stripe scanning probe comprises a single enclosure.</p>
<p id="p-0067" num="0108">In another embodiment of the present invention, the imaging sensor in the digital stripe scanning probe is a CMOS sensor.</p>
<p id="p-0068" num="0109">In another embodiment of the present invention, the imaging sensor in the digital stripe scanning probe is a CCD sensor,</p>
<p id="p-0069" num="0110">In an embodiment, digital cables are used to transfer data. Digital cables are cheaper and more compact than analogue video cables. Furthermore, the use of digital cables results in reduced background noise during data transmission.</p>
<p id="p-0070" num="0111">In a further embodiment of the present invention, the data connection between the digital stripe scanning probe and the computer is a standard bus such as Ethernet; the digital stripe scanning probe has an IP address.</p>
<p id="p-0071" num="0112">In a further embodiment of the present invention, the stripe imaging enclosure of the digital stripe scanning probe comprises a hot compartment and a cold compartment separated by a barrier with high thermal resistance.</p>
<p id="p-0072" num="0113">In a further embodiment of the present invention, a fan is provided in the hot compartment of the digital stripe scanning probe and the hot compartment is sealed.</p>
<p id="p-0073" num="0114">In another embodiment of the present invention, a fan is provided in the hot compartment of the digital stripe scanning probe and the hot compartment is through-flow with a dust filter on the input.</p>
<p id="p-0074" num="0115">In another embodiment of the present invention, the stripe is a laser stripe. The stripe may be created with static optics or with moving optics.</p>
<p id="p-0075" num="0116">In a further embodiment the power of the stripe is controlled over time. This may give rise to stripes whose intensity is unvariable across the stripe, but which intensity can be raised or lowered. It may also give rise to a stripe whose intensity is variable across the stripe (e.g. more intense in the centre or the edges).</p>
<p id="p-0076" num="0117">In another embodiment of the present invention, the sensor is a CMOS sensor that has a rolling shutter and the timing of the rolling shutter is controlled and synchronised with the power of the light stripe providing a large degree of control over the intensity of each imaged stripe or point along the stripe.</p>
<p id="p-0077" num="0118">In another embodiment of the invention, the sensor is a regular CCD working as a snapshot buffer and is synchronised with the power of the light stripe providing a large degree of control over the intensity of each imaged stripe or point along the stripe</p>
<p id="p-0078" num="0119">In a further embodiment of the present invention, the imaged intensity from a previous stripe is used adaptively to adjust the light power at each point along the current stripe such that near-optimum signal to noise is attained and the data quality is maximised.</p>
<p id="p-0079" num="0120">In another embodiment of the present invention, the stripe is created with moving optics. The moving optics may comprise a laser and moving mirror that generates a flying spot. The intensity of the flying spot may be adjusted within a sweep to give rise to a stripe whose intensity is variable across the stripe. Alternatively, intensity of the flying spot may be adjusted between sweeps to give rise to a stripe whose intensity is unvariable (i.e. almost uniform) across the stripe, but which intensity can be raised or lowered. The flying spot may be synchronised with the rolling shutter. The former and latter arrangements give rise to a stripe whose intensity is unvariable across the stripe, but which intensity can be raised or lowered.</p>
<p id="p-0080" num="0121">In another embodiment of the present invention, the stripe is created with static optics. The static optics are devoid of the mechanical parts associated with, for example, a moving mirror. A static optics may comprise a laser and a solid state micro-mirror array, or a laser and solid cylindrical optics. Static optics are capable of generating a stripe whose intensity is unvariable across the stripe, but which intensity can be raised or lowered. The micro-mirror is capable of projecting a stripe whose intensity is variable across the stripe because the array projects the stripe as a plurality of spots whose individual intensities can be adjusted.</p>
<p id="p-0081" num="0122">In a particular embodiment of the present invention, the sensor is a CMOS sensor that has a rolling shutter, the stripe is created using static optics, the timing of the rolling shutter is controlled and synchronised with the power of the light stripe, and the light power across the stripe is controlled by the laser.</p>
<p id="p-0082" num="0123">In a particular embodiment of the invention, the sensor is a regular CCD working as a snapshot buffer is used, the stripe is created with static optics and the light power in the stripe is controlled in the stripe by a micro-mirror array.</p>
<p id="p-0083" num="0124">In a particular embodiment of the invention, the sensor is a regular CCD working as a snapshot buffer is used, the stripe is created with moving optics and the light intensity within the stripe is controlled by the laser in combination with a moving mirror.</p>
<p id="p-0084" num="0125">In a further embodiment of the present invention, a tracking window that follows the stripe is used to increase the speed of scanning.</p>
<p id="p-0085" num="0126">In another embodiment of the present invention, a manually rotatable stripe trimmer with multiple positions is provided for projecting different stripe lengths.</p>
<p id="p-0086" num="0127">In another embodiment of the present invention, a manually positionable visor is provided for protecting the imaging window. A sensor is also provided for detecting whether the visor is open or closed.</p>
<p id="p-0087" num="0128">One other embodiment of the invention is a scanning probe for capturing data from a plurality of points on the surface of an object by irradiating the object with a light stripe and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0031" list-style="none">
    <li id="ul0031-0001" num="0129">(a) stripe generating means for generating and emitting a light stripe;</li>
    <li id="ul0031-0002" num="0130">(b) an addressable imaging sensor having a plurality of pixels to detect the light stripe reflected from the object surface;</li>
    <li id="ul0031-0003" num="0131">(c) sensor reading means for reading a different subset of the imaging sensor pixels at different times, the different subsets corresponding to different positions on the detected light stripe, to determine the light detected by the pixel(s) in each subset; and</li>
    <li id="ul0031-0004" num="0132">(d) means for adjusting the power of the light in dependence upon the subset of pixels read by the sensor reading means.</li>
</ul>
</p>
<p id="p-0088" num="0133">Another embodiment of the invention is a scanning probe as defined above, wherein the means for adjusting the power of the light is arranged to set the power for each subset of pixels in dependence upon the light detected by the pixel(s) in that subset for at least one previously projected light stripe and the power of the light emitted for that subset in at least one previously projected light stripe.</p>
<p id="p-0089" num="0134">Another embodiment of the invention is a scanning probe as defined above, further comprising means for adjusting the exposure time for a subset of the pixels in dependence upon the light power set for the subset.</p>
<p id="p-0090" num="0135">Another embodiment of the invention is a scanning probe as defined above, wherein the imaging sensor comprises a two-dimensional array of pixels, and the sensor reading means is arranged to read subsets of pixels such that each subset comprises a full line of pixels in the two-dimensional array.</p>
<p id="p-0091" num="0136">Another embodiment of the invention is a scanning probe as defined above, wherein the light stripe generating means comprises static optics to generate and emit a light stripe.</p>
<p id="p-0092" num="0137">Another embodiment of the invention is a scanning probe as defined above, wherein the light stripe generating means comprises a moving mirror to generate a light stripe by reflecting a light spot.</p>
<p id="p-0093" num="0138">Another embodiment of the invention is a method of capturing data from a plurality of points on the surface of an object by irradiating the object with a light stripe and detecting light reflected from the object surface, the method comprising:
<ul id="ul0032" list-style="none">
    <li id="ul0032-0001" num="0139">(a) generating and emitting a light stripe;</li>
    <li id="ul0032-0002" num="0140">(b) detecting the light stripe reflected from the object surface using an addressable imaging sensor having a plurality of pixels;</li>
    <li id="ul0032-0003" num="0141">(c) reading a different subset of the imaging sensor pixels at different times, the different subsets corresponding to different positions on the detected light stripe, to determine the light detected by the pixel(s) in each subset; and</li>
    <li id="ul0032-0004" num="0142">(d) adjusting the power of the light in dependence upon the subset of pixels read.</li>
</ul>
</p>
<p id="p-0094" num="0143">Another embodiment of the invention is a method as defined above, wherein the power of the light is adjusted by setting the power for each subset of pixels in dependence upon the light detected by the pixel(s) in that subset for at least one previously projected light stripe and the power of the light emitted for that subset in at least one previously projected light stripe.</p>
<p id="p-0095" num="0144">Another embodiment of the invention is a method as defined above, further comprising adjusting the exposure time for a subset of the pixels in dependence upon the light power set for the subset.</p>
<p id="p-0096" num="0145">Another embodiment of the invention is a method as defined above, wherein the light stripe reflected from the object surface is detected using an imaging sensor comprising a two-dimensional array of pixels, and wherein the subsets of pixels are read such that each subset comprises a full line of pixels in the two-dimensional array.</p>
<p id="p-0097" num="0146">Another embodiment of the invention is a method as defined above, wherein the light stripe is generated using static optics.</p>
<p id="p-0098" num="0147">Another embodiment of the invention is a method as defined above, wherein the light stripe is generated by reflecting a light spot using a moving mirror.</p>
<p id="p-0099" num="0148">Another embodiment of the invention is a scanning probe for capturing data from a plurality of points on the surface of the object by irradiating the object with a light stripe and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0033" list-style="none">
    <li id="ul0033-0001" num="0149">(a) stripe generating means for generating a light stripe;</li>
    <li id="ul0033-0002" num="0150">(b) an imaging sensor to detect the light stripe reflected from the object surface; and</li>
    <li id="ul0033-0003" num="0151">(c) an aperture through which the light stripe generated by the stripe generating means is emitted, the aperture being variable to provide an aperture of a first width and an aperture of a second width through which the light stripe must pass such that light stripes of different lengths are generated when the aperture is arranged at its different widths.</li>
</ul>
</p>
<p id="p-0100" num="0152">Another embodiment of the invention is a scanning probe as defined above, wherein the aperture is of non-circular shape and is variable by rotation relative to the light stripe to provide the aperture of first and second widths.</p>
<p id="p-0101" num="0153">Another embodiment of the invention is a scanning apparatus as defined above, wherein the aperture is manually variable.</p>
<p id="p-0102" num="0154">Another embodiment of the invention is a scanning apparatus as defined above, further comprising:
<ul id="ul0034" list-style="none">
    <li id="ul0034-0001" num="0000">
    <ul id="ul0035" list-style="none">
        <li id="ul0035-0001" num="0155">means for detecting whether the aperture is set to the first width or the second width; and</li>
        <li id="ul0035-0002" num="0156">means for setting the detection frame rate of the imaging sensor in dependence upon the determined width.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0103" num="0157">Another embodiment of the invention is a scanning apparatus as defined above, further comprising means for varying the aperture in response to user input instructions.</p>
<p id="p-0104" num="0158">Another embodiment of the invention is a scanning apparatus as defined above, further comprising means for setting the detection frame rate of the imaging sensor in dependence upon the user input instructions.</p>
<p id="p-0105" num="0159">Another embodiment of the invention is a scanning probe for capturing data from a plurality of points on the surface of an object by irradiating the object with light and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0036" list-style="none">
    <li id="ul0036-0001" num="0160">(a) light generating means for generating and emitting light;</li>
    <li id="ul0036-0002" num="0161">(b) an imaging sensor to detect light reflected from the object surface; and</li>
    <li id="ul0036-0003" num="0162">(c) data processing means operable to process signals from the imaging sensor;
    <ul id="ul0037" list-style="none">
        <li id="ul0037-0001" num="0163">wherein the data processing means is provided in a compartment separated from the light generating means and the imaging sensor.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0106" num="0164">Another embodiment of the invention is a scanning probe as defined above, wherein the imaging sensor and the data processing means are provided in a first enclosure and the light generating means is provided in a separate second enclosure, the first and second enclosures being rigidly connected together.</p>
<p id="p-0107" num="0165">Another embodiment of the invention is a scanning probe as defined above, wherein the compartment of the data processing means is separated from the imaging sensor by a barrier with high thermal resistance to thermally insulate the data processing means from the imaging sensor.</p>
<p id="p-0108" num="0166">Another embodiment of the invention is a scanning probe as defined above, wherein the light generating means, the imaging sensor, and the data processing means are provided in a single enclosure, and wherein the compartment of the data processing means is separated from the light generating means and the imaging sensor by a barrier with high thermal resistance to thermally insulate the data processing means from the light generating means and the imaging sensor.</p>
<p id="p-0109" num="0167">Another embodiment of the invention is a scanning probe as defined above, wherein the compartment containing the data processing means has an air inlet, an air outlet, and a fan arranged to draw air into the compartment through the air inlet and to expel air from the compartment through the air outlet.</p>
<p id="p-0110" num="0168">Another embodiment of he invention is a scanning probe for capturing a from a plurality of points on the surface of the object by irradiating the object with light and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0038" list-style="none">
    <li id="ul0038-0001" num="0169">(a) light generating means for generating and emitting light;</li>
    <li id="ul0038-0002" num="0170">(b) an imaging sensor having a plurality of pixels to detect light ref ed from the object surface through an imaging window; and</li>
    <li id="ul0038-0003" num="0171">(c) a visor moveable between a closed position in which the visor covers the imaging window and an open position in which the visor does not cover the imaging window.</li>
</ul>
</p>
<p id="p-0111" num="0172">Another embodiment of the invention is a scanning probe as defined above, further comprising means for detecting when the visor is in the closed position and means for inhibiting operation of the probe when it is detected that the visor is in the closed position.</p>
<p id="p-0112" num="0173">Another embodiment of the invention is a scanning probe as defined above, further comprising means for detecting when the visor is in the closed position and means for warning the user when it is detected that the visor is in the closed position.</p>
<p id="p-0113" num="0174">Another embodiment of the invention is a scanning probe as defined above, further comprising means for locking the visor in the open position and the closed position, respectively.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0114" num="0175">Embodiments of the present invention will now be described, by way of example only, with reference to the accompanying drawings, in which:</p>
<p id="p-0115" num="0176"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic layout of a scanning system in accordance with a first embodiment of the present invention;</p>
<p id="p-0116" num="0177"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram of the digital stripe scanning probe;</p>
<p id="p-0117" num="0178"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram of a cooling system for the digital stripe scanning probe;</p>
<p id="p-0118" num="0179"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic of the visor on the digital stripe scanning probe;</p>
<p id="p-0119" num="0180"><figref idref="DRAWINGS">FIG. 5</figref> is four diagrams of the stripe trimmer on the digital stripe scanning probe;</p>
<p id="p-0120" num="0181"><figref idref="DRAWINGS">FIG. 6A</figref> is a schematic of a monkey nut shaped aperture for the stripe trimmer;</p>
<p id="p-0121" num="0182"><figref idref="DRAWINGS">FIG. 6B</figref> is a schematic of a pair of lips shaped aperture for the stripe trimmer;</p>
<p id="p-0122" num="0183"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram of the electronics in the digital stripe scanning probe;</p>
<p id="p-0123" num="0184"><figref idref="DRAWINGS">FIG. 8</figref> is two views of a digital stripe scanning probe imaging a reflective sphere;</p>
<p id="p-0124" num="0185"><figref idref="DRAWINGS">FIG. 9A</figref> is a diagram of the stripe image on the imaging sensor when a roller shutter is employed;</p>
<p id="p-0125" num="0186"><figref idref="DRAWINGS">FIG. 9B</figref> is a diagram of the intensity I<sub>I </sub>imaged by each row over time when a roller shutter is employed;</p>
<p id="p-0126" num="0187"><figref idref="DRAWINGS">FIG. 9C</figref> is a diagram of the projected intensity I<sub>P </sub>output (on a log 10 scale) by the stripe projector over time when a roller shutter is employed;</p>
<p id="p-0127" num="0188"><figref idref="DRAWINGS">FIG. 10A to 10E</figref> are diagrams of incomplete stripe image patterns on the imaging sensor when a moving mirror or micro-mirror array is employed. <figref idref="DRAWINGS">FIG. 10F</figref> is a diagram of the acquired stripe image on the imaging sensor.</p>
<p id="p-0128" num="0189"><figref idref="DRAWINGS">FIG. 11A</figref> is a diagram of the intensity I<sub>I </sub>imaged by each row over time;</p>
<p id="p-0129" num="0190"><figref idref="DRAWINGS">FIG. 11B</figref> is a diagram of the projected intensity I<sub>P </sub>output (on a log 10 scale) by the stripe projector over time;</p>
<p id="p-0130" num="0191"><figref idref="DRAWINGS">FIG. 12</figref> is a method for calculating the new projected intensity for a point on a stripe;</p>
<p id="p-0131" num="0192"><figref idref="DRAWINGS">FIG. 13</figref> is a schematic of a stripe image within a tracking window;</p>
<p id="p-0132" num="0193"><figref idref="DRAWINGS">FIG. 14</figref> is a diagram for a relationship between the imaged intensity I<sub>I </sub>and the projected intensity I<sub>P</sub>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0133" num="0194">Unless defined otherwise, all technical and scientific terms used herein have the same meaning as is commonly understood by one of skill in the art. All publications referenced herein are incorporated by reference thereto. All United States patents and patent applications referenced herein are incorporated by reference herein in their entirety including the drawings.</p>
<p id="p-0134" num="0195">Throughout this application, the term &#x201c;about&#x201d; is used to indicate that a value includes the standard deviation of error for the device or method being employed to determine the value.</p>
<p id="p-0135" num="0196">The recitation of numerical ranges by endpoints includes all integer numbers and, where appropriate, fractions subsumed within that range (e.g. 1 to 5 can include 1, 2, 3, 4 when referring to, for example, a number of laser stripes, and can also include 1.5, 2, 2.75 and 3.80, when referring to, for example, measurements). The recitation of end points also includes the end point values themselves (e.g. from 1.0 to 5.0 includes both 1.0 and 5.0)</p>
<p id="p-0136" num="0197">Scanning System</p>
<p id="p-0137" num="0198">A first embodiment of a digital stripe scanning probe is now disclosed. The probe is &#x201c;digital&#x201d; in the sense that the probe comprises a process ng feature, for example, to compute the compute the intensity from one frame to another (e,g using a DSP processor or a FPGA processor) and/or to convert data recorded by the sensor into digital data <figref idref="DRAWINGS">FIG. 1</figref> is a layout of a scanning system <b>1</b> in accordance with a first embodiment of the present invention. The scanning system <b>1</b> comprises a digital stripe scanning probe <b>2</b> and a contact probe <b>3</b> mounted on a localiser <b>4</b>. The localiser <b>4</b> communicates with a computer <b>5</b> by means of a cable <b>6</b> or by wireless communication. The localiser <b>4</b> and an object <b>7</b> are mounted on a solid surface <b>8</b> such that there is no relative movement during scanning. It will be understood by people skilled in the art that this is an example of one such scanning system <b>1</b> that can be built using a digital stripe scanning probe <b>2</b>, but that other types of scanning system with a stripe scanning probe may be employed instead.</p>
<p id="p-0138" num="0199">Digital Stripe Scanning Probe</p>
<p id="p-0139" num="0200"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram of the digital stripe scanning probe <b>2</b>. The digital stripe scanning probe <b>2</b> comprises an imaging enclosure <b>11</b> and a stripe projector enclosure <b>12</b>. The enclosures <b>11</b>, <b>12</b> are mounted at either end of a rigid baseplate <b>13</b>. A stripe projector <b>14</b> is mounted on one end of the rigid baseplate <b>13</b>. A window <b>15</b> is provided in the stripe projector enclosure <b>12</b> for the lightpath <b>22</b> of the projected stripe to exit the stripe projector enclosure <b>12</b>. A camera <b>16</b> and lens <b>17</b> are mounted on the other end of the rigid baseplate <b>13</b> from the stripe projector <b>14</b>. A window <b>18</b> is provided in the imaging enclosure <b>11</b> for viewing the stripe on an object (not shown). A processing unit <b>19</b> is mounted inside the imaging enclosure <b>11</b>. A mounting plate <b>21</b> is provided on the baseplate <b>13</b> for mounting the digital stripe scanning probe <b>2</b> onto a localiser <b>4</b> (not shown). A connector <b>20</b> is provided for connecting a cable to the digital stripe scanning probe <b>2</b>; alternatively electrical connection could be automatically made at connector <b>20</b> when the digital stripe scanning probe <b>2</b> is mounted via mounting plate <b>21</b> onto a localiser <b>4</b>.</p>
<p id="p-0140" num="0201">Thermal Control</p>
<p id="p-0141" num="0202">Excess heat and temperature variation can cause a digital stripe scanning probe <b>2</b> to be inaccurate due to excessive thermal growth repositioning and or reorienting the optical components relative to each other and the mount <b>21</b> resulting in the measurements becoming inaccurate. State of the art stripe scanning probes have hot computer processing equipment located well away from the probe in a separate box. The temperature increase in these &#x2018;cool&#x2019; state of the art probes is small and careful thermal design has reduced thermal drift on start-up and enabled the probes to be used immediately without a warm-up period. The digital stripe scanning probe <b>2</b> has an on-board processing unit <b>19</b> and can generate more points per second than a state of the art stripe scanning probe. One reason for this is that the close proximity of the on-board processing unit <b>19</b> to the camera <b>16</b> permits data to be transferred rapidly from the camera <b>16</b> to the on-board processing unit using high bandwidth cables. Other reasons will be described below. The incorporation of the on-board processing unit <b>19</b> and the need for it to have high processing power, means that a lot of heat is generated in the digital stripe scanning probe <b>2</b>. In order to maintain the accuracy of and enable immediate use of the digital stripe scanning probe <b>2</b> without a warm-up period, a novel thermal control system is provided in which the hot processing unit <b>19</b> is situated in a hot compartment that is insulated from the optical components and baseplate which remain cool.</p>
<p id="p-0142" num="0203"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram of a cooling system for a further embodiment of the digital stripe scanning probe <b>2</b>. The imaging enclosure <b>11</b> is split into a hot compartment <b>34</b> and a cool compartment <b>33</b> by a thermal barrier <b>32</b>. In the hot compartment <b>34</b>, a fan <b>31</b> is mounted against an outlet perforated section <b>36</b> of the imaging enclosure <b>11</b> such that hot air can be expelled by the fan <b>31</b> through the outlet perforated section <b>36</b>. An inlet perforated section <b>37</b> is provided on the imaging enclosure <b>11</b> together with a dust filter <b>30</b>. Cool air sucked in through the inlet perforated section <b>37</b> passes through the processing unit <b>19</b>, is warmed up and exits through the outlet perforated section <b>36</b>. The heat generated in the cold compartment, hot compartment and projection enclosure of the digital stripe scanning probe <b>2</b> is H<sub>C</sub>, H<sub>L</sub>, H<sub>H </sub>respectively. Typical values are H<sub>C</sub>=0.5 W, H<sub>L</sub>=0.5 W, H<sub>H</sub>=3 W. In this case, approximately 75% of the heat generated in the digital stripe scanning probe <b>2</b> is H<sub>H </sub>and is generated by the processing unit <b>19</b> in the hot compartment <b>34</b>. The thermal barrier <b>32</b> reduces the flow of heat Q<sub>B </sub>from the hot compartment to the cool compartment. In the cool compartment <b>33</b>, the heat H<sub>C</sub>+Q<sub>B </sub>is removed by conventional conduction, convection and radiation. In the stripe projector enclosure <b>12</b>, the heat H<sub>L </sub>is removed by conventional conduction, convection and radiation. In the hot compartment <b>34</b>, the net heat H<sub>H</sub>. Q<sub>B </sub>is removed by conduction, radiation, convection and heat transfer Q<sub>A </sub>in which cool air passing through is warmed up. Without fan cooling, the hot compartment <b>34</b> typically operates at a temperature over 10 degrees Celsius higher than the cool compartment <b>33</b>. Although the thermal barrier <b>32</b> stops much of the heat transferring from the hot compartment <b>34</b> into the cool compartment <b>33</b>, the high temperature difference between the hot and cool compartments <b>34</b>, <b>33</b> requires a substantial thermal barrier <b>32</b> that is wide and heavy. The main problem with an uncooled hot compartment <b>34</b> is that when the digital stripe scanning probe <b>2</b> is used in hot ambient environments such as in a desert, the processing unit <b>19</b> overheats and stops working. A through-flow, fan-driven convection cooling system is most efficient for cooling the hot compartment <b>34</b> and removes heat Q<sub>A</sub>. The temperature difference between the hot and cold compartments <b>34</b>, <b>33</b> is around 2 degrees Celsius with forced convection. The thermal barrier <b>33</b> is constructed using materials and methods well known to those skilled in the art. In one extreme, the hot compartment <b>34</b> may be a separate enclosure from the cold compartment <b>33</b> with ambient air free to circulate between the two compartment enclosures. A further advantage of having separate hot and cold compartments <b>34</b>, <b>33</b> is that the fast-moving air caused by the fan <b>31</b>, does not pass over the optical components in the cold compartment and there are no resulting thermal fluctuations that reduce measuring stability. A temperature sensing device <b>35</b> is mounted in the baseplate <b>13</b> and is used as the input for thermal calibration of the digital stripe scanning probe <b>2</b> for use in environments with ambient temperatures typically varying from 0 to 40 C. Fans can fail with hard use over long periods in harsh, dirty environments. The digital stripe scanning probe <b>2</b> of the present embodiment with separate hot and cold compartments <b>34</b>, <b>33</b> can maintain its accuracy and be used without a functioning fan, in all but the hottest ambient environments.</p>
<p id="p-0143" num="0204">In an alternative embodiment, the hot compartment <b>34</b> contains a fan <b>31</b> for circulating air within the hot compartment <b>34</b> which is sealed and provided with efficient cooling fins.</p>
<p id="p-0144" num="0205">In an alternative embodiment, the digital stripe scanning probe <b>2</b> comprises a single enclosure within which there is a hot compartment <b>34</b> containing the processing unit <b>19</b>. This embodiment is more compact than a two-enclosure embodiment. This embodiment may have a through-flow forced cooling or an internal fan to circulate the air, or no fan.</p>
<p id="p-0145" num="0206">It will be understood by those skilled in the art, that other embodiments but includes all embodiments with separate hot and cold compartments are possible. For instance, the fan <b>31</b> and the filter <b>30</b> can be arranged together at the inlet with the fan sucking air in through the filter. In another embodiment, no filler is provided. In another embodiment, neither filter nor fan is provided and air naturally circulates in and out of the hot compartment through the perforations <b>36</b>, <b>37</b>.</p>
<p id="p-0146" num="0207">Visor</p>
<p id="p-0147" num="0208">Our experience with many hundreds of customers using our state of the art stripe scanning probes has shown that the main reason for any poor performance is that, despite training, the imaging window <b>18</b> becomes dirty and is not cleaned well by the user. The main source of dirt on the imaging window <b>18</b> is from dirty finger prints. For optical reasons, the imaging window <b>18</b> must be large and it is not possible to recess it sufficiently to make it physically impossible to touch.</p>
<p id="p-0148" num="0209">In an alternative embodiment of this invention, a visor is provided for protecting the imaging window <b>18</b> from being touched. <figref idref="DRAWINGS">FIG. 4</figref> is a schematic of the visor <b>41</b> on the digital stripe scanning probe <b>2</b>. The visor <b>41</b> rotates about two pivot positions on an axis <b>44</b> in which visor protrusions fit into dimples on the imaging enclosure <b>11</b>. The visor <b>41</b> can be locked in either of the Up or Down positions by means of a protrusion on the visor <b>45</b> settling into one of the two dimples <b>43</b> on the imaging enclosure <b>11</b>. For non-manual applications, the visor <b>41</b> may be removed all together by pulling it away from the imaging enclosure <b>11</b>. A visor detector <b>42</b> detects the presence of the visor <b>41</b> in the Down position; this information may be relayed to software that can inform the user that the visor <b>41</b> is stopping the operation of the digital stripe scanning probe <b>2</b>.</p>
<p id="p-0149" num="0210">The visor may be opaque or transparent.</p>
<p id="p-0150" num="0211">Stripe Trimmer</p>
<p id="p-0151" num="0212">When the digital stripe scanning probe <b>2</b> is being used to scan an area of detail, it is useful to be able to reduce the stripe length so as not to get excess data. State of the art scanning systems achieve a 50% reduction in stripe length using software that discards the last quarter of points at each end of the stripe. This is confusing to the operator because the operator sees a long stripe but only captures short stripe data and it is thereby difficult to use. In addition, the computer has to be used to set up this software feature.</p>
<p id="p-0152" num="0213">In another embodiment of the present invention, a manually rotatable stripe trimmer with multiple positions is provided for projecting different stripe lengths so that what the operator sees whilst scanning is the data that he captures. <figref idref="DRAWINGS">FIG. 5</figref> is four diagrams of the stripe trimmer <b>53</b> on the digital stripe scanning probe <b>2</b>. The stripe trimmer <b>53</b> has two positions: 100% stripe length (upper two diagrams) and 50% stripe length (lower two diagrams). The stripe trimmer <b>53</b> is mounted on the front of the stripe projector enclosure <b>12</b>, by means of a rotating bearing <b>54</b> and two locating dimples <b>56</b>. The user manually rotates it from one position to the other. A simple mechanical blocking system in which a pin on the stripe trimmer <b>53</b> impacts one of two blocks on the stripe projector enclosure <b>12</b> prevents the operator overturning the stripe trimmer <b>53</b> in either rotational direction. An indicator mark <b>51</b> on each side of the stripe trimmer <b>53</b> aligns with either the 50% rubric or the 100% rubric on the side of stripe projector enclosure <b>12</b> so that the operator can tell at a glance which position the stripe trimmer <b>53</b> is in. The stripe <b>55</b> emerges through the rectangular aperture <b>57</b>. In the 100% orientation, the stripe <b>55</b> passes through the length of the rectangular aperture <b>57</b> and is full length. In the 50% orientation, the stripe <b>55</b> passes through the width of the rectangular aperture <b>57</b> and is half length.</p>
<p id="p-0153" num="0214">It will be understood by those skilled in the art, that other configurations of a stripe trimmer are possible. For instance, with the pin and blocks removed, the stripe trimmer <b>53</b> could rotate round continuously, but with 4 dimple positions at 90 deg intervals. This has the advantage of having no blocks and each quarter-turn in either direction flips the stripe length from 50% to 100% or vice versa. The aperture <b>57</b> could be another shape such as a rounded slot rather than a rectangle.</p>
<p id="p-0154" num="0215">In another embodiment of the present invention, a shaped aperture is provided, allowing the user freedom to trim the stripe length between a minimum and a maximum. A good usability requirement for the shape of the aperture is to provide a constant ratio between rate of change of trimmer rotation angle and rate of change of stripe length. The resultant optimised aperture shape that can be generated by a person skilled in the art can be described as a monkey nut. A better usability requirement for the shape of the aperture is a constant ratio between rate of change of angle and rate of change of percentage stripe length. The resultant optimised aperture shape that can be generated by a person skilled in the art can be described as a pair of lips. The improved shape makes fine adjustment of a short stripe length easier, <figref idref="DRAWINGS">FIG. 6A</figref> is a schematic of a monkey nut shaped aperture for the stripe trimmer <b>53</b> between 50% and 100% where there is a constant ratio between rate of change of trimmer rotation angle and rate of change of stripe length. <figref idref="DRAWINGS">FIG. 6B</figref> is a schematic of a pair of lips shaped aperture for the stripe trimmer <b>53</b> between 50% and 100% where there is a constant ratio between rate of change of angle and rate of change of percentage stripe length. The shape of the aperture is different for different maximum/minimum stripe length ratios. For instance, with a minimum stripe length of 25%, the waist of the monkey nut is much smaller. Dimples can be located to guide the operator to positively locate the main positions that might be used such as for stripe lengths of 25%, 50%, 75% and 100%, such that a protrusion on the stripe trimmer <b>53</b> locates in the appropriate dimple. Other aperture shapes that change the stripe length with rotation are possible. Furthermore, embodiments are not limited to a rotary means of controlling the aperture, and a linear means such as sliding a trapezoidal shaped aperture across the projected laser stripes is possible. Yet, further embodiments are not limited to manual operation, and motorised control of the aperture either manually by push buttons or automatically by a process control system is possible.</p>
<p id="p-0155" num="0216">In a further embodiment, a sensor is provided to detect the position of the stripe trimmer set by the user, and a controller is provided to set the frame rate of camera <b>16</b> in dependence upon the detected position of the stripe trimmer. More particularly, the controller increases the frame rate as the length of the laser stripe decreases. This increased frame rate is possible because laser stripes of shorter length result in less pixel data to be read out and processed from the imaging sensor in camera <b>16</b>. As a result, the frame rate is optimised automatically for different laser stripe lengths.</p>
<p id="p-0156" num="0217">In an embodiment in which the stripe trimmer is adjusted automatically (rather than manually) in accordance with user input instructions defining a required laser stripe length, the controller may be arranged to set the frame rate in dependence upon the user instructions, thereby attaining the same advantages as those described above.</p>
<p id="p-0157" num="0218">Digital Stripe Scanning Probe Electronics</p>
<p id="p-0158" num="0219"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram of one embodiment of the electronics in the digital stripe scanning probe <b>2</b>. The processing unit <b>19</b> comprises four module PCBs: an FPGA module <b>75</b>, a DSP module <b>74</b> for communications, a peripheral interconnection module <b>73</b> and a power supply module <b>72</b>. The four modules are interconnected with power/data buses <b>80</b>. The camera <b>16</b> is connected to the FPGA module <b>75</b>. The peripheral interconnection module <b>73</b> connects to the temperature sensor <b>35</b>, the fan <b>31</b>, the rangefinder laser spot <b>71</b>, status LEDs <b>77</b>, the visor detector <b>42</b> and the stripe projector <b>14</b>. The DSP module <b>74</b> for communications links to a WiFi module <b>76</b>. A battery <b>78</b> is provided. The probe connector <b>20</b> links to the power/data buses <b>80</b>. Circuitry in the PSU module <b>72</b> is provided for recharging the battery <b>78</b>. Memory <b>79</b> is provided on the FPGA module <b>75</b> and the DSP module <b>74</b>. The memory <b>79</b> is both static and dynamic. The static memory <b>79</b> is used for storing identification, calibration, settings and other information such as usage history to aid maintenance. The settings in the static memory <b>79</b> may be changed by means of sending signals to the digital stripe scanning probe <b>2</b> over the communications bus. At least one accurate clock is provided for the purpose of time stamping synchronisation.</p>
<p id="p-0159" num="0220">It will be understood by those skilled in the art that other embodiments of the electronics in the digital stripe scanning probe <b>2</b> are possible. For instance, any or all of the modules in the processing unit <b>19</b> may be physically combined into a single module to suit packaging requirements. Any of the items <b>31</b>, <b>35</b>, <b>14</b>, <b>77</b>, <b>42</b>, <b>71</b>, <b>76</b> can be connected to or incorporated in any of the modules in the processing unit <b>19</b>. One or more chips can be combined into one chip. The power/data buses <b>80</b> may be configured in different arrangements to suit design requirements. The battery <b>78</b> may be permanent, rechargeable or replaceable.</p>
<p id="p-0160" num="0221">Cabling and Wireless</p>
<p id="p-0161" num="0222">The scanning system of <figref idref="DRAWINGS">FIG. 1</figref> has four main connection/communication requirements:
<ul id="ul0039" list-style="none">
    <li id="ul0039-0001" num="0000">
    <ul id="ul0040" list-style="none">
        <li id="ul0040-0001" num="0223">power/ground from localiser or computer to probe</li>
        <li id="ul0040-0002" num="0224">data communications between localiser and computer</li>
        <li id="ul0040-0003" num="0225">synchronisation between probe and localiser</li>
        <li id="ul0040-0004" num="0226">data communication between probe and computer.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0162" num="0227">A person skilled in the art may solve these connection/communication requirements using any effective combination of cables and wireless. Users prefer fewer cables.</p>
<p id="p-0163" num="0228">In the present embodiment, the probe, computer and localiser can share a common data bus such as Ethernet or Wifi. This reduces the cabling requirements. The use of a bus generally available on computers such as Ethernet, Wifi, USB or Firewire also removes the cost of purchasing a special PC card for a dedicated bus. Alternatively or in addition, data may be transferred between the probe and computer using a serial digital interface (SDI) which digital interface is well known in the art.</p>
<p id="p-0164" num="0229">Furthermore, in the present embodiment, a digital stripe scanning probe <b>2</b> can be used without cable attachment to a localiser <b>4</b>. A cable for power and ground is not required during use of the digital stripe scanning probe <b>2</b> due to the battery <b>78</b> built into it. However, the battery <b>78</b> will need replacing or recharging by cable. Data communications can be carried out with standard high bandwidth radio communication buses such as Wi-Fi. Where accurate clocks are present in both localiser <b>4</b> and digital stripe scanning probe <b>2</b>, then radio synchronisation can be used periodically to check/adjust the two clocks. In between these clock checks, both localiser <b>4</b> and digital stripe scanning probe <b>2</b> can timestamp each of their data packets and the data streams can be merged in downstream software.</p>
<p id="p-0165" num="0230">Synchronisation</p>
<p id="p-0166" num="0231">The digital stripe scanning probe <b>2</b> can be synchronised in more than one way without any change required to the hardware or firmware of the digital stripe scanning probe <b>2</b>. Localisers <b>4</b> operate in various ways. Different types of synchronisation are required for different localisers <b>4</b>. Synchronisation of the digital stripe scanning probe <b>2</b> with the localiser <b>4</b> is important for accuracy. The digital stripe scanning probe <b>2</b> has provision for generating and receiving different types of synchronisation signal in which the digital stripe scanning probe <b>2</b> can be either master, or slave to the localiser <b>4</b>, or slave to a master clock. Synchronisation signals include plain trigger signals and coded signals. Synchronisation signals can be real-time, pre-synchronised or post-synchronised. Pre- and post-synchronisation can make use of time stamping. Codes sent with a synchronisation signal can be quasi-unique identification codes and/or time stamp information. A small number of types of synchronisation are sufficient to cover nearly all localiser-probe synchronisation requirements. Different types of synchronisation are provided in the digital stripe scanning probe <b>2</b>. The operator sets the type of synchronisation to be used with a localiser by changing a setting in the digital stripe scanning probe <b>2</b>. Embodiments are not limited to the types of synchronisation disclosed herein, and any form of synchronisation of digital stripe scanning probe <b>2</b> and localiser <b>4</b> is possible.</p>
<p id="p-0167" num="0232">In the present embodiment, synchronisation is plug and play. A plug and play protocol/format is defined that covers a set of types of synchronisation. On being connected to a localiser <b>4</b>, the digital stripe scanning probe <b>2</b> and the localiser <b>4</b> automatically negotiate a synchronisation type. Plug and play has the advantage of not needing to have the operator set up each unit (localiser and digital stripe scanning probe) manually with specific synchronisation settings. A person skilled in the art may define the set of types of synchronisation to be used and the protocol/format.</p>
<p id="p-0168" num="0233">Light Levels</p>
<p id="p-0169" num="0234">The projected intensity of the laser stripe <b>55</b> for optimum incoming light level into the camera <b>16</b> varies by several orders of magnitude depending on factors including: surface colour, surface reflectivity, standoff distance from the digital stripe scanning probe <b>2</b> to the surface of the object <b>7</b>, surface normal relative to laser stripe projector <b>14</b>, surface normal relative to camera <b>16</b>, position of a point along the stripe and specular reflection. High projected intensity is required when the surface colour is dark and reflective, it is the end of the stripe, the surface normal points significantly away from both the camera <b>16</b> and the laser stripe projector <b>14</b> and there is a large standoff. Under these conditions very little of the projected laser power scatters back into the camera <b>16</b>. Low projected intensity is required in the middle of a stripe on a mirror surface at the specular angle and low standoff. Under these conditions virtually all the laser power is reflected straight back into the camera <b>16</b>. Typical differences in optimum projected laser intensity span a range of 100,000:1. An average CCD camera with a fixed setup can rarely produce quality scan data with a range of 1,000:1 in light level along the stripe. To achieve the best data quality when scanning, it is ideal to optimise the projected laser intensity for each point along the stripe. In state of the art stripe scanning probes with a static laser stripe, the whole stripe is imaged by a CCD camera at the same time.</p>
<p id="p-0170" num="0235">U.S. Pat. No. 5,193,120 (Gamache et al.) and JP2000-097629 (Mishitoshi et al.) disclose scanners comprising a CCD and a laser stripe generated with a cylindrical lens. A calculation engine is used to control the amount of light received depending on the light received in an earlier frame. The control consists in adjusting the exposure time of the CCD, the laser power, etc. Because of the properties of the CCD, the entire frame is captured at once. Furthermore, when using a cylindrical lens, the laser beam is split in a stripe and all points of the stripe have the same intensity. Therefore, with the configuration proposed by Gamache and Mishitoshi, it is not possible to vary or control the imaged intensity within a frame.</p>
<p id="p-0171" num="0236">State of the art stripe scanning probes work well on matte white surfaces because the variation in incoming light levels along the stripe vary by well under 1000:1. State of the art stripe scanning probes fail when scanning objects such as reflective spheres; failure is at both extremes: too much incoming light in areas of specular reflection and too little incoming light at the ends of the stripe.</p>
<p id="p-0172" num="0237">One embodiment of the present invention relates to a scanning probe <b>2</b> for capturing data from a plurality of points on the surface of an object by irradiating the object with a light stripe and detecting light reflected from the object surface, the scanning probe comprising:
<ul id="ul0041" list-style="none">
    <li id="ul0041-0001" num="0238">(a) stripe generating means <b>14</b> for generating and emitting a light stripe <b>55</b>;</li>
    <li id="ul0041-0002" num="0239">(b) a camera <b>16</b> comprising an imaging sensor having an array of pixels to detect the light stripe reflected from the object surface;</li>
    <li id="ul0041-0003" num="0240">(c) means for adjusting the intensity of the light stripe <b>55</b> during acquisition of a frame, in dependence upon the intensities detected by the camera <b>16</b>.</li>
</ul>
</p>
<p id="p-0173" num="0241">Adjustment to the intensity of the light stripe is performed during acquisition of a single frame, based on intensities detected by the camera while the frame is still being acquired. The invention achieves this by, for example, using a roller shutter which sequentially scans the surface of a 2D sensor; the adjustment is achieved using one or more intensities registered during a previous part of the rolling shutter scan. Alternatively or in addition, this is achieved using a stripe comprising individual spots that are rapidly and separately projected over the object. The spots effectively illuminate a portion of the object at a time, scanning the object sequentially; the adjustment is achieved using intensities registered during a previous part of the scan.</p>
<p id="p-0174" num="0242">In both alternatives, different subsets of the imaging sensor pixels at different times detect light reflected from the stripe during the acquisition of a frame, the different subsets corresponding to different positions on the detected light stripe. Preferably the different positions are adjacent. The intensity of the light is adjusted during acquisition of the frame, in dependence upon the intensities detected by the subset of pixels. Particular embodiments of the invention using a CMOS camera, a CCD camera, static and moving optics are described below.</p>
<p id="p-0175" num="0243">Stripe Imaging using a CMOS Camera and Rolling Shutter</p>
<p id="p-0176" num="0244">According to one embodiment of the invention, a camera <b>16</b> is one provided with a rolling shutter and the laser intensity is controlled such that the laser intensity for the stripe or each point in the stripe and the scan data is of optimum quality for any given captured frame. The laser stripe projector <b>14</b> may use static optics (e.g. solid cylindrical optics or a solid state micro-mirror array) for generating the stripe from a laser diode and lens. Alternatively, the laser stripe projector <b>14</b> may use moving optics (e.g. moving mirror) which are mechanically driven.</p>
<p id="p-0177" num="0245">Using a solid cylindrical optics, a laser of constant or variable intensity is projected through the optics resulting in a laser stripe <b>55</b> having an essentially unvariable intensity across the length of the stripe, which intensity can be increased or decreased across the length of the stripe.</p>
<p id="p-0178" num="0246">With a micro-mirror array, a laser of constant or variable intensity is projected onto the micro-mirror array. The stripe is essentially a plurality of spots. One or more spots can scan the object very rapidly (e.g. 500, 60, 700, 800, 900, 1000 or more Hz) giving the appearance of a continuous stripe. The resulting laser stripe <b>55</b> is formed from a plurality of points whose intensities can individually be controlled. The laser stripe <b>55</b> is generated by controlling the orientation of the micro-mirrors. The result can be a stripe <b>55</b> with unvariable intensity across the length of the stripe, as achieved using solid cylindrical optics. Alternatively, the result can be a stripe with variable intensity across the length of the stripe. For example, the micro-mirrors generating a first half of the stripe may spend two thirds of the time reflecting laser light towards the stripe, while the micro-mirrors generating the second half of the stripe may spend one third of the time reflecting laser light towards the stripe. In this example, the first half of the sensor would receive twice as much intensity than the second half. Micro-mirror arrays are known in art, for example, the DLP system produced by Texas Instruments (www.dlp.com).</p>
<p id="p-0179" num="0247">With a moving mirror array, the resulting laser stripe <b>55</b> is formed from a plurality of spots whose intensities can individually be controlled. One or more spots can scan the object very rapidly (e.g. 500, 60, 700, 800, 900, 1000 or more Hz) giving the appearance of a continuous stripe. The result may be a stripe <b>55</b> with unvariable intensity across the length of the stripe, as achieved using solid cylindrical optics. Alternatively, the result can be a stripe with variable intensity across the length of the stripe as achievable using a micro-mirror array. The mirror is typically a rotating polygon mirror or an oscillating galvanometer mirror that generates a flying spot that is synchronised with the laser power for each point along the projected stripe. A telecentric lens may be needed to enable synchronised operation at near and far standoffs. The angular velocity of the rotating mirror requires precise control and synchronisation which can be provided by a person skilled in the art.</p>
<p id="p-0180" num="0248">The laser stripe <b>55</b> is static and does not move relative to the baseplate <b>13</b>. The projected intensity of the laser stripe <b>55</b> may be controlled by controlling the power to the laser diode in the laser stripe projector <b>14</b> (for solid cylindrical optics or moving optics) and/or by controlling the micro-mirror array where present to project more or less intense light. The adjustment to the laser diode will be up to a maximum power consistent with an acceptable lifetime for the digital stripe scanning probe <b>2</b>. In addition, the laser diode power can be switched on and off and strobed at a high frequency. The high frequency of the laser power strobing must be much greater than the exposure time of a pixel on the imaging sensor in the camera <b>16</b> so as to project very low laser powers without causing timing problems. The imaging sensor in the camera <b>16</b> has an optimum incoming light level for the laser light coming into the camera <b>16</b> for a particular set of camera and image processing operating parameters (exposure, aperture, sensitivity, threshold). <figref idref="DRAWINGS">FIG. 8</figref> is two views of a digital stripe scanning probe <b>2</b> imaging an object <b>7</b> that is a reflective sphere. The stripe <b>55</b> is projected by the stripe projector <b>14</b> and imaged by the camera <b>16</b>. The left hand view is a side view. The right hand view is a front view. The centre &#x2018;S&#x2019; of the stripe <b>55</b> is specularly reflecting into the camera <b>16</b>.</p>
<p id="p-0181" num="0249"><figref idref="DRAWINGS">FIG. 9A</figref> is a diagram of the stripe image <b>82</b> of the stripe <b>55</b> on the imaging sensor <b>81</b>. The curve of the stripe <b>55</b> on the spherical object <b>7</b> is imaged as a curve on the stripe image <b>82</b>. The imaging sensor <b>81</b> is a CMOS sensor with rolling shutter. Imaging sensor chips <b>81</b> can he bought from a variety of manufacturers including Cypress Semiconductor Corporation (USA) who make the IBIS 5A-1300 CMOS imaging sensor. The Imaging sensor <b>81</b> is a 2D array of pixels and has a number of rows R<sub>1 </sub>. . . R<sub>N </sub>that is typically 1000 or more rows. The imaging sensor <b>81</b> is configured to have a rolling shutter which sweeps across the sensor, exposing rows of pixels sequentially during the acquisition of a frame. At any given time during acquisition of a single frame, a number (a subset) of pixels collect light whilst the rest of the pixels do not collect light. The full sweep of rolling shutter leads additively to exposure of essentially the entire imaging sensor array, during the acquisition period.</p>
<p id="p-0182" num="0250">A CMOS comprises a 2D array of light sensitive pixels which are capable of capturing an image. Each pixel performs its own A/D conversion within the CMOS, thus the output from a CMOS is digital, and there is no need to digitise the frame using a frame grabber. Furthermore, each pixel can be accessed individually to determine the intensity of light falling thereon. For this reason, a CMOS is also called an &#x201c;addressable camera&#x201d;. A CMOS can to used in a rolling shutter mode. The addressability allows flexibility in the integration time for each pixel; it need not be the same for all pixels. For example, the first half of a stripe may be integrated between t=0 and t=5 s, and the second half between t=5 and t=10 s.</p>
<p id="p-0183" num="0251">The shutter rolls in effect from row R<sub>1 </sub>to row R<sub>n</sub>. Row R<sub>3 </sub>is shaded to indicate that at time T, now R<sub>3 </sub>is collecting light whilst all the other rows are not collecting light. In state of the art stripe scanning probes, imaging sensors that typically have more columns than rows, are usually positioned in a landscape format so that the stripe is imaged over the maximum number of columns providing more points along a stripe for a given sensor. In the digital stripe scanning probe <b>2</b>, the imaging sensor <b>81</b> has been rotated 90 degrees to take advantage of the rolling shutter; the rows and columns are thereby interchanged in the present figure.</p>
<p id="p-0184" num="0252"><figref idref="DRAWINGS">FIG. 9B</figref> is a diagram of the intensity I<sub>I </sub>imaged by each row over time t, compared to the optimum imaged intensity I<sub>IO </sub>for the imaging sensor <b>81</b>. The stripe will image over several columns and the imaged intensity I<sub>I </sub>is the area under the curve when calculating the column centroid of a row. The optimum imaged intensity I<sub>IO </sub>is an intensity set by a skilled person adjusting laser power control parameters such that no pixel is flooded with too much light and the average signal in each pixel is well above the background noise that is removed by thresholding during image processing. The imaged intensity I<sub>I </sub>is close to the optimum imaged intensity I<sub>IO </sub>along the imaged stripe <b>82</b>. <figref idref="DRAWINGS">FIG. 9C</figref> is a diagram of the projected intensity I<sub>P </sub>output (on a log 10 scale) by the stripe projector <b>14</b> over time t. The projected intensity I<sub>P </sub>at each point on the stripe <b>55</b> is the projected intensity I<sub>P </sub>that results in an imaged intensity I<sub>I </sub>for that point, that is as close as possible to the optimum imaged intensity I<sub>IO</sub>. At point S, the projected intensity I<sub>P </sub>is small because at point S there is specular reflection of the projected intensity back into the camera <b>16</b>. At either end of the stripe <b>55</b>, such as row R<sub>1</sub>, the projected intensity I<sub>P </sub>is large because most of the projected light is scattered away from camera <b>16</b> and only a small proportion of the light travels to the image sensor <b>81</b>.</p>
<p id="p-0185" num="0253">The projected stripe <b>55</b> may have unvariable intensity across its length whereby an adjustment to the laser intensity will be evidenced across the stripe. Where the projected stripe <b>55</b> is generated using a micro-mirror or moving optics, the intensity within the stripe may also be adjusted as the stripe is effectively a series of individually projected spots. The projection of the spots can be synchronised with the rolling shutter such that adjustment of intensity can be applied to a part of the stripe <b>55</b> during the acquisition of a frame, with the effect that each frame captured by the CMOS is optimised.</p>
<p id="p-0186" num="0254">Stripe Imaging Using a CCD Camera</p>
<p id="p-0187" num="0255">According to another embodiment, the camera <b>16</b> is a CCD camera having a 2D array of sensors, and the laser stripe projector <b>14</b> is one that uses a moving mirror or a micro-mirror array in combination with a laser diode and lens. The moving mirror and the micro-mirror array are described above.</p>
<p id="p-0188" num="0256">The resulting laser stripe <b>55</b> is static relative to the baseplate <b>13</b>, but is formed from a plurality of points whose intensities can individually be controlled such that the laser intensity for each point in the stripe and the scan data is of optimum quality for any given frame.</p>
<p id="p-0189" num="0257">The projected intensity within the laser stripe <b>55</b> is controlled by controlling the power to the laser diode and/or by controlling the micro-mirror array where present to project more or less intense light. The adjustment to the laser diode will be up to a maximum power consistent with an acceptable lifetime for the digital stripe scanning probe <b>2</b>. In addition, the laser diode power can be switched on and off and strobed at a high frequency. The high frequency of the laser power strobing must be much greater than the time it takes for the mirror to sweep the stripe, and also much greater than the exposure time of a pixel on the CCD sensor in the camera <b>16</b> so as to project very low laser powers without causing timing problems. The CCD sensor in the camera <b>16</b> has an optimum incoming light level for the laser light coming into the camera <b>16</b> for a particular set of camera and image processing operating parameters (exposure, aperture, sensitivity, threshold).</p>
<p id="p-0190" num="0258"><figref idref="DRAWINGS">FIG. 8</figref> as described above applies to this embodiment and to the following description. <figref idref="DRAWINGS">FIG. 10F</figref> is a diagram of the stripe image <b>131</b> of the stripe <b>55</b> (<figref idref="DRAWINGS">FIG. 8</figref>) on the imaging sensor <b>132</b>. The stripe image <b>131</b> represents a captured frame. The curve of the stripe <b>55</b> on the spherical object <b>7</b> is imaged as a curve on the imaging sensor <b>131</b>. The imaging sensor <b>132</b> may be a CCD which can capture the intensity and position of light reflected from the object. The imaging sensor <b>132</b> is typically a 2D array of pixels and has a number of rows R<sub>1</sub>, . . . R<sub>N </sub>that is generally 1000 or more rows. Detection of an over- or under-saturated sensor in the array leads to a compensatory adjustment in laser intensity. The projected stripe <b>55</b> is effectively a series of spots projected from the laser by the sweep of a moving mirror. Adjustment of intensity can be applied to a part of the stripe <b>55</b> during the acquisition of a frame, with the effect that each frame captured by the CCD is optimised.</p>
<p id="p-0191" num="0259"><figref idref="DRAWINGS">FIGS. 10A</figref> to E show the incomplete patterns (<b>133</b><i>a </i>to <b>133</b><i>e</i>) of the stripe image <b>131</b> detected by the CCD <b>132</b> during acquisition of a complete frame at time intervals T=1 to T=5. At the first time interval T=1 (<figref idref="DRAWINGS">FIG. 10A</figref>), the image intensity of the incomplete pattern <b>133</b><i>a </i>is integrated, and result used to adjust the power output of the laser in detection of the pattern <b>133</b><i>b </i>during the next time interval T=2 (<figref idref="DRAWINGS">FIG. 10B</figref>). The cycle is repeated for subsequent patterns (<b>113</b><i>c </i>to <b>113</b><i>e</i>), until the length of the laser stripe <b>55</b> has been detected by the CCD sensor <b>132</b>. At the end of the detection period (T=1 to T=5), the image of the acquired frame has been optimised.</p>
<p id="p-0192" num="0260"><figref idref="DRAWINGS">FIG. 11A</figref> is a diagram of the imaged intensity I<sub>I </sub>of each incomplete pattern obtained by integration of the intensity during each time periods T<b>1</b> to T<b>5</b>, together with the optimum imaged intensity I<sub>IO </sub>for the imaging sensor <b>132</b>. The optimum imaged intensity I<sub>IO </sub>is an intensity set by a skilled person adjusting laser power control parameters such that no pixel in the CCD is flooded with too much light and the average signal in each pixel is well above the background noise that is removed by thresholding during image processing.</p>
<p id="p-0193" num="0261">The imaged intensity I<sub>I </sub>is close to the optimum imaged intensity I<sub>IO </sub>along the imaged stripe <b>132</b>. <figref idref="DRAWINGS">FIG. 11B</figref> is a diagram of the projected intensity I<sub>P </sub>output (on a log 10 scale) by the stripe projector <b>14</b> over time t. The projected intensity I<sub>P </sub>at each point on the stripe <b>55</b> is the projected intensity I<sub>P </sub>that results in an imaged intensity I<sub>I </sub>for that point, that is as close as possible to the optimum imaged intensity I<sub>IO</sub>. At point S, the projected intensity I<sub>P </sub>is small because at point S there is specular reflection of the projected intensity back into the camera <b>16</b>. At either end of the stripe <b>55</b>, such as now R<sub>1</sub>, the projected intensity I<sub>P </sub>is large because most of the projected light is scattered away from camera <b>16</b> and only a small proportion of the light travels to the image sensor <b>132</b>.</p>
<p id="p-0194" num="0262">Projected Intensity Control</p>
<p id="p-0195" num="0263">The DSP processor in the module <b>74</b>, executes a stripe intensity projection firmware procedure for taking a previously generated set of projected intensities with one projected intensity for each point along a stripe and outputting corresponding laser power values to the laser power circuitry on the peripheral module <b>73</b>. The laser power values are output in synchronisation with the timing of the rolling shutter on the imaging sensor <b>81</b> or movement of the mirror/micro-mirror such that the laser power corresponding to the required projected intensity for a point on the stripe is provided. In the case of a roller shutter system, the projected intensity is provided whilst the corresponding row on the imaging sensor <b>81</b> has the shutter open. In the case of a moving mirror system, the projected intensity is provided synchronised to the position of the mirror and projected spot. In the case of a micro-mirror system, the projected intensity is provided synchronised to the mirror-vibration frequencies and projected spots. It is a simple matter for persons skilled in electronics and processor software to implement circuitry and a firmware procedure to achieve these functions.</p>
<p id="p-0196" num="0264">Adaptive Stripe Intensity Control Method</p>
<p id="p-0197" num="0265">According to one embodiment of the invention, the ideal projected intensity of the laser for each point along the next stripe is estimated by using the imaged intensity for each point in one or more previous stripes and the known projected intensities of the laser for each point in the one or more previous stripes and iterating to a new estimate.</p>
<p id="p-0198" num="0266">According to another embodiment of the invention, the ideal projected intensity within a stripe, for the next point along the stripe is estimated by using the imaged intensity for one or more previous points within a stripe and the known projected intensities for one or more previous points within the stripe and iterating to a new estimate.</p>
<p id="p-0199" num="0267"><figref idref="DRAWINGS">FIG. 12</figref> is a method for calculating the new projected intensity for a point on a stripe. In Step <b>91</b>, one or more imaged intensities are received for the same point on one or more previous stripes, or for one or more previous points within the same stripe. In Step <b>92</b>, one or more projected intensities are received for the same point on one or more previous stripes, or for projected intensities are received for one or more previous points within the same stripe. The received projected intensities are the values used by the DSP processor in the module <b>74</b> for controlling the laser power in previous stripes or points. In Step <b>93</b>, a new projected intensity is calculated for the same point in the next stripe, or for a next point in the same stripe.</p>
<p id="p-0200" num="0268">Intensity Algorithm</p>
<p id="p-0201" num="0269">A simple algorithm for calculating the new projected intensity is based on the previous imaged intensity for a point and the previous projected intensity for the same paint. The relationship between previous imaged intensity and previous projected intensity is different for each design of digital stripe scanning probe <b>2</b> and is usually non-linear. An elliptical relationship has been found to be a good starting approximation, but parabolic or other relationships based on equations can be better. A single relationship can generally be used for all points in all rows. Each point has an unknown and usually changing light reflectance ratio. The previous coordinate for that light reflectance ratio is known: previous imaged intensity, previous projected intensity. The relationship is scaled using two coordinates: (previous imaged intensity, previous projected intensity) and the (0,0) point where both imaged and projected intensities are zero. The relationship can be expressed as an equation or embedded in a look-up table. <figref idref="DRAWINGS">FIG. 14</figref> is a diagram for a relationship <b>94</b> between the imaged intensity I<sub>I </sub>and the projected intensity I<sub>P</sub>. The relationship <b>94</b> is scaled to fit between the zero point <b>97</b> and the coordinate <b>95</b> of the previous imaged intensity and previous projected intensity. The scaled relationship is based on the measured light reflectance ratio from the previous point. The next projected intensity is calculated from the optimum imaged intensity I<sub>IO </sub>and the relationship <b>94</b> via coordinate <b>96</b>. The optimum imaged intensity I<sub>IO </sub>can be substantially larger or smaller than the previous imaged intensity.</p>
<p id="p-0202" num="0270">It will be appreciated by those skilled in the art, that a number of different methods can be used for generating the new projected intensity for a point. It will also be appreciated that a number of modifications will be obvious to those skilled in the art. The disclosed calculation of the next projected intensity assumes an unchanging light reflectance ratio; this is a best estimate, since the light reflectance ratio is likely to have changed by a small amount as the laser stripe <b>55</b> moves relative to the surface of the object <b>7</b>. Interpolation methods may be used where several previous projected and imaged intensities are processed. Smoothing methods may be used as a post process taking into account neighbouring next projected intensities.</p>
<p id="p-0203" num="0271">Rolling Shutter Multi-Row Exposure</p>
<p id="p-0204" num="0272">There are many different types and configurations for a rolling shutter. The exposure time is fixed for each frame. In general, a rolling shutter starts with the first pixel on row <b>1</b> and ends with the last pixel on the last row before continuing again at the first pixel on row <b>1</b>, possibly with a different exposure time. Each pixel is open to receive light for a certain amount of time: the exposure time. The length of exposure time of the rolling shutter depends on the imaging sensor, its setup and the laser power. At 100 frames per second and 1000 rows, an exposure of 0.1 msec will cover 10 rows. This means that 10 rows will be imaging light at any time. The ideal situation is then to reduce the exposure to 0.01 msec, but at such a short time, not enough light will be imaged. The laser intensity could be increased, but safety regulations for operator use of laser stripes limit this intensity. In practice, under different conditions, from 1 to 100 rows out of 1000 rows will be imaging light at any time. The disclosed adaptive stripe intensity control method is modified. The projected intensity for a point is now calculated as the average of all the projected intensities that were projected whilst the aperture was open on the row corresponding to that point. It will be appreciated by those skilled in the art, that a number of different methods and optimisations can be used for generating the new projected intensity for a point where multiple rows are simultaneously exposed.</p>
<p id="p-0205" num="0273">In the present embodiment, the exposure time is modified from one frame to the next, if there is a benefit to be gained in data quality by increasing or decreasing the exposure time. Where it is difficult to reach the optimum imaging intensity of parts of a stripe with the laser power at the maximum permissible power, then the exposure time is increased. Where the laser power is low for the whole frame, the exposure time is reduced in order to reduce the number of rows exposed simultaneously. A reduction in the number of rows exposed simultaneously increases the sharpness of response to any rapid changes in light reflection of the surface and optimises data quality.</p>
<p id="p-0206" num="0274">Labelling Data Quality</p>
<p id="p-0207" num="0275">The present embodiment is adaptive to rapid changes in surface texture and shape as the digital stripe scanning probe <b>2</b> moves over the surface of the object <b>7</b>. The reaction time to rapid changes is typically one stripe which on a system running at 200 stripes per second is equal to 5 msecs. It is likely that where there are rapid changes, the data quality will be worse during the change. In calculating the imaged intensity for each point, it is possible to give an indication of data quality. In the simplest form, data that does not pass a quality threshold, can simply be destroyed prior to data output to the application software. For some applications, a label can be attached to each sub-standard data point giving the degree of quality. A label of one byte in size could label quality from 0 (poor) to 255 (excellent).</p>
<p id="p-0208" num="0276">Scanned Stripe</p>
<p id="p-0209" num="0277">In an alternative embodiment, a laser stripe is created by scanning a laser spot using a rotating polygon mirror or an oscillating galvanometer mirror. The flying spot is synchronised with the rolling shutter and the laser power is set for each point along the projected stripe. A telecentric lens is needed to enable synchronised operation at near and far standoffs. The angular velocity of the rotating mirror requires precise control and synchronisation which can be provided by a person skilled in the art.</p>
<p id="p-0210" num="0278">Tracking Window</p>
<p id="p-0211" num="0279">The present embodiment increases the speed in stripes per second of the digital stripe scanning probe <b>2</b> by using a tracking rectangular window in which the stripe is present rather than a full frame. <figref idref="DRAWINGS">FIG. 13</figref> is a schematic of a stripe image <b>82</b> moving down an imaging sensor <b>81</b> within a tracking window <b>84</b>. The tracking window <b>84</b> is always the full width of the imaging sensor <b>81</b>. The tracking window <b>84</b> moves up and down tracking the stripe. The depth of the tracking window <b>84</b> can increase and decrease as the shape of the stripe image <b>82</b> changes. The tracking window <b>84</b> is larger than the rectangular area occupied by the stripe image <b>82</b>; this extra window area enables the stripe to move significantly between frames and still be captured. The extra window area is typically 10% of the height of the imaging sensor <b>81</b> at the top and at the bottom. There is a minimum height of tracking window <b>84</b>, which is typically 25% of the height of the imaging sensor <b>81</b> array. For the first frame of a scan, the window is the size of the whole frame. In following frames, the window shrinks down around the stripe image <b>82</b>. When a frame is processed. L the lowest point on the stripe image <b>82</b> and H the highest point on the stripe image <b>82</b> are calculated. The window size for a following frame is given as from H+0.1F to L&#x2212;0.1F where F is the number of columns in the imaging sensor <b>81</b>. The latency on the tracking can be restricted by the design of the imaging sensor <b>81</b> and the camera <b>16</b>.</p>
<p id="p-0212" num="0280">The advantage of using a tracking window is that it is not necessary to read out (or process) the data from the parts of the sensor which are outside the tracking window, resulting in significant time savings. Moreover, because of these time savings, more points per second may be acquired by the scanner. This is because the faster processing of data from one frame allows more frames per second to be captured and processed. This higher sampling results in better accuracy in point location (for example, the same point may be acquired several times and averaged). Storage requirements are also reduced because less data is read out and stored from the sensor. With a CMOS, the tracking can be set electronically as only a part of the frame is effectively read. With a CCD, as the entire frame is read, the tracking provides benefits during the computation as there is less data to process.</p>
<p id="p-0213" num="0281">The scanner may be arranged so that the pixels outside the tracking window do not accumulate charge during the integration time of the sensor. Alternatively, the scanner may be arranged so that all pixels accumulate charge. In the latter case, the charge for the pixels outside the tracking window is not read out, but is reset before the next sensor integration period.</p>
<p id="p-0214" num="0282">The rolling shutter described above operates within the tracking window.</p>
<p id="p-0215" num="0283">Sensors</p>
<p id="p-0216" num="0284">In the embodiments described above, the scanning probe has an imaging sensor comprising a CMOS sensor and a rolling shutter, or comprising a CCD.</p>
<p id="p-0217" num="0285">The CMOS is suitable for rolling shutter applications because each pixel can be individually addressed. A CMOS is also called an &#x201c;addressable camera&#x201d;. Furthermore, in a CMOS, each pixel performs its own A/D conversion. Also, using a rolling shutter, the integration time need not be the same for all pixels: for example, the first halt is integrated between t=0 s and t=5 s, and the second half between t=5 s and t=10 s. However, for the rolling shutter application, any type of addressable imaging sensor may be used, that is any type of sensor which permits selective read out of data from a predetermined region of the sensor without having to read out data from the other regions in the sensor. For example, certain types of CCD are addressable because they permit data to be read out from selected rows or columns of pixels, and these CCDs may be used in embodiments.</p>
<p id="p-0218" num="0286">The individual pixels of a CCD are not addressable, therefore, the present invention employs the combination with a variable intensity stripe or achieve an optimised frame. In a CCD the light is integrated in each pixel during a common period of time (exposure time): say from 0 to 10 s. At the end of the integration, the entire analog signal is transferred to a frame grabber to be digitalized.</p>
<p id="p-0219" num="0287">Laser Modifications</p>
<p id="p-0220" num="0288">In the embodiments described above, the stripe projector <b>14</b> of the scanning probe employs a laser to irradiate the object surface* The laser may emit light in any part of the electromagnetic spectrum such as the visible, infrared, etc. Furthermore, alternatives such as a white light source may be used instead of a laser.</p>
<p id="p-0221" num="0289">Other Modifications</p>
<p id="p-0222" num="0290">In the embodiments described above, a single stripe projector <b>14</b> and a single camera <b>16</b> are used. However multiple cameras may be used in conjunction with a single stripe projector. Alternatively, multiple cameras may be used with multiple stripe projectors&#x2014;for example, each stripe projector may project stripes at different orientations and each camera may detect a respective stripe.</p>
<p id="p-0223" num="0291">In the embodiments described above, the scanning probe is moved relative to the object to scan the object, and a localiser is used to determine the position of the scanning probe. However, instead, the scanning probe may be maintained in a stationary position and the object moved to known positions relative to the stationary probe. For example, the position of the object may be determined using one of the localisers described above.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A scanning probe for capturing data from a plurality of points on a surface of an object by irradiating the object with a light stripe and detecting light reflected from the object surface, the scanning probe comprising:
<claim-text>(a) a stripe generator for generating a light stripe;</claim-text>
<claim-text>(b) an imaging sensor to detect the light stripe reflected from the object surface; and</claim-text>
<claim-text>(c) an aperture through which the light stripe generated by the stripe generator is emitted, the aperture being variable to provide an aperture of a first width and an aperture of a second width through which the light stripe passes such that light stripes of different lengths are generated when the aperture is arranged at different widths.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A scanning probe according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the aperture is of non-circular shape and is variable by rotation relative to the light stripe to provide the apertures with the first and second widths.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A scanning probe according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the aperture is manually variable.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A scanning probe according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, further comprising:
<claim-text>an aperture position detector for detecting whether the aperture is set to the first width or the second width; and</claim-text>
<claim-text>a frame rate setter for setting a detection frame rate of the imaging sensor in dependence upon a detected width.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A scanning probe according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising an aperture adjuster for varying the aperture in response to user input instructions.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A scanning probe according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, further comprising a frame rate setter for setting a detection frame rate of the imaging sensor in dependence upon the user input instructions.</claim-text>
</claim>
</claims>
</us-patent-grant>
</my-root>
